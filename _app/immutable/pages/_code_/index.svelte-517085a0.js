import{S as rs,i as is,s as ns,e as un,b as dt,f as jt,g as fu,t as tr,d as du,h as se,o as zm,U as Ut,V as Er,j as Am,O as zc,l as Ie,m as ke,n as we,p as X,W as Rh,q as De,X as Bh,Q as Ac,R as Pc,T as Cc,Y as Tl,Z as Xo,_ as Wo,I as ie,K as Rc,E as xs,$ as Os,J as ln,r as tt,u as rt,v as Pr,w as xi,x as bi,y as wi,B as Si,a as ht,c as pt,M as Rn,G as mu,a0 as Pm,a1 as yd,P as Pg,a2 as Cg,a3 as Vp,a4 as Np,a5 as Mg,C as Wl,z as Hl,A as Jl}from"../../chunks/index-cfd5f23c.js";import{a as cu,u as Oh,S as Dg,m as Na,c as gd,b as Lg,d as Ir,e as Fh}from"../../chunks/Section-345755f2.js";import{b as ol}from"../../chunks/paths-1c47712a.js";import{c as yu,w as Tr,d as Ji}from"../../chunks/singletons-b37796d7.js";/* empty css                                                                 */var _d={},Ep={},Tp=34,Sc=10,Ip=13;function Cm(c){return new Function("d","return {"+c.map(function(p,m){return JSON.stringify(p)+": d["+m+'] || ""'}).join(",")+"}")}function Rg(c,p){var m=Cm(c);return function(v,S){return p(m(v),S,c)}}function vd(c){var p=Object.create(null),m=[];return c.forEach(function(v){for(var S in v)S in p||m.push(p[S]=S)}),m}function Va(c,p){var m=c+"",v=m.length;return v<p?new Array(p-v+1).join(0)+m:m}function Bg(c){return c<0?"-"+Va(-c,6):c>9999?"+"+Va(c,6):Va(c,4)}function Og(c){var p=c.getUTCHours(),m=c.getUTCMinutes(),v=c.getUTCSeconds(),S=c.getUTCMilliseconds();return isNaN(c)?"Invalid Date":Bg(c.getUTCFullYear())+"-"+Va(c.getUTCMonth()+1,2)+"-"+Va(c.getUTCDate(),2)+(S?"T"+Va(p,2)+":"+Va(m,2)+":"+Va(v,2)+"."+Va(S,3)+"Z":v?"T"+Va(p,2)+":"+Va(m,2)+":"+Va(v,2)+"Z":m||p?"T"+Va(p,2)+":"+Va(m,2)+"Z":"")}function Fg(c){var p=new RegExp('["'+c+`
\r]`),m=c.charCodeAt(0);function v(W,K){var H,fe,Oe=S(W,function(ze,Ke){if(H)return H(ze,Ke-1);fe=ze,H=K?Rg(ze,K):Cm(ze)});return Oe.columns=fe||[],Oe}function S(W,K){var H=[],fe=W.length,Oe=0,ze=0,Ke,Xe=fe<=0,Ft=!1;W.charCodeAt(fe-1)===Sc&&--fe,W.charCodeAt(fe-1)===Ip&&--fe;function Lt(){if(Xe)return Ep;if(Ft)return Ft=!1,_d;var He,xr=Oe,cr;if(W.charCodeAt(xr)===Tp){for(;Oe++<fe&&W.charCodeAt(Oe)!==Tp||W.charCodeAt(++Oe)===Tp;);return(He=Oe)>=fe?Xe=!0:(cr=W.charCodeAt(Oe++))===Sc?Ft=!0:cr===Ip&&(Ft=!0,W.charCodeAt(Oe)===Sc&&++Oe),W.slice(xr+1,He-1).replace(/""/g,'"')}for(;Oe<fe;){if((cr=W.charCodeAt(He=Oe++))===Sc)Ft=!0;else if(cr===Ip)Ft=!0,W.charCodeAt(Oe)===Sc&&++Oe;else if(cr!==m)continue;return W.slice(xr,He)}return Xe=!0,W.slice(xr,fe)}for(;(Ke=Lt())!==Ep;){for(var ft=[];Ke!==_d&&Ke!==Ep;)ft.push(Ke),Ke=Lt();K&&(ft=K(ft,ze++))==null||H.push(ft)}return H}function E(W,K){return W.map(function(H){return K.map(function(fe){return N(H[fe])}).join(c)})}function s(W,K){return K==null&&(K=vd(W)),[K.map(N).join(c)].concat(E(W,K)).join(`
`)}function M(W,K){return K==null&&(K=vd(W)),E(W,K).join(`
`)}function A(W){return W.map(V).join(`
`)}function V(W){return W.map(N).join(c)}function N(W){return W==null?"":W instanceof Date?Og(W):p.test(W+="")?'"'+W.replace(/"/g,'""')+'"':W}return{parse:v,parseRows:S,format:s,formatBody:M,formatRows:A,formatRow:V,formatValue:N}}var Vg=Fg(","),Ng=Vg.parse;function Ug(c){for(var p in c){var m=c[p].trim(),v,S;if(!m)m=null;else if(m==="true")m=!0;else if(m==="false")m=!1;else if(m==="NaN")m=NaN;else if(!isNaN(v=+m))m=v;else if(S=m.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))jg&&!!S[4]&&!S[7]&&(m=m.replace(/-/g,"/").replace(/T/," ")),m=new Date(m);else continue;c[p]=m}return c}const jg=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();async function qg(c,p=window.fetch){let v=await(await p(c)).text();return await Ng(v,Ug)}function Vh(c,p="",m=0){return c!=0?Math.abs(c).toFixed(m)+p:p=="pp"?"n/c":"<1%)"}yu.disable_scroll_handling;const xd=yu.goto;yu.invalidate;yu.prefetch;yu.prefetch_routes;yu.before_navigate;yu.after_navigate;function Zg(c){return c===0?!0:c}function Xl(c){return Zg(c)?Array.isArray(c)?p=>c.map(m=>typeof m!="function"?p[m]:m(p)):typeof c!="function"?p=>p[c]:c:null}function Gg(c){const p={};for(const m of c){if(Object(m)!==m)throw new TypeError("iterable for fromEntries should yield objects");const{"0":v,"1":S}=m;Object.defineProperty(p,v,{configurable:!0,enumerable:!0,writable:!0,value:S})}return p}function kp(c,p={}){return Gg(Object.entries(c).filter(([m,v])=>v!==void 0&&p[m]===void 0))}function Kg(c,p){if(!Array.isArray(c))throw new TypeError(`The first argument of calcExtents() must be an array. You passed in a ${typeof c}. Consider passing a flat array to the \`flatData\` prop. More info: https://layercake.graphics/guide/#flatdata`);if(Array.isArray(p)||p===void 0||p===null)throw new TypeError("The second argument of calcExtents() must be an object with field names as keys as accessor functions as values.");const m={},v=Object.keys(p),S=v.length;let E,s,M,A,V,N,W,K;const H=c.length;for(E=0;E<S;E+=1){for(A=v[E],W=p[A],V=null,N=null,s=0;s<H;s+=1)if(K=W(c[s]),Array.isArray(K)){const fe=K.length;for(M=0;M<fe;M+=1)K[M]!==void 0&&K[M]!==null&&Number.isNaN(K[M])===!1&&((V===null||K[M]<V)&&(V=K[M]),(N===null||K[M]>N)&&(N=K[M]))}else K!=null&&Number.isNaN(K)===!1&&((V===null||K<V)&&(V=K),(N===null||K>N)&&(N=K));m[A]=[V,N]}return m}function Mm(c=[],p){return Array.isArray(p)===!0?p.map((m,v)=>m===null?c[v]:m):c}function Sh(c){return function([m,v]){return m?Mm(m[c],v):v}}function Dh(c,p){return c==null||p==null?NaN:c<p?-1:c>p?1:c>=p?0:NaN}function Xg(c,p){return c==null||p==null?NaN:p<c?-1:p>c?1:p>=c?0:NaN}function Dm(c){let p,m,v;c.length!==2?(p=Dh,m=(M,A)=>Dh(c(M),A),v=(M,A)=>c(M)-A):(p=c===Dh||c===Xg?c:Wg,m=c,v=c);function S(M,A,V=0,N=M.length){if(V<N){if(p(A,A)!==0)return N;do{const W=V+N>>>1;m(M[W],A)<0?V=W+1:N=W}while(V<N)}return V}function E(M,A,V=0,N=M.length){if(V<N){if(p(A,A)!==0)return N;do{const W=V+N>>>1;m(M[W],A)<=0?V=W+1:N=W}while(V<N)}return V}function s(M,A,V=0,N=M.length){const W=S(M,A,V,N-1);return W>V&&v(M[W-1],A)>-v(M[W],A)?W-1:W}return{left:S,center:s,right:E}}function Wg(){return 0}function Hg(c){return c===null?NaN:+c}const Jg=Dm(Dh),Yg=Jg.right;Dm(Hg).center;const Qg=Yg;class bd extends Map{constructor(p,m=t_){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:m}}),p!=null)for(const[v,S]of p)this.set(v,S)}get(p){return super.get(wd(this,p))}has(p){return super.has(wd(this,p))}set(p,m){return super.set($g(this,p),m)}delete(p){return super.delete(e_(this,p))}}function wd({_intern:c,_key:p},m){const v=p(m);return c.has(v)?c.get(v):m}function $g({_intern:c,_key:p},m){const v=p(m);return c.has(v)?c.get(v):(c.set(v,m),m)}function e_({_intern:c,_key:p},m){const v=p(m);return c.has(v)&&(m=c.get(v),c.delete(v)),m}function t_(c){return c!==null&&typeof c=="object"?c.valueOf():c}var Mp=Math.sqrt(50),Dp=Math.sqrt(10),Lp=Math.sqrt(2);function r_(c,p,m){var v,S=-1,E,s,M;if(p=+p,c=+c,m=+m,c===p&&m>0)return[c];if((v=p<c)&&(E=c,c=p,p=E),(M=Lm(c,p,m))===0||!isFinite(M))return[];if(M>0){let A=Math.round(c/M),V=Math.round(p/M);for(A*M<c&&++A,V*M>p&&--V,s=new Array(E=V-A+1);++S<E;)s[S]=(A+S)*M}else{M=-M;let A=Math.round(c*M),V=Math.round(p*M);for(A/M<c&&++A,V/M>p&&--V,s=new Array(E=V-A+1);++S<E;)s[S]=(A+S)/M}return v&&s.reverse(),s}function Lm(c,p,m){var v=(p-c)/Math.max(0,m),S=Math.floor(Math.log(v)/Math.LN10),E=v/Math.pow(10,S);return S>=0?(E>=Mp?10:E>=Dp?5:E>=Lp?2:1)*Math.pow(10,S):-Math.pow(10,-S)/(E>=Mp?10:E>=Dp?5:E>=Lp?2:1)}function i_(c,p,m){var v=Math.abs(p-c)/Math.max(0,m),S=Math.pow(10,Math.floor(Math.log(v)/Math.LN10)),E=v/S;return E>=Mp?S*=10:E>=Dp?S*=5:E>=Lp&&(S*=2),p<c?-S:S}function n_(c,p,m){c=+c,p=+p,m=(S=arguments.length)<2?(p=c,c=0,1):S<3?1:+m;for(var v=-1,S=Math.max(0,Math.ceil((p-c)/m))|0,E=new Array(S);++v<S;)E[v]=c+v*m;return E}function Gh(c,p){switch(arguments.length){case 0:break;case 1:this.range(c);break;default:this.range(p).domain(c);break}return this}const Sd=Symbol("implicit");function Rm(){var c=new bd,p=[],m=[],v=Sd;function S(E){let s=c.get(E);if(s===void 0){if(v!==Sd)return v;c.set(E,s=p.push(E)-1)}return m[s%m.length]}return S.domain=function(E){if(!arguments.length)return p.slice();p=[],c=new bd;for(const s of E)c.has(s)||c.set(s,p.push(s)-1);return S},S.range=function(E){return arguments.length?(m=Array.from(E),S):m.slice()},S.unknown=function(E){return arguments.length?(v=E,S):v},S.copy=function(){return Rm(p,m).unknown(v)},Gh.apply(S,arguments),S}function Bm(){var c=Rm().unknown(void 0),p=c.domain,m=c.range,v=0,S=1,E,s,M=!1,A=0,V=0,N=.5;delete c.unknown;function W(){var K=p().length,H=S<v,fe=H?S:v,Oe=H?v:S;E=(Oe-fe)/Math.max(1,K-A+V*2),M&&(E=Math.floor(E)),fe+=(Oe-fe-E*(K-A))*N,s=E*(1-A),M&&(fe=Math.round(fe),s=Math.round(s));var ze=n_(K).map(function(Ke){return fe+E*Ke});return m(H?ze.reverse():ze)}return c.domain=function(K){return arguments.length?(p(K),W()):p()},c.range=function(K){return arguments.length?([v,S]=K,v=+v,S=+S,W()):[v,S]},c.rangeRound=function(K){return[v,S]=K,v=+v,S=+S,M=!0,W()},c.bandwidth=function(){return s},c.step=function(){return E},c.round=function(K){return arguments.length?(M=!!K,W()):M},c.padding=function(K){return arguments.length?(A=Math.min(1,V=+K),W()):A},c.paddingInner=function(K){return arguments.length?(A=Math.min(1,K),W()):A},c.paddingOuter=function(K){return arguments.length?(V=+K,W()):V},c.align=function(K){return arguments.length?(N=Math.max(0,Math.min(1,K)),W()):N},c.copy=function(){return Bm(p(),[v,S]).round(M).paddingInner(A).paddingOuter(V).align(N)},Gh.apply(W(),arguments)}function Up(c,p,m){c.prototype=p.prototype=m,m.constructor=c}function Om(c,p){var m=Object.create(c.prototype);for(var v in p)m[v]=p[v];return m}function Bc(){}var Mc=.7,Nh=1/Mc,Xu="\\s*([+-]?\\d+)\\s*",Dc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",nl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",o_=/^#([0-9a-f]{3,8})$/,a_=new RegExp(`^rgb\\(${Xu},${Xu},${Xu}\\)$`),s_=new RegExp(`^rgb\\(${nl},${nl},${nl}\\)$`),l_=new RegExp(`^rgba\\(${Xu},${Xu},${Xu},${Dc}\\)$`),u_=new RegExp(`^rgba\\(${nl},${nl},${nl},${Dc}\\)$`),c_=new RegExp(`^hsl\\(${Dc},${nl},${nl}\\)$`),h_=new RegExp(`^hsla\\(${Dc},${nl},${nl},${Dc}\\)$`),Ed={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Up(Bc,Lc,{copy(c){return Object.assign(new this.constructor,this,c)},displayable(){return this.rgb().displayable()},hex:Td,formatHex:Td,formatHex8:p_,formatHsl:f_,formatRgb:Id,toString:Id});function Td(){return this.rgb().formatHex()}function p_(){return this.rgb().formatHex8()}function f_(){return Fm(this).formatHsl()}function Id(){return this.rgb().formatRgb()}function Lc(c){var p,m;return c=(c+"").trim().toLowerCase(),(p=o_.exec(c))?(m=p[1].length,p=parseInt(p[1],16),m===6?kd(p):m===3?new Ua(p>>8&15|p>>4&240,p>>4&15|p&240,(p&15)<<4|p&15,1):m===8?Eh(p>>24&255,p>>16&255,p>>8&255,(p&255)/255):m===4?Eh(p>>12&15|p>>8&240,p>>8&15|p>>4&240,p>>4&15|p&240,((p&15)<<4|p&15)/255):null):(p=a_.exec(c))?new Ua(p[1],p[2],p[3],1):(p=s_.exec(c))?new Ua(p[1]*255/100,p[2]*255/100,p[3]*255/100,1):(p=l_.exec(c))?Eh(p[1],p[2],p[3],p[4]):(p=u_.exec(c))?Eh(p[1]*255/100,p[2]*255/100,p[3]*255/100,p[4]):(p=c_.exec(c))?Pd(p[1],p[2]/100,p[3]/100,1):(p=h_.exec(c))?Pd(p[1],p[2]/100,p[3]/100,p[4]):Ed.hasOwnProperty(c)?kd(Ed[c]):c==="transparent"?new Ua(NaN,NaN,NaN,0):null}function kd(c){return new Ua(c>>16&255,c>>8&255,c&255,1)}function Eh(c,p,m,v){return v<=0&&(c=p=m=NaN),new Ua(c,p,m,v)}function d_(c){return c instanceof Bc||(c=Lc(c)),c?(c=c.rgb(),new Ua(c.r,c.g,c.b,c.opacity)):new Ua}function Rp(c,p,m,v){return arguments.length===1?d_(c):new Ua(c,p,m,v==null?1:v)}function Ua(c,p,m,v){this.r=+c,this.g=+p,this.b=+m,this.opacity=+v}Up(Ua,Rp,Om(Bc,{brighter(c){return c=c==null?Nh:Math.pow(Nh,c),new Ua(this.r*c,this.g*c,this.b*c,this.opacity)},darker(c){return c=c==null?Mc:Math.pow(Mc,c),new Ua(this.r*c,this.g*c,this.b*c,this.opacity)},rgb(){return this},clamp(){return new Ua(pu(this.r),pu(this.g),pu(this.b),Uh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zd,formatHex:zd,formatHex8:m_,formatRgb:Ad,toString:Ad}));function zd(){return`#${hu(this.r)}${hu(this.g)}${hu(this.b)}`}function m_(){return`#${hu(this.r)}${hu(this.g)}${hu(this.b)}${hu((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ad(){const c=Uh(this.opacity);return`${c===1?"rgb(":"rgba("}${pu(this.r)}, ${pu(this.g)}, ${pu(this.b)}${c===1?")":`, ${c})`}`}function Uh(c){return isNaN(c)?1:Math.max(0,Math.min(1,c))}function pu(c){return Math.max(0,Math.min(255,Math.round(c)||0))}function hu(c){return c=pu(c),(c<16?"0":"")+c.toString(16)}function Pd(c,p,m,v){return v<=0?c=p=m=NaN:m<=0||m>=1?c=p=NaN:p<=0&&(c=NaN),new Bs(c,p,m,v)}function Fm(c){if(c instanceof Bs)return new Bs(c.h,c.s,c.l,c.opacity);if(c instanceof Bc||(c=Lc(c)),!c)return new Bs;if(c instanceof Bs)return c;c=c.rgb();var p=c.r/255,m=c.g/255,v=c.b/255,S=Math.min(p,m,v),E=Math.max(p,m,v),s=NaN,M=E-S,A=(E+S)/2;return M?(p===E?s=(m-v)/M+(m<v)*6:m===E?s=(v-p)/M+2:s=(p-m)/M+4,M/=A<.5?E+S:2-E-S,s*=60):M=A>0&&A<1?0:s,new Bs(s,M,A,c.opacity)}function y_(c,p,m,v){return arguments.length===1?Fm(c):new Bs(c,p,m,v==null?1:v)}function Bs(c,p,m,v){this.h=+c,this.s=+p,this.l=+m,this.opacity=+v}Up(Bs,y_,Om(Bc,{brighter(c){return c=c==null?Nh:Math.pow(Nh,c),new Bs(this.h,this.s,this.l*c,this.opacity)},darker(c){return c=c==null?Mc:Math.pow(Mc,c),new Bs(this.h,this.s,this.l*c,this.opacity)},rgb(){var c=this.h%360+(this.h<0)*360,p=isNaN(c)||isNaN(this.s)?0:this.s,m=this.l,v=m+(m<.5?m:1-m)*p,S=2*m-v;return new Ua(zp(c>=240?c-240:c+120,S,v),zp(c,S,v),zp(c<120?c+240:c-120,S,v),this.opacity)},clamp(){return new Bs(Cd(this.h),Th(this.s),Th(this.l),Uh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const c=Uh(this.opacity);return`${c===1?"hsl(":"hsla("}${Cd(this.h)}, ${Th(this.s)*100}%, ${Th(this.l)*100}%${c===1?")":`, ${c})`}`}}));function Cd(c){return c=(c||0)%360,c<0?c+360:c}function Th(c){return Math.max(0,Math.min(1,c||0))}function zp(c,p,m){return(c<60?p+(m-p)*c/60:c<180?m:c<240?p+(m-p)*(240-c)/60:p)*255}const jp=c=>()=>c;function g_(c,p){return function(m){return c+m*p}}function __(c,p,m){return c=Math.pow(c,m),p=Math.pow(p,m)-c,m=1/m,function(v){return Math.pow(c+v*p,m)}}function v_(c){return(c=+c)==1?Vm:function(p,m){return m-p?__(p,m,c):jp(isNaN(p)?m:p)}}function Vm(c,p){var m=p-c;return m?g_(c,m):jp(isNaN(c)?p:c)}const Md=function c(p){var m=v_(p);function v(S,E){var s=m((S=Rp(S)).r,(E=Rp(E)).r),M=m(S.g,E.g),A=m(S.b,E.b),V=Vm(S.opacity,E.opacity);return function(N){return S.r=s(N),S.g=M(N),S.b=A(N),S.opacity=V(N),S+""}}return v.gamma=c,v}(1);function x_(c,p){p||(p=[]);var m=c?Math.min(p.length,c.length):0,v=p.slice(),S;return function(E){for(S=0;S<m;++S)v[S]=c[S]*(1-E)+p[S]*E;return v}}function b_(c){return ArrayBuffer.isView(c)&&!(c instanceof DataView)}function w_(c,p){var m=p?p.length:0,v=c?Math.min(m,c.length):0,S=new Array(v),E=new Array(m),s;for(s=0;s<v;++s)S[s]=qp(c[s],p[s]);for(;s<m;++s)E[s]=p[s];return function(M){for(s=0;s<v;++s)E[s]=S[s](M);return E}}function S_(c,p){var m=new Date;return c=+c,p=+p,function(v){return m.setTime(c*(1-v)+p*v),m}}function jh(c,p){return c=+c,p=+p,function(m){return c*(1-m)+p*m}}function E_(c,p){var m={},v={},S;(c===null||typeof c!="object")&&(c={}),(p===null||typeof p!="object")&&(p={});for(S in p)S in c?m[S]=qp(c[S],p[S]):v[S]=p[S];return function(E){for(S in m)v[S]=m[S](E);return v}}var Bp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ap=new RegExp(Bp.source,"g");function T_(c){return function(){return c}}function I_(c){return function(p){return c(p)+""}}function k_(c,p){var m=Bp.lastIndex=Ap.lastIndex=0,v,S,E,s=-1,M=[],A=[];for(c=c+"",p=p+"";(v=Bp.exec(c))&&(S=Ap.exec(p));)(E=S.index)>m&&(E=p.slice(m,E),M[s]?M[s]+=E:M[++s]=E),(v=v[0])===(S=S[0])?M[s]?M[s]+=S:M[++s]=S:(M[++s]=null,A.push({i:s,x:jh(v,S)})),m=Ap.lastIndex;return m<p.length&&(E=p.slice(m),M[s]?M[s]+=E:M[++s]=E),M.length<2?A[0]?I_(A[0].x):T_(p):(p=A.length,function(V){for(var N=0,W;N<p;++N)M[(W=A[N]).i]=W.x(V);return M.join("")})}function qp(c,p){var m=typeof p,v;return p==null||m==="boolean"?jp(p):(m==="number"?jh:m==="string"?(v=Lc(p))?(p=v,Md):k_:p instanceof Lc?Md:p instanceof Date?S_:b_(p)?x_:Array.isArray(p)?w_:typeof p.valueOf!="function"&&typeof p.toString!="function"||isNaN(p)?E_:jh)(c,p)}function z_(c,p){return c=+c,p=+p,function(m){return Math.round(c*(1-m)+p*m)}}function A_(c){return function(){return c}}function P_(c){return+c}var Dd=[0,1];function il(c){return c}function Op(c,p){return(p-=c=+c)?function(m){return(m-c)/p}:A_(isNaN(p)?NaN:.5)}function C_(c,p){var m;return c>p&&(m=c,c=p,p=m),function(v){return Math.max(c,Math.min(p,v))}}function M_(c,p,m){var v=c[0],S=c[1],E=p[0],s=p[1];return S<v?(v=Op(S,v),E=m(s,E)):(v=Op(v,S),E=m(E,s)),function(M){return E(v(M))}}function D_(c,p,m){var v=Math.min(c.length,p.length)-1,S=new Array(v),E=new Array(v),s=-1;for(c[v]<c[0]&&(c=c.slice().reverse(),p=p.slice().reverse());++s<v;)S[s]=Op(c[s],c[s+1]),E[s]=m(p[s],p[s+1]);return function(M){var A=Qg(c,M,1,v)-1;return E[A](S[A](M))}}function Nm(c,p){return p.domain(c.domain()).range(c.range()).interpolate(c.interpolate()).clamp(c.clamp()).unknown(c.unknown())}function Um(){var c=Dd,p=Dd,m=qp,v,S,E,s=il,M,A,V;function N(){var K=Math.min(c.length,p.length);return s!==il&&(s=C_(c[0],c[K-1])),M=K>2?D_:M_,A=V=null,W}function W(K){return K==null||isNaN(K=+K)?E:(A||(A=M(c.map(v),p,m)))(v(s(K)))}return W.invert=function(K){return s(S((V||(V=M(p,c.map(v),jh)))(K)))},W.domain=function(K){return arguments.length?(c=Array.from(K,P_),N()):c.slice()},W.range=function(K){return arguments.length?(p=Array.from(K),N()):p.slice()},W.rangeRound=function(K){return p=Array.from(K),m=z_,N()},W.clamp=function(K){return arguments.length?(s=K?!0:il,N()):s!==il},W.interpolate=function(K){return arguments.length?(m=K,N()):m},W.unknown=function(K){return arguments.length?(E=K,W):E},function(K,H){return v=K,S=H,N()}}function L_(){return Um()(il,il)}function R_(c){return Math.abs(c=Math.round(c))>=1e21?c.toLocaleString("en").replace(/,/g,""):c.toString(10)}function qh(c,p){if((m=(c=p?c.toExponential(p-1):c.toExponential()).indexOf("e"))<0)return null;var m,v=c.slice(0,m);return[v.length>1?v[0]+v.slice(2):v,+c.slice(m+1)]}function Hu(c){return c=qh(Math.abs(c)),c?c[1]:NaN}function B_(c,p){return function(m,v){for(var S=m.length,E=[],s=0,M=c[0],A=0;S>0&&M>0&&(A+M+1>v&&(M=Math.max(1,v-A)),E.push(m.substring(S-=M,S+M)),!((A+=M+1)>v));)M=c[s=(s+1)%c.length];return E.reverse().join(p)}}function O_(c){return function(p){return p.replace(/[0-9]/g,function(m){return c[+m]})}}var F_=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Zh(c){if(!(p=F_.exec(c)))throw new Error("invalid format: "+c);var p;return new Zp({fill:p[1],align:p[2],sign:p[3],symbol:p[4],zero:p[5],width:p[6],comma:p[7],precision:p[8]&&p[8].slice(1),trim:p[9],type:p[10]})}Zh.prototype=Zp.prototype;function Zp(c){this.fill=c.fill===void 0?" ":c.fill+"",this.align=c.align===void 0?">":c.align+"",this.sign=c.sign===void 0?"-":c.sign+"",this.symbol=c.symbol===void 0?"":c.symbol+"",this.zero=!!c.zero,this.width=c.width===void 0?void 0:+c.width,this.comma=!!c.comma,this.precision=c.precision===void 0?void 0:+c.precision,this.trim=!!c.trim,this.type=c.type===void 0?"":c.type+""}Zp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function V_(c){e:for(var p=c.length,m=1,v=-1,S;m<p;++m)switch(c[m]){case".":v=S=m;break;case"0":v===0&&(v=m),S=m;break;default:if(!+c[m])break e;v>0&&(v=0);break}return v>0?c.slice(0,v)+c.slice(S+1):c}var jm;function N_(c,p){var m=qh(c,p);if(!m)return c+"";var v=m[0],S=m[1],E=S-(jm=Math.max(-8,Math.min(8,Math.floor(S/3)))*3)+1,s=v.length;return E===s?v:E>s?v+new Array(E-s+1).join("0"):E>0?v.slice(0,E)+"."+v.slice(E):"0."+new Array(1-E).join("0")+qh(c,Math.max(0,p+E-1))[0]}function Ld(c,p){var m=qh(c,p);if(!m)return c+"";var v=m[0],S=m[1];return S<0?"0."+new Array(-S).join("0")+v:v.length>S+1?v.slice(0,S+1)+"."+v.slice(S+1):v+new Array(S-v.length+2).join("0")}const Rd={"%":(c,p)=>(c*100).toFixed(p),b:c=>Math.round(c).toString(2),c:c=>c+"",d:R_,e:(c,p)=>c.toExponential(p),f:(c,p)=>c.toFixed(p),g:(c,p)=>c.toPrecision(p),o:c=>Math.round(c).toString(8),p:(c,p)=>Ld(c*100,p),r:Ld,s:N_,X:c=>Math.round(c).toString(16).toUpperCase(),x:c=>Math.round(c).toString(16)};function Bd(c){return c}var Od=Array.prototype.map,Fd=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function U_(c){var p=c.grouping===void 0||c.thousands===void 0?Bd:B_(Od.call(c.grouping,Number),c.thousands+""),m=c.currency===void 0?"":c.currency[0]+"",v=c.currency===void 0?"":c.currency[1]+"",S=c.decimal===void 0?".":c.decimal+"",E=c.numerals===void 0?Bd:O_(Od.call(c.numerals,String)),s=c.percent===void 0?"%":c.percent+"",M=c.minus===void 0?"\u2212":c.minus+"",A=c.nan===void 0?"NaN":c.nan+"";function V(W){W=Zh(W);var K=W.fill,H=W.align,fe=W.sign,Oe=W.symbol,ze=W.zero,Ke=W.width,Xe=W.comma,Ft=W.precision,Lt=W.trim,ft=W.type;ft==="n"?(Xe=!0,ft="g"):Rd[ft]||(Ft===void 0&&(Ft=12),Lt=!0,ft="g"),(ze||K==="0"&&H==="=")&&(ze=!0,K="0",H="=");var He=Oe==="$"?m:Oe==="#"&&/[boxX]/.test(ft)?"0"+ft.toLowerCase():"",xr=Oe==="$"?v:/[%p]/.test(ft)?s:"",cr=Rd[ft],Wt=/[defgprs%]/.test(ft);Ft=Ft===void 0?6:/[gprs]/.test(ft)?Math.max(1,Math.min(21,Ft)):Math.max(0,Math.min(20,Ft));function Ht(qe){var mr=He,It=xr,rr,it,hr;if(ft==="c")It=cr(qe)+It,qe="";else{qe=+qe;var Or=qe<0||1/qe<0;if(qe=isNaN(qe)?A:cr(Math.abs(qe),Ft),Lt&&(qe=V_(qe)),Or&&+qe==0&&fe!=="+"&&(Or=!1),mr=(Or?fe==="("?fe:M:fe==="-"||fe==="("?"":fe)+mr,It=(ft==="s"?Fd[8+jm/3]:"")+It+(Or&&fe==="("?")":""),Wt){for(rr=-1,it=qe.length;++rr<it;)if(hr=qe.charCodeAt(rr),48>hr||hr>57){It=(hr===46?S+qe.slice(rr+1):qe.slice(rr))+It,qe=qe.slice(0,rr);break}}}Xe&&!ze&&(qe=p(qe,1/0));var kt=mr.length+qe.length+It.length,er=kt<Ke?new Array(Ke-kt+1).join(K):"";switch(Xe&&ze&&(qe=p(er+qe,er.length?Ke-It.length:1/0),er=""),H){case"<":qe=mr+qe+It+er;break;case"=":qe=mr+er+qe+It;break;case"^":qe=er.slice(0,kt=er.length>>1)+mr+qe+It+er.slice(kt);break;default:qe=er+mr+qe+It;break}return E(qe)}return Ht.toString=function(){return W+""},Ht}function N(W,K){var H=V((W=Zh(W),W.type="f",W)),fe=Math.max(-8,Math.min(8,Math.floor(Hu(K)/3)))*3,Oe=Math.pow(10,-fe),ze=Fd[8+fe/3];return function(Ke){return H(Oe*Ke)+ze}}return{format:V,formatPrefix:N}}var Ih,qm,Zm;j_({thousands:",",grouping:[3],currency:["$",""]});function j_(c){return Ih=U_(c),qm=Ih.format,Zm=Ih.formatPrefix,Ih}function q_(c){return Math.max(0,-Hu(Math.abs(c)))}function Z_(c,p){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Hu(p)/3)))*3-Hu(Math.abs(c)))}function G_(c,p){return c=Math.abs(c),p=Math.abs(p)-c,Math.max(0,Hu(p)-Hu(c))+1}function K_(c,p,m,v){var S=i_(c,p,m),E;switch(v=Zh(v==null?",f":v),v.type){case"s":{var s=Math.max(Math.abs(c),Math.abs(p));return v.precision==null&&!isNaN(E=Z_(S,s))&&(v.precision=E),Zm(v,s)}case"":case"e":case"g":case"p":case"r":{v.precision==null&&!isNaN(E=G_(S,Math.max(Math.abs(c),Math.abs(p))))&&(v.precision=E-(v.type==="e"));break}case"f":case"%":{v.precision==null&&!isNaN(E=q_(S))&&(v.precision=E-(v.type==="%")*2);break}}return qm(v)}function Gm(c){var p=c.domain;return c.ticks=function(m){var v=p();return r_(v[0],v[v.length-1],m==null?10:m)},c.tickFormat=function(m,v){var S=p();return K_(S[0],S[S.length-1],m==null?10:m,v)},c.nice=function(m){m==null&&(m=10);var v=p(),S=0,E=v.length-1,s=v[S],M=v[E],A,V,N=10;for(M<s&&(V=s,s=M,M=V,V=S,S=E,E=V);N-- >0;){if(V=Lm(s,M,m),V===A)return v[S]=s,v[E]=M,p(v);if(V>0)s=Math.floor(s/V)*V,M=Math.ceil(M/V)*V;else if(V<0)s=Math.ceil(s*V)/V,M=Math.floor(M*V)/V;else break;A=V}return c},c}function Lh(){var c=L_();return c.copy=function(){return Nm(c,Lh())},Gh.apply(c,arguments),Gm(c)}function Vd(c){return function(p){return p<0?-Math.pow(-p,c):Math.pow(p,c)}}function X_(c){return c<0?-Math.sqrt(-c):Math.sqrt(c)}function W_(c){return c<0?-c*c:c*c}function H_(c){var p=c(il,il),m=1;function v(){return m===1?c(il,il):m===.5?c(X_,W_):c(Vd(m),Vd(1/m))}return p.exponent=function(S){return arguments.length?(m=+S,v()):m},Gm(p)}function Km(){var c=H_(Um());return c.copy=function(){return Nm(c,Km()).exponent(c.exponent())},Gh.apply(c,arguments),c}function J_(){return Km.apply(null,arguments).exponent(.5)}const Ic={x:Lh,y:Lh,z:Lh,r:J_};function Y_(c){return c.constant?"symlog":c.base?"log":c.exponent?c.exponent()===.5?"sqrt":"pow":"other"}function Nd(c){return c}function Q_(c){return p=>Math.log(c*p)}function $_(c){return p=>c*Math.exp(p)}function ev(c){return p=>Math.sign(p)*Math.log1p(Math.abs(p/c))}function tv(c){return p=>Math.sign(p)*Math.expm1(Math.abs(p))*c}function kh(c){return function(m){return m<0?-Math.pow(-m,c):Math.pow(m,c)}}function rv(c){const p=Y_(c);if(p==="log"){const m=Math.sign(c.domain()[0]);return{lift:Q_(m),ground:$_(m),scaleType:p}}return p==="pow"?{lift:kh(1),ground:kh(1/1),scaleType:p}:p==="sqrt"?{lift:kh(.5),ground:kh(1/.5),scaleType:p}:p==="symlog"?{lift:ev(1),ground:tv(1),scaleType:p}:{lift:Nd,ground:Nd,scaleType:p}}function iv(c,p){if(typeof c.range!="function")throw new Error("Scale method `range` must be a function");if(typeof c.domain!="function")throw new Error("Scale method `domain` must be a function");if(!Array.isArray(p))return c.domain();c.domain().length!==2&&console.warn("[LayerCake] The scale is expected to have a domain of length 2 to use padding. Are you sure you want to use padding? Your scale's domain is:",c.domain()),c.range().length!==2&&console.warn("[LayerCake] The scale is expected to have a range of length 2 to use padding. Are you sure you want to use padding? Your scale's range is:",c.range());const{lift:m,ground:v}=rv(c),S=c.domain()[0],E=Object.prototype.toString.call(S)==="[object Date]",[s,M]=c.domain().map(H=>m(E?H.getTime():H)),[A,V]=c.range(),N=p[0]||0,W=p[1]||0,K=(M-s)/(Math.abs(V-A)-N-W);return[s-N*K,W*K+M].map(H=>v(E?new Date(H):H))}function nv(c,p,m,v,S){let E,s;return S===!0?(E=0,s=100):(E=c==="r"?1:0,s=c==="y"?m:c==="r"?25:p),v===!0?[s,E]:[E,s]}function ov(c,p,m,v,S,E){return S?typeof S=="function"?S({width:p,height:m}):S:nv(c,p,m,v,E)}function zh(c){return function([m,v,S,E,s,M,A,V,N,W]){if(v===null)return null;const K=ov(c,A,V,M,N,W),H=m===Ic[c]?m():m.copy();return H.domain(Mm(v[c],S)).range(K),E&&H.domain(iv(H,E)),s===!0&&(typeof H.nice=="function"?H.nice():console.error(`[Layer Cake] You set \`${c}Nice: true\` but the ${c}Scale does not have a \`.nice\` method. Ignoring...`)),H}}function Ah([c,p]){return m=>{const v=c(m);return Array.isArray(v)?v.map(S=>p(S)):p(v)}}function Ph([c]){if(typeof c=="function"){if(typeof c.range=="function")return c.range();console.error("[LayerCake] Your scale doesn't have a `.range` method?")}return null}const Ch={x:!1,y:!0,z:!1,r:!1};const av=c=>({element:c[0]&4,width:c[0]&256,height:c[0]&512,aspectRatio:c[0]&1024,containerWidth:c[0]&128,containerHeight:c[0]&64}),Ud=c=>({element:c[2],width:c[8],height:c[9],aspectRatio:c[10],containerWidth:c[7],containerHeight:c[6]});function jd(c){let p,m,v;const S=c[90].default,E=zc(S,c,c[89],Ud);return{c(){p=Ie("div"),E&&E.c(),this.h()},l(s){p=ke(s,"DIV",{class:!0});var M=we(p);E&&E.l(M),M.forEach(se),this.h()},h(){X(p,"class","layercake-container svelte-vhzpsp"),Rh(()=>c[92].call(p)),De(p,"position",c[5],!1),De(p,"top",c[5]==="absolute"?"0":null,!1),De(p,"right",c[5]==="absolute"?"0":null,!1),De(p,"bottom",c[5]==="absolute"?"0":null,!1),De(p,"left",c[5]==="absolute"?"0":null,!1),De(p,"pointer-events",c[4]===!1?"none":null,!1)},m(s,M){dt(s,p,M),E&&E.m(p,null),c[91](p),m=Bh(p,c[92].bind(p)),v=!0},p(s,M){E&&E.p&&(!v||M[0]&1988|M[2]&134217728)&&Ac(E,S,s,s[89],v?Cc(S,s[89],M,av):Pc(s[89]),Ud),M[0]&32&&De(p,"position",s[5],!1),M[0]&32&&De(p,"top",s[5]==="absolute"?"0":null,!1),M[0]&32&&De(p,"right",s[5]==="absolute"?"0":null,!1),M[0]&32&&De(p,"bottom",s[5]==="absolute"?"0":null,!1),M[0]&32&&De(p,"left",s[5]==="absolute"?"0":null,!1),M[0]&16&&De(p,"pointer-events",s[4]===!1?"none":null,!1)},i(s){v||(jt(E,s),v=!0)},o(s){tr(E,s),v=!1},d(s){s&&se(p),E&&E.d(s),c[91](null),m()}}}function sv(c){let p,m,v=(c[3]===!0||typeof window<"u")&&jd(c);return{c(){v&&v.c(),p=un()},l(S){v&&v.l(S),p=un()},m(S,E){v&&v.m(S,E),dt(S,p,E),m=!0},p(S,E){S[3]===!0||typeof window<"u"?v?(v.p(S,E),E[0]&8&&jt(v,1)):(v=jd(S),v.c(),jt(v,1),v.m(p.parentNode,p)):v&&(fu(),tr(v,1,1,()=>{v=null}),du())},i(S){m||(jt(v),m=!0)},o(S){tr(v),m=!1},d(S){v&&v.d(S),S&&se(p)}}}function lv(c,p,m){let v,S,E,s,M,A,V,N,W,K,H,fe,Oe,ze,Ke,Xe,Ft,Lt,ft,He,xr,cr,Wt,Ht,qe,mr,It,rr,it,hr,Or,kt,er,nt,Ze,lr,br,Yi,Qi,Ni,Gt,{$$slots:_r={},$$scope:Rt}=p,{ssr:kr=!1}=p,{pointerEvents:xn=!0}=p,{position:bn="relative"}=p,{percentRange:qt=!1}=p,{width:wn=void 0}=p,{height:Ei=void 0}=p,{containerWidth:Ci=wn||100}=p,{containerHeight:Yn=Ei||100}=p,{element:Zi=void 0}=p,{x:Qn=void 0}=p,{y:hi=void 0}=p,{z:cn=void 0}=p,{r:Bn=void 0}=p,{data:Mi=[]}=p,{xDomain:Fr=void 0}=p,{yDomain:Yr=void 0}=p,{zDomain:Xr=void 0}=p,{rDomain:go=void 0}=p,{xNice:On=!1}=p,{yNice:ya=!1}=p,{zNice:Co=!1}=p,{rNice:hn=!1}=p,{xReverse:$n=Ch.x}=p,{yReverse:_o=Ch.y}=p,{zReverse:Mo=Ch.z}=p,{rReverse:$i=Ch.r}=p,{xPadding:eo=void 0}=p,{yPadding:vo=void 0}=p,{zPadding:Ho=void 0}=p,{rPadding:Jo=void 0}=p,{xScale:Ti=Ic.x}=p,{yScale:Qr=Ic.y}=p,{zScale:Ii=Ic.z}=p,{rScale:xo=Ic.r}=p,{xRange:en=void 0}=p,{yRange:Dr=void 0}=p,{zRange:C=void 0}=p,{rRange:R=void 0}=p,{padding:O={}}=p,{extents:G={}}=p,{flatData:ee=void 0}=p,{custom:le={}}=p,ce=!1;zm(()=>{ce=!0});const F={},re=Tr(qt);Ut(c,re,pe=>m(128,Yi=pe));const me=Tr(Ci);Ut(c,me,pe=>m(7,br=pe));const Ce=Tr(Yn);Ut(c,Ce,pe=>m(6,lr=pe));const Le=Tr(kp(G));Ut(c,Le,pe=>m(127,Ze=pe));const be=Tr(Mi);Ut(c,be,pe=>m(126,nt=pe));const Be=Tr(ee||Mi);Ut(c,Be,pe=>m(125,er=pe));const et=Tr(O);Ut(c,et,pe=>m(124,kt=pe));const Qe=Tr(Xl(Qn));Ut(c,Qe,pe=>m(123,Or=pe));const Se=Tr(Xl(hi));Ut(c,Se,pe=>m(122,hr=pe));const Je=Tr(Xl(cn));Ut(c,Je,pe=>m(121,it=pe));const Ne=Tr(Xl(Bn));Ut(c,Ne,pe=>m(120,rr=pe));const Ge=Tr(Fr);Ut(c,Ge,pe=>m(119,It=pe));const At=Tr(Yr);Ut(c,At,pe=>m(118,mr=pe));const je=Tr(Xr);Ut(c,je,pe=>m(117,qe=pe));const Pt=Tr(go);Ut(c,Pt,pe=>m(116,Ht=pe));const ar=Tr(On);Ut(c,ar,pe=>m(115,Wt=pe));const Ct=Tr(ya);Ut(c,Ct,pe=>m(114,cr=pe));const Vt=Tr(Co);Ut(c,Vt,pe=>m(113,xr=pe));const Mt=Tr(hn);Ut(c,Mt,pe=>m(112,He=pe));const oi=Tr($n);Ut(c,oi,pe=>m(111,ft=pe));const Jt=Tr(_o);Ut(c,Jt,pe=>m(110,Lt=pe));const zr=Tr(Mo);Ut(c,zr,pe=>m(109,Ft=pe));const or=Tr($i);Ut(c,or,pe=>m(108,Xe=pe));const Bt=Tr(eo);Ut(c,Bt,pe=>m(107,Ke=pe));const Zt=Tr(vo);Ut(c,Zt,pe=>m(106,ze=pe));const pi=Tr(Ho);Ut(c,pi,pe=>m(105,Oe=pe));const tn=Tr(Jo);Ut(c,tn,pe=>m(104,fe=pe));const Cr=Tr(en);Ut(c,Cr,pe=>m(103,H=pe));const ai=Tr(Dr);Ut(c,ai,pe=>m(102,K=pe));const Yo=Tr(C);Ut(c,Yo,pe=>m(101,W=pe));const Do=Tr(R);Ut(c,Do,pe=>m(100,N=pe));const Ar=Tr(Ti);Ut(c,Ar,pe=>m(99,V=pe));const bo=Tr(Qr);Ut(c,bo,pe=>m(98,A=pe));const fi=Tr(Ii);Ut(c,fi,pe=>m(97,M=pe));const Wr=Tr(xo);Ut(c,Wr,pe=>m(96,s=pe));const di=Tr(F);Ut(c,di,pe=>m(94,S=pe));const wr=Tr(le);Ut(c,wr,pe=>m(95,E=pe));const pn=Ji([Qe,Se,Je,Ne],([pe,$r,Di,vr])=>{const _a={};return pe&&(_a.x=pe),$r&&(_a.y=$r),Di&&(_a.z=Di),vr&&(_a.r=vr),_a}),mi=Ji([et,me,Ce],([pe])=>Object.assign({top:0,right:0,bottom:0,left:0},pe)),Qo=Ji([me,Ce,mi],([pe,$r,Di])=>{const vr={};return vr.top=Di.top,vr.right=pe-Di.right,vr.bottom=$r-Di.bottom,vr.left=Di.left,vr.width=vr.right-vr.left,vr.height=vr.bottom-vr.top,vr.width<=0&&ce===!0&&console.warn("[LayerCake] Target div has zero or negative width. Did you forget to set an explicit width in CSS on the container?"),vr.height<=0&&ce===!0&&console.warn("[LayerCake] Target div has zero or negative height. Did you forget to set an explicit height in CSS on the container?"),vr}),yi=Ji([Qo],([pe])=>pe.width);Ut(c,yi,pe=>m(8,Qi=pe));const Sn=Ji([Qo],([pe])=>pe.height);Ut(c,Sn,pe=>m(9,Ni=pe));const gi=Ji([Be,pn,Le],([pe,$r,Di])=>{const vr=kp($r,Di);return Object.keys(vr).length>0?{...Kg(pe,vr),...Di}:{}}),si=Ji([gi,Ge],Sh("x")),Fn=Ji([gi,At],Sh("y")),ki=Ji([gi,je],Sh("z")),sr=Ji([gi,Pt],Sh("r")),to=Ji([Ar,gi,si,Bt,ar,oi,yi,Sn,Cr,re],zh("x")),ro=Ji([Qe,to],Ah),Vn=Ji([bo,gi,Fn,Zt,Ct,Jt,yi,Sn,ai,re],zh("y")),al=Ji([Se,Vn],Ah),Lo=Ji([fi,gi,ki,pi,Vt,zr,yi,Sn,Yo,re],zh("z")),Yl=Ji([Je,Lo],Ah),os=Ji([Wr,gi,sr,tn,Mt,or,yi,Sn,Do,re],zh("r")),ga=Ji([Ne,os],Ah),wo=Ji([to],Ph),bs=Ji([Vn],Ph),ja=Ji([Lo],Ph),$o=Ji([os],Ph),Nn=Ji([yi,Sn],([pe,$r])=>pe/$r);Ut(c,Nn,pe=>m(10,Gt=pe));function En(pe){Tl[pe?"unshift":"push"](()=>{Zi=pe,m(2,Zi)})}function Gi(){Ci=this.clientWidth,Yn=this.clientHeight,m(0,Ci),m(1,Yn)}return c.$$set=pe=>{"ssr"in pe&&m(3,kr=pe.ssr),"pointerEvents"in pe&&m(4,xn=pe.pointerEvents),"position"in pe&&m(5,bn=pe.position),"percentRange"in pe&&m(51,qt=pe.percentRange),"width"in pe&&m(52,wn=pe.width),"height"in pe&&m(53,Ei=pe.height),"containerWidth"in pe&&m(0,Ci=pe.containerWidth),"containerHeight"in pe&&m(1,Yn=pe.containerHeight),"element"in pe&&m(2,Zi=pe.element),"x"in pe&&m(54,Qn=pe.x),"y"in pe&&m(55,hi=pe.y),"z"in pe&&m(56,cn=pe.z),"r"in pe&&m(57,Bn=pe.r),"data"in pe&&m(58,Mi=pe.data),"xDomain"in pe&&m(59,Fr=pe.xDomain),"yDomain"in pe&&m(60,Yr=pe.yDomain),"zDomain"in pe&&m(61,Xr=pe.zDomain),"rDomain"in pe&&m(62,go=pe.rDomain),"xNice"in pe&&m(63,On=pe.xNice),"yNice"in pe&&m(64,ya=pe.yNice),"zNice"in pe&&m(65,Co=pe.zNice),"rNice"in pe&&m(66,hn=pe.rNice),"xReverse"in pe&&m(67,$n=pe.xReverse),"yReverse"in pe&&m(68,_o=pe.yReverse),"zReverse"in pe&&m(69,Mo=pe.zReverse),"rReverse"in pe&&m(70,$i=pe.rReverse),"xPadding"in pe&&m(71,eo=pe.xPadding),"yPadding"in pe&&m(72,vo=pe.yPadding),"zPadding"in pe&&m(73,Ho=pe.zPadding),"rPadding"in pe&&m(74,Jo=pe.rPadding),"xScale"in pe&&m(75,Ti=pe.xScale),"yScale"in pe&&m(76,Qr=pe.yScale),"zScale"in pe&&m(77,Ii=pe.zScale),"rScale"in pe&&m(78,xo=pe.rScale),"xRange"in pe&&m(79,en=pe.xRange),"yRange"in pe&&m(80,Dr=pe.yRange),"zRange"in pe&&m(81,C=pe.zRange),"rRange"in pe&&m(82,R=pe.rRange),"padding"in pe&&m(83,O=pe.padding),"extents"in pe&&m(84,G=pe.extents),"flatData"in pe&&m(85,ee=pe.flatData),"custom"in pe&&m(86,le=pe.custom),"$$scope"in pe&&m(89,Rt=pe.$$scope)},c.$$.update=()=>{c.$$.dirty[1]&8388608&&Qn&&m(87,F.x=Qn,F),c.$$.dirty[1]&16777216&&hi&&m(87,F.y=hi,F),c.$$.dirty[1]&33554432&&cn&&m(87,F.z=cn,F),c.$$.dirty[1]&67108864&&Bn&&m(87,F.r=Bn,F),c.$$.dirty[1]&268435456&&Fr&&m(87,F.xDomain=Fr,F),c.$$.dirty[1]&536870912&&Yr&&m(87,F.yDomain=Yr,F),c.$$.dirty[1]&1073741824&&Xr&&m(87,F.zDomain=Xr,F),c.$$.dirty[2]&1&&go&&m(87,F.rDomain=go,F),c.$$.dirty[2]&131072&&en&&m(87,F.xRange=en,F),c.$$.dirty[2]&262144&&Dr&&m(87,F.yRange=Dr,F),c.$$.dirty[2]&524288&&C&&m(87,F.zRange=C,F),c.$$.dirty[2]&1048576&&R&&m(87,F.rRange=R,F),c.$$.dirty[1]&1048576&&Er(re,Yi=qt,Yi),c.$$.dirty[0]&1&&Er(me,br=Ci,br),c.$$.dirty[0]&2&&Er(Ce,lr=Yn,lr),c.$$.dirty[2]&4194304&&Er(Le,Ze=kp(G),Ze),c.$$.dirty[1]&134217728&&Er(be,nt=Mi,nt),c.$$.dirty[1]&134217728|c.$$.dirty[2]&8388608&&Er(Be,er=ee||Mi,er),c.$$.dirty[2]&2097152&&Er(et,kt=O,kt),c.$$.dirty[1]&8388608&&Er(Qe,Or=Xl(Qn),Or),c.$$.dirty[1]&16777216&&Er(Se,hr=Xl(hi),hr),c.$$.dirty[1]&33554432&&Er(Je,it=Xl(cn),it),c.$$.dirty[1]&67108864&&Er(Ne,rr=Xl(Bn),rr),c.$$.dirty[1]&268435456&&Er(Ge,It=Fr,It),c.$$.dirty[1]&536870912&&Er(At,mr=Yr,mr),c.$$.dirty[1]&1073741824&&Er(je,qe=Xr,qe),c.$$.dirty[2]&1&&Er(Pt,Ht=go,Ht),c.$$.dirty[2]&2&&Er(ar,Wt=On,Wt),c.$$.dirty[2]&4&&Er(Ct,cr=ya,cr),c.$$.dirty[2]&8&&Er(Vt,xr=Co,xr),c.$$.dirty[2]&16&&Er(Mt,He=hn,He),c.$$.dirty[2]&32&&Er(oi,ft=$n,ft),c.$$.dirty[2]&64&&Er(Jt,Lt=_o,Lt),c.$$.dirty[2]&128&&Er(zr,Ft=Mo,Ft),c.$$.dirty[2]&256&&Er(or,Xe=$i,Xe),c.$$.dirty[2]&512&&Er(Bt,Ke=eo,Ke),c.$$.dirty[2]&1024&&Er(Zt,ze=vo,ze),c.$$.dirty[2]&2048&&Er(pi,Oe=Ho,Oe),c.$$.dirty[2]&4096&&Er(tn,fe=Jo,fe),c.$$.dirty[2]&131072&&Er(Cr,H=en,H),c.$$.dirty[2]&262144&&Er(ai,K=Dr,K),c.$$.dirty[2]&524288&&Er(Yo,W=C,W),c.$$.dirty[2]&1048576&&Er(Do,N=R,N),c.$$.dirty[2]&8192&&Er(Ar,V=Ti,V),c.$$.dirty[2]&16384&&Er(bo,A=Qr,A),c.$$.dirty[2]&32768&&Er(fi,M=Ii,M),c.$$.dirty[2]&65536&&Er(Wr,s=xo,s),c.$$.dirty[2]&16777216&&Er(wr,E=le,E),c.$$.dirty[2]&33554432&&Er(di,S=F,S),c.$$.dirty[2]&67108864&&Am("LayerCake",v)},m(88,v={activeGetters:pn,width:yi,height:Sn,percentRange:re,aspectRatio:Nn,containerWidth:me,containerHeight:Ce,x:Qe,y:Se,z:Je,r:Ne,custom:wr,data:be,xNice:ar,yNice:Ct,zNice:Vt,rNice:Mt,xReverse:oi,yReverse:Jt,zReverse:zr,rReverse:or,xPadding:Bt,yPadding:Zt,zPadding:pi,rPadding:tn,padding:mi,flatData:Be,extents:gi,xDomain:si,yDomain:Fn,zDomain:ki,rDomain:sr,xRange:wo,yRange:bs,zRange:ja,rRange:$o,config:di,xScale:to,xGet:ro,yScale:Vn,yGet:al,zScale:Lo,zGet:Yl,rScale:os,rGet:ga}),[Ci,Yn,Zi,kr,xn,bn,lr,br,Qi,Ni,Gt,re,me,Ce,Le,be,Be,et,Qe,Se,Je,Ne,Ge,At,je,Pt,ar,Ct,Vt,Mt,oi,Jt,zr,or,Bt,Zt,pi,tn,Cr,ai,Yo,Do,Ar,bo,fi,Wr,di,wr,yi,Sn,Nn,qt,wn,Ei,Qn,hi,cn,Bn,Mi,Fr,Yr,Xr,go,On,ya,Co,hn,$n,_o,Mo,$i,eo,vo,Ho,Jo,Ti,Qr,Ii,xo,en,Dr,C,R,O,G,ee,le,F,v,Rt,_r,En,Gi]}class uv extends rs{constructor(p){super(),is(this,p,lv,sv,ns,{ssr:3,pointerEvents:4,position:5,percentRange:51,width:52,height:53,containerWidth:0,containerHeight:1,element:2,x:54,y:55,z:56,r:57,data:58,xDomain:59,yDomain:60,zDomain:61,rDomain:62,xNice:63,yNice:64,zNice:65,rNice:66,xReverse:67,yReverse:68,zReverse:69,rReverse:70,xPadding:71,yPadding:72,zPadding:73,rPadding:74,xScale:75,yScale:76,zScale:77,rScale:78,xRange:79,yRange:80,zRange:81,rRange:82,padding:83,extents:84,flatData:85,custom:86},null,[-1,-1,-1,-1,-1])}}const cv=c=>({element:c&1}),qd=c=>({element:c[0]}),hv=c=>({element:c&1}),Zd=c=>({element:c[0]});function pv(c){let p,m,v,S,E;const s=c[12].defs,M=zc(s,c,c[11],Zd),A=c[12].default,V=zc(A,c,c[11],qd);return{c(){p=Xo("svg"),m=Xo("defs"),M&&M.c(),v=Xo("g"),V&&V.c(),this.h()},l(N){p=Wo(N,"svg",{class:!0,viewBox:!0,width:!0,height:!0});var W=we(p);m=Wo(W,"defs",{});var K=we(m);M&&M.l(K),K.forEach(se),v=Wo(W,"g",{class:!0,transform:!0});var H=we(v);V&&V.l(H),H.forEach(se),W.forEach(se),this.h()},h(){X(v,"class","layercake-layout-svg_g"),X(v,"transform",S="translate("+c[7].left+", "+c[7].top+")"),X(p,"class","layercake-layout-svg svelte-u84d8d"),X(p,"viewBox",c[4]),X(p,"width",c[5]),X(p,"height",c[6]),De(p,"z-index",c[2],!1),De(p,"pointer-events",c[3]===!1?"none":null,!1)},m(N,W){dt(N,p,W),ie(p,m),M&&M.m(m,null),ie(p,v),V&&V.m(v,null),c[13](v),c[14](p),E=!0},p(N,[W]){M&&M.p&&(!E||W&2049)&&Ac(M,s,N,N[11],E?Cc(s,N[11],W,hv):Pc(N[11]),Zd),V&&V.p&&(!E||W&2049)&&Ac(V,A,N,N[11],E?Cc(A,N[11],W,cv):Pc(N[11]),qd),(!E||W&128&&S!==(S="translate("+N[7].left+", "+N[7].top+")"))&&X(v,"transform",S),(!E||W&16)&&X(p,"viewBox",N[4]),(!E||W&32)&&X(p,"width",N[5]),(!E||W&64)&&X(p,"height",N[6]),W&4&&De(p,"z-index",N[2],!1),W&8&&De(p,"pointer-events",N[3]===!1?"none":null,!1)},i(N){E||(jt(M,N),jt(V,N),E=!0)},o(N){tr(M,N),tr(V,N),E=!1},d(N){N&&se(p),M&&M.d(N),V&&V.d(N),c[13](null),c[14](null)}}}function fv(c,p,m){let v,S,E,{$$slots:s={},$$scope:M}=p,{element:A=void 0}=p,{innerElement:V=void 0}=p,{zIndex:N=void 0}=p,{pointerEvents:W=void 0}=p,{viewBox:K=void 0}=p;const{containerWidth:H,containerHeight:fe,padding:Oe}=Rc("LayerCake");Ut(c,H,Xe=>m(5,v=Xe)),Ut(c,fe,Xe=>m(6,S=Xe)),Ut(c,Oe,Xe=>m(7,E=Xe));function ze(Xe){Tl[Xe?"unshift":"push"](()=>{V=Xe,m(1,V)})}function Ke(Xe){Tl[Xe?"unshift":"push"](()=>{A=Xe,m(0,A)})}return c.$$set=Xe=>{"element"in Xe&&m(0,A=Xe.element),"innerElement"in Xe&&m(1,V=Xe.innerElement),"zIndex"in Xe&&m(2,N=Xe.zIndex),"pointerEvents"in Xe&&m(3,W=Xe.pointerEvents),"viewBox"in Xe&&m(4,K=Xe.viewBox),"$$scope"in Xe&&m(11,M=Xe.$$scope)},[A,V,N,W,K,v,S,E,H,fe,Oe,M,s,ze,Ke]}class dv extends rs{constructor(p){super(),is(this,p,fv,pv,ns,{element:0,innerElement:1,zIndex:2,pointerEvents:3,viewBox:4})}}function Gd(c,p,m){const v=c.slice();return v[24]=p[m],v[26]=m,v}function Kd(c){let p,m,v,S;return{c(){p=Xo("rect"),this.h()},l(E){p=Wo(E,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),we(p).forEach(se),this.h()},h(){X(p,"class","group-rect"),X(p,"data-id",c[26]),X(p,"x",m=c[11].bandwidth?c[7](c[24]):c[7](c[24])[0]),X(p,"y",v=c[13](c[12](c[24]))-1),X(p,"width",S=c[11].bandwidth?c[11].bandwidth():c[9](c[24])),X(p,"height","3"),X(p,"fill","#CEDC20"),X(p,"stroke",c[0]),X(p,"stroke-width",c[1])},m(E,s){dt(E,p,s)},p(E,s){s&3200&&m!==(m=E[11].bandwidth?E[7](E[24]):E[7](E[24])[0])&&X(p,"x",m),s&13312&&v!==(v=E[13](E[12](E[24]))-1)&&X(p,"y",v),s&3584&&S!==(S=E[11].bandwidth?E[11].bandwidth():E[9](E[24]))&&X(p,"width",S),s&1&&X(p,"stroke",E[0]),s&2&&X(p,"stroke-width",E[1])},d(E){E&&se(p)}}}function Xd(c){let p,m,v,S,E,s,M,A,V=c[12]&&Kd(c);return{c(){p=Xo("rect"),V&&V.c(),s=Xo("text"),this.h()},l(N){p=Wo(N,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),we(p).forEach(se),V&&V.l(N),s=Wo(N,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0}),we(s).forEach(se),this.h()},h(){X(p,"class","group-rect"),X(p,"data-id",c[26]),X(p,"x",m=c[11].bandwidth?c[7](c[24]):c[7](c[24])[0]),X(p,"y",v=c[6](c[24])),X(p,"width",S=c[11].bandwidth?c[11].bandwidth():c[9](c[24])),X(p,"height",E=c[8](c[24])),X(p,"fill",c[4]),X(p,"stroke",c[0]),X(p,"stroke-width",c[1]),X(s,"x",M=c[11].bandwidth?c[7](c[24])+c[11].bandwidth()/2:c[7](c[24])[0]),X(s,"y",A=c[6](c[24])-4),X(s,"dx",c[2]),X(s,"dy",c[3]),X(s,"text-anchor",c[5])},m(N,W){dt(N,p,W),V&&V.m(N,W),dt(N,s,W)},p(N,W){W&3200&&m!==(m=N[11].bandwidth?N[7](N[24]):N[7](N[24])[0])&&X(p,"x",m),W&1088&&v!==(v=N[6](N[24]))&&X(p,"y",v),W&3584&&S!==(S=N[11].bandwidth?N[11].bandwidth():N[9](N[24]))&&X(p,"width",S),W&1280&&E!==(E=N[8](N[24]))&&X(p,"height",E),W&16&&X(p,"fill",N[4]),W&1&&X(p,"stroke",N[0]),W&2&&X(p,"stroke-width",N[1]),N[12]?V?V.p(N,W):(V=Kd(N),V.c(),V.m(s.parentNode,s)):V&&(V.d(1),V=null),W&3200&&M!==(M=N[11].bandwidth?N[7](N[24])+N[11].bandwidth()/2:N[7](N[24])[0])&&X(s,"x",M),W&1088&&A!==(A=N[6](N[24])-4)&&X(s,"y",A),W&4&&X(s,"dx",N[2]),W&8&&X(s,"dy",N[3]),W&32&&X(s,"text-anchor",N[5])},d(N){N&&se(p),V&&V.d(N),N&&se(s)}}}function mv(c){let p,m=c[10],v=[];for(let S=0;S<m.length;S+=1)v[S]=Xd(Gd(c,m,S));return{c(){p=Xo("g");for(let S=0;S<v.length;S+=1)v[S].c();this.h()},l(S){p=Wo(S,"g",{class:!0});var E=we(p);for(let s=0;s<v.length;s+=1)v[s].l(E);E.forEach(se),this.h()},h(){X(p,"class","column-group svelte-wgzwsk")},m(S,E){dt(S,p,E);for(let s=0;s<v.length;s+=1)v[s].m(p,null)},p(S,[E]){if(E&16383){m=S[10];let s;for(s=0;s<m.length;s+=1){const M=Gd(S,m,s);v[s]?v[s].p(M,E):(v[s]=Xd(M),v[s].c(),v[s].m(p,null))}for(;s<v.length;s+=1)v[s].d(1);v.length=m.length}},i:xs,o:xs,d(S){S&&se(p),Os(v,S)}}}function yv(c,p,m){let v,S,E,s,M,A,V,N,W;const{data:K,xGet:H,yGet:fe,yRange:Oe,xScale:ze,yScale:Ke,y:Xe,z:Ft}=Rc("LayerCake");Ut(c,K,qe=>m(10,A=qe)),Ut(c,H,qe=>m(7,M=qe)),Ut(c,fe,qe=>m(6,E=qe)),Ut(c,Oe,qe=>m(22,s=qe)),Ut(c,ze,qe=>m(11,V=qe)),Ut(c,Ke,qe=>m(13,W=qe)),Ut(c,Ft,qe=>m(12,N=qe));let{stroke:Lt=""}=p,{strokeWidth:ft=0}=p,{dxTick:He=0}=p,{dyTick:xr=0}=p,{formatVal:cr=qe=>qe}=p,{fill:Wt="#00205b"}=p,{textAnchor:Ht="middle"}=p;return c.$$set=qe=>{"stroke"in qe&&m(0,Lt=qe.stroke),"strokeWidth"in qe&&m(1,ft=qe.strokeWidth),"dxTick"in qe&&m(2,He=qe.dxTick),"dyTick"in qe&&m(3,xr=qe.dyTick),"formatVal"in qe&&m(21,cr=qe.formatVal),"fill"in qe&&m(4,Wt=qe.fill),"textAnchor"in qe&&m(5,Ht=qe.textAnchor)},c.$$.update=()=>{c.$$.dirty&128&&m(9,v=qe=>{const mr=M(qe);return Math.max(0,mr[1]-mr[0])}),c.$$.dirty&4194368&&m(8,S=qe=>s[0]-E(qe))},[Lt,ft,He,xr,Wt,Ht,E,M,S,v,A,V,N,W,K,H,fe,Oe,ze,Ke,Ft,cr,s]}class gv extends rs{constructor(p){super(),is(this,p,yv,mv,ns,{stroke:0,strokeWidth:1,dxTick:2,dyTick:3,formatVal:21,fill:4,textAnchor:5})}}function Wd(c,p,m){const v=c.slice();return v[28]=p[m],v[30]=m,v}function Hd(c){let p,m,v,S;return{c(){p=Xo("line"),this.h()},l(E){p=Wo(E,"line",{y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0,"stroke-width":!0,class:!0}),we(p).forEach(se),this.h()},h(){X(p,"y1",m=c[20]*-1),X(p,"y2",v=c[14]&&c[30]%2==0?c[10]+c[8]+2:c[10]+c[8]-13),X(p,"x1","0"),X(p,"x2","0"),X(p,"stroke",c[11]),X(p,"stroke-width",S=c[15]&&Array.isArray(c[4])&&c[30]==Math.floor(c[4].length/2)?2:1),X(p,"class","svelte-fwjh80"),ln(p,"baseline",c[13])},m(E,s){dt(E,p,s)},p(E,s){s&1048576&&m!==(m=E[20]*-1)&&X(p,"y1",m),s&17664&&v!==(v=E[14]&&E[30]%2==0?E[10]+E[8]+2:E[10]+E[8]-13)&&X(p,"y2",v),s&2048&&X(p,"stroke",E[11]),s&32784&&S!==(S=E[15]&&Array.isArray(E[4])&&E[30]==Math.floor(E[4].length/2)?2:1)&&X(p,"stroke-width",S),s&8192&&ln(p,"baseline",E[13])},d(E){E&&se(p)}}}function _v(c){let p=c[1](c[28])+"",m;return{c(){m=tt(p)},l(v){m=rt(v,p)},m(v,S){dt(v,m,S)},p(v,S){S&262146&&p!==(p=v[1](v[28])+"")&&Pr(m,p)},d(v){v&&se(m)}}}function vv(c){let p,m=c[1](c[28])+"",v,S;return{c(){p=tt(c[5]),v=tt(m),S=tt(c[6])},l(E){p=rt(E,c[5]),v=rt(E,m),S=rt(E,c[6])},m(E,s){dt(E,p,s),dt(E,v,s),dt(E,S,s)},p(E,s){s&32&&Pr(p,E[5]),s&262146&&m!==(m=E[1](E[28])+"")&&Pr(v,m),s&64&&Pr(S,E[6])},d(E){E&&se(p),E&&se(v),E&&se(S)}}}function Jd(c){let p,m,v,S,E,s,M,A=c[0]!==!1&&Hd(c);function V(K,H){return K[30]==K[18].length-1?vv:_v}let N=V(c),W=N(c);return{c(){p=Xo("g"),A&&A.c(),m=Xo("text"),W.c(),this.h()},l(K){p=Wo(K,"g",{class:!0,transform:!0});var H=we(p);A&&A.l(H),m=Wo(H,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0,fill:!0,class:!0});var fe=we(m);W.l(fe),fe.forEach(se),H.forEach(se),this.h()},h(){X(m,"x",v=c[7]||c[16]?c[17].bandwidth()/2:0),X(m,"y",S=c[3]?c[20]*-1-6:c[14]&&c[30]%2==0?c[8]+15:c[8]),X(m,"dx",E=c[24](c[30])=="start"?c[9]-2:c[24](c[30])=="end"?c[9]+2:c[9]),X(m,"dy",c[10]),X(m,"text-anchor",c[24](c[30])),X(m,"fill",c[12]),X(m,"class","svelte-fwjh80"),ln(m,"bold",c[15]&&Array.isArray(c[4])&&c[30]==Math.floor(c[4].length/2)),X(p,"class",s="tick tick-"+c[28]+" svelte-fwjh80"),X(p,"transform",M="translate("+c[17](c[28])+","+c[19][0]+")")},m(K,H){dt(K,p,H),A&&A.m(p,null),ie(p,m),W.m(m,null)},p(K,H){K[0]!==!1?A?A.p(K,H):(A=Hd(K),A.c(),A.m(p,m)):A&&(A.d(1),A=null),N===(N=V(K))&&W?W.p(K,H):(W.d(1),W=N(K),W&&(W.c(),W.m(m,null))),H&196736&&v!==(v=K[7]||K[16]?K[17].bandwidth()/2:0)&&X(m,"x",v),H&1065224&&S!==(S=K[3]?K[20]*-1-6:K[14]&&K[30]%2==0?K[8]+15:K[8])&&X(m,"y",S),H&512&&E!==(E=K[24](K[30])=="start"?K[9]-2:K[24](K[30])=="end"?K[9]+2:K[9])&&X(m,"dx",E),H&1024&&X(m,"dy",K[10]),H&4096&&X(m,"fill",K[12]),H&32784&&ln(m,"bold",K[15]&&Array.isArray(K[4])&&K[30]==Math.floor(K[4].length/2)),H&262144&&s!==(s="tick tick-"+K[28]+" svelte-fwjh80")&&X(p,"class",s),H&917504&&M!==(M="translate("+K[17](K[28])+","+K[19][0]+")")&&X(p,"transform",M)},d(K){K&&se(p),A&&A.d(),W.d()}}}function Yd(c){let p,m,v;return{c(){p=Xo("line"),this.h()},l(S){p=Wo(S,"line",{class:!0,y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0}),we(p).forEach(se),this.h()},h(){X(p,"class","baseline svelte-fwjh80"),X(p,"y1",c[20]),X(p,"y2","0"),X(p,"x1",m=c[17](0)),X(p,"x2",v=c[17](0)),X(p,"stroke",c[11])},m(S,E){dt(S,p,E)},p(S,E){E&1048576&&X(p,"y1",S[20]),E&131072&&m!==(m=S[17](0))&&X(p,"x1",m),E&131072&&v!==(v=S[17](0))&&X(p,"x2",v),E&2048&&X(p,"stroke",S[11])},d(S){S&&se(p)}}}function xv(c){let p,m,v=c[18],S=[];for(let s=0;s<v.length;s+=1)S[s]=Jd(Wd(c,v,s));let E=c[2]===!0&&Yd(c);return{c(){p=Xo("g");for(let s=0;s<S.length;s+=1)S[s].c();m=un(),E&&E.c(),this.h()},l(s){p=Wo(s,"g",{class:!0});var M=we(p);for(let A=0;A<S.length;A+=1)S[A].l(M);m=un(),E&&E.l(M),M.forEach(se),this.h()},h(){X(p,"class","axis x-axis")},m(s,M){dt(s,p,M);for(let A=0;A<S.length;A+=1)S[A].m(p,null);ie(p,m),E&&E.m(p,null)},p(s,[M]){if(M&18874363){v=s[18];let A;for(A=0;A<v.length;A+=1){const V=Wd(s,v,A);S[A]?S[A].p(V,M):(S[A]=Jd(V),S[A].c(),S[A].m(p,m))}for(;A<S.length;A+=1)S[A].d(1);S.length=v.length}s[2]===!0?E?E.p(s,M):(E=Yd(s),E.c(),E.m(p,null)):E&&(E.d(1),E=null)},i:xs,o:xs,d(s){s&&se(p),Os(S,s),E&&E.d()}}}function bv(c,p,m){let v,S,E,s,M;const{width:A,height:V,xScale:N,yScale:W,yRange:K}=Rc("LayerCake");Ut(c,V,it=>m(20,M=it)),Ut(c,N,it=>m(17,E=it)),Ut(c,K,it=>m(19,s=it));let{gridlines:H=!0}=p,{formatTick:fe=it=>it}=p,{baseline:Oe=!1}=p,{flipped:ze=!1}=p,{snapTicks:Ke=!1}=p,{ticks:Xe=void 0}=p,{prefix:Ft=""}=p,{suffix:Lt=""}=p,{xTick:ft=void 0}=p,{yTick:He=15}=p,{dxTick:xr=0}=p,{dyTick:cr=0}=p,{lineColor:Wt="#999"}=p,{textColor:Ht="#555"}=p,{solid:qe=!1}=p,{stagger:mr=!1}=p,{median:It=!0}=p;function rr(it){if(Ke===!0){if(it===0)return"start";if(it===S.length-1)return"end"}return"middle"}return c.$$set=it=>{"gridlines"in it&&m(0,H=it.gridlines),"formatTick"in it&&m(1,fe=it.formatTick),"baseline"in it&&m(2,Oe=it.baseline),"flipped"in it&&m(3,ze=it.flipped),"snapTicks"in it&&m(25,Ke=it.snapTicks),"ticks"in it&&m(4,Xe=it.ticks),"prefix"in it&&m(5,Ft=it.prefix),"suffix"in it&&m(6,Lt=it.suffix),"xTick"in it&&m(7,ft=it.xTick),"yTick"in it&&m(8,He=it.yTick),"dxTick"in it&&m(9,xr=it.dxTick),"dyTick"in it&&m(10,cr=it.dyTick),"lineColor"in it&&m(11,Wt=it.lineColor),"textColor"in it&&m(12,Ht=it.textColor),"solid"in it&&m(13,qe=it.solid),"stagger"in it&&m(14,mr=it.stagger),"median"in it&&m(15,It=it.median)},c.$$.update=()=>{c.$$.dirty&131072&&m(16,v=typeof E.bandwidth=="function"),c.$$.dirty&196624&&m(18,S=Array.isArray(Xe)?Xe:v?E.domain():E.ticks(Xe))},[H,fe,Oe,ze,Xe,Ft,Lt,ft,He,xr,cr,Wt,Ht,qe,mr,It,v,E,S,s,M,V,N,K,rr,Ke]}class wv extends rs{constructor(p){super(),is(this,p,bv,xv,ns,{gridlines:0,formatTick:1,baseline:2,flipped:3,snapTicks:25,ticks:4,prefix:5,suffix:6,xTick:7,yTick:8,dxTick:9,dyTick:10,lineColor:11,textColor:12,solid:13,stagger:14,median:15})}}function Sv(c){let p,m,v,S;return p=new gv({props:{fill:c[1],formatVal:c[5]}}),v=new wv({props:{gridlines:!1}}),{c(){xi(p.$$.fragment),m=ht(),xi(v.$$.fragment)},l(E){bi(p.$$.fragment,E),m=pt(E),bi(v.$$.fragment,E)},m(E,s){wi(p,E,s),dt(E,m,s),wi(v,E,s),S=!0},p(E,s){const M={};s&2&&(M.fill=E[1]),s&32&&(M.formatVal=E[5]),p.$set(M)},i(E){S||(jt(p.$$.fragment,E),jt(v.$$.fragment,E),S=!0)},o(E){tr(p.$$.fragment,E),tr(v.$$.fragment,E),S=!1},d(E){Si(p,E),E&&se(m),Si(v,E)}}}function Ev(c){let p,m;return p=new dv({props:{$$slots:{default:[Sv]},$$scope:{ctx:c}}}),{c(){xi(p.$$.fragment)},l(v){bi(p.$$.fragment,v)},m(v,S){wi(p,v,S),m=!0},p(v,S){const E={};S&1058&&(E.$$scope={dirty:S,ctx:v}),p.$set(E)},i(v){m||(jt(p.$$.fragment,v),m=!0)},o(v){tr(p.$$.fragment,v),m=!1},d(v){Si(p,v)}}}function Tv(c){let p,m,v;return m=new uv({props:{padding:{top:15,right:0,bottom:20,left:0},x:c[2],y:c[3],z:c[4],xScale:Bm().paddingInner([.02]).round(!0),xDomain:c[7],yDomain:c[6],zDomain:c[6],data:c[0],$$slots:{default:[Ev]},$$scope:{ctx:c}}}),{c(){p=Ie("div"),xi(m.$$.fragment),this.h()},l(S){p=ke(S,"DIV",{class:!0});var E=we(p);bi(m.$$.fragment,E),E.forEach(se),this.h()},h(){X(p,"class","chart-container svelte-s9z6lx")},m(S,E){dt(S,p,E),wi(m,p,null),v=!0},p(S,[E]){const s={};E&4&&(s.x=S[2]),E&8&&(s.y=S[3]),E&16&&(s.z=S[4]),E&128&&(s.xDomain=S[7]),E&64&&(s.yDomain=S[6]),E&64&&(s.zDomain=S[6]),E&1&&(s.data=S[0]),E&1058&&(s.$$scope={dirty:E,ctx:S}),m.$set(s)},i(S){v||(jt(m.$$.fragment,S),v=!0)},o(S){tr(m.$$.fragment,S),v=!1},d(S){S&&se(p),Si(m)}}}function Iv(c,p,m){let v,S,E,{data:s}=p,{suffix:M="%"}=p,{decimals:A=0}=p,{fill:V="#00205B"}=p,{xKey:N="x"}=p,{yKey:W="y"}=p,{zKey:K=null}=p;return c.$$set=H=>{"data"in H&&m(0,s=H.data),"suffix"in H&&m(8,M=H.suffix),"decimals"in H&&m(9,A=H.decimals),"fill"in H&&m(1,V=H.fill),"xKey"in H&&m(2,N=H.xKey),"yKey"in H&&m(3,W=H.yKey),"zKey"in H&&m(4,K=H.zKey)},c.$$.update=()=>{c.$$.dirty&5&&m(7,v=s.map(H=>H[N])),c.$$.dirty&9&&m(6,S=[0,Math.max(...s.map(H=>H[W]))]),c.$$.dirty&768&&m(5,E=H=>H.toFixed(A)+M)},[s,V,N,W,K,E,S,v,M,A]}class Ec extends rs{constructor(p){super(),is(this,p,Iv,Tv,ns,{data:0,suffix:8,decimals:9,fill:1,xKey:2,yKey:3,zKey:4})}}function Qd(c,p,m){const v=c.slice();return v[7]=p[m],v[9]=m,v}function $d(c){let p,m=c[0],v=[];for(let S=0;S<m.length;S+=1)v[S]=em(Qd(c,m,S));return{c(){p=Xo("svg");for(let S=0;S<v.length;S+=1)v[S].c();this.h()},l(S){p=Wo(S,"svg",{class:!0});var E=we(p);for(let s=0;s<v.length;s+=1)v[s].l(E);E.forEach(se),this.h()},h(){X(p,"class","stack svelte-q6mgyr")},m(S,E){dt(S,p,E);for(let s=0;s<v.length;s+=1)v[s].m(p,null)},p(S,E){if(E&31){m=S[0];let s;for(s=0;s<m.length;s+=1){const M=Qd(S,m,s);v[s]?v[s].p(M,E):(v[s]=em(M),v[s].c(),v[s].m(p,null))}for(;s<v.length;s+=1)v[s].d(1);v.length=m.length}},d(S){S&&se(p),Os(v,S)}}}function em(c){let p,m;return{c(){p=Xo("rect"),this.h()},l(v){p=Wo(v,"rect",{class:!0,x:!0,style:!0}),we(p).forEach(se),this.h()},h(){X(p,"class","cell svelte-q6mgyr"),X(p,"x",m=c[4][c[9]]/c[3]*100+"%"),De(p,"width",c[7][c[1]]/c[3]*100+"%"),De(p,"fill",c[2][c[9]])},m(v,S){dt(v,p,S)},p(v,S){S&24&&m!==(m=v[4][v[9]]/v[3]*100+"%")&&X(p,"x",m),S&11&&De(p,"width",v[7][v[1]]/v[3]*100+"%"),S&4&&De(p,"fill",v[2][v[9]])},d(v){v&&se(p)}}}function kv(c){let p,m=c[3]&&c[4]&&$d(c);return{c(){m&&m.c(),p=un()},l(v){m&&m.l(v),p=un()},m(v,S){m&&m.m(v,S),dt(v,p,S)},p(v,[S]){v[3]&&v[4]?m?m.p(v,S):(m=$d(v),m.c(),m.m(p.parentNode,p)):m&&(m.d(1),m=null)},i:xs,o:xs,d(v){m&&m.d(v),v&&se(p)}}}function zv(c,p,m){let{data:v}=p,{xKey:S="x"}=p,{yKey:E="y"}=p,{colors:s=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=p,M,A;function V(){m(3,M=v.map(W=>W[E]).reduce((W,K)=>W+K,0));let N=[0];v.forEach(W=>N.push(N[N.length-1]+W[E])),m(4,A=N)}return c.$$set=N=>{"data"in N&&m(0,v=N.data),"xKey"in N&&m(5,S=N.xKey),"yKey"in N&&m(1,E=N.yKey),"colors"in N&&m(2,s=N.colors)},c.$$.update=()=>{c.$$.dirty&3&&(v||E)&&V()},[v,E,s,M,A,S]}class Xm extends rs{constructor(p){super(),is(this,p,zv,kv,ns,{data:0,xKey:5,yKey:1,colors:2})}}function tm(c,p,m){const v=c.slice();return v[12]=p[m],v[14]=m,v}function Av(c){let p,m,v=Vh(Math.round(c[12][c[3]]),"%)")+"",S;return{c(){p=Ie("span"),m=tt("(NI "),S=tt(v),this.h()},l(E){p=ke(E,"SPAN",{class:!0,style:!0});var s=we(p);m=rt(s,"(NI "),S=rt(s,v),s.forEach(se),this.h()},h(){X(p,"class",""),De(p,"color","#3878C5")},m(E,s){dt(E,p,s),ie(p,m),ie(p,S)},p(E,s){s&9&&v!==(v=Vh(Math.round(E[12][E[3]]),"%)")+"")&&Pr(S,v)},d(E){E&&se(p)}}}function Pv(c){let p,m,v=Vh(Math.round(c[12][c[3]]),"%)")+"",S;return{c(){p=Ie("span"),m=tt("(2011 "),S=tt(v),this.h()},l(E){p=ke(E,"SPAN",{class:!0,style:!0});var s=we(p);m=rt(s,"(2011 "),S=rt(s,v),s.forEach(se),this.h()},h(){X(p,"class",""),De(p,"color","#3878C5")},m(E,s){dt(E,p,s),ie(p,m),ie(p,S)},p(E,s){s&9&&v!==(v=Vh(Math.round(E[12][E[3]]),"%)")+"")&&Pr(S,v)},d(E){E&&se(p)}}}function rm(c){let p,m,v,S,E=c[12][c[1]]+"",s,M,A=c[6](c[12][c[2]])+"",V,N,W,K;function H(ze,Ke){if(ze[3]=="prev")return Pv;if(ze[3])return Av}let fe=H(c),Oe=fe&&fe(c);return{c(){p=Ie("li"),m=Xo("svg"),v=Xo("rect"),S=ht(),s=tt(E),M=ht(),V=tt(A),N=ht(),Oe&&Oe.c(),W=ht(),K=Ie("br"),this.h()},l(ze){p=ke(ze,"LI",{style:!0,class:!0});var Ke=we(p);m=Wo(Ke,"svg",{width:!0,height:!0,class:!0});var Xe=we(m);v=Wo(Xe,"rect",{width:!0,height:!0,style:!0});var Ft=we(v);Ft.forEach(se),Xe.forEach(se),S=pt(Ke),s=rt(Ke,E),M=pt(Ke),V=rt(Ke,A),N=pt(Ke),Oe&&Oe.l(Ke),Ke.forEach(se),W=pt(ze),K=ke(ze,"BR",{}),this.h()},h(){X(v,"width","20"),X(v,"height","30"),De(v,"fill",c[4][c[14]]),X(m,"width","20"),X(m,"height","30"),X(m,"class","bullet svelte-17303hq"),De(p,"color",c[5]),X(p,"class","svelte-17303hq")},m(ze,Ke){dt(ze,p,Ke),ie(p,m),ie(m,v),ie(p,S),ie(p,s),ie(p,M),ie(p,V),ie(p,N),Oe&&Oe.m(p,null),dt(ze,W,Ke),dt(ze,K,Ke)},p(ze,Ke){Ke&16&&De(v,"fill",ze[4][ze[14]]),Ke&3&&E!==(E=ze[12][ze[1]]+"")&&Pr(s,E),Ke&5&&A!==(A=ze[6](ze[12][ze[2]])+"")&&Pr(V,A),fe===(fe=H(ze))&&Oe?Oe.p(ze,Ke):(Oe&&Oe.d(1),Oe=fe&&fe(ze),Oe&&(Oe.c(),Oe.m(p,null))),Ke&32&&De(p,"color",ze[5])},d(ze){ze&&se(p),Oe&&Oe.d(),ze&&se(W),ze&&se(K)}}}function Cv(c){let p,m=c[0],v=[];for(let S=0;S<m.length;S+=1)v[S]=rm(tm(c,m,S));return{c(){p=Ie("ul");for(let S=0;S<v.length;S+=1)v[S].c();this.h()},l(S){p=ke(S,"UL",{class:!0});var E=we(p);for(let s=0;s<v.length;s+=1)v[s].l(E);E.forEach(se),this.h()},h(){X(p,"class","svelte-17303hq")},m(S,E){dt(S,p,E);for(let s=0;s<v.length;s+=1)v[s].m(p,null)},p(S,[E]){if(E&127){m=S[0];let s;for(s=0;s<m.length;s+=1){const M=tm(S,m,s);v[s]?v[s].p(M,E):(v[s]=rm(M),v[s].c(),v[s].m(p,null))}for(;s<v.length;s+=1)v[s].d(1);v.length=m.length}},i:xs,o:xs,d(S){S&&se(p),Os(v,S)}}}function Mv(c,p,m){let v,{data:S}=p,{xKey:E="x"}=p,{yKey:s="y"}=p,{zKey:M="ew"}=p,{colors:A=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=p,{textColor:V="#555"}=p,{mutedColor:N="#999"}=p,{decimals:W=null}=p,{round:K=!1}=p;function H(fe){let Oe;return W?Oe=(fe/v*100).toFixed(W)+"%":fe/v*100<1?Oe="<1%":Oe=(fe/v*100).toFixed(0)+"%",Oe}return c.$$set=fe=>{"data"in fe&&m(0,S=fe.data),"xKey"in fe&&m(1,E=fe.xKey),"yKey"in fe&&m(2,s=fe.yKey),"zKey"in fe&&m(3,M=fe.zKey),"colors"in fe&&m(4,A=fe.colors),"textColor"in fe&&m(5,V=fe.textColor),"mutedColor"in fe&&m(7,N=fe.mutedColor),"decimals"in fe&&m(8,W=fe.decimals),"round"in fe&&m(9,K=fe.round)},c.$$.update=()=>{c.$$.dirty&5&&(v=S.map(fe=>fe[s]).reduce((fe,Oe)=>fe+Oe,0)),c.$$.dirty&9&&S.map(fe=>fe[M]).reduce((fe,Oe)=>fe+Oe,0)},[S,E,s,M,A,V,H,N,W,K]}class Dv extends rs{constructor(p){super(),is(this,p,Mv,Cv,ns,{data:0,xKey:1,yKey:2,zKey:3,colors:4,textColor:5,mutedColor:7,decimals:8,round:9})}}function im(c){let p,m,v,S;m=new Xm({props:{data:c[0],yKey:c[4],colors:c[5]}});let E=c[7]&&nm(c);return{c(){p=Ie("div"),xi(m.$$.fragment),v=ht(),E&&E.c(),this.h()},l(s){p=ke(s,"DIV",{class:!0,style:!0});var M=we(p);bi(m.$$.fragment,M),v=pt(M),E&&E.l(M),M.forEach(se),this.h()},h(){X(p,"class","chart svelte-1tebgpk"),De(p,"height",c[1]*.28+"px")},m(s,M){dt(s,p,M),wi(m,p,null),ie(p,v),E&&E.m(p,null),S=!0},p(s,M){const A={};M&1&&(A.data=s[0]),M&16&&(A.yKey=s[4]),M&32&&(A.colors=s[5]),m.$set(A),s[7]?E?E.p(s,M):(E=nm(s),E.c(),E.m(p,null)):E&&(E.d(1),E=null),(!S||M&2)&&De(p,"height",s[1]*.28+"px")},i(s){S||(jt(m.$$.fragment,s),S=!0)},o(s){tr(m.$$.fragment,s),S=!1},d(s){s&&se(p),Si(m),E&&E.d()}}}function nm(c){let p,m;return{c(){p=Ie("div"),m=tt(c[7]),this.h()},l(v){p=ke(v,"DIV",{class:!0});var S=we(p);m=rt(S,c[7]),S.forEach(se),this.h()},h(){X(p,"class","label svelte-1tebgpk")},m(v,S){dt(v,p,S),ie(p,m)},p(v,S){S&128&&Pr(m,v[7])},d(v){v&&se(p)}}}function Lv(c){let p,m,v,S,E,s,M;m=new Xm({props:{data:c[0],yKey:c[3],colors:c[5]}});let A=c[4]&&im(c);return s=new Dv({props:{data:c[0],xKey:c[2],yKey:c[3],zKey:c[4],decimals:c[6],colors:c[5]}}),{c(){p=Ie("div"),xi(m.$$.fragment),v=ht(),A&&A.c(),S=ht(),E=Ie("div"),xi(s.$$.fragment),this.h()},l(V){p=ke(V,"DIV",{class:!0,style:!0});var N=we(p);bi(m.$$.fragment,N),N.forEach(se),v=pt(V),A&&A.l(V),S=pt(V),E=ke(V,"DIV",{class:!0});var W=we(E);bi(s.$$.fragment,W),W.forEach(se),this.h()},h(){X(p,"class","chart svelte-1tebgpk"),De(p,"padding-top","3px"),De(p,"height",(c[4]?c[1]*.72:c[1])+"px"),X(E,"class","legend svelte-1tebgpk")},m(V,N){dt(V,p,N),wi(m,p,null),dt(V,v,N),A&&A.m(V,N),dt(V,S,N),dt(V,E,N),wi(s,E,null),M=!0},p(V,[N]){const W={};N&1&&(W.data=V[0]),N&8&&(W.yKey=V[3]),N&32&&(W.colors=V[5]),m.$set(W),(!M||N&18)&&De(p,"height",(V[4]?V[1]*.72:V[1])+"px"),V[4]?A?(A.p(V,N),N&16&&jt(A,1)):(A=im(V),A.c(),jt(A,1),A.m(S.parentNode,S)):A&&(fu(),tr(A,1,1,()=>{A=null}),du());const K={};N&1&&(K.data=V[0]),N&4&&(K.xKey=V[2]),N&8&&(K.yKey=V[3]),N&16&&(K.zKey=V[4]),N&64&&(K.decimals=V[6]),N&32&&(K.colors=V[5]),s.$set(K)},i(V){M||(jt(m.$$.fragment,V),jt(A),jt(s.$$.fragment,V),M=!0)},o(V){tr(m.$$.fragment,V),tr(A),tr(s.$$.fragment,V),M=!1},d(V){V&&se(p),Si(m),V&&se(v),A&&A.d(V),V&&se(S),V&&se(E),Si(s)}}}function Rv(c,p,m){let{data:v}=p,{height:S=80}=p,{xKey:E="x"}=p,{yKey:s="y"}=p,{zKey:M="ew"}=p,{colors:A=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=p,{decimals:V=null}=p,{label:N=null}=p;return c.$$set=W=>{"data"in W&&m(0,v=W.data),"height"in W&&m(1,S=W.height),"xKey"in W&&m(2,E=W.xKey),"yKey"in W&&m(3,s=W.yKey),"zKey"in W&&m(4,M=W.zKey),"colors"in W&&m(5,A=W.colors),"decimals"in W&&m(6,V=W.decimals),"label"in W&&m(7,N=W.label)},[v,S,E,s,M,A,V,N]}class Mh extends rs{constructor(p){super(),is(this,p,Rv,Lv,ns,{data:0,height:1,xKey:2,yKey:3,zKey:4,colors:5,decimals:6,label:7})}}var Bv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ov={rgb2hsl:Oc,rgb2hsv:Kh,rgb2hwb:Fc,rgb2cmyk:Vc,rgb2keyword:Nc,rgb2xyz:Gp,rgb2lab:Kp,rgb2lch:Fv,hsl2rgb:Xh,hsl2hsv:Vv,hsl2hwb:Nv,hsl2cmyk:Uv,hsl2keyword:jv,hsv2rgb:Wh,hsv2hsl:qv,hsv2hwb:Zv,hsv2cmyk:Gv,hsv2keyword:Kv,hwb2rgb:Uc,hwb2hsl:Xv,hwb2hsv:Wv,hwb2cmyk:Hv,hwb2keyword:Jv,cmyk2rgb:jc,cmyk2hsl:Yv,cmyk2hsv:Qv,cmyk2hwb:$v,cmyk2keyword:e0,keyword2rgb:gu,keyword2hsl:n0,keyword2hsv:o0,keyword2hwb:a0,keyword2cmyk:s0,keyword2lab:l0,keyword2xyz:u0,xyz2rgb:Wm,xyz2lab:Hm,xyz2lch:t0,lab2xyz:Xp,lab2rgb:Jm,lab2lch:Wp,lch2lab:Hp,lch2xyz:r0,lch2rgb:i0};function Oc(c){var p=c[0]/255,m=c[1]/255,v=c[2]/255,S=Math.min(p,m,v),E=Math.max(p,m,v),s=E-S,M,A,V;return E==S?M=0:p==E?M=(m-v)/s:m==E?M=2+(v-p)/s:v==E&&(M=4+(p-m)/s),M=Math.min(M*60,360),M<0&&(M+=360),V=(S+E)/2,E==S?A=0:V<=.5?A=s/(E+S):A=s/(2-E-S),[M,A*100,V*100]}function Kh(c){var p=c[0],m=c[1],v=c[2],S=Math.min(p,m,v),E=Math.max(p,m,v),s=E-S,M,A,V;return E==0?A=0:A=s/E*1e3/10,E==S?M=0:p==E?M=(m-v)/s:m==E?M=2+(v-p)/s:v==E&&(M=4+(p-m)/s),M=Math.min(M*60,360),M<0&&(M+=360),V=E/255*1e3/10,[M,A,V]}function Fc(c){var p=c[0],m=c[1],E=c[2],v=Oc(c)[0],S=1/255*Math.min(p,Math.min(m,E)),E=1-1/255*Math.max(p,Math.max(m,E));return[v,S*100,E*100]}function Vc(c){var p=c[0]/255,m=c[1]/255,v=c[2]/255,S,E,s,M;return M=Math.min(1-p,1-m,1-v),S=(1-p-M)/(1-M)||0,E=(1-m-M)/(1-M)||0,s=(1-v-M)/(1-M)||0,[S*100,E*100,s*100,M*100]}function Nc(c){return Ym[JSON.stringify(c)]}function Gp(c){var p=c[0]/255,m=c[1]/255,v=c[2]/255;p=p>.04045?Math.pow((p+.055)/1.055,2.4):p/12.92,m=m>.04045?Math.pow((m+.055)/1.055,2.4):m/12.92,v=v>.04045?Math.pow((v+.055)/1.055,2.4):v/12.92;var S=p*.4124+m*.3576+v*.1805,E=p*.2126+m*.7152+v*.0722,s=p*.0193+m*.1192+v*.9505;return[S*100,E*100,s*100]}function Kp(c){var p=Gp(c),m=p[0],v=p[1],S=p[2],E,s,M;return m/=95.047,v/=100,S/=108.883,m=m>.008856?Math.pow(m,1/3):7.787*m+16/116,v=v>.008856?Math.pow(v,1/3):7.787*v+16/116,S=S>.008856?Math.pow(S,1/3):7.787*S+16/116,E=116*v-16,s=500*(m-v),M=200*(v-S),[E,s,M]}function Fv(c){return Wp(Kp(c))}function Xh(c){var p=c[0]/360,m=c[1]/100,v=c[2]/100,S,E,s,M,A;if(m==0)return A=v*255,[A,A,A];v<.5?E=v*(1+m):E=v+m-v*m,S=2*v-E,M=[0,0,0];for(var V=0;V<3;V++)s=p+1/3*-(V-1),s<0&&s++,s>1&&s--,6*s<1?A=S+(E-S)*6*s:2*s<1?A=E:3*s<2?A=S+(E-S)*(2/3-s)*6:A=S,M[V]=A*255;return M}function Vv(c){var p=c[0],m=c[1]/100,v=c[2]/100,S,E;return v===0?[0,0,0]:(v*=2,m*=v<=1?v:2-v,E=(v+m)/2,S=2*m/(v+m),[p,S*100,E*100])}function Nv(c){return Fc(Xh(c))}function Uv(c){return Vc(Xh(c))}function jv(c){return Nc(Xh(c))}function Wh(c){var p=c[0]/60,m=c[1]/100,A=c[2]/100,v=Math.floor(p)%6,S=p-Math.floor(p),E=255*A*(1-m),s=255*A*(1-m*S),M=255*A*(1-m*(1-S)),A=255*A;switch(v){case 0:return[A,M,E];case 1:return[s,A,E];case 2:return[E,A,M];case 3:return[E,s,A];case 4:return[M,E,A];case 5:return[A,E,s]}}function qv(c){var p=c[0],m=c[1]/100,v=c[2]/100,S,E;return E=(2-m)*v,S=m*v,S/=E<=1?E:2-E,S=S||0,E/=2,[p,S*100,E*100]}function Zv(c){return Fc(Wh(c))}function Gv(c){return Vc(Wh(c))}function Kv(c){return Nc(Wh(c))}function Uc(c){var p=c[0]/360,m=c[1]/100,v=c[2]/100,S=m+v,E,s,M,A;switch(S>1&&(m/=S,v/=S),E=Math.floor(6*p),s=1-v,M=6*p-E,(E&1)!=0&&(M=1-M),A=m+M*(s-m),E){default:case 6:case 0:r=s,g=A,b=m;break;case 1:r=A,g=s,b=m;break;case 2:r=m,g=s,b=A;break;case 3:r=m,g=A,b=s;break;case 4:r=A,g=m,b=s;break;case 5:r=s,g=m,b=A;break}return[r*255,g*255,b*255]}function Xv(c){return Oc(Uc(c))}function Wv(c){return Kh(Uc(c))}function Hv(c){return Vc(Uc(c))}function Jv(c){return Nc(Uc(c))}function jc(c){var p=c[0]/100,m=c[1]/100,v=c[2]/100,S=c[3]/100,E,s,M;return E=1-Math.min(1,p*(1-S)+S),s=1-Math.min(1,m*(1-S)+S),M=1-Math.min(1,v*(1-S)+S),[E*255,s*255,M*255]}function Yv(c){return Oc(jc(c))}function Qv(c){return Kh(jc(c))}function $v(c){return Fc(jc(c))}function e0(c){return Nc(jc(c))}function Wm(c){var p=c[0]/100,m=c[1]/100,v=c[2]/100,S,E,s;return S=p*3.2406+m*-1.5372+v*-.4986,E=p*-.9689+m*1.8758+v*.0415,s=p*.0557+m*-.204+v*1.057,S=S>.0031308?1.055*Math.pow(S,1/2.4)-.055:S=S*12.92,E=E>.0031308?1.055*Math.pow(E,1/2.4)-.055:E=E*12.92,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s=s*12.92,S=Math.min(Math.max(0,S),1),E=Math.min(Math.max(0,E),1),s=Math.min(Math.max(0,s),1),[S*255,E*255,s*255]}function Hm(c){var p=c[0],m=c[1],v=c[2],S,E,s;return p/=95.047,m/=100,v/=108.883,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,m=m>.008856?Math.pow(m,1/3):7.787*m+16/116,v=v>.008856?Math.pow(v,1/3):7.787*v+16/116,S=116*m-16,E=500*(p-m),s=200*(m-v),[S,E,s]}function t0(c){return Wp(Hm(c))}function Xp(c){var p=c[0],m=c[1],v=c[2],S,E,s,M;return p<=8?(E=p*100/903.3,M=7.787*(E/100)+16/116):(E=100*Math.pow((p+16)/116,3),M=Math.pow(E/100,1/3)),S=S/95.047<=.008856?S=95.047*(m/500+M-16/116)/7.787:95.047*Math.pow(m/500+M,3),s=s/108.883<=.008859?s=108.883*(M-v/200-16/116)/7.787:108.883*Math.pow(M-v/200,3),[S,E,s]}function Wp(c){var p=c[0],m=c[1],v=c[2],S,E,s;return S=Math.atan2(v,m),E=S*360/2/Math.PI,E<0&&(E+=360),s=Math.sqrt(m*m+v*v),[p,s,E]}function Jm(c){return Wm(Xp(c))}function Hp(c){var p=c[0],m=c[1],v=c[2],S,E,s;return s=v/360*2*Math.PI,S=m*Math.cos(s),E=m*Math.sin(s),[p,S,E]}function r0(c){return Xp(Hp(c))}function i0(c){return Jm(Hp(c))}function gu(c){return Fp[c]}function n0(c){return Oc(gu(c))}function o0(c){return Kh(gu(c))}function a0(c){return Fc(gu(c))}function s0(c){return Vc(gu(c))}function l0(c){return Kp(gu(c))}function u0(c){return Gp(gu(c))}var Fp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Ym={};for(var om in Fp)Ym[JSON.stringify(Fp[om])]=om;var Pp=Ov,Ku=function(){return new qc};for(var Tc in Pp){Ku[Tc+"Raw"]=function(c){return function(p){return typeof p=="number"&&(p=Array.prototype.slice.call(arguments)),Pp[c](p)}}(Tc);var am=/(\w+)2(\w+)/.exec(Tc),Cp=am[1],c0=am[2];Ku[Cp]=Ku[Cp]||{},Ku[Cp][c0]=Ku[Tc]=function(c){return function(p){typeof p=="number"&&(p=Array.prototype.slice.call(arguments));var m=Pp[c](p);if(typeof m=="string"||m===void 0)return m;for(var v=0;v<m.length;v++)m[v]=Math.round(m[v]);return m}}(Tc)}var qc=function(){this.convs={}};qc.prototype.routeSpace=function(c,p){var m=p[0];return m===void 0?this.getValues(c):(typeof m=="number"&&(m=Array.prototype.slice.call(p)),this.setValues(c,m))};qc.prototype.setValues=function(c,p){return this.space=c,this.convs={},this.convs[c]=p,this};qc.prototype.getValues=function(c){var p=this.convs[c];if(!p){var m=this.space,v=this.convs[m];p=Ku[m][c](v),this.convs[c]=p}return p};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(c){qc.prototype[c]=function(p){return this.routeSpace(c,arguments)}});function sm(c,p,m){const v=c.slice();return v[33]=p[m],v[36]=p,v[35]=m,v}function lm(c,p,m){const v=c.slice();return v[33]=p[m],v[34]=p,v[35]=m,v}function h0(c){let p,m,v=(c[0]?c[0]:"Select one")+"",S,E,s,M,A,V;return{c(){p=Ie("a"),m=Ie("span"),S=tt(v),E=ht(),s=Ie("span"),M=tt("\xA0"),this.h()},l(N){p=ke(N,"A",{id:!0,class:!0});var W=we(p);m=ke(W,"SPAN",{class:!0});var K=we(m);S=rt(K,v),K.forEach(se),E=pt(W),s=ke(W,"SPAN",{class:!0});var H=we(s);M=rt(H,"\xA0"),H.forEach(se),W.forEach(se),this.h()},h(){X(m,"class","svelte-3tt915"),X(s,"class","button svelte-3tt915"),ln(s,"search",c[3]),ln(s,"down",!c[3]),X(p,"id","toggle"),X(p,"class","svelte-3tt915")},m(N,W){dt(N,p,W),ie(p,m),ie(m,S),ie(p,E),ie(p,s),ie(s,M),A||(V=Rn(p,"click",c[12]),A=!0)},p(N,W){W[0]&1&&v!==(v=(N[0]?N[0]:"Select one")+"")&&Pr(S,v),W[0]&8&&ln(s,"search",N[3]),W[0]&8&&ln(s,"down",!N[3])},d(N){N&&se(p),A=!1,V()}}}function p0(c){let p,m,v=c[5][c[1]]+"",S,E,s,M,A,V,N,W=c[2]&&um(c);return{c(){p=Ie("a"),m=Ie("span"),S=tt(v),E=ht(),W&&W.c(),s=ht(),M=Ie("span"),A=tt("\xA0"),this.h()},l(K){p=ke(K,"A",{id:!0,class:!0});var H=we(p);m=ke(H,"SPAN",{class:!0});var fe=we(m);S=rt(fe,v),E=pt(fe),W&&W.l(fe),fe.forEach(se),s=pt(H),M=ke(H,"SPAN",{class:!0});var Oe=we(M);A=rt(Oe,"\xA0"),Oe.forEach(se),H.forEach(se),this.h()},h(){X(m,"class","selection svelte-3tt915"),X(M,"class","button close svelte-3tt915"),X(p,"id","toggle"),X(p,"class","selected svelte-3tt915")},m(K,H){dt(K,p,H),ie(p,m),ie(m,S),ie(m,E),W&&W.m(m,null),ie(p,s),ie(p,M),ie(M,A),V||(N=[Rn(M,"click",c[14]),Rn(p,"click",c[12])],V=!0)},p(K,H){H[0]&34&&v!==(v=K[5][K[1]]+"")&&Pr(S,v),K[2]?W?W.p(K,H):(W=um(K),W.c(),W.m(m,null)):W&&(W.d(1),W=null)},d(K){K&&se(p),W&&W.d(),V=!1,mu(N)}}}function um(c){let p,m=c[5][c[2]]+"",v;return{c(){p=Ie("small"),v=tt(m),this.h()},l(S){p=ke(S,"SMALL",{class:!0});var E=we(p);v=rt(E,m),E.forEach(se),this.h()},h(){X(p,"class","svelte-3tt915")},m(S,E){dt(S,p,E),ie(p,v)},p(S,E){E[0]&36&&m!==(m=S[5][S[2]]+"")&&Pr(v,m)},d(S){S&&se(p)}}}function cm(c){let p,m,v,S,E,s;function M(N,W){return N[4].length<3?y0:N[8][0]&&N[2]?m0:N[8][0]?d0:f0}let A=M(c),V=A(c);return{c(){p=Ie("div"),m=Ie("input"),v=ht(),S=Ie("ul"),V.c(),this.h()},l(N){p=ke(N,"DIV",{id:!0,style:!0,class:!0});var W=we(p);m=ke(W,"INPUT",{type:!0,placeholder:!0,autocomplete:!0,onfocus:!0,class:!0}),v=pt(W),S=ke(W,"UL",{class:!0});var K=we(S);V.l(K),K.forEach(se),W.forEach(se),this.h()},h(){X(m,"type","text"),X(m,"placeholder",""),X(m,"autocomplete","false"),m.autofocus="autofocus",X(m,"onfocus","this.select()"),X(m,"class","svelte-3tt915"),X(S,"class","svelte-3tt915"),X(p,"id","dropdown"),De(p,"top","0"),X(p,"class","svelte-3tt915")},m(N,W){dt(N,p,W),ie(p,m),yd(m,c[4]),c[24](m),ie(p,v),ie(p,S),V.m(S,null),c[31](p),m.focus(),E||(s=[Rn(m,"input",c[23]),Rn(m,"keyup",c[16])],E=!0)},p(N,W){W[0]&16&&m.value!==N[4]&&yd(m,N[4]),A===(A=M(N))&&V?V.p(N,W):(V.d(1),V=A(N),V&&(V.c(),V.m(S,null)))},d(N){N&&se(p),c[24](null),V.d(),c[31](null),E=!1,mu(s)}}}function f0(c){let p,m;return{c(){p=Ie("li"),m=tt("No results"),this.h()},l(v){p=ke(v,"LI",{class:!0});var S=we(p);m=rt(S,"No results"),S.forEach(se),this.h()},h(){X(p,"class","svelte-3tt915")},m(v,S){dt(v,p,S),ie(p,m)},p:xs,d(v){v&&se(p)}}}function d0(c){let p,m=c[8],v=[];for(let S=0;S<m.length;S+=1)v[S]=hm(sm(c,m,S));return{c(){for(let S=0;S<v.length;S+=1)v[S].c();p=un()},l(S){for(let E=0;E<v.length;E+=1)v[E].l(S);p=un()},m(S,E){for(let s=0;s<v.length;s+=1)v[s].m(S,E);dt(S,p,E)},p(S,E){if(E[0]&10626){m=S[8];let s;for(s=0;s<m.length;s+=1){const M=sm(S,m,s);v[s]?v[s].p(M,E):(v[s]=hm(M),v[s].c(),v[s].m(p.parentNode,p))}for(;s<v.length;s+=1)v[s].d(1);v.length=m.length}},d(S){Os(v,S),S&&se(p)}}}function m0(c){let p,m=c[8],v=[];for(let S=0;S<m.length;S+=1)v[S]=pm(lm(c,m,S));return{c(){for(let S=0;S<v.length;S+=1)v[S].c();p=un()},l(S){for(let E=0;E<v.length;E+=1)v[E].l(S);p=un()},m(S,E){for(let s=0;s<v.length;s+=1)v[s].m(S,E);dt(S,p,E)},p(S,E){if(E[0]&10630){m=S[8];let s;for(s=0;s<m.length;s+=1){const M=lm(S,m,s);v[s]?v[s].p(M,E):(v[s]=pm(M),v[s].c(),v[s].m(p.parentNode,p))}for(;s<v.length;s+=1)v[s].d(1);v.length=m.length}},d(S){Os(v,S),S&&se(p)}}}function y0(c){let p,m;return{c(){p=Ie("li"),m=tt("Type a name..."),this.h()},l(v){p=ke(v,"LI",{class:!0});var S=we(p);m=rt(S,"Type a name..."),S.forEach(se),this.h()},h(){X(p,"class","svelte-3tt915")},m(v,S){dt(v,p,S),ie(p,m)},p:xs,d(v){v&&se(p)}}}function hm(c){let p,m=c[33][c[1]]+"",v,S,E=c[35],s,M;function A(){return c[28](c[33])}function V(){return c[29](c[35])}const N=()=>c[30](p,E),W=()=>c[30](null,E);return{c(){p=Ie("li"),v=tt(m),S=ht(),this.h()},l(K){p=ke(K,"LI",{class:!0});var H=we(p);v=rt(H,m),S=pt(H),H.forEach(se),this.h()},h(){X(p,"class","svelte-3tt915"),ln(p,"highlight",c[7]==c[35])},m(K,H){dt(K,p,H),ie(p,v),ie(p,S),N(),s||(M=[Rn(p,"click",A),Rn(p,"mouseover",V)],s=!0)},p(K,H){c=K,H[0]&258&&m!==(m=c[33][c[1]]+"")&&Pr(v,m),E!==c[35]&&(W(),E=c[35],N()),H[0]&128&&ln(p,"highlight",c[7]==c[35])},d(K){K&&se(p),W(),s=!1,mu(M)}}}function pm(c){let p,m=c[33][c[1]]+"",v,S,E,s=c[33][c[2]]+"",M,A,V=c[35],N,W;function K(){return c[25](c[33])}function H(){return c[26](c[35])}const fe=()=>c[27](p,V),Oe=()=>c[27](null,V);return{c(){p=Ie("li"),v=tt(m),S=ht(),E=Ie("small"),M=tt(s),A=ht(),this.h()},l(ze){p=ke(ze,"LI",{class:!0});var Ke=we(p);v=rt(Ke,m),S=pt(Ke),E=ke(Ke,"SMALL",{class:!0});var Xe=we(E);M=rt(Xe,s),Xe.forEach(se),A=pt(Ke),Ke.forEach(se),this.h()},h(){X(E,"class","svelte-3tt915"),X(p,"class","svelte-3tt915"),ln(p,"highlight",c[7]==c[35])},m(ze,Ke){dt(ze,p,Ke),ie(p,v),ie(p,S),ie(p,E),ie(E,M),ie(p,A),fe(),N||(W=[Rn(p,"click",K),Rn(p,"mouseover",H)],N=!0)},p(ze,Ke){c=ze,Ke[0]&258&&m!==(m=c[33][c[1]]+"")&&Pr(v,m),Ke[0]&260&&s!==(s=c[33][c[2]]+"")&&Pr(M,s),V!==c[35]&&(Oe(),V=c[35],fe()),Ke[0]&128&&ln(p,"highlight",c[7]==c[35])},d(ze){ze&&se(p),Oe(),N=!1,mu(W)}}}function g0(c){let p,m,v,S;function E(V,N){return V[5]&&!V[3]?p0:h0}let s=E(c),M=s(c),A=c[6]&&cm(c);return{c(){p=Ie("div"),M.c(),m=ht(),A&&A.c(),this.h()},l(V){p=ke(V,"DIV",{id:!0,class:!0});var N=we(p);M.l(N),m=pt(N),A&&A.l(N),N.forEach(se),this.h()},h(){X(p,"id","select"),X(p,"class","svelte-3tt915"),ln(p,"active",c[6])},m(V,N){dt(V,p,N),M.m(p,null),ie(p,m),A&&A.m(p,null),v||(S=[Rn(window,"click",c[17]),Rn(p,"keydown",c[15])],v=!0)},p(V,N){s===(s=E(V))&&M?M.p(V,N):(M.d(1),M=s(V),M&&(M.c(),M.m(p,m))),V[6]?A?A.p(V,N):(A=cm(V),A.c(),A.m(p,null)):A&&(A.d(1),A=null),N[0]&64&&ln(p,"active",V[6])},i:xs,o:xs,d(V){V&&se(p),M.d(),A&&A.d(),v=!1,mu(S)}}}function _0(c){return new Promise(p=>setTimeout(p,c))}function v0(c,p,m){let v;const S=Pm();let{options:E}=p,{selected:s=null}=p,{placeholder:M="Enter a town or area name"}=p,{value:A="code"}=p,{label:V="name"}=p,{group:N=null}=p,{search:W=!1}=p,K=s,H=s?E.find(nt=>{nt[A]==s[A]}):null,fe=!1,Oe="",ze=null,Ke,Xe,Ft,Lt=[];function ft(nt){nt.stopPropagation(),m(4,Oe=""),m(6,fe=!fe),_0(10).then(()=>{Ft&&fe&&Ft.focus()})}function He(nt){m(18,s=nt),m(6,fe=!1),S("select",{selected:nt,value:nt[A]})}function xr(nt){nt.stopPropagation(),m(18,s=null),m(21,K=null),m(5,H=null),S("select",{selected:null,value:null})}function cr(nt){fe&&Ke[0]&&Number.isInteger(ze)&&(nt.keyCode===38?(m(7,ze-=ze>0?1:0),Lt[ze].scrollIntoView({block:"nearest",inline:"start"})):nt.keyCode===40&&(m(7,ze+=ze<Ke.length-1?1:0),Lt[ze].scrollIntoView({block:"nearest",inline:"end"})))}function Wt(nt){Ke[0]&&Number.isInteger(ze)&&nt.keyCode===13&&He(Ke[ze])}function Ht(nt){nt.target!==Xe&&(m(6,fe=!1),m(7,ze=0))}function qe(){Oe=this.value,m(4,Oe)}function mr(nt){Tl[nt?"unshift":"push"](()=>{Ft=nt,m(10,Ft)})}const It=nt=>He(nt),rr=nt=>m(7,ze=nt);function it(nt,Ze){Tl[nt?"unshift":"push"](()=>{Lt[Ze]=nt,m(11,Lt)})}const hr=nt=>He(nt),Or=nt=>m(7,ze=nt);function kt(nt,Ze){Tl[nt?"unshift":"push"](()=>{Lt[Ze]=nt,m(11,Lt)})}function er(nt){Tl[nt?"unshift":"push"](()=>{Xe=nt,m(9,Xe)})}return c.$$set=nt=>{"options"in nt&&m(19,E=nt.options),"selected"in nt&&m(18,s=nt.selected),"placeholder"in nt&&m(0,M=nt.placeholder),"value"in nt&&m(20,A=nt.value),"label"in nt&&m(1,V=nt.label),"group"in nt&&m(2,N=nt.group),"search"in nt&&m(3,W=nt.search)},c.$$.update=()=>{c.$$.dirty[0]&16&&m(22,v=Oe?new RegExp(Oe,"i"):null),c.$$.dirty[0]&4718594&&(m(8,Ke=v?E.filter(nt=>v.test(nt[V])):E),m(7,ze=0)),c.$$.dirty[0]&3932160&&K!=s&&(m(5,H=E.find(nt=>nt[A]==s[A])),m(21,K=s))},[M,V,N,W,Oe,H,fe,ze,Ke,Xe,Ft,Lt,ft,He,xr,cr,Wt,Ht,s,E,A,K,v,qe,mr,It,rr,it,hr,Or,kt,er]}class x0 extends rs{constructor(p){super(),is(this,p,v0,g0,ns,{options:19,selected:18,placeholder:0,value:20,label:1,group:2,search:3},null,[-1,-1])}}var kc={exports:{}};(function(c,p){(function(m,v){c.exports=v()})(Bv,function(){var m,v,S;function E(s,M){if(!m)m=M;else if(!v)v=M;else{var A="var sharedChunk = {}; ("+m+")(sharedChunk); ("+v+")(sharedChunk);",V={};m(V),S=M(V),typeof window<"u"&&(S.workerUrl=window.URL.createObjectURL(new Blob([A],{type:"text/javascript"})))}}return E(["exports"],function(s){function M(e,t){return e(t={exports:{}},t.exports),t.exports}var A=V;function V(e,t,i,l){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=l,this.p2x=i,this.p2y=l}V.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},V.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},V.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},V.prototype.solveCurveX=function(e,t){var i,l,h,f,y;for(t===void 0&&(t=1e-6),h=e,y=0;y<8;y++){if(f=this.sampleCurveX(h)-e,Math.abs(f)<t)return h;var w=this.sampleCurveDerivativeX(h);if(Math.abs(w)<1e-6)break;h-=f/w}if((h=e)<(i=0))return i;if(h>(l=1))return l;for(;i<l;){if(f=this.sampleCurveX(h),Math.abs(f-e)<t)return h;e>f?i=h:l=h,h=.5*(l-i)+i}return h},V.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var N=W;function W(e,t){this.x=e,this.y=t}W.prototype={clone:function(){return new W(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(e,t){var i=Math.cos(e),l=Math.sin(e),h=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},W.convert=function(e){return e instanceof W?e:Array.isArray(e)?new W(e[0],e[1]):e};var K=typeof self<"u"?self:{},H=Math.pow(2,53)-1;function fe(e,t,i,l){var h=new A(e,t,i,l);return function(f){return h.solve(f)}}var Oe=fe(.25,.1,.25,1);function ze(e,t,i){return Math.min(i,Math.max(t,e))}function Ke(e,t,i){var l=i-t,h=((e-t)%l+l)%l+t;return h===t?i:h}function Xe(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,h=t;l<h.length;l+=1){var f=h[l];for(var y in f)e[y]=f[y]}return e}var Ft=1;function Lt(){return Ft++}function ft(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function He(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function xr(e,t){e.forEach(function(i){t[i]&&(t[i]=t[i].bind(t))})}function cr(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Wt(e,t,i){var l={};for(var h in e)l[h]=t.call(i||this,e[h],h,e);return l}function Ht(e,t,i){var l={};for(var h in e)t.call(i||this,e[h],h,e)&&(l[h]=e[h]);return l}function qe(e){return Array.isArray(e)?e.map(qe):typeof e=="object"&&e?Wt(e,qe):e}var mr={};function It(e){mr[e]||(typeof console<"u"&&console.warn(e),mr[e]=!0)}function rr(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function it(e){for(var t=0,i=0,l=e.length,h=l-1,f=void 0,y=void 0;i<l;h=i++)t+=((y=e[h]).x-(f=e[i]).x)*(f.y+y.y);return t}function hr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Or(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(l,h,f,y){var w=f||y;return t[h]=!w||w.toLowerCase(),""}),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var kt=null;function er(e){if(kt==null){var t=e.navigator?e.navigator.userAgent:null;kt=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return kt}function nt(e){try{var t=K[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var Ze,lr,br,Yi,Qi=K.performance&&K.performance.now?K.performance.now.bind(K.performance):Date.now.bind(Date),Ni=K.requestAnimationFrame||K.mozRequestAnimationFrame||K.webkitRequestAnimationFrame||K.msRequestAnimationFrame,Gt=K.cancelAnimationFrame||K.mozCancelAnimationFrame||K.webkitCancelAnimationFrame||K.msCancelAnimationFrame,_r={now:Qi,frame:function(e){var t=Ni(e);return{cancel:function(){return Gt(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var i=K.document.createElement("canvas"),l=i.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return i.width=e.width,i.height=e.height,l.drawImage(e,0,0,e.width,e.height),l.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return Ze||(Ze=K.document.createElement("a")),Ze.href=e,Ze.href},hardwareConcurrency:K.navigator&&K.navigator.hardwareConcurrency||4,get devicePixelRatio(){return K.devicePixelRatio},get prefersReducedMotion(){return!!K.matchMedia&&(lr==null&&(lr=K.matchMedia("(prefers-reduced-motion: reduce)")),lr.matches)}},Rt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},kr={supported:!1,testSupport:function(e){!xn&&Yi&&(bn?qt(e):br=e)}},xn=!1,bn=!1;function qt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Yi),e.isContextLost())return;kr.supported=!0}catch{}e.deleteTexture(t),xn=!0}K.document&&((Yi=K.document.createElement("img")).onload=function(){br&&qt(br),br=null,bn=!0},Yi.onerror=function(){xn=!0,br=null},Yi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var wn="01",Ei=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function Ci(e){return e.indexOf("mapbox:")===0}Ei.prototype._createSkuToken=function(){var e=function(){for(var t="",i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",wn,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Ei.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Ei.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Ei.prototype.normalizeStyleURL=function(e,t){if(!Ci(e))return e;var i=hi(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Ei.prototype.normalizeGlyphsURL=function(e,t){if(!Ci(e))return e;var i=hi(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Ei.prototype.normalizeSourceURL=function(e,t){if(!Ci(e))return e;var i=hi(e);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||t)},Ei.prototype.normalizeSpriteURL=function(e,t,i,l){var h=hi(e);return Ci(e)?(h.path="/styles/v1"+h.path+"/sprite"+t+i,this._makeAPIURL(h,this._customAccessToken||l)):(h.path+=""+t+i,cn(h))},Ei.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!Ci(e))return e;var i=hi(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(_r.devicePixelRatio>=2||t===512?"@2x":"")+(kr.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var l=this._customAccessToken||function(h){for(var f=0,y=h;f<y.length;f+=1){var w=y[f].match(/^access_token=(.*)$/);if(w)return w[1]}return null}(i.params)||Rt.ACCESS_TOKEN;return Rt.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,l)},Ei.prototype.canonicalizeTileURL=function(e,t){var i=hi(e);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return e;var l="mapbox://tiles/";l+=i.path.replace("/v4/","");var h=i.params;return t&&(h=h.filter(function(f){return!f.match(/^access_token=/)})),h.length&&(l+="?"+h.join("&")),l},Ei.prototype.canonicalizeTileset=function(e,t){for(var i=!!t&&Ci(t),l=[],h=0,f=e.tiles||[];h<f.length;h+=1){var y=f[h];Zi(y)?l.push(this.canonicalizeTileURL(y,i)):l.push(y)}return l},Ei.prototype._makeAPIURL=function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=hi(Rt.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){var h=e.params.indexOf("secure");h>=0&&e.params.splice(h,1)}if(l.path!=="/"&&(e.path=""+l.path+e.path),!Rt.REQUIRE_ACCESS_TOKEN)return cn(e);if(!(t=t||Rt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return e.params=e.params.filter(function(f){return f.indexOf("access_token")===-1}),e.params.push("access_token="+t),cn(e)};var Yn=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Zi(e){return Yn.test(e)}var Qn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function hi(e){var t=e.match(Qn);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function cn(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Bn(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(K.atob(t[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Mi=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Mi.prototype.getStorageKey=function(e){var t,i=Bn(Rt.ACCESS_TOKEN);return t=i&&i.u?K.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(l,h){return String.fromCharCode(Number("0x"+h))})):Rt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},Mi.prototype.fetchEventData=function(){var e=nt("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{var l=K.localStorage.getItem(t);l&&(this.eventData=JSON.parse(l));var h=K.localStorage.getItem(i);h&&(this.anonId=h)}catch{It("Unable to read from LocalStorage")}},Mi.prototype.saveEventData=function(){var e=nt("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{K.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&K.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{It("Unable to write to LocalStorage")}},Mi.prototype.processRequests=function(e){},Mi.prototype.postEvent=function(e,t,i,l){var h=this;if(Rt.EVENTS_URL){var f=hi(Rt.EVENTS_URL);f.params.push("access_token="+(l||Rt.ACCESS_TOKEN||""));var y={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:wn,userId:this.anonId},w=t?Xe(y,t):y,I={url:cn(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([w])};this.pendingRequest=Dr(I,function(k){h.pendingRequest=null,i(k),h.saveEventData(),h.processRequests(l)})}},Mi.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Fr,Yr,Xr=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(i,l,h,f){this.skuToken=h,(Rt.EVENTS_URL&&f||Rt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(y){return Ci(y)||Zi(y)}))&&this.queueRequest({id:l,timestamp:Date.now()},f)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){var h=this.queue.shift(),f=h.id,y=h.timestamp;f&&this.success[f]||(this.anonId||this.fetchEventData(),He(this.anonId)||(this.anonId=ft()),this.postEvent(y,{skuToken:this.skuToken},function(w){w||f&&(l.success[f]=!0)},i))}},t}(Mi),go=new(function(e){function t(i){e.call(this,"appUserTurnstile"),this._customAccessToken=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(i,l){Rt.EVENTS_URL&&Rt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(h){return Ci(h)||Zi(h)})&&this.queueRequest(Date.now(),l)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var h=Bn(Rt.ACCESS_TOKEN),f=h?h.u:Rt.ACCESS_TOKEN,y=f!==this.eventData.tokenU;He(this.anonId)||(this.anonId=ft(),y=!0);var w=this.queue.shift();if(this.eventData.lastSuccess){var I=new Date(this.eventData.lastSuccess),k=new Date(w),P=(w-this.eventData.lastSuccess)/864e5;y=y||P>=1||P<-1||I.getDate()!==k.getDate()}else y=!0;if(!y)return this.processRequests();this.postEvent(w,{"enabled.telemetry":!1},function(D){D||(l.eventData.lastSuccess=w,l.eventData.tokenU=f)},i)}},t}(Mi)),On=go.postTurnstileEvent.bind(go),ya=new Xr,Co=ya.postMapLoadEvent.bind(ya),hn=500,$n=50;function _o(){K.caches&&!Fr&&(Fr=K.caches.open("mapbox-tiles"))}function Mo(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var $i,eo=1/0;function vo(){return $i==null&&($i=K.OffscreenCanvas&&new K.OffscreenCanvas(1,1).getContext("2d")&&typeof K.createImageBitmap=="function"),$i}var Ho={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ho);var Jo=function(e){function t(i,l,h){l===401&&Zi(h)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,i),this.status=l,this.url=h,this.name=this.constructor.name,this.message=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),Ti=hr()?function(){return self.worker&&self.worker.referrer}:function(){return(K.location.protocol==="blob:"?K.parent:K).location.href},Qr,Ii,xo=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(Ti())&&!/^\w+:/.test(i))){if(K.fetch&&K.Request&&K.AbortController&&K.Request.prototype.hasOwnProperty("signal"))return function(l,h){var f,y=new K.AbortController,w=new K.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:Ti(),signal:y.signal}),I=!1,k=!1,P=(f=w.url).indexOf("sku=")>0&&Zi(f);l.type==="json"&&w.headers.set("Accept","application/json");var D=function(U,$,te){if(!k){if(U&&U.message!=="SecurityError"&&It(U),$&&te)return B($);var ue=Date.now();K.fetch(w).then(function(ne){if(ne.ok){var de=P?ne.clone():null;return B(ne,de,ue)}return h(new Jo(ne.statusText,ne.status,l.url))}).catch(function(ne){ne.code!==20&&h(new Error(ne.message))})}},B=function(U,$,te){(l.type==="arrayBuffer"?U.arrayBuffer():l.type==="json"?U.json():U.text()).then(function(ue){k||($&&te&&function(ne,de,ge){if(_o(),Fr){var xe={status:de.status,statusText:de.statusText,headers:new K.Headers};de.headers.forEach(function(Me,Fe){return xe.headers.set(Fe,Me)});var Ee=Or(de.headers.get("Cache-Control")||"");Ee["no-store"]||(Ee["max-age"]&&xe.headers.set("Expires",new Date(ge+1e3*Ee["max-age"]).toUTCString()),new Date(xe.headers.get("Expires")).getTime()-ge<42e4||function(Me,Fe){if(Yr===void 0)try{new Response(new ReadableStream),Yr=!0}catch{Yr=!1}Yr?Fe(Me.body):Me.blob().then(Fe)}(de,function(Me){var Fe=new K.Response(Me,xe);_o(),Fr&&Fr.then(function(We){return We.put(Mo(ne.url),Fe)}).catch(function(We){return It(We.message)})}))}}(w,$,te),I=!0,h(null,ue,U.headers.get("Cache-Control"),U.headers.get("Expires")))}).catch(function(ue){k||h(new Error(ue.message))})};return P?function(U,$){if(_o(),!Fr)return $(null);var te=Mo(U.url);Fr.then(function(ue){ue.match(te).then(function(ne){var de=function(ge){if(!ge)return!1;var xe=new Date(ge.headers.get("Expires")||0),Ee=Or(ge.headers.get("Cache-Control")||"");return xe>Date.now()&&!Ee["no-cache"]}(ne);ue.delete(te),de&&ue.put(te,ne.clone()),$(null,ne,de)}).catch($)}).catch($)}(w,D):D(null,null),{cancel:function(){k=!0,I||y.abort()}}}(e,t);if(hr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(l,h){var f=new K.XMLHttpRequest;for(var y in f.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(f.responseType="arraybuffer"),l.headers)f.setRequestHeader(y,l.headers[y]);return l.type==="json"&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials=l.credentials==="include",f.onerror=function(){h(new Error(f.statusText))},f.onload=function(){if((f.status>=200&&f.status<300||f.status===0)&&f.response!==null){var w=f.response;if(l.type==="json")try{w=JSON.parse(f.response)}catch(I){return h(I)}h(null,w,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else h(new Jo(f.statusText,f.status,l.url))},f.send(l.body),{cancel:function(){return f.abort()}}}(e,t)},en=function(e,t){return xo(Xe(e,{type:"arrayBuffer"}),t)},Dr=function(e,t){return xo(Xe(e,{method:"POST"}),t)},C="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Qr=[],Ii=0;var R=function(e,t){if(kr.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),Ii>=Rt.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return Qr.push(i),i}Ii++;var l=!1,h=function(){if(!l)for(l=!0,Ii--;Qr.length&&Ii<Rt.MAX_PARALLEL_IMAGE_REQUESTS;){var y=Qr.shift();y.cancelled||(y.cancel=R(y.requestParameters,y.callback).cancel)}},f=en(e,function(y,w,I,k){h(),y?t(y):w&&(vo()?function(P,D){var B=new K.Blob([new Uint8Array(P)],{type:"image/png"});K.createImageBitmap(B).then(function(U){D(null,U)}).catch(function(U){D(new Error("Could not load image because of "+U.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(w,t):function(P,D,B,U){var $=new K.Image,te=K.URL;$.onload=function(){D(null,$),te.revokeObjectURL($.src),$.onload=null,K.requestAnimationFrame(function(){$.src=C})},$.onerror=function(){return D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var ue=new K.Blob([new Uint8Array(P)],{type:"image/png"});$.cacheControl=B,$.expires=U,$.src=P.byteLength?te.createObjectURL(ue):C}(w,t,I,k))});return{cancel:function(){f.cancel(),h()}}};function O(e,t,i){i[e]&&i[e].indexOf(t)!==-1||(i[e]=i[e]||[],i[e].push(t))}function G(e,t,i){if(i&&i[e]){var l=i[e].indexOf(t);l!==-1&&i[e].splice(l,1)}}var ee=function(e,t){t===void 0&&(t={}),Xe(this,t),this.type=e},le=function(e){function t(i,l){l===void 0&&(l={}),e.call(this,"error",Xe({error:i},l))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ee),ce=function(){};ce.prototype.on=function(e,t){return this._listeners=this._listeners||{},O(e,t,this._listeners),this},ce.prototype.off=function(e,t){return G(e,t,this._listeners),G(e,t,this._oneTimeListeners),this},ce.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},O(e,t,this._oneTimeListeners),this},ce.prototype.fire=function(e,t){typeof e=="string"&&(e=new ee(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;for(var l=0,h=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];l<h.length;l+=1)h[l].call(this,e);for(var f=0,y=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];f<y.length;f+=1){var w=y[f];G(i,w,this._oneTimeListeners),w.call(this,e)}var I=this._eventedParent;I&&(Xe(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),I.fire(e))}else e instanceof le&&console.error(e.error);return this},ce.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},ce.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var F={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},re=function(e,t,i,l){this.message=(e?e+": ":"")+i,l&&(this.identifier=l),t!=null&&t.__line__&&(this.line=t.__line__)};function me(e){var t=e.value;return t?[new re(e.key,t,"constants have been deprecated as of v8")]:[]}function Ce(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,h=t;l<h.length;l+=1){var f=h[l];for(var y in f)e[y]=f[y]}return e}function Le(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function be(e){if(Array.isArray(e))return e.map(be);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=be(e[i]);return t}return Le(e)}var Be=function(e){function t(i,l){e.call(this,l),this.message=l,this.key=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),et=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,l=t;i<l.length;i+=1){var h=l[i];this.bindings[h[0]]=h[1]}};et.prototype.concat=function(e){return new et(this,e)},et.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},et.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var Qe={kind:"null"},Se={kind:"number"},Je={kind:"string"},Ne={kind:"boolean"},Ge={kind:"color"},At={kind:"object"},je={kind:"value"},Pt={kind:"collator"},ar={kind:"formatted"},Ct={kind:"resolvedImage"};function Vt(e,t){return{kind:"array",itemType:e,N:t}}function Mt(e){if(e.kind==="array"){var t=Mt(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var oi=[Qe,Se,Je,Ne,Ge,ar,At,Vt(je),Ct];function Jt(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Jt(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var i=0,l=oi;i<l.length;i+=1)if(!Jt(l[i],t))return null}}return"Expected "+Mt(e)+" but found "+Mt(t)+" instead."}function zr(e,t){return t.some(function(i){return i.kind===e.kind})}function or(e,t){return t.some(function(i){return i==="null"?e===null:i==="array"?Array.isArray(e):i==="object"?e&&!Array.isArray(e)&&typeof e=="object":i===typeof e})}var Bt=M(function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(w){return(w=Math.round(w))<0?0:w>255?255:w}function h(w){return l(w[w.length-1]==="%"?parseFloat(w)/100*255:parseInt(w))}function f(w){return(I=w[w.length-1]==="%"?parseFloat(w)/100:parseFloat(w))<0?0:I>1?1:I;var I}function y(w,I,k){return k<0?k+=1:k>1&&(k-=1),6*k<1?w+(I-w)*k*6:2*k<1?I:3*k<2?w+(I-w)*(2/3-k)*6:w}try{t.parseCSSColor=function(w){var I,k=w.replace(/ /g,"").toLowerCase();if(k in i)return i[k].slice();if(k[0]==="#")return k.length===4?(I=parseInt(k.substr(1),16))>=0&&I<=4095?[(3840&I)>>4|(3840&I)>>8,240&I|(240&I)>>4,15&I|(15&I)<<4,1]:null:k.length===7&&(I=parseInt(k.substr(1),16))>=0&&I<=16777215?[(16711680&I)>>16,(65280&I)>>8,255&I,1]:null;var P=k.indexOf("("),D=k.indexOf(")");if(P!==-1&&D+1===k.length){var B=k.substr(0,P),U=k.substr(P+1,D-(P+1)).split(","),$=1;switch(B){case"rgba":if(U.length!==4)return null;$=f(U.pop());case"rgb":return U.length!==3?null:[h(U[0]),h(U[1]),h(U[2]),$];case"hsla":if(U.length!==4)return null;$=f(U.pop());case"hsl":if(U.length!==3)return null;var te=(parseFloat(U[0])%360+360)%360/360,ue=f(U[1]),ne=f(U[2]),de=ne<=.5?ne*(ue+1):ne+ue-ne*ue,ge=2*ne-de;return[l(255*y(ge,de,te+1/3)),l(255*y(ge,de,te)),l(255*y(ge,de,te-1/3)),$];default:return null}}return null}}catch{}}).parseCSSColor,Zt=function(e,t,i,l){l===void 0&&(l=1),this.r=e,this.g=t,this.b=i,this.a=l};Zt.parse=function(e){if(e){if(e instanceof Zt)return e;if(typeof e=="string"){var t=Bt(e);if(t)return new Zt(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},Zt.prototype.toString=function(){var e=this.toArray(),t=e[1],i=e[2],l=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(i)+","+l+")"},Zt.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Zt.black=new Zt(0,0,0,1),Zt.white=new Zt(1,1,1,1),Zt.transparent=new Zt(0,0,0,0),Zt.red=new Zt(1,0,0,1);var pi=function(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};pi.prototype.compare=function(e,t){return this.collator.compare(e,t)},pi.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var tn=function(e,t,i,l,h){this.text=e,this.image=t,this.scale=i,this.fontStack=l,this.textColor=h},Cr=function(e){this.sections=e};Cr.fromString=function(e){return new Cr([new tn(e,null,null,null,null)])},Cr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Cr.factory=function(e){return e instanceof Cr?e:Cr.fromString(e)},Cr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Cr.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];if(l.image)e.push(["image",l.image.name]);else{e.push(l.text);var h={};l.fontStack&&(h["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(h["font-scale"]=l.scale),l.textColor&&(h["text-color"]=["rgba"].concat(l.textColor.toArray())),e.push(h)}}return e};var ai=function(e){this.name=e.name,this.available=e.available};function Yo(e,t,i,l){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:"Invalid rgba value ["+[e,t,i,l].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof l=="number"?[e,t,i,l]:[e,t,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Do(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof Zt||e instanceof pi||e instanceof Cr||e instanceof ai)return!0;if(Array.isArray(e)){for(var t=0,i=e;t<i.length;t+=1)if(!Do(i[t]))return!1;return!0}if(typeof e=="object"){for(var l in e)if(!Do(e[l]))return!1;return!0}return!1}function Ar(e){if(e===null)return Qe;if(typeof e=="string")return Je;if(typeof e=="boolean")return Ne;if(typeof e=="number")return Se;if(e instanceof Zt)return Ge;if(e instanceof pi)return Pt;if(e instanceof Cr)return ar;if(e instanceof ai)return Ct;if(Array.isArray(e)){for(var t,i=e.length,l=0,h=e;l<h.length;l+=1){var f=Ar(h[l]);if(t){if(t===f)continue;t=je;break}t=f}return Vt(t||je,i)}return At}function bo(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof Zt||e instanceof Cr||e instanceof ai?e.toString():JSON.stringify(e)}ai.prototype.toString=function(){return this.name},ai.fromString=function(e){return e?new ai({name:e,available:!1}):null},ai.prototype.serialize=function(){return["image",this.name]};var fi=function(e,t){this.type=e,this.value=t};fi.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Do(e[1]))return t.error("invalid value");var i=e[1],l=Ar(i),h=t.expectedType;return l.kind!=="array"||l.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(l=h),new fi(l,i)},fi.prototype.evaluate=function(){return this.value},fi.prototype.eachChild=function(){},fi.prototype.outputDefined=function(){return!0},fi.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Zt?["rgba"].concat(this.value.toArray()):this.value instanceof Cr?this.value.serialize():this.value};var Wr=function(e){this.name="ExpressionEvaluationError",this.message=e};Wr.prototype.toJSON=function(){return this.message};var di={string:Je,number:Se,boolean:Ne,object:At},wr=function(e,t){this.type=e,this.args=t};wr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i,l=1,h=e[0];if(h==="array"){var f,y;if(e.length>2){var w=e[1];if(typeof w!="string"||!(w in di)||w==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);f=di[w],l++}else f=je;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);y=e[2],l++}i=Vt(f,y)}else i=di[h];for(var I=[];l<e.length;l++){var k=t.parse(e[l],l,je);if(!k)return null;I.push(k)}return new wr(i,I)},wr.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!Jt(this.type,Ar(i)))return i;if(t===this.args.length-1)throw new Wr("Expected value to be of type "+Mt(this.type)+", but found "+Mt(Ar(i))+" instead.")}return null},wr.prototype.eachChild=function(e){this.args.forEach(e)},wr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},wr.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var l=e.N;(typeof l=="number"||this.args.length>1)&&t.push(l)}}return t.concat(this.args.map(function(h){return h.serialize()}))};var pn=function(e){this.type=ar,this.sections=e};pn.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var l=[],h=!1,f=1;f<=e.length-1;++f){var y=e[f];if(h&&typeof y=="object"&&!Array.isArray(y)){h=!1;var w=null;if(y["font-scale"]&&!(w=t.parse(y["font-scale"],1,Se)))return null;var I=null;if(y["text-font"]&&!(I=t.parse(y["text-font"],1,Vt(Je))))return null;var k=null;if(y["text-color"]&&!(k=t.parse(y["text-color"],1,Ge)))return null;var P=l[l.length-1];P.scale=w,P.font=I,P.textColor=k}else{var D=t.parse(e[f],1,je);if(!D)return null;var B=D.type.kind;if(B!=="string"&&B!=="value"&&B!=="null"&&B!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,l.push({content:D,scale:null,font:null,textColor:null})}}return new pn(l)},pn.prototype.evaluate=function(e){return new Cr(this.sections.map(function(t){var i=t.content.evaluate(e);return Ar(i)===Ct?new tn("",i,null,null,null):new tn(bo(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},pn.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}},pn.prototype.outputDefined=function(){return!1},pn.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e.push(l.content.serialize());var h={};l.scale&&(h["font-scale"]=l.scale.serialize()),l.font&&(h["text-font"]=l.font.serialize()),l.textColor&&(h["text-color"]=l.textColor.serialize()),e.push(h)}return e};var mi=function(e){this.type=Ct,this.input=e};mi.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,Je);return i?new mi(i):t.error("No image name provided.")},mi.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=ai.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i},mi.prototype.eachChild=function(e){e(this.input)},mi.prototype.outputDefined=function(){return!1},mi.prototype.serialize=function(){return["image",this.input.serialize()]};var Qo={"to-boolean":Ne,"to-color":Ge,"to-number":Se,"to-string":Je},yi=function(e,t){this.type=e,this.args=t};yi.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var l=Qo[i],h=[],f=1;f<e.length;f++){var y=t.parse(e[f],f,je);if(!y)return null;h.push(y)}return new yi(l,h)},yi.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,i,l=0,h=this.args;l<h.length;l+=1){if(i=null,(t=h[l].evaluate(e))instanceof Zt)return t;if(typeof t=="string"){var f=e.parseColor(t);if(f)return f}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Yo(t[0],t[1],t[2],t[3])))return new Zt(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Wr(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var y=null,w=0,I=this.args;w<I.length;w+=1){if((y=I[w].evaluate(e))===null)return 0;var k=Number(y);if(!isNaN(k))return k}throw new Wr("Could not convert "+JSON.stringify(y)+" to number.")}return this.type.kind==="formatted"?Cr.fromString(bo(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?ai.fromString(bo(this.args[0].evaluate(e))):bo(this.args[0].evaluate(e))},yi.prototype.eachChild=function(e){this.args.forEach(e)},yi.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},yi.prototype.serialize=function(){if(this.type.kind==="formatted")return new pn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new mi(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Sn=["Unknown","Point","LineString","Polygon"],gi=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};gi.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},gi.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Sn[this.feature.type]:this.feature.type:null},gi.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},gi.prototype.canonicalID=function(){return this.canonical},gi.prototype.properties=function(){return this.feature&&this.feature.properties||{}},gi.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Zt.parse(e)),t};var si=function(e,t,i,l){this.name=e,this.type=t,this._evaluate=i,this.args=l};si.prototype.evaluate=function(e){return this._evaluate(e,this.args)},si.prototype.eachChild=function(e){this.args.forEach(e)},si.prototype.outputDefined=function(){return!1},si.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},si.parse=function(e,t){var i,l=e[0],h=si.definitions[l];if(!h)return t.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0);for(var f=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,w=y.filter(function(vt){var lt=vt[0];return!Array.isArray(lt)||lt.length===e.length-1}),I=null,k=0,P=w;k<P.length;k+=1){var D=P[k],B=D[0],U=D[1];I=new vr(t.registry,t.path,null,t.scope);for(var $=[],te=!1,ue=1;ue<e.length;ue++){var ne=e[ue],de=Array.isArray(B)?B[ue-1]:B.type,ge=I.parse(ne,1+$.length,de);if(!ge){te=!0;break}$.push(ge)}if(!te)if(Array.isArray(B)&&B.length!==$.length)I.error("Expected "+B.length+" arguments, but found "+$.length+" instead.");else{for(var xe=0;xe<$.length;xe++){var Ee=Array.isArray(B)?B[xe]:B.type,Me=$[xe];I.concat(xe+1).checkSubtype(Ee,Me.type)}if(I.errors.length===0)return new si(l,f,U,$)}}if(w.length===1)(i=t.errors).push.apply(i,I.errors);else{for(var Fe=(w.length?w:y).map(function(vt){var lt;return lt=vt[0],Array.isArray(lt)?"("+lt.map(Mt).join(", ")+")":"("+Mt(lt.type)+"...)"}).join(" | "),We=[],gt=1;gt<e.length;gt++){var st=t.parse(e[gt],1+We.length);if(!st)return null;We.push(Mt(st.type))}t.error("Expected arguments of type "+Fe+", but found ("+We.join(", ")+") instead.")}return null},si.register=function(e,t){for(var i in si.definitions=t,t)e[i]=si};var Fn=function(e,t,i){this.type=Pt,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};function ki(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function sr(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function to(e,t){var i=(180+e[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(i*h*8192),Math.round(l*h*8192)]}function ro(e,t,i){return t[1]>e[1]!=i[1]>e[1]&&e[0]<(i[0]-t[0])*(e[1]-t[1])/(i[1]-t[1])+t[0]}function Vn(e,t){for(var i,l,h,f,y,w,I,k=!1,P=0,D=t.length;P<D;P++)for(var B=t[P],U=0,$=B.length;U<$-1;U++){if((f=(i=e)[0]-(l=B[U])[0])*(I=i[1]-(h=B[U+1])[1])-(w=i[0]-h[0])*(y=i[1]-l[1])==0&&f*w<=0&&y*I<=0)return!1;ro(e,B[U],B[U+1])&&(k=!k)}return k}function al(e,t){for(var i=0;i<t.length;i++)if(Vn(e,t[i]))return!0;return!1}function Lo(e,t,i,l){var h=l[0]-i[0],f=l[1]-i[1],y=(e[0]-i[0])*f-h*(e[1]-i[1]),w=(t[0]-i[0])*f-h*(t[1]-i[1]);return y>0&&w<0||y<0&&w>0}function Yl(e,t,i){for(var l=0,h=i;l<h.length;l+=1)for(var f=h[l],y=0;y<f.length-1;++y)if((D=[(P=f[y+1])[0]-(k=f[y])[0],P[1]-k[1]])[0]*(B=[(I=t)[0]-(w=e)[0],I[1]-w[1]])[1]-D[1]*B[0]!=0&&Lo(w,I,k,P)&&Lo(k,P,w,I))return!0;var w,I,k,P,D,B;return!1}function os(e,t){for(var i=0;i<e.length;++i)if(!Vn(e[i],t))return!1;for(var l=0;l<e.length-1;++l)if(Yl(e[l],e[l+1],t))return!1;return!0}function ga(e,t){for(var i=0;i<t.length;i++)if(os(e,t[i]))return!0;return!1}function wo(e,t,i){for(var l=[],h=0;h<e.length;h++){for(var f=[],y=0;y<e[h].length;y++){var w=to(e[h][y],i);ki(t,w),f.push(w)}l.push(f)}return l}function bs(e,t,i){for(var l=[],h=0;h<e.length;h++){var f=wo(e[h],t,i);l.push(f)}return l}function ja(e,t,i,l){if(e[0]<i[0]||e[0]>i[2]){var h=.5*l,f=e[0]-i[0]>h?-l:i[0]-e[0]>h?l:0;f===0&&(f=e[0]-i[2]>h?-l:i[2]-e[0]>h?l:0),e[0]+=f}ki(t,e)}function $o(e,t,i,l){for(var h=8192*Math.pow(2,l.z),f=[8192*l.x,8192*l.y],y=[],w=0,I=e;w<I.length;w+=1)for(var k=0,P=I[w];k<P.length;k+=1){var D=P[k],B=[D.x+f[0],D.y+f[1]];ja(B,t,i,h),y.push(B)}return y}function Nn(e,t,i,l){for(var h,f=8192*Math.pow(2,l.z),y=[8192*l.x,8192*l.y],w=[],I=0,k=e;I<k.length;I+=1){for(var P=[],D=0,B=k[I];D<B.length;D+=1){var U=B[D],$=[U.x+y[0],U.y+y[1]];ki(t,$),P.push($)}w.push(P)}if(t[2]-t[0]<=f/2){(h=t)[0]=h[1]=1/0,h[2]=h[3]=-1/0;for(var te=0,ue=w;te<ue.length;te+=1)for(var ne=0,de=ue[te];ne<de.length;ne+=1)ja(de[ne],t,i,f)}return w}Fn.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var l=t.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Ne);if(!l)return null;var h=t.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Ne);if(!h)return null;var f=null;return i.locale&&!(f=t.parse(i.locale,1,Je))?null:new Fn(l,h,f)},Fn.prototype.evaluate=function(e){return new pi(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Fn.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Fn.prototype.outputDefined=function(){return!1},Fn.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var En=function(e,t){this.type=Ne,this.geojson=e,this.geometries=t};function Gi(e){if(e instanceof si&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof En)return!1;var t=!0;return e.eachChild(function(i){t&&!Gi(i)&&(t=!1)}),t}function pe(e){if(e instanceof si&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(i){t&&!pe(i)&&(t=!1)}),t}function $r(e,t){if(e instanceof si&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild(function(l){i&&!$r(l,t)&&(i=!1)}),i}En.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Do(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var l=0;l<i.features.length;++l){var h=i.features[l].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new En(i,i.features[l].geometry)}else if(i.type==="Feature"){var f=i.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new En(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new En(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},En.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],f=t.canonicalID();if(i.type==="Polygon"){var y=wo(i.coordinates,h,f),w=$o(t.geometry(),l,h,f);if(!sr(l,h))return!1;for(var I=0,k=w;I<k.length;I+=1)if(!Vn(k[I],y))return!1}if(i.type==="MultiPolygon"){var P=bs(i.coordinates,h,f),D=$o(t.geometry(),l,h,f);if(!sr(l,h))return!1;for(var B=0,U=D;B<U.length;B+=1)if(!al(U[B],P))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],f=t.canonicalID();if(i.type==="Polygon"){var y=wo(i.coordinates,h,f),w=Nn(t.geometry(),l,h,f);if(!sr(l,h))return!1;for(var I=0,k=w;I<k.length;I+=1)if(!os(k[I],y))return!1}if(i.type==="MultiPolygon"){var P=bs(i.coordinates,h,f),D=Nn(t.geometry(),l,h,f);if(!sr(l,h))return!1;for(var B=0,U=D;B<U.length;B+=1)if(!ga(U[B],P))return!1}return!0}(e,this.geometries)}return!1},En.prototype.eachChild=function(){},En.prototype.outputDefined=function(){return!0},En.prototype.serialize=function(){return["within",this.geojson]};var Di=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Di.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new Di(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Di.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Di.prototype.eachChild=function(){},Di.prototype.outputDefined=function(){return!1},Di.prototype.serialize=function(){return["var",this.name]};var vr=function(e,t,i,l,h){t===void 0&&(t=[]),l===void 0&&(l=new et),h===void 0&&(h=[]),this.registry=e,this.path=t,this.key=t.map(function(f){return"["+f+"]"}).join(""),this.scope=l,this.errors=h,this.expectedType=i};function _a(e,t){for(var i,l=e.length-1,h=0,f=l,y=0;h<=f;)if((i=e[y=Math.floor((h+f)/2)])<=t){if(y===l||t<e[y+1])return y;h=y+1}else{if(!(i>t))throw new Wr("Input is not a number.");f=y-1}return 0}vr.prototype.parse=function(e,t,i,l,h){return h===void 0&&(h={}),t?this.concat(t,i,l)._parse(e,h):this._parse(e,h)},vr.prototype._parse=function(e,t){function i(k,P,D){return D==="assert"?new wr(P,[k]):D==="coerce"?new yi(P,[k]):k}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var l=e[0];if(typeof l!="string")return this.error("Expression name must be a string, but found "+typeof l+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var h=this.registry[l];if(h){var f=h.parse(e,this);if(!f)return null;if(this.expectedType){var y=this.expectedType,w=f.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||w.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||w.kind!=="value"&&w.kind!=="string"){if(this.checkSubtype(y,w))return null}else f=i(f,y,t.typeAnnotation||"coerce");else f=i(f,y,t.typeAnnotation||"assert")}if(!(f instanceof fi)&&f.type.kind!=="resolvedImage"&&function k(P){if(P instanceof Di)return k(P.boundExpression);if(P instanceof si&&P.name==="error"||P instanceof Fn||P instanceof En)return!1;var D=P instanceof yi||P instanceof wr,B=!0;return P.eachChild(function(U){B=D?B&&k(U):B&&U instanceof fi}),!!B&&Gi(P)&&$r(P,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(f)){var I=new gi;try{f=new fi(f.type,f.evaluate(I))}catch(k){return this.error(k.message),null}}return f}return this.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},vr.prototype.concat=function(e,t,i){var l=typeof e=="number"?this.path.concat(e):this.path,h=i?this.scope.concat(i):this.scope;return new vr(this.registry,l,t||null,h,this.errors)},vr.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var l=""+this.key+t.map(function(h){return"["+h+"]"}).join("");this.errors.push(new Be(l,e))},vr.prototype.checkSubtype=function(e,t){var i=Jt(e,t);return i&&this.error(i),i};var Tn=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var l=0,h=i;l<h.length;l+=1){var f=h[l],y=f[1];this.labels.push(f[0]),this.outputs.push(y)}};function qr(e,t,i){return e*(1-i)+t*i}Tn.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,Se);if(!i)return null;var l=[],h=null;t.expectedType&&t.expectedType.kind!=="value"&&(h=t.expectedType);for(var f=1;f<e.length;f+=2){var y=f===1?-1/0:e[f],w=e[f+1],I=f,k=f+1;if(typeof y!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(l.length&&l[l.length-1][0]>=y)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);var P=t.parse(w,k,h);if(!P)return null;h=h||P.type,l.push([y,P])}return new Tn(h,i,l)},Tn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var h=t.length;return l>=t[h-1]?i[h-1].evaluate(e):i[_a(t,l)].evaluate(e)},Tn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},Tn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Tn.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var ea=Object.freeze({__proto__:null,number:qr,color:function(e,t,i){return new Zt(qr(e.r,t.r,i),qr(e.g,t.g,i),qr(e.b,t.b,i),qr(e.a,t.a,i))},array:function(e,t,i){return e.map(function(l,h){return qr(l,t[h],i)})}}),Il=6/29*3*(6/29),Ql=Math.PI/180,as=180/Math.PI;function va(e){return e>.008856451679035631?Math.pow(e,1/3):e/Il+4/29}function sl(e){return e>6/29?e*e*e:Il*(e-4/29)}function Ro(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function io(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function xa(e){var t=io(e.r),i=io(e.g),l=io(e.b),h=va((.4124564*t+.3575761*i+.1804375*l)/.95047),f=va((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*f-16,a:500*(h-f),b:200*(f-va((.0193339*t+.119192*i+.9503041*l)/1.08883)),alpha:e.a}}function kl(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,l=isNaN(e.b)?t:t-e.b/200;return t=1*sl(t),i=.95047*sl(i),l=1.08883*sl(l),new Zt(Ro(3.2404542*i-1.5371385*t-.4985314*l),Ro(-.969266*i+1.8760108*t+.041556*l),Ro(.0556434*i-.2040259*t+1.0572252*l),e.alpha)}function ws(e,t,i){var l=t-e;return e+i*(l>180||l<-180?l-360*Math.round(l/360):l)}var ll={forward:xa,reverse:kl,interpolate:function(e,t,i){return{l:qr(e.l,t.l,i),a:qr(e.a,t.a,i),b:qr(e.b,t.b,i),alpha:qr(e.alpha,t.alpha,i)}}},Ss={forward:function(e){var t=xa(e),i=t.l,l=t.a,h=t.b,f=Math.atan2(h,l)*as;return{h:f<0?f+360:f,c:Math.sqrt(l*l+h*h),l:i,alpha:e.a}},reverse:function(e){var t=e.h*Ql,i=e.c;return kl({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:ws(e.h,t.h,i),c:qr(e.c,t.c,i),l:qr(e.l,t.l,i),alpha:qr(e.alpha,t.alpha,i)}}},ss=Object.freeze({__proto__:null,lab:ll,hcl:Ss}),_i=function(e,t,i,l,h){this.type=e,this.operator=t,this.interpolation=i,this.input=l,this.labels=[],this.outputs=[];for(var f=0,y=h;f<y.length;f+=1){var w=y[f],I=w[1];this.labels.push(w[0]),this.outputs.push(I)}};function ul(e,t,i,l){var h=l-i,f=e-i;return h===0?0:t===1?f/h:(Math.pow(t,f)-1)/(Math.pow(t,h)-1)}_i.interpolationFactor=function(e,t,i,l){var h=0;if(e.name==="exponential")h=ul(t,e.base,i,l);else if(e.name==="linear")h=ul(t,1,i,l);else if(e.name==="cubic-bezier"){var f=e.controlPoints;h=new A(f[0],f[1],f[2],f[3]).solve(ul(t,1,i,l))}return h},_i.parse=function(e,t){var i=e[0],l=e[1],h=e[2],f=e.slice(3);if(!Array.isArray(l)||l.length===0)return t.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){var y=l[1];if(typeof y!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:y}}else{if(l[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(l[0]),1,0);var w=l.slice(1);if(w.length!==4||w.some(function(ue){return typeof ue!="number"||ue<0||ue>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:w}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(h=t.parse(h,2,Se)))return null;var I=[],k=null;i==="interpolate-hcl"||i==="interpolate-lab"?k=Ge:t.expectedType&&t.expectedType.kind!=="value"&&(k=t.expectedType);for(var P=0;P<f.length;P+=2){var D=f[P],B=f[P+1],U=P+3,$=P+4;if(typeof D!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(I.length&&I[I.length-1][0]>=D)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);var te=t.parse(B,$,k);if(!te)return null;k=k||te.type,I.push([D,te])}return k.kind==="number"||k.kind==="color"||k.kind==="array"&&k.itemType.kind==="number"&&typeof k.N=="number"?new _i(k,i,l,h,I):t.error("Type "+Mt(k)+" is not interpolatable.")},_i.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var h=t.length;if(l>=t[h-1])return i[h-1].evaluate(e);var f=_a(t,l),y=_i.interpolationFactor(this.interpolation,l,t[f],t[f+1]),w=i[f].evaluate(e),I=i[f+1].evaluate(e);return this.operator==="interpolate"?ea[this.type.kind.toLowerCase()](w,I,y):this.operator==="interpolate-hcl"?Ss.reverse(Ss.interpolate(Ss.forward(w),Ss.forward(I),y)):ll.reverse(ll.interpolate(ll.forward(w),ll.forward(I),y))},_i.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},_i.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},_i.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};var ba=function(e,t){this.type=e,this.args=t};ba.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,l=t.expectedType;l&&l.kind!=="value"&&(i=l);for(var h=[],f=0,y=e.slice(1);f<y.length;f+=1){var w=t.parse(y[f],1+h.length,i,void 0,{typeAnnotation:"omit"});if(!w)return null;i=i||w.type,h.push(w)}var I=l&&h.some(function(k){return Jt(l,k.type)});return new ba(I?je:i,h)},ba.prototype.evaluate=function(e){for(var t,i=null,l=0,h=0,f=this.args;h<f.length&&(l++,(i=f[h].evaluate(e))&&i instanceof ai&&!i.available&&(t||(t=i.name),i=null,l===this.args.length&&(i=t)),i===null);h+=1);return i},ba.prototype.eachChild=function(e){this.args.forEach(e)},ba.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},ba.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Un=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};Un.prototype.evaluate=function(e){return this.result.evaluate(e)},Un.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1)e(i[t][1]);e(this.result)},Un.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],l=1;l<e.length-1;l+=2){var h=e[l];if(typeof h!="string")return t.error("Expected string, but found "+typeof h+" instead.",l);if(/[^a-zA-Z0-9_]/.test(h))return t.error("Variable names must contain only alphanumeric characters or '_'.",l);var f=t.parse(e[l+1],l+1);if(!f)return null;i.push([h,f])}var y=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return y?new Un(i,y):null},Un.prototype.outputDefined=function(){return this.result.outputDefined()},Un.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var l=i[t];e.push(l[0],l[1].serialize())}return e.push(this.result.serialize()),e};var qa=function(e,t,i){this.type=e,this.index=t,this.input=i};qa.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,Se),l=t.parse(e[2],2,Vt(t.expectedType||je));return i&&l?new qa(l.type.itemType,i,l):null},qa.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new Wr("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new Wr("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new Wr("Array index must be an integer, but found "+t+" instead.");return i[t]},qa.prototype.eachChild=function(e){e(this.index),e(this.input)},qa.prototype.outputDefined=function(){return!1},qa.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var So=function(e,t){this.type=Ne,this.needle=e,this.haystack=t};So.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,je),l=t.parse(e[2],2,je);return i&&l?zr(i.type,[Ne,Je,Se,Qe,je])?new So(i,l):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Mt(i.type)+" instead"):null},So.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!or(t,["boolean","string","number","null"]))throw new Wr("Expected first argument to be of type boolean, string, number or null, but found "+Mt(Ar(t))+" instead.");if(!or(i,["string","array"]))throw new Wr("Expected second argument to be of type array or string, but found "+Mt(Ar(i))+" instead.");return i.indexOf(t)>=0},So.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},So.prototype.outputDefined=function(){return!0},So.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var no=function(e,t,i){this.type=Se,this.needle=e,this.haystack=t,this.fromIndex=i};no.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,je),l=t.parse(e[2],2,je);if(!i||!l)return null;if(!zr(i.type,[Ne,Je,Se,Qe,je]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Mt(i.type)+" instead");if(e.length===4){var h=t.parse(e[3],3,Se);return h?new no(i,l,h):null}return new no(i,l)},no.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!or(t,["boolean","string","number","null"]))throw new Wr("Expected first argument to be of type boolean, string, number or null, but found "+Mt(Ar(t))+" instead.");if(!or(i,["string","array"]))throw new Wr("Expected second argument to be of type array or string, but found "+Mt(Ar(i))+" instead.");if(this.fromIndex){var l=this.fromIndex.evaluate(e);return i.indexOf(t,l)}return i.indexOf(t)},no.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},no.prototype.outputDefined=function(){return!1},no.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Za=function(e,t,i,l,h,f){this.inputType=e,this.type=t,this.input=i,this.cases=l,this.outputs=h,this.otherwise=f};Za.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var i,l;t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(var h={},f=[],y=2;y<e.length-1;y+=2){var w=e[y],I=e[y+1];Array.isArray(w)||(w=[w]);var k=t.concat(y);if(w.length===0)return k.error("Expected at least one branch label.");for(var P=0,D=w;P<D.length;P+=1){var B=D[P];if(typeof B!="number"&&typeof B!="string")return k.error("Branch labels must be numbers or strings.");if(typeof B=="number"&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return k.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof B=="number"&&Math.floor(B)!==B)return k.error("Numeric branch labels must be integer values.");if(i){if(k.checkSubtype(i,Ar(B)))return null}else i=Ar(B);if(h[String(B)]!==void 0)return k.error("Branch labels must be unique.");h[String(B)]=f.length}var U=t.parse(I,y,l);if(!U)return null;l=l||U.type,f.push(U)}var $=t.parse(e[1],1,je);if(!$)return null;var te=t.parse(e[e.length-1],e.length-1,l);return te?$.type.kind!=="value"&&t.concat(1).checkSubtype(i,$.type)?null:new Za(i,l,$,h,f,te):null},Za.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Ar(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},Za.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Za.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},Za.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],l={},h=0,f=Object.keys(this.cases).sort();h<f.length;h+=1){var y=f[h];(D=l[this.cases[y]])===void 0?(l[this.cases[y]]=i.length,i.push([this.cases[y],[y]])):i[D][1].push(y)}for(var w=function(U){return e.inputType.kind==="number"?Number(U):U},I=0,k=i;I<k.length;I+=1){var P=k[I],D=P[0],B=P[1];t.push(B.length===1?w(B[0]):B.map(w)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var Eo=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};Eo.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var l=[],h=1;h<e.length-1;h+=2){var f=t.parse(e[h],h,Ne);if(!f)return null;var y=t.parse(e[h+1],h+1,i);if(!y)return null;l.push([f,y]),i=i||y.type}var w=t.parse(e[e.length-1],e.length-1,i);return w?new Eo(i,l,w):null},Eo.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],h=l[1];if(l[0].evaluate(e))return h.evaluate(e)}return this.otherwise.evaluate(e)},Eo.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],h=l[1];e(l[0]),e(h)}e(this.otherwise)},Eo.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},Eo.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Bo=function(e,t,i,l){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=l};function cl(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function zl(e,t,i,l){return l.compare(t,i)===0}function Sr(e,t,i){var l=e!=="=="&&e!=="!=";return function(){function h(f,y,w){this.type=Ne,this.lhs=f,this.rhs=y,this.collator=w,this.hasUntypedArgument=f.type.kind==="value"||y.type.kind==="value"}return h.parse=function(f,y){if(f.length!==3&&f.length!==4)return y.error("Expected two or three arguments.");var w=f[0],I=y.parse(f[1],1,je);if(!I)return null;if(!cl(w,I.type))return y.concat(1).error('"'+w+`" comparisons are not supported for type '`+Mt(I.type)+"'.");var k=y.parse(f[2],2,je);if(!k)return null;if(!cl(w,k.type))return y.concat(2).error('"'+w+`" comparisons are not supported for type '`+Mt(k.type)+"'.");if(I.type.kind!==k.type.kind&&I.type.kind!=="value"&&k.type.kind!=="value")return y.error("Cannot compare types '"+Mt(I.type)+"' and '"+Mt(k.type)+"'.");l&&(I.type.kind==="value"&&k.type.kind!=="value"?I=new wr(k.type,[I]):I.type.kind!=="value"&&k.type.kind==="value"&&(k=new wr(I.type,[k])));var P=null;if(f.length===4){if(I.type.kind!=="string"&&k.type.kind!=="string"&&I.type.kind!=="value"&&k.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(!(P=y.parse(f[3],3,Pt)))return null}return new h(I,k,P)},h.prototype.evaluate=function(f){var y=this.lhs.evaluate(f),w=this.rhs.evaluate(f);if(l&&this.hasUntypedArgument){var I=Ar(y),k=Ar(w);if(I.kind!==k.kind||I.kind!=="string"&&I.kind!=="number")throw new Wr('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+I.kind+", "+k.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){var P=Ar(y),D=Ar(w);if(P.kind!=="string"||D.kind!=="string")return t(f,y,w)}return this.collator?i(f,y,w,this.collator.evaluate(f)):t(f,y,w)},h.prototype.eachChild=function(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)},h.prototype.outputDefined=function(){return!0},h.prototype.serialize=function(){var f=[e];return this.eachChild(function(y){f.push(y.serialize())}),f},h}()}Bo.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,je),l=t.parse(e[2],2,Se);if(!i||!l)return null;if(!zr(i.type,[Vt(je),Je,je]))return t.error("Expected first argument to be of type array or string, but found "+Mt(i.type)+" instead");if(e.length===4){var h=t.parse(e[3],3,Se);return h?new Bo(i.type,i,l,h):null}return new Bo(i.type,i,l)},Bo.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!or(t,["string","array"]))throw new Wr("Expected first argument to be of type array or string, but found "+Mt(Ar(t))+" instead.");if(this.endIndex){var l=this.endIndex.evaluate(e);return t.slice(i,l)}return t.slice(i)},Bo.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Bo.prototype.outputDefined=function(){return!1},Bo.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var wa=Sr("==",function(e,t,i){return t===i},zl),jn=Sr("!=",function(e,t,i){return t!==i},function(e,t,i,l){return!zl(0,t,i,l)}),Sa=Sr("<",function(e,t,i){return t<i},function(e,t,i,l){return l.compare(t,i)<0}),Al=Sr(">",function(e,t,i){return t>i},function(e,t,i,l){return l.compare(t,i)>0}),ls=Sr("<=",function(e,t,i){return t<=i},function(e,t,i,l){return l.compare(t,i)<=0}),_u=Sr(">=",function(e,t,i){return t>=i},function(e,t,i,l){return l.compare(t,i)>=0}),Ga=function(e,t,i,l,h){this.type=Je,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=l,this.maxFractionDigits=h};Ga.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,Se);if(!i)return null;var l=e[2];if(typeof l!="object"||Array.isArray(l))return t.error("NumberFormat options argument must be an object.");var h=null;if(l.locale&&!(h=t.parse(l.locale,1,Je)))return null;var f=null;if(l.currency&&!(f=t.parse(l.currency,1,Je)))return null;var y=null;if(l["min-fraction-digits"]&&!(y=t.parse(l["min-fraction-digits"],1,Se)))return null;var w=null;return l["max-fraction-digits"]&&!(w=t.parse(l["max-fraction-digits"],1,Se))?null:new Ga(i,h,f,y,w)},Ga.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Ga.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Ga.prototype.outputDefined=function(){return!1},Ga.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var oo=function(e){this.type=Se,this.input=e};oo.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Mt(i.type)+" instead."):new oo(i):null},oo.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new Wr("Expected value to be of type string or array, but found "+Mt(Ar(t))+" instead.")},oo.prototype.eachChild=function(e){e(this.input)},oo.prototype.outputDefined=function(){return!1},oo.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Oo={"==":wa,"!=":jn,">":Al,"<":Sa,">=":_u,"<=":ls,array:wr,at:qa,boolean:wr,case:Eo,coalesce:ba,collator:Fn,format:pn,image:mi,in:So,"index-of":no,interpolate:_i,"interpolate-hcl":_i,"interpolate-lab":_i,length:oo,let:Un,literal:fi,match:Za,number:wr,"number-format":Ga,object:wr,slice:Bo,step:Tn,string:wr,"to-boolean":yi,"to-color":yi,"to-number":yi,"to-string":yi,var:Di,within:En};function Pl(e,t){var i=t[0],l=t[1],h=t[2],f=t[3];i=i.evaluate(e),l=l.evaluate(e),h=h.evaluate(e);var y=f?f.evaluate(e):1,w=Yo(i,l,h,y);if(w)throw new Wr(w);return new Zt(i/255*y,l/255*y,h/255*y,y)}function Cl(e,t){return e in t}function Ea(e,t){var i=t[e];return i===void 0?null:i}function Ka(e){return{type:e}}function ta(e){return{result:"success",value:e}}function rn(e){return{result:"error",value:e}}function qn(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Ml(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function ra(e){return!!e.expression&&e.expression.interpolated}function Vr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Fs(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Es(e){return e}function ia(e,t,i){return e!==void 0?e:t!==void 0?t:i!==void 0?i:void 0}function Dl(e,t,i,l,h){return ia(typeof i===h?l[i]:void 0,e.default,t.default)}function $l(e,t,i){if(Vr(i)!=="number")return ia(e.default,t.default);var l=e.stops.length;if(l===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[l-1][0])return e.stops[l-1][1];var h=_a(e.stops.map(function(f){return f[0]}),i);return e.stops[h][1]}function Xa(e,t,i){var l=e.base!==void 0?e.base:1;if(Vr(i)!=="number")return ia(e.default,t.default);var h=e.stops.length;if(h===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[h-1][0])return e.stops[h-1][1];var f=_a(e.stops.map(function(D){return D[0]}),i),y=function(D,B,U,$){var te=$-U,ue=D-U;return te===0?0:B===1?ue/te:(Math.pow(B,ue)-1)/(Math.pow(B,te)-1)}(i,l,e.stops[f][0],e.stops[f+1][0]),w=e.stops[f][1],I=e.stops[f+1][1],k=ea[t.type]||Es;if(e.colorSpace&&e.colorSpace!=="rgb"){var P=ss[e.colorSpace];k=function(D,B){return P.reverse(P.interpolate(P.forward(D),P.forward(B),y))}}return typeof w.evaluate=="function"?{evaluate:function(){for(var D=[],B=arguments.length;B--;)D[B]=arguments[B];var U=w.evaluate.apply(void 0,D),$=I.evaluate.apply(void 0,D);if(U!==void 0&&$!==void 0)return k(U,$,y)}}:k(w,I,y)}function na(e,t,i){return t.type==="color"?i=Zt.parse(i):t.type==="formatted"?i=Cr.fromString(i.toString()):t.type==="resolvedImage"?i=ai.fromString(i.toString()):Vr(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),ia(i,e.default,t.default)}si.register(Oo,{error:[{kind:"error"},[Je],function(e,t){throw new Wr(t[0].evaluate(e))}],typeof:[Je,[je],function(e,t){return Mt(Ar(t[0].evaluate(e)))}],"to-rgba":[Vt(Se,4),[Ge],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Ge,[Se,Se,Se],Pl],rgba:[Ge,[Se,Se,Se,Se],Pl],has:{type:Ne,overloads:[[[Je],function(e,t){return Cl(t[0].evaluate(e),e.properties())}],[[Je,At],function(e,t){var i=t[1];return Cl(t[0].evaluate(e),i.evaluate(e))}]]},get:{type:je,overloads:[[[Je],function(e,t){return Ea(t[0].evaluate(e),e.properties())}],[[Je,At],function(e,t){var i=t[1];return Ea(t[0].evaluate(e),i.evaluate(e))}]]},"feature-state":[je,[Je],function(e,t){return Ea(t[0].evaluate(e),e.featureState||{})}],properties:[At,[],function(e){return e.properties()}],"geometry-type":[Je,[],function(e){return e.geometryType()}],id:[je,[],function(e){return e.id()}],zoom:[Se,[],function(e){return e.globals.zoom}],"heatmap-density":[Se,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Se,[],function(e){return e.globals.lineProgress||0}],accumulated:[je,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[Se,Ka(Se),function(e,t){for(var i=0,l=0,h=t;l<h.length;l+=1)i+=h[l].evaluate(e);return i}],"*":[Se,Ka(Se),function(e,t){for(var i=1,l=0,h=t;l<h.length;l+=1)i*=h[l].evaluate(e);return i}],"-":{type:Se,overloads:[[[Se,Se],function(e,t){var i=t[1];return t[0].evaluate(e)-i.evaluate(e)}],[[Se],function(e,t){return-t[0].evaluate(e)}]]},"/":[Se,[Se,Se],function(e,t){var i=t[1];return t[0].evaluate(e)/i.evaluate(e)}],"%":[Se,[Se,Se],function(e,t){var i=t[1];return t[0].evaluate(e)%i.evaluate(e)}],ln2:[Se,[],function(){return Math.LN2}],pi:[Se,[],function(){return Math.PI}],e:[Se,[],function(){return Math.E}],"^":[Se,[Se,Se],function(e,t){var i=t[1];return Math.pow(t[0].evaluate(e),i.evaluate(e))}],sqrt:[Se,[Se],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Se,[Se],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Se,[Se],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Se,[Se],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Se,[Se],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Se,[Se],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Se,[Se],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Se,[Se],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Se,[Se],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Se,[Se],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Se,Ka(Se),function(e,t){return Math.min.apply(Math,t.map(function(i){return i.evaluate(e)}))}],max:[Se,Ka(Se),function(e,t){return Math.max.apply(Math,t.map(function(i){return i.evaluate(e)}))}],abs:[Se,[Se],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Se,[Se],function(e,t){var i=t[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[Se,[Se],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Se,[Se],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Ne,[Je,je],function(e,t){var i=t[0],l=t[1];return e.properties()[i.value]===l.value}],"filter-id-==":[Ne,[je],function(e,t){var i=t[0];return e.id()===i.value}],"filter-type-==":[Ne,[Je],function(e,t){var i=t[0];return e.geometryType()===i.value}],"filter-<":[Ne,[Je,je],function(e,t){var i=t[0],l=t[1],h=e.properties()[i.value],f=l.value;return typeof h==typeof f&&h<f}],"filter-id-<":[Ne,[je],function(e,t){var i=t[0],l=e.id(),h=i.value;return typeof l==typeof h&&l<h}],"filter->":[Ne,[Je,je],function(e,t){var i=t[0],l=t[1],h=e.properties()[i.value],f=l.value;return typeof h==typeof f&&h>f}],"filter-id->":[Ne,[je],function(e,t){var i=t[0],l=e.id(),h=i.value;return typeof l==typeof h&&l>h}],"filter-<=":[Ne,[Je,je],function(e,t){var i=t[0],l=t[1],h=e.properties()[i.value],f=l.value;return typeof h==typeof f&&h<=f}],"filter-id-<=":[Ne,[je],function(e,t){var i=t[0],l=e.id(),h=i.value;return typeof l==typeof h&&l<=h}],"filter->=":[Ne,[Je,je],function(e,t){var i=t[0],l=t[1],h=e.properties()[i.value],f=l.value;return typeof h==typeof f&&h>=f}],"filter-id->=":[Ne,[je],function(e,t){var i=t[0],l=e.id(),h=i.value;return typeof l==typeof h&&l>=h}],"filter-has":[Ne,[je],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Ne,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Ne,[Vt(Je)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Ne,[Vt(je)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Ne,[Je,Vt(je)],function(e,t){var i=t[0];return t[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[Ne,[Je,Vt(je)],function(e,t){var i=t[0],l=t[1];return function(h,f,y,w){for(;y<=w;){var I=y+w>>1;if(f[I]===h)return!0;f[I]>h?w=I-1:y=I+1}return!1}(e.properties()[i.value],l.value,0,l.value.length-1)}],all:{type:Ne,overloads:[[[Ne,Ne],function(e,t){var i=t[1];return t[0].evaluate(e)&&i.evaluate(e)}],[Ka(Ne),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(!l[i].evaluate(e))return!1;return!0}]]},any:{type:Ne,overloads:[[[Ne,Ne],function(e,t){var i=t[1];return t[0].evaluate(e)||i.evaluate(e)}],[Ka(Ne),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(l[i].evaluate(e))return!0;return!1}]]},"!":[Ne,[Ne],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Ne,[Je],function(e,t){var i=e.globals&&e.globals.isSupportedScript;return!i||i(t[0].evaluate(e))}],upcase:[Je,[Je],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[Je,[Je],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[Je,Ka(je),function(e,t){return t.map(function(i){return bo(i.evaluate(e))}).join("")}],"resolved-locale":[Je,[Pt],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var us=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new gi,this._defaultValue=t?function(i){return i.type==="color"&&Fs(i.default)?new Zt(0,0,0,0):i.type==="color"?Zt.parse(i.default)||null:i.default===void 0?null:i.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function ao(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in Oo}function Zn(e,t){var i=new vr(Oo,[],t?function(h){var f={color:Ge,string:Je,number:Se,enum:Je,boolean:Ne,formatted:ar,resolvedImage:Ct};return h.type==="array"?Vt(f[h.value]||je,h.length):f[h.type]}(t):void 0),l=i.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?ta(new us(l,t)):rn(i.errors)}us.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,h,f){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=l,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=f,this.expression.evaluate(this._evaluator)},us.prototype.evaluate=function(e,t,i,l,h,f){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=l,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=f||null;try{var y=this.expression.evaluate(this._evaluator);if(y==null||typeof y=="number"&&y!=y)return this._defaultValue;if(this._enumValues&&!(y in this._enumValues))throw new Wr("Expected value to be one of "+Object.keys(this._enumValues).map(function(w){return JSON.stringify(w)}).join(", ")+", but found "+JSON.stringify(y)+" instead.");return y}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}};var To=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!pe(t.expression)};To.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,h,f){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,h,f)},To.prototype.evaluate=function(e,t,i,l,h,f){return this._styleExpression.evaluate(e,t,i,l,h,f)};var cs=function(e,t,i,l){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!pe(t.expression),this.interpolationType=l};function hs(e,t){if((e=Zn(e,t)).result==="error")return e;var i=e.value.expression,l=Gi(i);if(!l&&!qn(t))return rn([new Be("","data expressions not supported")]);var h=$r(i,["zoom"]);if(!h&&!Ml(t))return rn([new Be("","zoom expressions not supported")]);var f=function y(w){var I=null;if(w instanceof Un)I=y(w.result);else if(w instanceof ba)for(var k=0,P=w.args;k<P.length&&!(I=y(P[k]));k+=1);else(w instanceof Tn||w instanceof _i)&&w.input instanceof si&&w.input.name==="zoom"&&(I=w);return I instanceof Be||w.eachChild(function(D){var B=y(D);B instanceof Be?I=B:!I&&B?I=new Be("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):I&&B&&I!==B&&(I=new Be("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),I}(i);return f||h?f instanceof Be?rn([f]):f instanceof _i&&!ra(t)?rn([new Be("",'"interpolate" expressions cannot be used with this property')]):ta(f?new cs(l?"camera":"composite",e.value,f.labels,f instanceof _i?f.interpolation:void 0):new To(l?"constant":"source",e.value)):rn([new Be("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}cs.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,h,f){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,h,f)},cs.prototype.evaluate=function(e,t,i,l,h,f){return this._styleExpression.evaluate(e,t,i,l,h,f)},cs.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?_i.interpolationFactor(this.interpolationType,e,t,i):0};var Vs=function(e,t){this._parameters=e,this._specification=t,Ce(this,function i(l,h){var f,y,w,I=h.type==="color",k=l.stops&&typeof l.stops[0][0]=="object",P=k||!(k||l.property!==void 0),D=l.type||(ra(h)?"exponential":"interval");if(I&&((l=Ce({},l)).stops&&(l.stops=l.stops.map(function(st){return[st[0],Zt.parse(st[1])]})),l.default=Zt.parse(l.default?l.default:h.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!ss[l.colorSpace])throw new Error("Unknown color space: "+l.colorSpace);if(D==="exponential")f=Xa;else if(D==="interval")f=$l;else if(D==="categorical"){f=Dl,y=Object.create(null);for(var B=0,U=l.stops;B<U.length;B+=1){var $=U[B];y[$[0]]=$[1]}w=typeof l.stops[0][0]}else{if(D!=="identity")throw new Error('Unknown function type "'+D+'"');f=na}if(k){for(var te={},ue=[],ne=0;ne<l.stops.length;ne++){var de=l.stops[ne],ge=de[0].zoom;te[ge]===void 0&&(te[ge]={zoom:ge,type:l.type,property:l.property,default:l.default,stops:[]},ue.push(ge)),te[ge].stops.push([de[0].value,de[1]])}for(var xe=[],Ee=0,Me=ue;Ee<Me.length;Ee+=1){var Fe=Me[Ee];xe.push([te[Fe].zoom,i(te[Fe],h)])}var We={name:"linear"};return{kind:"composite",interpolationType:We,interpolationFactor:_i.interpolationFactor.bind(void 0,We),zoomStops:xe.map(function(st){return st[0]}),evaluate:function(st,vt){var lt=st.zoom;return Xa({stops:xe,base:l.base},h,lt).evaluate(lt,vt)}}}if(P){var gt=D==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:gt,interpolationFactor:_i.interpolationFactor.bind(void 0,gt),zoomStops:l.stops.map(function(st){return st[0]}),evaluate:function(st){return f(l,h,st.zoom,y,w)}}}return{kind:"source",evaluate:function(st,vt){var lt=vt&&vt.properties?vt.properties[l.property]:void 0;return lt===void 0?ia(l.default,h.default):f(l,h,lt,y,w)}}}(this._parameters,this._specification))};function Io(e){var t=e.key,i=e.value,l=e.valueSpec||{},h=e.objectElementValidators||{},f=e.style,y=e.styleSpec,w=[],I=Vr(i);if(I!=="object")return[new re(t,i,"object expected, "+I+" found")];for(var k in i){var P=k.split(".")[0],D=l[P]||l["*"],B=void 0;if(h[P])B=h[P];else if(l[P])B=Qt;else if(h["*"])B=h["*"];else{if(!l["*"]){w.push(new re(t,i[k],'unknown property "'+k+'"'));continue}B=Qt}w=w.concat(B({key:(t&&t+".")+k,value:i[k],valueSpec:D,style:f,styleSpec:y,object:i,objectKey:k},i))}for(var U in l)h[U]||l[U].required&&l[U].default===void 0&&i[U]===void 0&&w.push(new re(t,i,'missing required property "'+U+'"'));return w}function ps(e){var t=e.value,i=e.valueSpec,l=e.style,h=e.styleSpec,f=e.key,y=e.arrayElementValidator||Qt;if(Vr(t)!=="array")return[new re(f,t,"array expected, "+Vr(t)+" found")];if(i.length&&t.length!==i.length)return[new re(f,t,"array length "+i.length+" expected, length "+t.length+" found")];if(i["min-length"]&&t.length<i["min-length"])return[new re(f,t,"array length at least "+i["min-length"]+" expected, length "+t.length+" found")];var w={type:i.value,values:i.values};h.$version<7&&(w.function=i.function),Vr(i.value)==="object"&&(w=i.value);for(var I=[],k=0;k<t.length;k++)I=I.concat(y({array:t,arrayIndex:k,value:t[k],valueSpec:w,style:l,styleSpec:h,key:f+"["+k+"]"}));return I}function Ts(e){var t=e.key,i=e.value,l=e.valueSpec,h=Vr(i);return h==="number"&&i!=i&&(h="NaN"),h!=="number"?[new re(t,i,"number expected, "+h+" found")]:"minimum"in l&&i<l.minimum?[new re(t,i,i+" is less than the minimum value "+l.minimum)]:"maximum"in l&&i>l.maximum?[new re(t,i,i+" is greater than the maximum value "+l.maximum)]:[]}function Ll(e){var t,i,l,h=e.valueSpec,f=Le(e.value.type),y={},w=f!=="categorical"&&e.value.property===void 0,I=!w,k=Vr(e.value.stops)==="array"&&Vr(e.value.stops[0])==="array"&&Vr(e.value.stops[0][0])==="object",P=Io({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(U){if(f==="identity")return[new re(U.key,U.value,'identity function may not have a "stops" property')];var $=[],te=U.value;return $=$.concat(ps({key:U.key,value:te,valueSpec:U.valueSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:D})),Vr(te)==="array"&&te.length===0&&$.push(new re(U.key,te,"array must have at least one stop")),$},default:function(U){return Qt({key:U.key,value:U.value,valueSpec:h,style:U.style,styleSpec:U.styleSpec})}}});return f==="identity"&&w&&P.push(new re(e.key,e.value,'missing required property "property"')),f==="identity"||e.value.stops||P.push(new re(e.key,e.value,'missing required property "stops"')),f==="exponential"&&e.valueSpec.expression&&!ra(e.valueSpec)&&P.push(new re(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(I&&!qn(e.valueSpec)?P.push(new re(e.key,e.value,"property functions not supported")):w&&!Ml(e.valueSpec)&&P.push(new re(e.key,e.value,"zoom functions not supported"))),f!=="categorical"&&!k||e.value.property!==void 0||P.push(new re(e.key,e.value,'"property" property is required')),P;function D(U){var $=[],te=U.value,ue=U.key;if(Vr(te)!=="array")return[new re(ue,te,"array expected, "+Vr(te)+" found")];if(te.length!==2)return[new re(ue,te,"array length 2 expected, length "+te.length+" found")];if(k){if(Vr(te[0])!=="object")return[new re(ue,te,"object expected, "+Vr(te[0])+" found")];if(te[0].zoom===void 0)return[new re(ue,te,"object stop key must have zoom")];if(te[0].value===void 0)return[new re(ue,te,"object stop key must have value")];if(l&&l>Le(te[0].zoom))return[new re(ue,te[0].zoom,"stop zoom values must appear in ascending order")];Le(te[0].zoom)!==l&&(l=Le(te[0].zoom),i=void 0,y={}),$=$.concat(Io({key:ue+"[0]",value:te[0],valueSpec:{zoom:{}},style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:Ts,value:B}}))}else $=$.concat(B({key:ue+"[0]",value:te[0],valueSpec:{},style:U.style,styleSpec:U.styleSpec},te));return ao(be(te[1]))?$.concat([new re(ue+"[1]",te[1],"expressions are not allowed in function stops.")]):$.concat(Qt({key:ue+"[1]",value:te[1],valueSpec:h,style:U.style,styleSpec:U.styleSpec}))}function B(U,$){var te=Vr(U.value),ue=Le(U.value),ne=U.value!==null?U.value:$;if(t){if(te!==t)return[new re(U.key,ne,te+" stop domain type must match previous stop domain type "+t)]}else t=te;if(te!=="number"&&te!=="string"&&te!=="boolean")return[new re(U.key,ne,"stop domain value must be a number, string, or boolean")];if(te!=="number"&&f!=="categorical"){var de="number expected, "+te+" found";return qn(h)&&f===void 0&&(de+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new re(U.key,ne,de)]}return f!=="categorical"||te!=="number"||isFinite(ue)&&Math.floor(ue)===ue?f!=="categorical"&&te==="number"&&i!==void 0&&ue<i?[new re(U.key,ne,"stop domain values must appear in ascending order")]:(i=ue,f==="categorical"&&ue in y?[new re(U.key,ne,"stop domain values must be unique")]:(y[ue]=!0,[])):[new re(U.key,ne,"integer expected, found "+ue)]}}function Wa(e){var t=(e.expressionContext==="property"?hs:Zn)(be(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(l){return new re(""+e.key+l.key,e.value,l.message)});var i=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!i.outputDefined())return[new re(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!pe(i))return[new re(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!pe(i))return[new re(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!$r(i,["zoom","feature-state"]))return[new re(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Gi(i))return[new re(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Fo(e){var t=e.key,i=e.value,l=e.valueSpec,h=[];return Array.isArray(l.values)?l.values.indexOf(Le(i))===-1&&h.push(new re(t,i,"expected one of ["+l.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(l.values).indexOf(Le(i))===-1&&h.push(new re(t,i,"expected one of ["+Object.keys(l.values).join(", ")+"], "+JSON.stringify(i)+" found")),h}function Ns(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,i=e.slice(1);t<i.length;t+=1){var l=i[t];if(!Ns(l)&&typeof l!="boolean")return!1}return!0;default:return!0}}Vs.deserialize=function(e){return new Vs(e._parameters,e._specification)},Vs.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Ha={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ta(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Ns(e)||(e=Ia(e));var t=Zn(e,Ha);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,l,h){return t.value.evaluate(i,l,{},h)},needGeometry:function i(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(var h=1;h<l.length;h++)if(i(l[h]))return!0;return!1}(e)}}function eu(e,t){return e<t?-1:e>t?1:0}function Ia(e){if(!e)return!0;var t,i=e[0];return e.length<=1?i!=="any":i==="=="?Is(e[1],e[2],"=="):i==="!="?Us(Is(e[1],e[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Is(e[1],e[2],i):i==="any"?(t=e.slice(1),["any"].concat(t.map(Ia))):i==="all"?["all"].concat(e.slice(1).map(Ia)):i==="none"?["all"].concat(e.slice(1).map(Ia).map(Us)):i==="in"?hl(e[1],e.slice(2)):i==="!in"?Us(hl(e[1],e.slice(2))):i==="has"?Rl(e[1]):i==="!has"?Us(Rl(e[1])):i!=="within"||e}function Is(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function hl(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(i){return typeof i!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(eu)]]:["filter-in-small",e,["literal",t]]}}function Rl(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Us(e){return["!",e]}function Vo(e){return Ns(be(e.value))?Wa(Ce({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(i){var l=i.value,h=i.key;if(Vr(l)!=="array")return[new re(h,l,"array expected, "+Vr(l)+" found")];var f,y=i.styleSpec,w=[];if(l.length<1)return[new re(h,l,"filter array must have at least 1 element")];switch(w=w.concat(Fo({key:h+"[0]",value:l[0],valueSpec:y.filter_operator,style:i.style,styleSpec:i.styleSpec})),Le(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Le(l[1])==="$type"&&w.push(new re(h,l,'"$type" cannot be use with operator "'+l[0]+'"'));case"==":case"!=":l.length!==3&&w.push(new re(h,l,'filter array for operator "'+l[0]+'" must have 3 elements'));case"in":case"!in":l.length>=2&&(f=Vr(l[1]))!=="string"&&w.push(new re(h+"[1]",l[1],"string expected, "+f+" found"));for(var I=2;I<l.length;I++)f=Vr(l[I]),Le(l[1])==="$type"?w=w.concat(Fo({key:h+"["+I+"]",value:l[I],valueSpec:y.geometry_type,style:i.style,styleSpec:i.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&w.push(new re(h+"["+I+"]",l[I],"string, number, or boolean expected, "+f+" found"));break;case"any":case"all":case"none":for(var k=1;k<l.length;k++)w=w.concat(t({key:h+"["+k+"]",value:l[k],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":f=Vr(l[1]),l.length!==2?w.push(new re(h,l,'filter array for "'+l[0]+'" operator must have 2 elements')):f!=="string"&&w.push(new re(h+"[1]",l[1],"string expected, "+f+" found"));break;case"within":f=Vr(l[1]),l.length!==2?w.push(new re(h,l,'filter array for "'+l[0]+'" operator must have 2 elements')):f!=="object"&&w.push(new re(h+"[1]",l[1],"object expected, "+f+" found"))}return w}(e)}function so(e,t){var i=e.key,l=e.style,h=e.styleSpec,f=e.value,y=e.objectKey,w=h[t+"_"+e.layerType];if(!w)return[];var I=y.match(/^(.*)-transition$/);if(t==="paint"&&I&&w[I[1]]&&w[I[1]].transition)return Qt({key:i,value:f,valueSpec:h.transition,style:l,styleSpec:h});var k,P=e.valueSpec||w[y];if(!P)return[new re(i,f,'unknown property "'+y+'"')];if(Vr(f)==="string"&&qn(P)&&!P.tokens&&(k=/^{([^}]+)}$/.exec(f)))return[new re(i,f,'"'+y+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(k[1])+" }`.")];var D=[];return e.layerType==="symbol"&&(y==="text-field"&&l&&!l.glyphs&&D.push(new re(i,f,'use of "text-field" requires a style "glyphs" property')),y==="text-font"&&Fs(be(f))&&Le(f.type)==="identity"&&D.push(new re(i,f,'"text-font" does not support identity functions'))),D.concat(Qt({key:e.key,value:f,valueSpec:P,style:l,styleSpec:h,expressionContext:"property",propertyType:t,propertyKey:y}))}function oa(e){return so(e,"paint")}function ks(e){return so(e,"layout")}function fs(e){var t=[],i=e.value,l=e.key,h=e.style,f=e.styleSpec;i.type||i.ref||t.push(new re(l,i,'either "type" or "ref" is required'));var y,w=Le(i.type),I=Le(i.ref);if(i.id)for(var k=Le(i.id),P=0;P<e.arrayIndex;P++){var D=h.layers[P];Le(D.id)===k&&t.push(new re(l,i.id,'duplicate layer id "'+i.id+'", previously used at line '+D.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function($){$ in i&&t.push(new re(l,i[$],'"'+$+'" is prohibited for ref layers'))}),h.layers.forEach(function($){Le($.id)===I&&(y=$)}),y?y.ref?t.push(new re(l,i.ref,"ref cannot reference another ref layer")):w=Le(y.type):t.push(new re(l,i.ref,'ref layer "'+I+'" not found'));else if(w!=="background")if(i.source){var B=h.sources&&h.sources[i.source],U=B&&Le(B.type);B?U==="vector"&&w==="raster"?t.push(new re(l,i.source,'layer "'+i.id+'" requires a raster source')):U==="raster"&&w!=="raster"?t.push(new re(l,i.source,'layer "'+i.id+'" requires a vector source')):U!=="vector"||i["source-layer"]?U==="raster-dem"&&w!=="hillshade"?t.push(new re(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!i.paint||!i.paint["line-gradient"]||U==="geojson"&&B.lineMetrics||t.push(new re(l,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new re(l,i,'layer "'+i.id+'" must specify a "source-layer"')):t.push(new re(l,i.source,'source "'+i.source+'" not found'))}else t.push(new re(l,i,'missing required property "source"'));return t=t.concat(Io({key:l,value:i,valueSpec:f.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Qt({key:l+".type",value:i.type,valueSpec:f.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:Vo,layout:function($){return Io({layer:i,key:$.key,value:$.value,style:$.style,styleSpec:$.styleSpec,objectElementValidators:{"*":function(te){return ks(Ce({layerType:w},te))}}})},paint:function($){return Io({layer:i,key:$.key,value:$.value,style:$.style,styleSpec:$.styleSpec,objectElementValidators:{"*":function(te){return oa(Ce({layerType:w},te))}}})}}}))}function zs(e){var t=e.value,i=e.key,l=Vr(t);return l!=="string"?[new re(i,t,"string expected, "+l+" found")]:[]}var Nr={promoteId:function(e){var t=e.key,i=e.value;if(Vr(i)==="string")return zs({key:t,value:i});var l=[];for(var h in i)l.push.apply(l,zs({key:t+"."+h,value:i[h]}));return l}};function ka(e){var t=e.value,i=e.key,l=e.styleSpec,h=e.style;if(!t.type)return[new re(i,t,'"type" is required')];var f,y=Le(t.type);switch(y){case"vector":case"raster":case"raster-dem":return Io({key:i,value:t,valueSpec:l["source_"+y.replace("-","_")],style:e.style,styleSpec:l,objectElementValidators:Nr});case"geojson":if(f=Io({key:i,value:t,valueSpec:l.source_geojson,style:h,styleSpec:l,objectElementValidators:Nr}),t.cluster)for(var w in t.clusterProperties){var I=t.clusterProperties[w],k=I[0],P=typeof k=="string"?[k,["accumulated"],["get",w]]:k;f.push.apply(f,Wa({key:i+"."+w+".map",value:I[1],expressionContext:"cluster-map"})),f.push.apply(f,Wa({key:i+"."+w+".reduce",value:P,expressionContext:"cluster-reduce"}))}return f;case"video":return Io({key:i,value:t,valueSpec:l.source_video,style:h,styleSpec:l});case"image":return Io({key:i,value:t,valueSpec:l.source_image,style:h,styleSpec:l});case"canvas":return[new re(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Fo({key:i+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,styleSpec:l})}}function No(e){var t=e.value,i=e.styleSpec,l=i.light,h=e.style,f=[],y=Vr(t);if(t===void 0)return f;if(y!=="object")return f.concat([new re("light",t,"object expected, "+y+" found")]);for(var w in t){var I=w.match(/^(.*)-transition$/);f=f.concat(I&&l[I[1]]&&l[I[1]].transition?Qt({key:w,value:t[w],valueSpec:i.transition,style:h,styleSpec:i}):l[w]?Qt({key:w,value:t[w],valueSpec:l[w],style:h,styleSpec:i}):[new re(w,t[w],'unknown property "'+w+'"')])}return f}var za={"*":function(){return[]},array:ps,boolean:function(e){var t=e.value,i=e.key,l=Vr(t);return l!=="boolean"?[new re(i,t,"boolean expected, "+l+" found")]:[]},number:Ts,color:function(e){var t=e.key,i=e.value,l=Vr(i);return l!=="string"?[new re(t,i,"color expected, "+l+" found")]:Bt(i)===null?[new re(t,i,'color expected, "'+i+'" found')]:[]},constants:me,enum:Fo,filter:Vo,function:Ll,layer:fs,object:Io,source:ka,light:No,string:zs,formatted:function(e){return zs(e).length===0?[]:Wa(e)},resolvedImage:function(e){return zs(e).length===0?[]:Wa(e)}};function Qt(e){var t=e.value,i=e.valueSpec,l=e.styleSpec;return i.expression&&Fs(Le(t))?Ll(e):i.expression&&ao(be(t))?Wa(e):i.type&&za[i.type]?za[i.type](e):Io(Ce({},e,{valueSpec:i.type?l[i.type]:i}))}function dr(e){var t=e.value,i=e.key,l=zs(e);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new re(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new re(i,t,'"glyphs" url must include a "{range}" token'))),l}function Ui(e,t){t===void 0&&(t=F);var i=[];return i=i.concat(Qt({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:dr,"*":function(){return[]}}})),e.constants&&(i=i.concat(me({key:"constants",value:e.constants,style:e,styleSpec:t}))),As(i)}function As(e){return[].concat(e).sort(function(t,i){return t.line-i.line})}function Gn(e){return function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return As(e.apply(this,t))}}Ui.source=Gn(ka),Ui.light=Gn(No),Ui.layer=Gn(fs),Ui.filter=Gn(Vo),Ui.paintProperty=Gn(oa),Ui.layoutProperty=Gn(ks);var In=Ui,Ja=In.light,tu=In.paintProperty,aa=In.layoutProperty;function pl(e,t){var i=!1;if(t&&t.length)for(var l=0,h=t;l<h.length;l+=1)e.fire(new le(new Error(h[l].message))),i=!0;return i}var sa=Gr;function Gr(e,t,i){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var h=new Int32Array(this.arrayBuffer);e=h[0],this.d=(t=h[1])+2*(i=h[2]);for(var f=0;f<this.d*this.d;f++){var y=h[3+f],w=h[3+f+1];l.push(y===w?null:h.subarray(y,w))}var I=h[3+l.length+1];this.keys=h.subarray(h[3+l.length],I),this.bboxes=h.subarray(I),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var k=0;k<this.d*this.d;k++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var P=i/t*e;this.min=-P,this.max=e+P}Gr.prototype.insert=function(e,t,i,l,h){this._forEachCell(t,i,l,h,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(h)},Gr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Gr.prototype._insertCell=function(e,t,i,l,h,f){this.cells[h].push(f)},Gr.prototype.query=function(e,t,i,l,h){var f=this.min,y=this.max;if(e<=f&&t<=f&&y<=i&&y<=l&&!h)return Array.prototype.slice.call(this.keys);var w=[];return this._forEachCell(e,t,i,l,this._queryCell,w,{},h),w},Gr.prototype._queryCell=function(e,t,i,l,h,f,y,w){var I=this.cells[h];if(I!==null)for(var k=this.keys,P=this.bboxes,D=0;D<I.length;D++){var B=I[D];if(y[B]===void 0){var U=4*B;(w?w(P[U+0],P[U+1],P[U+2],P[U+3]):e<=P[U+2]&&t<=P[U+3]&&i>=P[U+0]&&l>=P[U+1])?(y[B]=!0,f.push(k[B])):y[B]=!1}}},Gr.prototype._forEachCell=function(e,t,i,l,h,f,y,w){for(var I=this._convertToCellCoord(e),k=this._convertToCellCoord(t),P=this._convertToCellCoord(i),D=this._convertToCellCoord(l),B=I;B<=P;B++)for(var U=k;U<=D;U++){var $=this.d*U+B;if((!w||w(this._convertFromCellCoord(B),this._convertFromCellCoord(U),this._convertFromCellCoord(B+1),this._convertFromCellCoord(U+1)))&&h.call(this,e,t,i,l,$,f,y,w))return}},Gr.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Gr.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Gr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var h=new Int32Array(t+i+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var f=t,y=0;y<e.length;y++){var w=e[y];h[3+y]=f,h.set(w,f),f+=w.length}return h[3+e.length]=f,h.set(this.keys,f),h[3+e.length+1]=f+=this.keys.length,h.set(this.bboxes,f),f+=this.bboxes.length,h.buffer};var Aa=K.ImageData,Bl=K.ImageBitmap,li={};function $e(e,t,i){i===void 0&&(i={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),li[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}for(var kn in $e("Object",Object),sa.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},sa.deserialize=function(e){return new sa(e.buffer)},$e("Grid",sa),$e("Color",Zt),$e("Error",Error),$e("ResolvedImage",ai),$e("StylePropertyFunction",Vs),$e("StyleExpression",us,{omit:["_evaluator"]}),$e("ZoomDependentExpression",cs),$e("ZoomConstantExpression",To),$e("CompoundExpression",si,{omit:["_evaluate"]}),Oo)Oo[kn]._classRegistryKey||$e("Expression_"+kn,Oo[kn]);function ko(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function fn(e){return Bl&&e instanceof Bl}function Ki(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(ko(e)||fn(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return t&&t.push(i.buffer),i}if(e instanceof Aa)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var l=[],h=0,f=e;h<f.length;h+=1)l.push(Ki(f[h],t));return l}if(typeof e=="object"){var y=e.constructor,w=y._classRegistryKey;if(!w)throw new Error("can't serialize object of unregistered class");var I=y.serialize?y.serialize(e,t):{};if(!y.serialize){for(var k in e)if(e.hasOwnProperty(k)&&!(li[w].omit.indexOf(k)>=0)){var P=e[k];I[k]=li[w].shallow.indexOf(k)>=0?P:Ki(P,t)}e instanceof Error&&(I.message=e.message)}if(I.$name)throw new Error("$name property is reserved for worker serialization logic.");return w!=="Object"&&(I.$name=w),I}throw new Error("can't serialize object of type "+typeof e)}function zn(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||ko(e)||fn(e)||ArrayBuffer.isView(e)||e instanceof Aa)return e;if(Array.isArray(e))return e.map(zn);if(typeof e=="object"){var t=e.$name||"Object",i=li[t].klass;if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);for(var l=Object.create(i.prototype),h=0,f=Object.keys(e);h<f.length;h+=1){var y=f[h];if(y!=="$name"){var w=e[y];l[y]=li[t].shallow.indexOf(y)>=0?w:zn(w)}}return l}throw new Error("can't deserialize object of type "+typeof e)}var Ya=function(){this.first=!0};Ya.prototype.update=function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))};var Ye={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function fl(e){for(var t=0,i=e;t<i.length;t+=1)if(Pa(i[t].charCodeAt(0)))return!0;return!1}function Pa(e){return!(e!==746&&e!==747&&(e<4352||!(Ye["Bopomofo Extended"](e)||Ye.Bopomofo(e)||Ye["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Ye["CJK Compatibility Ideographs"](e)||Ye["CJK Compatibility"](e)||Ye["CJK Radicals Supplement"](e)||Ye["CJK Strokes"](e)||!(!Ye["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||Ye["CJK Unified Ideographs Extension A"](e)||Ye["CJK Unified Ideographs"](e)||Ye["Enclosed CJK Letters and Months"](e)||Ye["Hangul Compatibility Jamo"](e)||Ye["Hangul Jamo Extended-A"](e)||Ye["Hangul Jamo Extended-B"](e)||Ye["Hangul Jamo"](e)||Ye["Hangul Syllables"](e)||Ye.Hiragana(e)||Ye["Ideographic Description Characters"](e)||Ye.Kanbun(e)||Ye["Kangxi Radicals"](e)||Ye["Katakana Phonetic Extensions"](e)||Ye.Katakana(e)&&e!==12540||!(!Ye["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!Ye["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Ye["Unified Canadian Aboriginal Syllabics"](e)||Ye["Unified Canadian Aboriginal Syllabics Extended"](e)||Ye["Vertical Forms"](e)||Ye["Yijing Hexagram Symbols"](e)||Ye["Yi Syllables"](e)||Ye["Yi Radicals"](e))))}function ds(e){return!(Pa(e)||function(t){return!!(Ye["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Ye["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Ye["Letterlike Symbols"](t)||Ye["Number Forms"](t)||Ye["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Ye["Control Pictures"](t)&&t!==9251||Ye["Optical Character Recognition"](t)||Ye["Enclosed Alphanumerics"](t)||Ye["Geometric Shapes"](t)||Ye["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Ye["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Ye["CJK Symbols and Punctuation"](t)||Ye.Katakana(t)||Ye["Private Use Area"](t)||Ye["CJK Compatibility Forms"](t)||Ye["Small Form Variants"](t)||Ye["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function lo(e){return e>=1424&&e<=2303||Ye["Arabic Presentation Forms-A"](e)||Ye["Arabic Presentation Forms-B"](e)}function An(e,t){return!(!t&&lo(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Ye.Khmer(e))}function la(e){for(var t=0,i=e;t<i.length;t+=1)if(lo(i[t].charCodeAt(0)))return!0;return!1}var ua=null,Kn="unavailable",Lr=null,Ol=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(Kn="error"),ua&&ua(e)};function js(){Fl.fire(new ee("pluginStateChange",{pluginStatus:Kn,pluginURL:Lr}))}var Fl=new ce,qs=function(){return Kn},Li=function(){if(Kn!=="deferred"||!Lr)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Kn="loading",js(),Lr&&en({url:Lr},function(e){e?Ol(e):(Kn="loaded",js())})},Zr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Kn==="loaded"||Zr.applyArabicShaping!=null},isLoading:function(){return Kn==="loading"},setState:function(e){Kn=e.pluginStatus,Lr=e.pluginURL},isParsed:function(){return Zr.applyArabicShaping!=null&&Zr.processBidirectionalText!=null&&Zr.processStyledBidirectionalText!=null},getPluginURL:function(){return Lr}},Yt=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ya,this.transition={})};Yt.prototype.isSupportedScript=function(e){return function(t,i){for(var l=0,h=t;l<h.length;l+=1)if(!An(h[l].charCodeAt(0),i))return!1;return!0}(e,Zr.isLoaded())},Yt.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Yt.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}};var ca=function(e,t){this.property=e,this.value=t,this.expression=function(i,l){if(Fs(i))return new Vs(i,l);if(ao(i)){var h=hs(i,l);if(h.result==="error")throw new Error(h.value.map(function(y){return y.key+": "+y.message}).join(", "));return h.value}var f=i;return typeof i=="string"&&l.type==="color"&&(f=Zt.parse(i)),{kind:"constant",evaluate:function(){return f}}}(t===void 0?e.specification.default:t,e.specification)};ca.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},ca.prototype.possiblyEvaluate=function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)};var zo=function(e){this.property=e,this.value=new ca(e,void 0)};zo.prototype.transitioned=function(e,t){return new dn(this.property,this.value,t,Xe({},e.transition,this.transition),e.now)},zo.prototype.untransitioned=function(){return new dn(this.property,this.value,null,{},0)};var Ri=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};Ri.prototype.getValue=function(e){return qe(this._values[e].value.value)},Ri.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new zo(this._values[e].property)),this._values[e].value=new ca(this._values[e].property,t===null?void 0:qe(t))},Ri.prototype.getTransition=function(e){return qe(this._values[e].transition)},Ri.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new zo(this._values[e].property)),this._values[e].transition=qe(t)||void 0},Ri.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],h=this.getValue(l);h!==void 0&&(e[l]=h);var f=this.getTransition(l);f!==void 0&&(e[l+"-transition"]=f)}return e},Ri.prototype.transitioned=function(e,t){for(var i=new Qa(this._properties),l=0,h=Object.keys(this._values);l<h.length;l+=1){var f=h[l];i._values[f]=this._values[f].transitioned(e,t._values[f])}return i},Ri.prototype.untransitioned=function(){for(var e=new Qa(this._properties),t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t];e._values[l]=this._values[l].untransitioned()}return e};var dn=function(e,t,i,l,h){this.property=e,this.value=t,this.begin=h+l.delay||0,this.end=this.begin+l.duration||0,e.specification.transition&&(l.delay||l.duration)&&(this.prior=i)};dn.prototype.possiblyEvaluate=function(e,t,i){var l=e.now||0,h=this.value.possiblyEvaluate(e,t,i),f=this.prior;if(f){if(l>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(l<this.begin)return f.possiblyEvaluate(e,t,i);var y=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(f.possiblyEvaluate(e,t,i),h,function(w){if(w<=0)return 0;if(w>=1)return 1;var I=w*w,k=I*w;return 4*(w<.5?k:3*(w-I)+k-.75)}(y))}return h};var Qa=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Qa.prototype.possiblyEvaluate=function(e,t,i){for(var l=new _e(this._properties),h=0,f=Object.keys(this._values);h<f.length;h+=1){var y=f[h];l._values[y]=this._values[y].possiblyEvaluate(e,t,i)}return l},Qa.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var uo=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};uo.prototype.getValue=function(e){return qe(this._values[e].value)},uo.prototype.setValue=function(e,t){this._values[e]=new ca(this._values[e].property,t===null?void 0:qe(t))},uo.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],h=this.getValue(l);h!==void 0&&(e[l]=h)}return e},uo.prototype.possiblyEvaluate=function(e,t,i){for(var l=new _e(this._properties),h=0,f=Object.keys(this._values);h<f.length;h+=1){var y=f[h];l._values[y]=this._values[y].possiblyEvaluate(e,t,i)}return l};var Hr=function(e,t,i){this.property=e,this.value=t,this.parameters=i};Hr.prototype.isConstant=function(){return this.value.kind==="constant"},Hr.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Hr.prototype.evaluate=function(e,t,i,l){return this.property.evaluate(this.value,this.parameters,e,t,i,l)};var _e=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};_e.prototype.get=function(e){return this._values[e]};var Pe=function(e){this.specification=e};Pe.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Pe.prototype.interpolate=function(e,t,i){var l=ea[this.specification.type];return l?l(e,t,i):e};var ot=function(e,t){this.specification=e,this.overrides=t};ot.prototype.possiblyEvaluate=function(e,t,i,l){return new Hr(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},i,l)}:e.expression,t)},ot.prototype.interpolate=function(e,t,i){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new Hr(this,{kind:"constant",value:void 0},e.parameters);var l=ea[this.specification.type];return l?new Hr(this,{kind:"constant",value:l(e.value.value,t.value.value,i)},e.parameters):e},ot.prototype.evaluate=function(e,t,i,l,h,f){return e.kind==="constant"?e.value:e.evaluate(t,i,l,h,f)};var co=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l,h,f){if(i.value===void 0)return new Hr(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){var y=i.expression.evaluate(l,null,{},h,f),w=i.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,I=this._calculate(w,w,w,l);return new Hr(this,{kind:"constant",value:I},l)}if(i.expression.kind==="camera"){var k=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new Hr(this,{kind:"constant",value:k},l)}return new Hr(this,i.expression,l)},t.prototype.evaluate=function(i,l,h,f,y,w){if(i.kind==="source"){var I=i.evaluate(l,h,f,y,w);return this._calculate(I,I,I,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},h,f),i.evaluate({zoom:Math.floor(l.zoom)},h,f),i.evaluate({zoom:Math.floor(l.zoom)+1},h,f),l):i.value},t.prototype._calculate=function(i,l,h,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:h,to:l}},t.prototype.interpolate=function(i){return i},t}(ot),Bi=function(e){this.specification=e};Bi.prototype.possiblyEvaluate=function(e,t,i,l){if(e.value!==void 0){if(e.expression.kind==="constant"){var h=e.expression.evaluate(t,null,{},i,l);return this._calculate(h,h,h,t)}return this._calculate(e.expression.evaluate(new Yt(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Yt(Math.floor(t.zoom),t)),e.expression.evaluate(new Yt(Math.floor(t.zoom+1),t)),t)}},Bi.prototype._calculate=function(e,t,i,l){return l.zoom>l.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}},Bi.prototype.interpolate=function(e){return e};var mn=function(e){this.specification=e};mn.prototype.possiblyEvaluate=function(e,t,i,l){return!!e.expression.evaluate(t,null,{},i,l)},mn.prototype.interpolate=function(){return!1};var Ur=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var i=e[t];i.specification.overridable&&this.overridableProperties.push(t);var l=this.defaultPropertyValues[t]=new ca(i,void 0),h=this.defaultTransitionablePropertyValues[t]=new zo(i);this.defaultTransitioningPropertyValues[t]=h.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=l.possiblyEvaluate({})}};$e("DataDrivenProperty",ot),$e("DataConstantProperty",Pe),$e("CrossFadedDataDrivenProperty",co),$e("CrossFadedProperty",Bi),$e("ColorRampProperty",mn);var Pn=function(e){function t(i,l){if(e.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new uo(l.layout)),l.paint)){for(var h in this._transitionablePaint=new Ri(l.paint),i.paint)this.setPaintProperty(h,i.paint[h],{validate:!1});for(var f in i.layout)this.setLayoutProperty(f,i.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _e(l.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},t.prototype.setLayoutProperty=function(i,l,h){h===void 0&&(h={}),l!=null&&this._validate(aa,"layers."+this.id+".layout."+i,i,l,h)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)},t.prototype.getPaintProperty=function(i){return cr(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},t.prototype.setPaintProperty=function(i,l,h){if(h===void 0&&(h={}),l!=null&&this._validate(tu,"layers."+this.id+".paint."+i,i,l,h))return!1;if(cr(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),l||void 0),!1;var f=this._transitionablePaint._values[i],y=f.property.specification["property-type"]==="cross-faded-data-driven",w=f.value.isDataDriven(),I=f.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);var k=this._transitionablePaint._values[i].value;return k.isDataDriven()||w||y||this._handleOverridablePaintPropertyUpdate(i,I,k)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,h){return!1},t.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)},t.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),Ht(i,function(l,h){return!(l===void 0||h==="layout"&&!Object.keys(l).length||h==="paint"&&!Object.keys(l).length)})},t.prototype._validate=function(i,l,h,f,y){return y===void 0&&(y={}),(!y||y.validate!==!1)&&pl(this,i.call(In,{key:l,layerType:this.type,objectKey:h,value:f,styleSpec:F,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var i in this.paint._values){var l=this.paint.get(i);if(l instanceof Hr&&qn(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1},t}(ce),$a={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Ca=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Kt=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function ei(e,t){t===void 0&&(t=1);var i=0,l=0;return{members:e.map(function(h){var f=$a[h.type].BYTES_PER_ELEMENT,y=i=ms(i,Math.max(t,f)),w=h.components||1;return l=Math.max(l,f),i+=f*w,{name:h.name,type:h.type,components:w,offset:y}}),size:ms(i,Math.max(l,t)),alignment:t}}function ms(e,t){return Math.ceil(e/t)*t}Kt.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Kt.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Kt.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Kt.prototype.clear=function(){this.length=0},Kt.prototype.resize=function(e){this.reserve(e),this.length=e},Kt.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Kt.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Uo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var h=this.length;return this.resize(h+1),this.emplace(h,i,l)},t.prototype.emplace=function(i,l,h){var f=2*i;return this.int16[f+0]=l,this.int16[f+1]=h,i},t}(Kt);Uo.prototype.bytesPerElement=4,$e("StructArrayLayout2i4",Uo);var Vl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f){var y=this.length;return this.resize(y+1),this.emplace(y,i,l,h,f)},t.prototype.emplace=function(i,l,h,f,y){var w=4*i;return this.int16[w+0]=l,this.int16[w+1]=h,this.int16[w+2]=f,this.int16[w+3]=y,i},t}(Kt);Vl.prototype.bytesPerElement=8,$e("StructArrayLayout4i8",Vl);var Ma=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,h,f,y,w)},t.prototype.emplace=function(i,l,h,f,y,w,I){var k=6*i;return this.int16[k+0]=l,this.int16[k+1]=h,this.int16[k+2]=f,this.int16[k+3]=y,this.int16[k+4]=w,this.int16[k+5]=I,i},t}(Kt);Ma.prototype.bytesPerElement=12,$e("StructArrayLayout2i4i12",Ma);var Xn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,h,f,y,w)},t.prototype.emplace=function(i,l,h,f,y,w,I){var k=4*i,P=8*i;return this.int16[k+0]=l,this.int16[k+1]=h,this.uint8[P+4]=f,this.uint8[P+5]=y,this.uint8[P+6]=w,this.uint8[P+7]=I,i},t}(Kt);Xn.prototype.bytesPerElement=8,$e("StructArrayLayout2i4ub8",Xn);var ha=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var h=this.length;return this.resize(h+1),this.emplace(h,i,l)},t.prototype.emplace=function(i,l,h){var f=2*i;return this.float32[f+0]=l,this.float32[f+1]=h,i},t}(Kt);ha.prototype.bytesPerElement=8,$e("StructArrayLayout2f8",ha);var nn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w,I,k,P,D){var B=this.length;return this.resize(B+1),this.emplace(B,i,l,h,f,y,w,I,k,P,D)},t.prototype.emplace=function(i,l,h,f,y,w,I,k,P,D,B){var U=10*i;return this.uint16[U+0]=l,this.uint16[U+1]=h,this.uint16[U+2]=f,this.uint16[U+3]=y,this.uint16[U+4]=w,this.uint16[U+5]=I,this.uint16[U+6]=k,this.uint16[U+7]=P,this.uint16[U+8]=D,this.uint16[U+9]=B,i},t}(Kt);nn.prototype.bytesPerElement=20,$e("StructArrayLayout10ui20",nn);var dl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w,I,k,P,D,B,U){var $=this.length;return this.resize($+1),this.emplace($,i,l,h,f,y,w,I,k,P,D,B,U)},t.prototype.emplace=function(i,l,h,f,y,w,I,k,P,D,B,U,$){var te=12*i;return this.int16[te+0]=l,this.int16[te+1]=h,this.int16[te+2]=f,this.int16[te+3]=y,this.uint16[te+4]=w,this.uint16[te+5]=I,this.uint16[te+6]=k,this.uint16[te+7]=P,this.int16[te+8]=D,this.int16[te+9]=B,this.int16[te+10]=U,this.int16[te+11]=$,i},t}(Kt);dl.prototype.bytesPerElement=24,$e("StructArrayLayout4i4ui4i24",dl);var jo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h){var f=this.length;return this.resize(f+1),this.emplace(f,i,l,h)},t.prototype.emplace=function(i,l,h,f){var y=3*i;return this.float32[y+0]=l,this.float32[y+1]=h,this.float32[y+2]=f,i},t}(Kt);jo.prototype.bytesPerElement=12,$e("StructArrayLayout3f12",jo);var Zs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint32[1*i+0]=l,i},t}(Kt);Zs.prototype.bytesPerElement=4,$e("StructArrayLayout1ul4",Zs);var ml=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w,I,k,P){var D=this.length;return this.resize(D+1),this.emplace(D,i,l,h,f,y,w,I,k,P)},t.prototype.emplace=function(i,l,h,f,y,w,I,k,P,D){var B=10*i,U=5*i;return this.int16[B+0]=l,this.int16[B+1]=h,this.int16[B+2]=f,this.int16[B+3]=y,this.int16[B+4]=w,this.int16[B+5]=I,this.uint32[U+3]=k,this.uint16[B+8]=P,this.uint16[B+9]=D,i},t}(Kt);ml.prototype.bytesPerElement=20,$e("StructArrayLayout6i1ul2ui20",ml);var Gs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,h,f,y,w)},t.prototype.emplace=function(i,l,h,f,y,w,I){var k=6*i;return this.int16[k+0]=l,this.int16[k+1]=h,this.int16[k+2]=f,this.int16[k+3]=y,this.int16[k+4]=w,this.int16[k+5]=I,i},t}(Kt);Gs.prototype.bytesPerElement=12,$e("StructArrayLayout2i2i2i12",Gs);var ys=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y){var w=this.length;return this.resize(w+1),this.emplace(w,i,l,h,f,y)},t.prototype.emplace=function(i,l,h,f,y,w){var I=4*i,k=8*i;return this.float32[I+0]=l,this.float32[I+1]=h,this.float32[I+2]=f,this.int16[k+6]=y,this.int16[k+7]=w,i},t}(Kt);ys.prototype.bytesPerElement=16,$e("StructArrayLayout2f1f2i16",ys);var Nl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f){var y=this.length;return this.resize(y+1),this.emplace(y,i,l,h,f)},t.prototype.emplace=function(i,l,h,f,y){var w=12*i,I=3*i;return this.uint8[w+0]=l,this.uint8[w+1]=h,this.float32[I+1]=f,this.float32[I+2]=y,i},t}(Kt);Nl.prototype.bytesPerElement=12,$e("StructArrayLayout2ub2f12",Nl);var es=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h){var f=this.length;return this.resize(f+1),this.emplace(f,i,l,h)},t.prototype.emplace=function(i,l,h,f){var y=3*i;return this.uint16[y+0]=l,this.uint16[y+1]=h,this.uint16[y+2]=f,i},t}(Kt);es.prototype.bytesPerElement=6,$e("StructArrayLayout3ui6",es);var ho=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w,I,k,P,D,B,U,$,te,ue,ne,de){var ge=this.length;return this.resize(ge+1),this.emplace(ge,i,l,h,f,y,w,I,k,P,D,B,U,$,te,ue,ne,de)},t.prototype.emplace=function(i,l,h,f,y,w,I,k,P,D,B,U,$,te,ue,ne,de,ge){var xe=24*i,Ee=12*i,Me=48*i;return this.int16[xe+0]=l,this.int16[xe+1]=h,this.uint16[xe+2]=f,this.uint16[xe+3]=y,this.uint32[Ee+2]=w,this.uint32[Ee+3]=I,this.uint32[Ee+4]=k,this.uint16[xe+10]=P,this.uint16[xe+11]=D,this.uint16[xe+12]=B,this.float32[Ee+7]=U,this.float32[Ee+8]=$,this.uint8[Me+36]=te,this.uint8[Me+37]=ue,this.uint8[Me+38]=ne,this.uint32[Ee+10]=de,this.int16[xe+22]=ge,i},t}(Kt);ho.prototype.bytesPerElement=48,$e("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ho);var yl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w,I,k,P,D,B,U,$,te,ue,ne,de,ge,xe,Ee,Me,Fe,We,gt,st,vt,lt,Xt){var Tt=this.length;return this.resize(Tt+1),this.emplace(Tt,i,l,h,f,y,w,I,k,P,D,B,U,$,te,ue,ne,de,ge,xe,Ee,Me,Fe,We,gt,st,vt,lt,Xt)},t.prototype.emplace=function(i,l,h,f,y,w,I,k,P,D,B,U,$,te,ue,ne,de,ge,xe,Ee,Me,Fe,We,gt,st,vt,lt,Xt,Tt){var ct=34*i,$t=17*i;return this.int16[ct+0]=l,this.int16[ct+1]=h,this.int16[ct+2]=f,this.int16[ct+3]=y,this.int16[ct+4]=w,this.int16[ct+5]=I,this.int16[ct+6]=k,this.int16[ct+7]=P,this.uint16[ct+8]=D,this.uint16[ct+9]=B,this.uint16[ct+10]=U,this.uint16[ct+11]=$,this.uint16[ct+12]=te,this.uint16[ct+13]=ue,this.uint16[ct+14]=ne,this.uint16[ct+15]=de,this.uint16[ct+16]=ge,this.uint16[ct+17]=xe,this.uint16[ct+18]=Ee,this.uint16[ct+19]=Me,this.uint16[ct+20]=Fe,this.uint16[ct+21]=We,this.uint16[ct+22]=gt,this.uint32[$t+12]=st,this.float32[$t+13]=vt,this.float32[$t+14]=lt,this.float32[$t+15]=Xt,this.float32[$t+16]=Tt,i},t}(Kt);yl.prototype.bytesPerElement=68,$e("StructArrayLayout8i15ui1ul4f68",yl);var Da=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.float32[1*i+0]=l,i},t}(Kt);Da.prototype.bytesPerElement=4,$e("StructArrayLayout1f4",Da);var qo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h){var f=this.length;return this.resize(f+1),this.emplace(f,i,l,h)},t.prototype.emplace=function(i,l,h,f){var y=3*i;return this.int16[y+0]=l,this.int16[y+1]=h,this.int16[y+2]=f,i},t}(Kt);qo.prototype.bytesPerElement=6,$e("StructArrayLayout3i6",qo);var Ul=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h){var f=this.length;return this.resize(f+1),this.emplace(f,i,l,h)},t.prototype.emplace=function(i,l,h,f){var y=4*i;return this.uint32[2*i+0]=l,this.uint16[y+2]=h,this.uint16[y+3]=f,i},t}(Kt);Ul.prototype.bytesPerElement=8,$e("StructArrayLayout1ul2ui8",Ul);var Ks=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var h=this.length;return this.resize(h+1),this.emplace(h,i,l)},t.prototype.emplace=function(i,l,h){var f=2*i;return this.uint16[f+0]=l,this.uint16[f+1]=h,i},t}(Kt);Ks.prototype.bytesPerElement=4,$e("StructArrayLayout2ui4",Ks);var jl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint16[1*i+0]=l,i},t}(Kt);jl.prototype.bytesPerElement=2,$e("StructArrayLayout1ui2",jl);var pa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f){var y=this.length;return this.resize(y+1),this.emplace(y,i,l,h,f)},t.prototype.emplace=function(i,l,h,f,y){var w=4*i;return this.float32[w+0]=l,this.float32[w+1]=h,this.float32[w+2]=f,this.float32[w+3]=y,i},t}(Kt);pa.prototype.bytesPerElement=16,$e("StructArrayLayout4f16",pa);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new N(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,i),t}(Ca);n.prototype.size=20;var a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new n(this,i)},t}(ml);$e("CollisionBoxArray",a);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(l){this._structArray.uint8[this._pos1+37]=l},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(l){this._structArray.uint8[this._pos1+38]=l},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+10]=l},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,i),t}(Ca);o.prototype.size=48;var u=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new o(this,i)},t}(ho);$e("PlacedSymbolArray",u);var d=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+12]=l},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,i),t}(Ca);d.prototype.size=68;var _=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new d(this,i)},t}(yl);$e("SymbolInstanceArray",_);var x=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(i){return this.float32[1*i+0]},t}(Da);$e("GlyphOffsetArray",x);var T=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(i){return this.int16[3*i+0]},t.prototype.gety=function(i){return this.int16[3*i+1]},t.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},t}(qo);$e("SymbolLineVertexArray",T);var z=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,i),t}(Ca);z.prototype.size=8;var L=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new z(this,i)},t}(Ul);$e("FeatureIndexArray",L);var j=ei([{name:"a_pos",components:2,type:"Int16"}],4).members,q=function(e){e===void 0&&(e=[]),this.segments=e};function Z(e,t){return 256*(e=ze(Math.floor(e),0,255))+ze(Math.floor(t),0,255)}q.prototype.prepareSegment=function(e,t,i,l){var h=this.segments[this.segments.length-1];return e>q.MAX_VERTEX_ARRAY_LENGTH&&It("Max vertices per segment is "+q.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!h||h.vertexLength+e>q.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==l)&&(h={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},l!==void 0&&(h.sortKey=l),this.segments.push(h)),h},q.prototype.get=function(){return this.segments},q.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var i=t[e];for(var l in i.vaos)i.vaos[l].destroy()}},q.simpleSegment=function(e,t,i,l){return new q([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:l,vaos:{},sortKey:0}])},q.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,$e("SegmentVector",q);var J=ei([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Q=M(function(e){e.exports=function(t,i){var l,h,f,y,w,I,k,P;for(h=t.length-(l=3&t.length),f=i,w=3432918353,I=461845907,P=0;P<h;)k=255&t.charCodeAt(P)|(255&t.charCodeAt(++P))<<8|(255&t.charCodeAt(++P))<<16|(255&t.charCodeAt(++P))<<24,++P,f=27492+(65535&(y=5*(65535&(f=(f^=k=(65535&(k=(k=(65535&k)*w+(((k>>>16)*w&65535)<<16)&4294967295)<<15|k>>>17))*I+(((k>>>16)*I&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(k=0,l){case 3:k^=(255&t.charCodeAt(P+2))<<16;case 2:k^=(255&t.charCodeAt(P+1))<<8;case 1:f^=k=(65535&(k=(k=(65535&(k^=255&t.charCodeAt(P)))*w+(((k>>>16)*w&65535)<<16)&4294967295)<<15|k>>>17))*I+(((k>>>16)*I&65535)<<16)&4294967295}return f^=t.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0}}),oe=M(function(e){e.exports=function(t,i){for(var l,h=t.length,f=i^h,y=0;h>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(y)|(255&t.charCodeAt(++y))<<8|(255&t.charCodeAt(++y))<<16|(255&t.charCodeAt(++y))<<24))+((1540483477*(l>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),h-=4,++y;switch(h){case 3:f^=(255&t.charCodeAt(y+2))<<16;case 2:f^=(255&t.charCodeAt(y+1))<<8;case 1:f=1540483477*(65535&(f^=255&t.charCodeAt(y)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0}}),Y=Q,ae=oe;Y.murmur3=Q,Y.murmur2=ae;var he=function(){this.ids=[],this.positions=[],this.indexed=!1};he.prototype.add=function(e,t,i,l){this.ids.push(Te(e)),this.positions.push(t,i,l)},he.prototype.getPositions=function(e){for(var t=Te(e),i=0,l=this.ids.length-1;i<l;){var h=i+l>>1;this.ids[h]>=t?l=h:i=h+1}for(var f=[];this.ids[i]===t;)f.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return f},he.serialize=function(e,t){var i=new Float64Array(e.ids),l=new Uint32Array(e.positions);return function h(f,y,w,I){for(;w<I;){for(var k=f[w+I>>1],P=w-1,D=I+1;;){do P++;while(f[P]<k);do D--;while(f[D]>k);if(P>=D)break;ve(f,P,D),ve(y,3*P,3*D),ve(y,3*P+1,3*D+1),ve(y,3*P+2,3*D+2)}D-w<I-D?(h(f,y,w,D),w=D+1):(h(f,y,D+1,I),I=D)}}(i,l,0,i.length-1),t&&t.push(i.buffer,l.buffer),{ids:i,positions:l}},he.deserialize=function(e){var t=new he;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var ye=Math.pow(2,53)-1;function Te(e){var t=+e;return!isNaN(t)&&t<=ye?t:Y(String(e))}function ve(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}$e("FeaturePositionMap",he);var Ae=function(e,t){this.gl=e.gl,this.location=t},Re=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},t}(Ae),Ue=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},t}(Ae),Ve=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},t}(Ae),at=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},t}(Ae),yt=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},t}(Ae),mt=function(e){function t(i,l){e.call(this,i,l),this.current=Zt.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},t}(Ae),_t=new Float32Array(16),ir=function(e){function t(i,l){e.call(this,i,l),this.current=_t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},t}(Ae);function ut(e){return[Z(255*e.r,255*e.g),Z(255*e.b,255*e.a)]}var zt=function(e,t,i){this.value=e,this.uniformNames=t.map(function(l){return"u_"+l}),this.type=i};zt.prototype.setUniform=function(e,t,i){e.set(i.constantOr(this.value))},zt.prototype.getBinding=function(e,t,i){return this.type==="color"?new mt(e,t):new Ue(e,t)};var Ot=function(e,t){this.uniformNames=t.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Ot.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Ot.prototype.setUniform=function(e,t,i,l){var h=l==="u_pattern_to"?this.patternTo:l==="u_pattern_from"?this.patternFrom:l==="u_pixel_ratio_to"?this.pixelRatioTo:l==="u_pixel_ratio_from"?this.pixelRatioFrom:null;h&&e.set(h)},Ot.prototype.getBinding=function(e,t,i){return i.substr(0,9)==="u_pattern"?new yt(e,t):new Ue(e,t)};var Et=function(e,t,i,l){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(function(h){return{name:"a_"+h,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new l};Et.prototype.populatePaintArray=function(e,t,i,l,h){var f=this.paintVertexArray.length,y=this.expression.evaluate(new Yt(0),t,{},l,[],h);this.paintVertexArray.resize(e),this._setPaintValue(f,e,y)},Et.prototype.updatePaintArray=function(e,t,i,l){var h=this.expression.evaluate({zoom:0},i,l);this._setPaintValue(e,t,h)},Et.prototype._setPaintValue=function(e,t,i){if(this.type==="color")for(var l=ut(i),h=e;h<t;h++)this.paintVertexArray.emplace(h,l[0],l[1]);else{for(var f=e;f<t;f++)this.paintVertexArray.emplace(f,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Et.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Et.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var St=function(e,t,i,l,h,f){this.expression=e,this.uniformNames=t.map(function(y){return"u_"+y+"_t"}),this.type=i,this.useIntegerZoom=l,this.zoom=h,this.maxValue=0,this.paintVertexAttributes=t.map(function(y){return{name:"a_"+y,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new f};St.prototype.populatePaintArray=function(e,t,i,l,h){var f=this.expression.evaluate(new Yt(this.zoom),t,{},l,[],h),y=this.expression.evaluate(new Yt(this.zoom+1),t,{},l,[],h),w=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(w,e,f,y)},St.prototype.updatePaintArray=function(e,t,i,l){var h=this.expression.evaluate({zoom:this.zoom},i,l),f=this.expression.evaluate({zoom:this.zoom+1},i,l);this._setPaintValue(e,t,h,f)},St.prototype._setPaintValue=function(e,t,i,l){if(this.type==="color")for(var h=ut(i),f=ut(l),y=e;y<t;y++)this.paintVertexArray.emplace(y,h[0],h[1],f[0],f[1]);else{for(var w=e;w<t;w++)this.paintVertexArray.emplace(w,i,l);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(l))}},St.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},St.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},St.prototype.setUniform=function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,l=ze(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(l)},St.prototype.getBinding=function(e,t,i){return new Ue(e,t)};var Dt=function(e,t,i,l,h,f){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=l,this.layerId=f,this.zoomInPaintVertexArray=new h,this.zoomOutPaintVertexArray=new h};Dt.prototype.populatePaintArray=function(e,t,i){var l=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(l,e,t.patterns&&t.patterns[this.layerId],i)},Dt.prototype.updatePaintArray=function(e,t,i,l,h){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],h)},Dt.prototype._setPaintValues=function(e,t,i,l){if(l&&i){var h=l[i.min],f=l[i.mid],y=l[i.max];if(h&&f&&y)for(var w=e;w<t;w++)this.zoomInPaintVertexArray.emplace(w,f.tl[0],f.tl[1],f.br[0],f.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1],f.pixelRatio,h.pixelRatio),this.zoomOutPaintVertexArray.emplace(w,f.tl[0],f.tl[1],f.br[0],f.br[1],y.tl[0],y.tl[1],y.br[0],y.br[1],f.pixelRatio,y.pixelRatio)}},Dt.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,J.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,J.members,this.expression.isStateDependent))},Dt.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var bt=function(e,t,i){this.binders={},this._buffers=[];var l=[];for(var h in e.paint._values)if(i(h)){var f=e.paint.get(h);if(f instanceof Hr&&qn(f.property.specification)){var y=zi(h,e.type),w=f.value,I=f.property.specification.type,k=f.property.useIntegerZoom,P=f.property.specification["property-type"],D=P==="cross-faded"||P==="cross-faded-data-driven";if(w.kind==="constant")this.binders[h]=D?new Ot(w.value,y):new zt(w.value,y,I),l.push("/u_"+h);else if(w.kind==="source"||D){var B=ui(h,I,"source");this.binders[h]=D?new Dt(w,I,k,t,B,e.id):new Et(w,y,I,B),l.push("/a_"+h)}else{var U=ui(h,I,"composite");this.binders[h]=new St(w,y,I,k,t,U),l.push("/z_"+h)}}}this.cacheKey=l.sort().join("")};bt.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Et||t instanceof St?t.maxValue:0},bt.prototype.populatePaintArrays=function(e,t,i,l,h){for(var f in this.binders){var y=this.binders[f];(y instanceof Et||y instanceof St||y instanceof Dt)&&y.populatePaintArray(e,t,i,l,h)}},bt.prototype.setConstantPatternPositions=function(e,t){for(var i in this.binders){var l=this.binders[i];l instanceof Ot&&l.setConstantPatternPositions(e,t)}},bt.prototype.updatePaintArrays=function(e,t,i,l,h){var f=!1;for(var y in e)for(var w=0,I=t.getPositions(y);w<I.length;w+=1){var k=I[w],P=i.feature(k.index);for(var D in this.binders){var B=this.binders[D];if((B instanceof Et||B instanceof St||B instanceof Dt)&&B.expression.isStateDependent===!0){var U=l.paint.get(D);B.expression=U.value,B.updatePaintArray(k.start,k.end,P,e[y],h),f=!0}}}return f},bt.prototype.defines=function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof zt||i instanceof Ot)&&e.push.apply(e,i.uniformNames.map(function(l){return"#define HAS_UNIFORM_"+l}))}return e},bt.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Et||i instanceof St)for(var l=0;l<i.paintVertexAttributes.length;l++)e.push(i.paintVertexAttributes[l].name);else if(i instanceof Dt)for(var h=0;h<J.members.length;h++)e.push(J.members[h].name)}return e},bt.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof zt||i instanceof Ot||i instanceof St)for(var l=0,h=i.uniformNames;l<h.length;l+=1)e.push(h[l])}return e},bt.prototype.getPaintVertexBuffers=function(){return this._buffers},bt.prototype.getUniforms=function(e,t){var i=[];for(var l in this.binders){var h=this.binders[l];if(h instanceof zt||h instanceof Ot||h instanceof St)for(var f=0,y=h.uniformNames;f<y.length;f+=1){var w=y[f];if(t[w]){var I=h.getBinding(e,t[w],w);i.push({name:w,property:l,binding:I})}}}return i},bt.prototype.setUniforms=function(e,t,i,l){for(var h=0,f=t;h<f.length;h+=1){var y=f[h],w=y.name,I=y.property;this.binders[I].setUniform(y.binding,l,i.get(I),w)}},bt.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof Dt){var l=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;l&&this._buffers.push(l)}else(i instanceof Et||i instanceof St)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},bt.prototype.upload=function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof Et||i instanceof St||i instanceof Dt)&&i.upload(e)}this.updatePaintBuffers()},bt.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Et||t instanceof St||t instanceof Dt)&&t.destroy()}};var wt=function(e,t,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var l=0,h=e;l<h.length;l+=1){var f=h[l];this.programConfigurations[f.id]=new bt(f,t,i)}this.needsUpload=!1,this._featureMap=new he,this._bufferOffset=0};function zi(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function ui(e,t,i){var l={color:{source:ha,composite:pa},number:{source:Da,composite:ha}},h=function(f){return{"line-pattern":{source:nn,composite:nn},"fill-pattern":{source:nn,composite:nn},"fill-extrusion-pattern":{source:nn,composite:nn}}[f]}(e);return h&&h[i]||l[t][i]}wt.prototype.populatePaintArrays=function(e,t,i,l,h,f){for(var y in this.programConfigurations)this.programConfigurations[y].populatePaintArrays(e,t,l,h,f);t.id!==void 0&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},wt.prototype.updatePaintArrays=function(e,t,i,l){for(var h=0,f=i;h<f.length;h+=1){var y=f[h];this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(e,this._featureMap,t,y,l)||this.needsUpload}},wt.prototype.get=function(e){return this.programConfigurations[e]},wt.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},wt.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},$e("ConstantBinder",zt),$e("CrossFadedConstantBinder",Ot),$e("SourceExpressionBinder",Et),$e("CrossFadedCompositeBinder",Dt),$e("CompositeExpressionBinder",St),$e("ProgramConfiguration",bt,{omit:["_buffers"]}),$e("ProgramConfigurationSet",wt);var on=Math.pow(2,14)-1,ji=-on-1;function Rr(e){for(var t=8192/e.extent,i=e.loadGeometry(),l=0;l<i.length;l++)for(var h=i[l],f=0;f<h.length;f++){var y=h[f],w=Math.round(y.x*t),I=Math.round(y.y*t);y.x=ze(w,ji,on),y.y=ze(I,ji,on),(w<y.x||w>y.x+1||I<y.y||I>y.y+1)&&It("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function ci(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Rr(e):[]}}function Cn(e,t,i,l,h){e.emplaceBack(2*t+(l+1)/2,2*i+(h+1)/2)}var Mn=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Uo,this.indexArray=new es,this.segments=new q,this.programConfigurations=new wt(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function ts(e,t){for(var i=0;i<e.length;i++)if(fa(t,e[i]))return!0;for(var l=0;l<t.length;l++)if(fa(e,t[l]))return!0;return!!Xs(e,t)}function Dn(e,t,i){return!!fa(e,t)||!!_s(t,e,i)}function Zo(e,t){if(e.length===1)return Ws(t,e[0]);for(var i=0;i<t.length;i++)for(var l=t[i],h=0;h<l.length;h++)if(fa(e,l[h]))return!0;for(var f=0;f<e.length;f++)if(Ws(t,e[f]))return!0;for(var y=0;y<t.length;y++)if(Xs(e,t[y]))return!0;return!1}function yn(e,t,i){if(e.length>1){if(Xs(e,t))return!0;for(var l=0;l<t.length;l++)if(_s(t[l],e,i))return!0}for(var h=0;h<e.length;h++)if(_s(e[h],t,i))return!0;return!1}function Xs(e,t){if(e.length===0||t.length===0)return!1;for(var i=0;i<e.length-1;i++)for(var l=e[i],h=e[i+1],f=0;f<t.length-1;f++)if(gs(l,h,t[f],t[f+1]))return!0;return!1}function gs(e,t,i,l){return rr(e,i,l)!==rr(t,i,l)&&rr(e,t,i)!==rr(e,t,l)}function _s(e,t,i){var l=i*i;if(t.length===1)return e.distSqr(t[0])<l;for(var h=1;h<t.length;h++)if(Ps(e,t[h-1],t[h])<l)return!0;return!1}function Ps(e,t,i){var l=t.distSqr(i);if(l===0)return e.distSqr(t);var h=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/l;return e.distSqr(h<0?t:h>1?i:i.sub(t)._mult(h)._add(t))}function Ws(e,t){for(var i,l,h,f=!1,y=0;y<e.length;y++)for(var w=0,I=(i=e[y]).length-1;w<i.length;I=w++)(l=i[w]).y>t.y!=(h=i[I]).y>t.y&&t.x<(h.x-l.x)*(t.y-l.y)/(h.y-l.y)+l.x&&(f=!f);return f}function fa(e,t){for(var i=!1,l=0,h=e.length-1;l<e.length;h=l++){var f=e[l],y=e[h];f.y>t.y!=y.y>t.y&&t.x<(y.x-f.x)*(t.y-f.y)/(y.y-f.y)+f.x&&(i=!i)}return i}function Cs(e,t,i){var l=i[0],h=i[2];if(e.x<l.x&&t.x<l.x||e.x>h.x&&t.x>h.x||e.y<l.y&&t.y<l.y||e.y>h.y&&t.y>h.y)return!1;var f=rr(e,t,i[0]);return f!==rr(e,t,i[1])||f!==rr(e,t,i[2])||f!==rr(e,t,i[3])}function Go(e,t,i){var l=t.paint.get(e).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(e)}function ti(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function La(e,t,i,l,h){if(!t[0]&&!t[1])return e;var f=N.convert(t)._mult(h);i==="viewport"&&f._rotate(-l);for(var y=[],w=0;w<e.length;w++)y.push(e[w].sub(f));return y}Mn.prototype.populate=function(e,t,i){var l=this.layers[0],h=[],f=null;l.type==="circle"&&(f=l.layout.get("circle-sort-key"));for(var y=0,w=e;y<w.length;y+=1){var I=w[y],k=I.feature,P=I.id,D=I.index,B=I.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,$=ci(k,U);if(this.layers[0]._featureFilter.filter(new Yt(this.zoom),$,i)){var te=f?f.evaluate($,{},i):void 0,ue={id:P,properties:k.properties,type:k.type,sourceLayerIndex:B,index:D,geometry:U?$.geometry:Rr(k),patterns:{},sortKey:te};h.push(ue)}}f&&h.sort(function(We,gt){return We.sortKey-gt.sortKey});for(var ne=0,de=h;ne<de.length;ne+=1){var ge=de[ne],xe=ge.geometry,Ee=ge.index,Me=ge.sourceLayerIndex,Fe=e[Ee].feature;this.addFeature(ge,xe,Ee,i),t.featureIndex.insert(Fe,xe,Ee,Me,this.index)}},Mn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Mn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Mn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Mn.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,j),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Mn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Mn.prototype.addFeature=function(e,t,i,l){for(var h=0,f=t;h<f.length;h+=1)for(var y=0,w=f[h];y<w.length;y+=1){var I=w[y],k=I.x,P=I.y;if(!(k<0||k>=8192||P<0||P>=8192)){var D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),B=D.vertexLength;Cn(this.layoutVertexArray,k,P,-1,-1),Cn(this.layoutVertexArray,k,P,1,-1),Cn(this.layoutVertexArray,k,P,1,1),Cn(this.layoutVertexArray,k,P,-1,1),this.indexArray.emplaceBack(B,B+1,B+2),this.indexArray.emplaceBack(B,B+3,B+2),D.vertexLength+=4,D.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},l)},$e("CircleBucket",Mn,{omit:["layers"]});var Ra=new Ur({"circle-sort-key":new ot(F.layout_circle["circle-sort-key"])}),Ms={paint:new Ur({"circle-radius":new ot(F.paint_circle["circle-radius"]),"circle-color":new ot(F.paint_circle["circle-color"]),"circle-blur":new ot(F.paint_circle["circle-blur"]),"circle-opacity":new ot(F.paint_circle["circle-opacity"]),"circle-translate":new Pe(F.paint_circle["circle-translate"]),"circle-translate-anchor":new Pe(F.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Pe(F.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Pe(F.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ot(F.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ot(F.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ot(F.paint_circle["circle-stroke-opacity"])}),layout:Ra},pr=typeof Float32Array<"u"?Float32Array:Array;function po(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ln(e,t,i){var l=t[0],h=t[1],f=t[2],y=t[3],w=t[4],I=t[5],k=t[6],P=t[7],D=t[8],B=t[9],U=t[10],$=t[11],te=t[12],ue=t[13],ne=t[14],de=t[15],ge=i[0],xe=i[1],Ee=i[2],Me=i[3];return e[0]=ge*l+xe*w+Ee*D+Me*te,e[1]=ge*h+xe*I+Ee*B+Me*ue,e[2]=ge*f+xe*k+Ee*U+Me*ne,e[3]=ge*y+xe*P+Ee*$+Me*de,e[4]=(ge=i[4])*l+(xe=i[5])*w+(Ee=i[6])*D+(Me=i[7])*te,e[5]=ge*h+xe*I+Ee*B+Me*ue,e[6]=ge*f+xe*k+Ee*U+Me*ne,e[7]=ge*y+xe*P+Ee*$+Me*de,e[8]=(ge=i[8])*l+(xe=i[9])*w+(Ee=i[10])*D+(Me=i[11])*te,e[9]=ge*h+xe*I+Ee*B+Me*ue,e[10]=ge*f+xe*k+Ee*U+Me*ne,e[11]=ge*y+xe*P+Ee*$+Me*de,e[12]=(ge=i[12])*l+(xe=i[13])*w+(Ee=i[14])*D+(Me=i[15])*te,e[13]=ge*h+xe*I+Ee*B+Me*ue,e[14]=ge*f+xe*k+Ee*U+Me*ne,e[15]=ge*y+xe*P+Ee*$+Me*de,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,i=arguments.length;i--;)t+=e[i]*e[i];return Math.sqrt(t)});var Ko,vu=Ln;function Hs(e,t,i){var l=t[0],h=t[1],f=t[2],y=t[3];return e[0]=i[0]*l+i[4]*h+i[8]*f+i[12]*y,e[1]=i[1]*l+i[5]*h+i[9]*f+i[13]*y,e[2]=i[2]*l+i[6]*h+i[10]*f+i[14]*y,e[3]=i[3]*l+i[7]*h+i[11]*f+i[15]*y,e}Ko=new pr(3),pr!=Float32Array&&(Ko[0]=0,Ko[1]=0,Ko[2]=0),function(){var e=new pr(4);pr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Ju=(function(){var e=new pr(2);pr!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(i){e.call(this,i,Ms)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Mn(i)},t.prototype.queryRadius=function(i){var l=i;return Go("circle-radius",this,l)+Go("circle-stroke-width",this,l)+ti(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(i,l,h,f,y,w,I,k){for(var P=La(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),w.angle,I),D=this.paint.get("circle-radius").evaluate(l,h)+this.paint.get("circle-stroke-width").evaluate(l,h),B=this.paint.get("circle-pitch-alignment")==="map",U=B?P:function(Fe,We){return Fe.map(function(gt){return Js(gt,We)})}(P,k),$=B?D*I:D,te=0,ue=f;te<ue.length;te+=1)for(var ne=0,de=ue[te];ne<de.length;ne+=1){var ge=de[ne],xe=B?ge:Js(ge,k),Ee=$,Me=Hs([],[ge.x,ge.y,0,1],k);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ee*=Me[3]/w.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ee*=w.cameraToCenterDistance/Me[3]),Dn(U,xe,Ee))return!0}return!1},t}(Pn));function Js(e,t){var i=Hs([],[e.x,e.y,0,1],t);return new N(i[0]/i[3],i[1]/i[3])}var ru=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Mn);function da(e,t,i,l){var h=t.width,f=t.height;if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==h*f*i)throw new RangeError("mismatched image size")}else l=new Uint8Array(h*f*i);return e.width=h,e.height=f,e.data=l,e}function gl(e,t,i){var l=t.width,h=t.height;if(l!==e.width||h!==e.height){var f=da({},{width:l,height:h},i);iu(e,f,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,l),height:Math.min(e.height,h)},i),e.width=l,e.height=h,e.data=f.data}}function iu(e,t,i,l,h,f){if(h.width===0||h.height===0)return t;if(h.width>e.width||h.height>e.height||i.x>e.width-h.width||i.y>e.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||l.x>t.width-h.width||l.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");for(var y=e.data,w=t.data,I=0;I<h.height;I++)for(var k=((i.y+I)*e.width+i.x)*f,P=((l.y+I)*t.width+l.x)*f,D=0;D<h.width*f;D++)w[P+D]=y[k+D];return t}$e("HeatmapBucket",ru,{omit:["layers"]});var _l=function(e,t){da(this,e,1,t)};_l.prototype.resize=function(e){gl(this,e,1)},_l.prototype.clone=function(){return new _l({width:this.width,height:this.height},new Uint8Array(this.data))},_l.copy=function(e,t,i,l,h){iu(e,t,i,l,h,1)};var Wn=function(e,t){da(this,e,4,t)};Wn.prototype.resize=function(e){gl(this,e,4)},Wn.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Wn.prototype.clone=function(){return new Wn({width:this.width,height:this.height},new Uint8Array(this.data))},Wn.copy=function(e,t,i,l,h){iu(e,t,i,l,h,4)},$e("AlphaImage",_l),$e("RGBAImage",Wn);var Zc={paint:new Ur({"heatmap-radius":new ot(F.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ot(F.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Pe(F.paint_heatmap["heatmap-intensity"]),"heatmap-color":new mn(F.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Pe(F.paint_heatmap["heatmap-opacity"])})};function Yu(e){var t={},i=e.resolution||256,l=e.clips?e.clips.length:1,h=e.image||new Wn({width:i,height:l}),f=function($,te,ue){t[e.evaluationKey]=ue;var ne=e.expression.evaluate(t);h.data[$+te+0]=Math.floor(255*ne.r/ne.a),h.data[$+te+1]=Math.floor(255*ne.g/ne.a),h.data[$+te+2]=Math.floor(255*ne.b/ne.a),h.data[$+te+3]=Math.floor(255*ne.a)};if(e.clips)for(var y=0,w=0;y<l;++y,w+=4*i)for(var I=0,k=0;I<i;I++,k+=4){var P=I/(i-1),D=e.clips[y];f(w,k,D.start*(1-P)+D.end*P)}else for(var B=0,U=0;B<i;B++,U+=4)f(0,U,B/(i-1));return h}var $m=function(e){function t(i){e.call(this,i,Zc),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new ru(i)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Yu({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Pn),ey={paint:new Ur({"hillshade-illumination-direction":new Pe(F.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Pe(F.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Pe(F.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Pe(F.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Pe(F.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Pe(F.paint_hillshade["hillshade-accent-color"])})},ty=function(e){function t(i){e.call(this,i,ey)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Pn),ry=ei([{name:"a_pos",components:2,type:"Int16"}],4).members,Hh=Gc,iy=Gc;function Gc(e,t,i){i=i||2;var l,h,f,y,w,I,k,P=t&&t.length,D=P?t[0]*i:e.length,B=Jp(e,0,D,i,!0),U=[];if(!B||B.next===B.prev)return U;if(P&&(B=function(te,ue,ne,de){var ge,xe,Ee,Me=[];for(ge=0,xe=ue.length;ge<xe;ge++)(Ee=Jp(te,ue[ge]*de,ge<xe-1?ue[ge+1]*de:te.length,de,!1))===Ee.next&&(Ee.steiner=!0),Me.push(hy(Ee));for(Me.sort(ly),ge=0;ge<Me.length;ge++)uy(Me[ge],ne),ne=ql(ne,ne.next);return ne}(e,t,B,i)),e.length>80*i){l=f=e[0],h=y=e[1];for(var $=i;$<D;$+=i)(w=e[$])<l&&(l=w),(I=e[$+1])<h&&(h=I),w>f&&(f=w),I>y&&(y=I);k=(k=Math.max(f-l,y-h))!==0?1/k:0}return Qu(B,U,i,l,h,k),U}function Jp(e,t,i,l,h){var f,y;if(h===Qh(e,t,i,l)>0)for(f=t;f<i;f+=l)y=$p(f,e[f],e[f+1],y);else for(f=i-l;f>=t;f-=l)y=$p(f,e[f],e[f+1],y);return y&&Kc(y,y.next)&&(ec(y),y=y.next),y}function ql(e,t){if(!e)return e;t||(t=e);var i,l=e;do if(i=!1,l.steiner||!Kc(l,l.next)&&Xi(l.prev,l,l.next)!==0)l=l.next;else{if(ec(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function Qu(e,t,i,l,h,f,y){if(e){!y&&f&&function(P,D,B,U){var $=P;do $.z===null&&($.z=Jh($.x,$.y,D,B,U)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==P);$.prevZ.nextZ=null,$.prevZ=null,function(te){var ue,ne,de,ge,xe,Ee,Me,Fe,We=1;do{for(ne=te,te=null,xe=null,Ee=0;ne;){for(Ee++,de=ne,Me=0,ue=0;ue<We&&(Me++,de=de.nextZ);ue++);for(Fe=We;Me>0||Fe>0&&de;)Me!==0&&(Fe===0||!de||ne.z<=de.z)?(ge=ne,ne=ne.nextZ,Me--):(ge=de,de=de.nextZ,Fe--),xe?xe.nextZ=ge:te=ge,ge.prevZ=xe,xe=ge;ne=de}xe.nextZ=null,We*=2}while(Ee>1)}($)}(e,l,h,f);for(var w,I,k=e;e.prev!==e.next;)if(w=e.prev,I=e.next,f?oy(e,l,h,f):ny(e))t.push(w.i/i),t.push(e.i/i),t.push(I.i/i),ec(e),e=I.next,k=I.next;else if((e=I)===k){y?y===1?Qu(e=ay(ql(e),t,i),t,i,l,h,f,2):y===2&&sy(e,t,i,l,h,f):Qu(ql(e),t,i,l,h,f,1);break}}}function ny(e){var t=e.prev,i=e,l=e.next;if(Xi(t,i,l)>=0)return!1;for(var h=e.next.next;h!==e.prev;){if(xu(t.x,t.y,i.x,i.y,l.x,l.y,h.x,h.y)&&Xi(h.prev,h,h.next)>=0)return!1;h=h.next}return!0}function oy(e,t,i,l){var h=e.prev,f=e,y=e.next;if(Xi(h,f,y)>=0)return!1;for(var w=h.x>f.x?h.x>y.x?h.x:y.x:f.x>y.x?f.x:y.x,I=h.y>f.y?h.y>y.y?h.y:y.y:f.y>y.y?f.y:y.y,k=Jh(h.x<f.x?h.x<y.x?h.x:y.x:f.x<y.x?f.x:y.x,h.y<f.y?h.y<y.y?h.y:y.y:f.y<y.y?f.y:y.y,t,i,l),P=Jh(w,I,t,i,l),D=e.prevZ,B=e.nextZ;D&&D.z>=k&&B&&B.z<=P;){if(D!==e.prev&&D!==e.next&&xu(h.x,h.y,f.x,f.y,y.x,y.y,D.x,D.y)&&Xi(D.prev,D,D.next)>=0||(D=D.prevZ,B!==e.prev&&B!==e.next&&xu(h.x,h.y,f.x,f.y,y.x,y.y,B.x,B.y)&&Xi(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;D&&D.z>=k;){if(D!==e.prev&&D!==e.next&&xu(h.x,h.y,f.x,f.y,y.x,y.y,D.x,D.y)&&Xi(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;B&&B.z<=P;){if(B!==e.prev&&B!==e.next&&xu(h.x,h.y,f.x,f.y,y.x,y.y,B.x,B.y)&&Xi(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function ay(e,t,i){var l=e;do{var h=l.prev,f=l.next.next;!Kc(h,f)&&Yp(h,l,l.next,f)&&$u(h,f)&&$u(f,h)&&(t.push(h.i/i),t.push(l.i/i),t.push(f.i/i),ec(l),ec(l.next),l=e=f),l=l.next}while(l!==e);return ql(l)}function sy(e,t,i,l,h,f){var y=e;do{for(var w=y.next.next;w!==y.prev;){if(y.i!==w.i&&py(y,w)){var I=Qp(y,w);return y=ql(y,y.next),I=ql(I,I.next),Qu(y,t,i,l,h,f),void Qu(I,t,i,l,h,f)}w=w.next}y=y.next}while(y!==e)}function ly(e,t){return e.x-t.x}function uy(e,t){if(t=function(l,h){var f,y=h,w=l.x,I=l.y,k=-1/0;do{if(I<=y.y&&I>=y.next.y&&y.next.y!==y.y){var P=y.x+(I-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(P<=w&&P>k){if(k=P,P===w){if(I===y.y)return y;if(I===y.next.y)return y.next}f=y.x<y.next.x?y:y.next}}y=y.next}while(y!==h);if(!f)return null;if(w===k)return f;var D,B=f,U=f.x,$=f.y,te=1/0;y=f;do w>=y.x&&y.x>=U&&w!==y.x&&xu(I<$?w:k,I,U,$,I<$?k:w,I,y.x,y.y)&&(D=Math.abs(I-y.y)/(w-y.x),$u(y,l)&&(D<te||D===te&&(y.x>f.x||y.x===f.x&&cy(f,y)))&&(f=y,te=D)),y=y.next;while(y!==B);return f}(e,t)){var i=Qp(t,e);ql(t,t.next),ql(i,i.next)}}function cy(e,t){return Xi(e.prev,e,t.prev)<0&&Xi(t.next,e,e.next)<0}function Jh(e,t,i,l,h){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*h)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-l)*h)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function hy(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function xu(e,t,i,l,h,f,y,w){return(h-y)*(t-w)-(e-y)*(f-w)>=0&&(e-y)*(l-w)-(i-y)*(t-w)>=0&&(i-y)*(f-w)-(h-y)*(l-w)>=0}function py(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(i,l){var h=i;do{if(h.i!==i.i&&h.next.i!==i.i&&h.i!==l.i&&h.next.i!==l.i&&Yp(h,h.next,i,l))return!0;h=h.next}while(h!==i);return!1}(e,t)&&($u(e,t)&&$u(t,e)&&function(i,l){var h=i,f=!1,y=(i.x+l.x)/2,w=(i.y+l.y)/2;do h.y>w!=h.next.y>w&&h.next.y!==h.y&&y<(h.next.x-h.x)*(w-h.y)/(h.next.y-h.y)+h.x&&(f=!f),h=h.next;while(h!==i);return f}(e,t)&&(Xi(e.prev,e,t.prev)||Xi(e,t.prev,t))||Kc(e,t)&&Xi(e.prev,e,e.next)>0&&Xi(t.prev,t,t.next)>0)}function Xi(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Kc(e,t){return e.x===t.x&&e.y===t.y}function Yp(e,t,i,l){var h=Wc(Xi(e,t,i)),f=Wc(Xi(e,t,l)),y=Wc(Xi(i,l,e)),w=Wc(Xi(i,l,t));return h!==f&&y!==w||!(h!==0||!Xc(e,i,t))||!(f!==0||!Xc(e,l,t))||!(y!==0||!Xc(i,e,l))||!(w!==0||!Xc(i,t,l))}function Xc(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Wc(e){return e>0?1:e<0?-1:0}function $u(e,t){return Xi(e.prev,e,e.next)<0?Xi(e,t,e.next)>=0&&Xi(e,e.prev,t)>=0:Xi(e,t,e.prev)<0||Xi(e,e.next,t)<0}function Qp(e,t){var i=new Yh(e.i,e.x,e.y),l=new Yh(t.i,t.x,t.y),h=e.next,f=t.prev;return e.next=t,t.prev=e,i.next=h,h.prev=i,l.next=i,i.prev=l,f.next=l,l.prev=f,l}function $p(e,t,i,l){var h=new Yh(e,t,i);return l?(h.next=l.next,h.prev=l,l.next.prev=h,l.next=h):(h.prev=h,h.next=h),h}function ec(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Yh(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Qh(e,t,i,l){for(var h=0,f=t,y=i-l;f<i;f+=l)h+=(e[y]-e[f])*(e[f+1]+e[y+1]),y=f;return h}function fy(e,t,i,l,h){(function f(y,w,I,k,P){for(;k>I;){if(k-I>600){var D=k-I+1,B=w-I+1,U=Math.log(D),$=.5*Math.exp(2*U/3),te=.5*Math.sqrt(U*$*(D-$)/D)*(B-D/2<0?-1:1);f(y,w,Math.max(I,Math.floor(w-B*$/D+te)),Math.min(k,Math.floor(w+(D-B)*$/D+te)),P)}var ue=y[w],ne=I,de=k;for(tc(y,I,w),P(y[k],ue)>0&&tc(y,I,k);ne<de;){for(tc(y,ne,de),ne++,de--;P(y[ne],ue)<0;)ne++;for(;P(y[de],ue)>0;)de--}P(y[I],ue)===0?tc(y,I,de):tc(y,++de,k),de<=w&&(I=de+1),w<=de&&(k=de-1)}})(e,t,i||0,l||e.length-1,h||dy)}function tc(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}function dy(e,t){return e<t?-1:e>t?1:0}function $h(e,t){var i=e.length;if(i<=1)return[e];for(var l,h,f=[],y=0;y<i;y++){var w=it(e[y]);w!==0&&(e[y].area=Math.abs(w),h===void 0&&(h=w<0),h===w<0?(l&&f.push(l),l=[e[y]]):l.push(e[y]))}if(l&&f.push(l),t>1)for(var I=0;I<f.length;I++)f[I].length<=t||(fy(f[I],t,1,f[I].length-1,my),f[I]=f[I].slice(0,t));return f}function my(e,t){return t.area-e.area}function ep(e,t,i){for(var l=i.patternDependencies,h=!1,f=0,y=t;f<y.length;f+=1){var w=y[f].paint.get(e+"-pattern");w.isConstant()||(h=!0);var I=w.constantOr(null);I&&(h=!0,l[I.to]=!0,l[I.from]=!0)}return h}function tp(e,t,i,l,h){for(var f=h.patternDependencies,y=0,w=t;y<w.length;y+=1){var I=w[y],k=I.paint.get(e+"-pattern").value;if(k.kind!=="constant"){var P=k.evaluate({zoom:l-1},i,{},h.availableImages),D=k.evaluate({zoom:l},i,{},h.availableImages),B=k.evaluate({zoom:l+1},i,{},h.availableImages);D=D&&D.name?D.name:D,B=B&&B.name?B.name:B,f[P=P&&P.name?P.name:P]=!0,f[D]=!0,f[B]=!0,i.patterns[I.id]={min:P,mid:D,max:B}}}return i}Gc.deviation=function(e,t,i,l){var h=t&&t.length,f=Math.abs(Qh(e,0,h?t[0]*i:e.length,i));if(h)for(var y=0,w=t.length;y<w;y++)f-=Math.abs(Qh(e,t[y]*i,y<w-1?t[y+1]*i:e.length,i));var I=0;for(y=0;y<l.length;y+=3){var k=l[y]*i,P=l[y+1]*i,D=l[y+2]*i;I+=Math.abs((e[k]-e[D])*(e[P+1]-e[k+1])-(e[k]-e[P])*(e[D+1]-e[k+1]))}return f===0&&I===0?0:Math.abs((I-f)/f)},Gc.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,h=0;h<e.length;h++){for(var f=0;f<e[h].length;f++)for(var y=0;y<t;y++)i.vertices.push(e[h][f][y]);h>0&&i.holes.push(l+=e[h-1].length)}return i},Hh.default=iy;var Ds=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Uo,this.indexArray=new es,this.indexArray2=new Ks,this.programConfigurations=new wt(e.layers,e.zoom),this.segments=new q,this.segments2=new q,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Ds.prototype.populate=function(e,t,i){this.hasPattern=ep("fill",this.layers,t);for(var l=this.layers[0].layout.get("fill-sort-key"),h=[],f=0,y=e;f<y.length;f+=1){var w=y[f],I=w.feature,k=w.id,P=w.index,D=w.sourceLayerIndex,B=this.layers[0]._featureFilter.needGeometry,U=ci(I,B);if(this.layers[0]._featureFilter.filter(new Yt(this.zoom),U,i)){var $=l?l.evaluate(U,{},i,t.availableImages):void 0,te={id:k,properties:I.properties,type:I.type,sourceLayerIndex:D,index:P,geometry:B?U.geometry:Rr(I),patterns:{},sortKey:$};h.push(te)}}l&&h.sort(function(Fe,We){return Fe.sortKey-We.sortKey});for(var ue=0,ne=h;ue<ne.length;ue+=1){var de=ne[ue],ge=de.geometry,xe=de.index,Ee=de.sourceLayerIndex;if(this.hasPattern){var Me=tp("fill",this.layers,de,this.zoom,t);this.patternFeatures.push(Me)}else this.addFeature(de,ge,xe,i,{});t.featureIndex.insert(e[xe].feature,ge,xe,Ee,this.index)}},Ds.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ds.prototype.addFeatures=function(e,t,i){for(var l=0,h=this.patternFeatures;l<h.length;l+=1){var f=h[l];this.addFeature(f,f.geometry,f.index,t,i)}},Ds.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ds.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ds.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ry),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Ds.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ds.prototype.addFeature=function(e,t,i,l,h){for(var f=0,y=$h(t,500);f<y.length;f+=1){for(var w=y[f],I=0,k=0,P=w;k<P.length;k+=1)I+=P[k].length;for(var D=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),B=D.vertexLength,U=[],$=[],te=0,ue=w;te<ue.length;te+=1){var ne=ue[te];if(ne.length!==0){ne!==w[0]&&$.push(U.length/2);var de=this.segments2.prepareSegment(ne.length,this.layoutVertexArray,this.indexArray2),ge=de.vertexLength;this.layoutVertexArray.emplaceBack(ne[0].x,ne[0].y),this.indexArray2.emplaceBack(ge+ne.length-1,ge),U.push(ne[0].x),U.push(ne[0].y);for(var xe=1;xe<ne.length;xe++)this.layoutVertexArray.emplaceBack(ne[xe].x,ne[xe].y),this.indexArray2.emplaceBack(ge+xe-1,ge+xe),U.push(ne[xe].x),U.push(ne[xe].y);de.vertexLength+=ne.length,de.primitiveLength+=ne.length}}for(var Ee=Hh(U,$),Me=0;Me<Ee.length;Me+=3)this.indexArray.emplaceBack(B+Ee[Me],B+Ee[Me+1],B+Ee[Me+2]);D.vertexLength+=I,D.primitiveLength+=Ee.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,h,l)},$e("FillBucket",Ds,{omit:["layers","patternFeatures"]});var yy=new Ur({"fill-sort-key":new ot(F.layout_fill["fill-sort-key"])}),gy={paint:new Ur({"fill-antialias":new Pe(F.paint_fill["fill-antialias"]),"fill-opacity":new ot(F.paint_fill["fill-opacity"]),"fill-color":new ot(F.paint_fill["fill-color"]),"fill-outline-color":new ot(F.paint_fill["fill-outline-color"]),"fill-translate":new Pe(F.paint_fill["fill-translate"]),"fill-translate-anchor":new Pe(F.paint_fill["fill-translate-anchor"]),"fill-pattern":new co(F.paint_fill["fill-pattern"])}),layout:yy},_y=function(e){function t(i){e.call(this,i,gy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l);var h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(i){return new Ds(i)},t.prototype.queryRadius=function(){return ti(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(i,l,h,f,y,w,I){return Zo(La(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),w.angle,I),f)},t.prototype.isTileClipped=function(){return!0},t}(Pn),vy=ei([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,ef=bu;function bu(e,t,i,l,h){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=l,this._values=h,e.readFields(xy,this,t)}function xy(e,t,i){e==1?t.id=i.readVarint():e==2?function(l,h){for(var f=l.readVarint()+l.pos;l.pos<f;){var y=h._keys[l.readVarint()],w=h._values[l.readVarint()];h.properties[y]=w}}(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function by(e){for(var t,i,l=0,h=0,f=e.length,y=f-1;h<f;y=h++)l+=((i=e[y]).x-(t=e[h]).x)*(t.y+i.y);return l}bu.types=["Unknown","Point","LineString","Polygon"],bu.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,l=1,h=0,f=0,y=0,w=[];e.pos<i;){if(h<=0){var I=e.readVarint();l=7&I,h=I>>3}if(h--,l===1||l===2)f+=e.readSVarint(),y+=e.readSVarint(),l===1&&(t&&w.push(t),t=[]),t.push(new N(f,y));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&w.push(t),w},bu.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,l=0,h=0,f=0,y=1/0,w=-1/0,I=1/0,k=-1/0;e.pos<t;){if(l<=0){var P=e.readVarint();i=7&P,l=P>>3}if(l--,i===1||i===2)(h+=e.readSVarint())<y&&(y=h),h>w&&(w=h),(f+=e.readSVarint())<I&&(I=f),f>k&&(k=f);else if(i!==7)throw new Error("unknown command "+i)}return[y,I,w,k]},bu.prototype.toGeoJSON=function(e,t,i){var l,h,f=this.extent*Math.pow(2,i),y=this.extent*e,w=this.extent*t,I=this.loadGeometry(),k=bu.types[this.type];function P(U){for(var $=0;$<U.length;$++){var te=U[$];U[$]=[360*(te.x+y)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(te.y+w)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var D=[];for(l=0;l<I.length;l++)D[l]=I[l][0];P(I=D);break;case 2:for(l=0;l<I.length;l++)P(I[l]);break;case 3:for(I=function(U){var $=U.length;if($<=1)return[U];for(var te,ue,ne=[],de=0;de<$;de++){var ge=by(U[de]);ge!==0&&(ue===void 0&&(ue=ge<0),ue===ge<0?(te&&ne.push(te),te=[U[de]]):te.push(U[de]))}return te&&ne.push(te),ne}(I),l=0;l<I.length;l++)for(h=0;h<I[l].length;h++)P(I[l][h])}I.length===1?I=I[0]:k="Multi"+k;var B={type:"Feature",geometry:{type:k,coordinates:I},properties:this.properties};return"id"in this&&(B.id=this.id),B};var tf=rf;function rf(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(wy,this,t),this.length=this._features.length}function wy(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(function(l){for(var h=null,f=l.readVarint()+l.pos;l.pos<f;){var y=l.readVarint()>>3;h=y===1?l.readString():y===2?l.readFloat():y===3?l.readDouble():y===4?l.readVarint64():y===5?l.readVarint():y===6?l.readSVarint():y===7?l.readBoolean():null}return h}(i))}function Sy(e,t,i){if(e===3){var l=new tf(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}rf.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new ef(this._pbf,t,this.extent,this._keys,this._values)};var wu={VectorTile:function(e,t){this.layers=e.readFields(Sy,{},t)},VectorTileFeature:ef,VectorTileLayer:tf},Ey=wu.VectorTileFeature.types,rp=Math.pow(2,13);function rc(e,t,i,l,h,f,y,w){e.emplaceBack(t,i,2*Math.floor(l*rp)+y,h*rp*2,f*rp*2,Math.round(w))}var Ls=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ma,this.indexArray=new es,this.programConfigurations=new wt(e.layers,e.zoom),this.segments=new q,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Ty(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Ls.prototype.populate=function(e,t,i){this.features=[],this.hasPattern=ep("fill-extrusion",this.layers,t);for(var l=0,h=e;l<h.length;l+=1){var f=h[l],y=f.feature,w=f.id,I=f.index,k=f.sourceLayerIndex,P=this.layers[0]._featureFilter.needGeometry,D=ci(y,P);if(this.layers[0]._featureFilter.filter(new Yt(this.zoom),D,i)){var B={id:w,sourceLayerIndex:k,index:I,geometry:P?D.geometry:Rr(y),properties:y.properties,type:y.type,patterns:{}};this.hasPattern?this.features.push(tp("fill-extrusion",this.layers,B,this.zoom,t)):this.addFeature(B,B.geometry,I,i,{}),t.featureIndex.insert(y,B.geometry,I,k,this.index,!0)}}},Ls.prototype.addFeatures=function(e,t,i){for(var l=0,h=this.features;l<h.length;l+=1){var f=h[l];this.addFeature(f,f.geometry,f.index,t,i)}},Ls.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ls.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ls.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ls.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,vy),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ls.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ls.prototype.addFeature=function(e,t,i,l,h){for(var f=0,y=$h(t,500);f<y.length;f+=1){for(var w=y[f],I=0,k=0,P=w;k<P.length;k+=1)I+=P[k].length;for(var D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),B=0,U=w;B<U.length;B+=1){var $=U[B];if($.length!==0&&!(($t=$).every(function(Nt){return Nt.x<0})||$t.every(function(Nt){return Nt.x>8192})||$t.every(function(Nt){return Nt.y<0})||$t.every(function(Nt){return Nt.y>8192})))for(var te=0,ue=0;ue<$.length;ue++){var ne=$[ue];if(ue>=1){var de=$[ue-1];if(!Ty(ne,de)){D.vertexLength+4>q.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var ge=ne.sub(de)._perp()._unit(),xe=de.dist(ne);te+xe>32768&&(te=0),rc(this.layoutVertexArray,ne.x,ne.y,ge.x,ge.y,0,0,te),rc(this.layoutVertexArray,ne.x,ne.y,ge.x,ge.y,0,1,te),rc(this.layoutVertexArray,de.x,de.y,ge.x,ge.y,0,0,te+=xe),rc(this.layoutVertexArray,de.x,de.y,ge.x,ge.y,0,1,te);var Ee=D.vertexLength;this.indexArray.emplaceBack(Ee,Ee+2,Ee+1),this.indexArray.emplaceBack(Ee+1,Ee+2,Ee+3),D.vertexLength+=4,D.primitiveLength+=2}}}}if(D.vertexLength+I>q.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),Ey[e.type]==="Polygon"){for(var Me=[],Fe=[],We=D.vertexLength,gt=0,st=w;gt<st.length;gt+=1){var vt=st[gt];if(vt.length!==0){vt!==w[0]&&Fe.push(Me.length/2);for(var lt=0;lt<vt.length;lt++){var Xt=vt[lt];rc(this.layoutVertexArray,Xt.x,Xt.y,0,0,1,1,0),Me.push(Xt.x),Me.push(Xt.y)}}}for(var Tt=Hh(Me,Fe),ct=0;ct<Tt.length;ct+=3)this.indexArray.emplaceBack(We+Tt[ct],We+Tt[ct+2],We+Tt[ct+1]);D.primitiveLength+=Tt.length/3,D.vertexLength+=I}}var $t;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,h,l)},$e("FillExtrusionBucket",Ls,{omit:["layers","features"]});var Iy={paint:new Ur({"fill-extrusion-opacity":new Pe(F["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ot(F["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Pe(F["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Pe(F["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new co(F["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ot(F["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ot(F["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Pe(F["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},ky=function(e){function t(i){e.call(this,i,Iy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Ls(i)},t.prototype.queryRadius=function(){return ti(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,l,h,f,y,w,I,k){var P=La(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),w.angle,I),D=this.paint.get("fill-extrusion-height").evaluate(l,h),B=this.paint.get("fill-extrusion-base").evaluate(l,h),U=function(te,ue,ne,de){for(var ge=[],xe=0,Ee=te;xe<Ee.length;xe+=1){var Me=Ee[xe],Fe=[Me.x,Me.y,0,1];Hs(Fe,Fe,ue),ge.push(new N(Fe[0]/Fe[3],Fe[1]/Fe[3]))}return ge}(P,k),$=function(te,ue,ne,de){for(var ge=[],xe=[],Ee=de[8]*ue,Me=de[9]*ue,Fe=de[10]*ue,We=de[11]*ue,gt=de[8]*ne,st=de[9]*ne,vt=de[10]*ne,lt=de[11]*ne,Xt=0,Tt=te;Xt<Tt.length;Xt+=1){for(var ct=[],$t=[],Nt=0,ur=Tt[Xt];Nt<ur.length;Nt+=1){var xt=ur[Nt],yr=xt.x,ii=xt.y,Ai=de[0]*yr+de[4]*ii+de[12],vi=de[1]*yr+de[5]*ii+de[13],ni=de[2]*yr+de[6]*ii+de[14],Pi=de[3]*yr+de[7]*ii+de[15],an=ni+Fe,sn=Pi+We,mo=Ai+gt,_n=vi+st,yo=ni+vt,Oi=Pi+lt,vn=new N((Ai+Ee)/sn,(vi+Me)/sn);vn.z=an/sn,ct.push(vn);var nr=new N(mo/Oi,_n/Oi);nr.z=yo/Oi,$t.push(nr)}ge.push(ct),xe.push($t)}return[ge,xe]}(f,B,D,k);return function(te,ue,ne){var de=1/0;Zo(ne,ue)&&(de=nf(ne,ue[0]));for(var ge=0;ge<ue.length;ge++)for(var xe=ue[ge],Ee=te[ge],Me=0;Me<xe.length-1;Me++){var Fe=xe[Me],We=[Fe,xe[Me+1],Ee[Me+1],Ee[Me],Fe];ts(ne,We)&&(de=Math.min(de,nf(ne,We)))}return de!==1/0&&de}($[0],$[1],U)},t}(Pn);function ic(e,t){return e.x*t.x+e.y*t.y}function nf(e,t){if(e.length===1){for(var i,l=0,h=t[l++];!i||h.equals(i);)if(!(i=t[l++]))return 1/0;for(;l<t.length;l++){var f=t[l],y=e[0],w=i.sub(h),I=f.sub(h),k=y.sub(h),P=ic(w,w),D=ic(w,I),B=ic(I,I),U=ic(k,w),$=ic(k,I),te=P*B-D*D,ue=(B*U-D*$)/te,ne=(P*$-D*U)/te,de=h.z*(1-ue-ne)+i.z*ue+f.z*ne;if(isFinite(de))return de}return 1/0}for(var ge=1/0,xe=0,Ee=t;xe<Ee.length;xe+=1)ge=Math.min(ge,Ee[xe].z);return ge}var zy=ei([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Ay=ei([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Py=wu.VectorTileFeature.types,Cy=Math.cos(Math.PI/180*37.5),of=Math.pow(2,14)/.5,Ao=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){t.gradients[i.id]={}}),this.layoutVertexArray=new Xn,this.layoutVertexArray2=new ha,this.indexArray=new es,this.programConfigurations=new wt(e.layers,e.zoom),this.segments=new q,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};Ao.prototype.populate=function(e,t,i){this.hasPattern=ep("line",this.layers,t);for(var l=this.layers[0].layout.get("line-sort-key"),h=[],f=0,y=e;f<y.length;f+=1){var w=y[f],I=w.feature,k=w.id,P=w.index,D=w.sourceLayerIndex,B=this.layers[0]._featureFilter.needGeometry,U=ci(I,B);if(this.layers[0]._featureFilter.filter(new Yt(this.zoom),U,i)){var $=l?l.evaluate(U,{},i):void 0,te={id:k,properties:I.properties,type:I.type,sourceLayerIndex:D,index:P,geometry:B?U.geometry:Rr(I),patterns:{},sortKey:$};h.push(te)}}l&&h.sort(function(Fe,We){return Fe.sortKey-We.sortKey});for(var ue=0,ne=h;ue<ne.length;ue+=1){var de=ne[ue],ge=de.geometry,xe=de.index,Ee=de.sourceLayerIndex;if(this.hasPattern){var Me=tp("line",this.layers,de,this.zoom,t);this.patternFeatures.push(Me)}else this.addFeature(de,ge,xe,i,{});t.featureIndex.insert(e[xe].feature,ge,xe,Ee,this.index)}},Ao.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ao.prototype.addFeatures=function(e,t,i){for(var l=0,h=this.patternFeatures;l<h.length;l+=1){var f=h[l];this.addFeature(f,f.geometry,f.index,t,i)}},Ao.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ao.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ao.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Ay)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,zy),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ao.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ao.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Ao.prototype.addFeature=function(e,t,i,l,h){var f=this.layers[0].layout,y=f.get("line-join").evaluate(e,{}),w=f.get("line-cap"),I=f.get("line-miter-limit"),k=f.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var P=0,D=t;P<D.length;P+=1)this.addLine(D[P],e,y,w,I,k);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,h,l)},Ao.prototype.addLine=function(e,t,i,l,h,f){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var y=0;y<e.length-1;y++)this.totalDistance+=e[y].dist(e[y+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var w=Py[t.type]==="Polygon",I=e.length;I>=2&&e[I-1].equals(e[I-2]);)I--;for(var k=0;k<I-1&&e[k].equals(e[k+1]);)k++;if(!(I<(w?3:2))){i==="bevel"&&(h=1.05);var P,D=this.overscaling<=16?122880/(512*this.overscaling):0,B=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray),U=void 0,$=void 0,te=void 0,ue=void 0;this.e1=this.e2=-1,w&&(ue=e[k].sub(P=e[I-2])._unit()._perp());for(var ne=k;ne<I;ne++)if(!($=ne===I-1?w?e[k+1]:void 0:e[ne+1])||!e[ne].equals($)){ue&&(te=ue),P&&(U=P),P=e[ne],ue=$?$.sub(P)._unit()._perp():te;var de=(te=te||ue).add(ue);de.x===0&&de.y===0||de._unit();var ge=te.x*ue.x+te.y*ue.y,xe=de.x*ue.x+de.y*ue.y,Ee=xe!==0?1/xe:1/0,Me=2*Math.sqrt(2-2*xe),Fe=xe<Cy&&U&&$,We=te.x*ue.y-te.y*ue.x>0;if(Fe&&ne>k){var gt=P.dist(U);if(gt>2*D){var st=P.sub(P.sub(U)._mult(D/gt)._round());this.updateDistance(U,st),this.addCurrentVertex(st,te,0,0,B),U=st}}var vt=U&&$,lt=vt?i:w?"butt":l;if(vt&&lt==="round"&&(Ee<f?lt="miter":Ee<=2&&(lt="fakeround")),lt==="miter"&&Ee>h&&(lt="bevel"),lt==="bevel"&&(Ee>2&&(lt="flipbevel"),Ee<h&&(lt="miter")),U&&this.updateDistance(U,P),lt==="miter")de._mult(Ee),this.addCurrentVertex(P,de,0,0,B);else if(lt==="flipbevel"){if(Ee>100)de=ue.mult(-1);else{var Xt=Ee*te.add(ue).mag()/te.sub(ue).mag();de._perp()._mult(Xt*(We?-1:1))}this.addCurrentVertex(P,de,0,0,B),this.addCurrentVertex(P,de.mult(-1),0,0,B)}else if(lt==="bevel"||lt==="fakeround"){var Tt=-Math.sqrt(Ee*Ee-1),ct=We?Tt:0,$t=We?0:Tt;if(U&&this.addCurrentVertex(P,te,ct,$t,B),lt==="fakeround")for(var Nt=Math.round(180*Me/Math.PI/20),ur=1;ur<Nt;ur++){var xt=ur/Nt;if(xt!==.5){var yr=xt-.5;xt+=xt*yr*(xt-1)*((1.0904+ge*(ge*(3.55645-1.43519*ge)-3.2452))*yr*yr+(.848013+ge*(.215638*ge-1.06021)))}var ii=ue.sub(te)._mult(xt)._add(te)._unit()._mult(We?-1:1);this.addHalfVertex(P,ii.x,ii.y,!1,We,0,B)}$&&this.addCurrentVertex(P,ue,-ct,-$t,B)}else if(lt==="butt")this.addCurrentVertex(P,de,0,0,B);else if(lt==="square"){var Ai=U?1:-1;this.addCurrentVertex(P,de,Ai,Ai,B)}else lt==="round"&&(U&&(this.addCurrentVertex(P,te,0,0,B),this.addCurrentVertex(P,te,1,1,B,!0)),$&&(this.addCurrentVertex(P,ue,-1,-1,B,!0),this.addCurrentVertex(P,ue,0,0,B)));if(Fe&&ne<I-1){var vi=P.dist($);if(vi>2*D){var ni=P.add($.sub(P)._mult(D/vi)._round());this.updateDistance(P,ni),this.addCurrentVertex(ni,ue,0,0,B),P=ni}}}}},Ao.prototype.addCurrentVertex=function(e,t,i,l,h,f){f===void 0&&(f=!1);var y=t.y*l-t.x,w=-t.y-t.x*l;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,f,!1,i,h),this.addHalfVertex(e,y,w,f,!0,-l,h),this.distance>of/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,i,l,h,f))},Ao.prototype.addHalfVertex=function(e,t,i,l,h,f,y){var w=.5*(this.lineClips?this.scaledDistance*(of-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(l?1:0),(e.y<<1)+(h?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(f===0?0:f<0?-1:1)|(63&w)<<2,w>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var I=y.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),y.primitiveLength++),h?this.e2=I:this.e1=I},Ao.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Ao.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},$e("LineBucket",Ao,{omit:["layers","patternFeatures"]});var My=new Ur({"line-cap":new Pe(F.layout_line["line-cap"]),"line-join":new ot(F.layout_line["line-join"]),"line-miter-limit":new Pe(F.layout_line["line-miter-limit"]),"line-round-limit":new Pe(F.layout_line["line-round-limit"]),"line-sort-key":new ot(F.layout_line["line-sort-key"])}),af={paint:new Ur({"line-opacity":new ot(F.paint_line["line-opacity"]),"line-color":new ot(F.paint_line["line-color"]),"line-translate":new Pe(F.paint_line["line-translate"]),"line-translate-anchor":new Pe(F.paint_line["line-translate-anchor"]),"line-width":new ot(F.paint_line["line-width"]),"line-gap-width":new ot(F.paint_line["line-gap-width"]),"line-offset":new ot(F.paint_line["line-offset"]),"line-blur":new ot(F.paint_line["line-blur"]),"line-dasharray":new Bi(F.paint_line["line-dasharray"]),"line-pattern":new co(F.paint_line["line-pattern"]),"line-gradient":new mn(F.paint_line["line-gradient"])}),layout:My},sf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l){return l=new Yt(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),e.prototype.possiblyEvaluate.call(this,i,l)},t.prototype.evaluate=function(i,l,h,f){return l=Xe({},l,{zoom:Math.floor(l.zoom)}),e.prototype.evaluate.call(this,i,l,h,f)},t}(ot))(af.paint.properties["line-width"].specification);sf.useIntegerZoom=!0;var Dy=function(e){function t(i){e.call(this,i,af),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Tn,this.gradientVersion=(this.gradientVersion+1)%H)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l),this.paint._values["line-floorwidth"]=sf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},t.prototype.createBucket=function(i){return new Ao(i)},t.prototype.queryRadius=function(i){var l=i,h=lf(Go("line-width",this,l),Go("line-gap-width",this,l)),f=Go("line-offset",this,l);return h/2+Math.abs(f)+ti(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,l,h,f,y,w,I){var k=La(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),w.angle,I),P=I/2*lf(this.paint.get("line-width").evaluate(l,h),this.paint.get("line-gap-width").evaluate(l,h)),D=this.paint.get("line-offset").evaluate(l,h);return D&&(f=function(B,U){for(var $=[],te=new N(0,0),ue=0;ue<B.length;ue++){for(var ne=B[ue],de=[],ge=0;ge<ne.length;ge++){var xe=ne[ge],Ee=ne[ge+1],Me=ge===0?te:xe.sub(ne[ge-1])._unit()._perp(),Fe=ge===ne.length-1?te:Ee.sub(xe)._unit()._perp(),We=Me._add(Fe)._unit();We._mult(1/(We.x*Fe.x+We.y*Fe.y)),de.push(We._mult(U)._add(xe))}$.push(de)}return $}(f,D*I)),function(B,U,$){for(var te=0;te<U.length;te++){var ue=U[te];if(B.length>=3){for(var ne=0;ne<ue.length;ne++)if(fa(B,ue[ne]))return!0}if(yn(B,ue,$))return!0}return!1}(k,f,P)},t.prototype.isTileClipped=function(){return!0},t}(Pn);function lf(e,t){return t>0?t+2*e:e}var Ly=ei([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ry=ei([{name:"a_projected_pos",components:3,type:"Float32"}],4),By=(ei([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),ei([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),uf=(ei([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),ei([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Oy=ei([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Fy(e,t,i){return e.sections.forEach(function(l){l.text=function(h,f,y){var w=f.layout.get("text-transform").evaluate(y,{});return w==="uppercase"?h=h.toLocaleUpperCase():w==="lowercase"&&(h=h.toLocaleLowerCase()),Zr.applyArabicShaping&&(h=Zr.applyArabicShaping(h)),h}(l.text,t,i)}),e}ei([{name:"triangle",components:3,type:"Uint16"}]),ei([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ei([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ei([{type:"Float32",name:"offsetX"}]),ei([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var nc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},cf=function(e,t,i,l,h){var f,y,w=8*h-l-1,I=(1<<w)-1,k=I>>1,P=-7,D=i?h-1:0,B=i?-1:1,U=e[t+D];for(D+=B,f=U&(1<<-P)-1,U>>=-P,P+=w;P>0;f=256*f+e[t+D],D+=B,P-=8);for(y=f&(1<<-P)-1,f>>=-P,P+=l;P>0;y=256*y+e[t+D],D+=B,P-=8);if(f===0)f=1-k;else{if(f===I)return y?NaN:1/0*(U?-1:1);y+=Math.pow(2,l),f-=k}return(U?-1:1)*y*Math.pow(2,f-l)},hf=function(e,t,i,l,h,f){var y,w,I,k=8*f-h-1,P=(1<<k)-1,D=P>>1,B=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,U=l?0:f-1,$=l?1:-1,te=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(w=isNaN(t)?1:0,y=P):(y=Math.floor(Math.log(t)/Math.LN2),t*(I=Math.pow(2,-y))<1&&(y--,I*=2),(t+=y+D>=1?B/I:B*Math.pow(2,1-D))*I>=2&&(y++,I/=2),y+D>=P?(w=0,y=P):y+D>=1?(w=(t*I-1)*Math.pow(2,h),y+=D):(w=t*Math.pow(2,D-1)*Math.pow(2,h),y=0));h>=8;e[i+U]=255&w,U+=$,w/=256,h-=8);for(y=y<<h|w,k+=h;k>0;e[i+U]=255&y,U+=$,y/=256,k-=8);e[i+U-$]|=128*te},Hc=Kr;function Kr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Kr.Varint=0,Kr.Fixed64=1,Kr.Bytes=2,Kr.Fixed32=5;var pf=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function vl(e){return e.type===Kr.Bytes?e.readVarint()+e.pos:e.pos+1}function Su(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function ff(e,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var h=i.pos-1;h>=e;h--)i.buf[h+l]=i.buf[h]}function Vy(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function Ny(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function Uy(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function jy(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function qy(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function Zy(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function Gy(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function Ky(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function Xy(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Jc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Eu(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function df(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Wy(e,t,i){e===1&&i.readMessage(Hy,t)}function Hy(e,t,i){if(e===3){var l=i.readMessage(Jy,{}),h=l.width,f=l.height,y=l.left,w=l.top,I=l.advance;t.push({id:l.id,bitmap:new _l({width:h+6,height:f+6},l.bitmap),metrics:{width:h,height:f,left:y,top:w,advance:I}})}}function Jy(e,t,i){e===1?t.id=i.readVarint():e===2?t.bitmap=i.readBytes():e===3?t.width=i.readVarint():e===4?t.height=i.readVarint():e===5?t.left=i.readSVarint():e===6?t.top=i.readSVarint():e===7&&(t.advance=i.readVarint())}function mf(e){for(var t=0,i=0,l=0,h=e;l<h.length;l+=1){var f=h[l];t+=f.w*f.h,i=Math.max(i,f.w)}e.sort(function(te,ue){return ue.h-te.h});for(var y=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}],w=0,I=0,k=0,P=e;k<P.length;k+=1)for(var D=P[k],B=y.length-1;B>=0;B--){var U=y[B];if(!(D.w>U.w||D.h>U.h)){if(D.x=U.x,D.y=U.y,I=Math.max(I,D.y+D.h),w=Math.max(w,D.x+D.w),D.w===U.w&&D.h===U.h){var $=y.pop();B<y.length&&(y[B]=$)}else D.h===U.h?(U.x+=D.w,U.w-=D.w):D.w===U.w?(U.y+=D.h,U.h-=D.h):(y.push({x:U.x+D.w,y:U.y,w:U.w-D.w,h:D.h}),U.y+=D.h,U.h-=D.h);break}}return{w,h:I,fill:t/(w*I)||0}}Kr.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),h=l>>3,f=this.pos;this.type=7&l,e(h,t,this),this.pos===f&&this.skip(l)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Jc(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=df(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Jc(this.buf,this.pos)+4294967296*Jc(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Jc(this.buf,this.pos)+4294967296*df(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=cf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=cf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(h,f,y){var w,I,k=y.buf;if(w=(112&(I=k[y.pos++]))>>4,I<128||(w|=(127&(I=k[y.pos++]))<<3,I<128)||(w|=(127&(I=k[y.pos++]))<<10,I<128)||(w|=(127&(I=k[y.pos++]))<<17,I<128)||(w|=(127&(I=k[y.pos++]))<<24,I<128)||(w|=(1&(I=k[y.pos++]))<<31,I<128))return Su(h,w,f);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&pf?function(i,l,h){return pf.decode(i.subarray(l,h))}(this.buf,t,e):function(i,l,h){for(var f="",y=l;y<h;){var w,I,k,P=i[y],D=null,B=P>239?4:P>223?3:P>191?2:1;if(y+B>h)break;B===1?P<128&&(D=P):B===2?(192&(w=i[y+1]))==128&&(D=(31&P)<<6|63&w)<=127&&(D=null):B===3?(I=i[y+2],(192&(w=i[y+1]))==128&&(192&I)==128&&((D=(15&P)<<12|(63&w)<<6|63&I)<=2047||D>=55296&&D<=57343)&&(D=null)):B===4&&(I=i[y+2],k=i[y+3],(192&(w=i[y+1]))==128&&(192&I)==128&&(192&k)==128&&((D=(15&P)<<18|(63&w)<<12|(63&I)<<6|63&k)<=65535||D>=1114112)&&(D=null)),D===null?(D=65533,B=1):D>65535&&(D-=65536,f+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),f+=String.fromCharCode(D),y+=B}return f}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Kr.Bytes)return e.push(this.readVarint(t));var i=vl(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Kr.Bytes)return e.push(this.readSVarint());var t=vl(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Kr.Bytes)return e.push(this.readBoolean());var t=vl(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Kr.Bytes)return e.push(this.readFloat());var t=vl(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Kr.Bytes)return e.push(this.readDouble());var t=vl(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Kr.Bytes)return e.push(this.readFixed32());var t=vl(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Kr.Bytes)return e.push(this.readSFixed32());var t=vl(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Kr.Bytes)return e.push(this.readFixed64());var t=vl(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Kr.Bytes)return e.push(this.readSFixed64());var t=vl(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Kr.Varint)for(;this.buf[this.pos++]>127;);else if(t===Kr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Kr.Fixed32)this.pos+=4;else{if(t!==Kr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Eu(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Eu(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Eu(this.buf,-1&e,this.pos),Eu(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Eu(this.buf,-1&e,this.pos),Eu(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,i){var l,h;if(t>=0?(l=t%4294967296|0,h=t/4294967296|0):(h=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,h=h+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(f,y,w){w.buf[w.pos++]=127&f|128,f>>>=7,w.buf[w.pos++]=127&f|128,f>>>=7,w.buf[w.pos++]=127&f|128,f>>>=7,w.buf[w.pos++]=127&f|128,w.buf[w.pos]=127&(f>>>=7)}(l,0,i),function(f,y){var w=(7&f)<<4;y.buf[y.pos++]|=w|((f>>>=3)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f)))))}(h,i)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(l,h,f){for(var y,w,I=0;I<h.length;I++){if((y=h.charCodeAt(I))>55295&&y<57344){if(!w){y>56319||I+1===h.length?(l[f++]=239,l[f++]=191,l[f++]=189):w=y;continue}if(y<56320){l[f++]=239,l[f++]=191,l[f++]=189,w=y;continue}y=w-55296<<10|y-56320|65536,w=null}else w&&(l[f++]=239,l[f++]=191,l[f++]=189,w=null);y<128?l[f++]=y:(y<2048?l[f++]=y>>6|192:(y<65536?l[f++]=y>>12|224:(l[f++]=y>>18|240,l[f++]=y>>12&63|128),l[f++]=y>>6&63|128),l[f++]=63&y|128)}return f}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&ff(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),hf(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),hf(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var l=this.pos-i;l>=128&&ff(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(e,t,i){this.writeTag(e,Kr.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Vy,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Ny,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,qy,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Uy,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,jy,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,Zy,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Gy,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Ky,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Xy,t)},writeBytesField:function(e,t){this.writeTag(e,Kr.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Kr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Kr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Kr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Kr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Kr.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Kr.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Kr.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Kr.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Kr.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var Yc=function(e,t){var i=t.pixelRatio,l=t.version,h=t.stretchX,f=t.stretchY,y=t.content;this.paddedRect=e,this.pixelRatio=i,this.stretchX=h,this.stretchY=f,this.content=y,this.version=l},oc={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};oc.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},oc.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},oc.tlbr.get=function(){return this.tl.concat(this.br)},oc.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Yc.prototype,oc);var ac=function(e,t){var i={},l={};this.haveRenderCallbacks=[];var h=[];this.addImages(e,i,h),this.addImages(t,l,h);var f=mf(h),y=new Wn({width:f.w||1,height:f.h||1});for(var w in e){var I=e[w],k=i[w].paddedRect;Wn.copy(I.data,y,{x:0,y:0},{x:k.x+1,y:k.y+1},I.data)}for(var P in t){var D=t[P],B=l[P].paddedRect,U=B.x+1,$=B.y+1,te=D.data.width,ue=D.data.height;Wn.copy(D.data,y,{x:0,y:0},{x:U,y:$},D.data),Wn.copy(D.data,y,{x:0,y:ue-1},{x:U,y:$-1},{width:te,height:1}),Wn.copy(D.data,y,{x:0,y:0},{x:U,y:$+ue},{width:te,height:1}),Wn.copy(D.data,y,{x:te-1,y:0},{x:U-1,y:$},{width:1,height:ue}),Wn.copy(D.data,y,{x:0,y:0},{x:U+te,y:$},{width:1,height:ue})}this.image=y,this.iconPositions=i,this.patternPositions=l};ac.prototype.addImages=function(e,t,i){for(var l in e){var h=e[l],f={x:0,y:0,w:h.data.width+2,h:h.data.height+2};i.push(f),t[l]=new Yc(f,h),h.hasRenderCallback&&this.haveRenderCallbacks.push(l)}},ac.prototype.patchUpdatedImages=function(e,t){for(var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)},ac.prototype.patchUpdatedImage=function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var l=e.tl;i.update(t.data,void 0,{x:l[0],y:l[1]})}},$e("ImagePosition",Yc),$e("ImageAtlas",ac);var Ba={horizontal:1,vertical:2,horizontalOnly:3},Tu=function(){this.scale=1,this.fontStack="",this.imageName=null};Tu.forText=function(e,t){var i=new Tu;return i.scale=e||1,i.fontStack=t,i},Tu.forImage=function(e){var t=new Tu;return t.imageName=e,t};var fo=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Qc(e,t,i,l,h,f,y,w,I,k,P,D,B,U,$,te){var ue,ne=fo.fromFeature(e,h);D===Ba.vertical&&ne.verticalizePunctuation();var de=Zr.processBidirectionalText,ge=Zr.processStyledBidirectionalText;if(de&&ne.sections.length===1){ue=[];for(var xe=0,Ee=de(ne.toString(),ip(ne,k,f,t,l,U,$));xe<Ee.length;xe+=1){var Me=Ee[xe],Fe=new fo;Fe.text=Me,Fe.sections=ne.sections;for(var We=0;We<Me.length;We++)Fe.sectionIndex.push(0);ue.push(Fe)}}else if(ge){ue=[];for(var gt=0,st=ge(ne.text,ne.sectionIndex,ip(ne,k,f,t,l,U,$));gt<st.length;gt+=1){var vt=st[gt],lt=new fo;lt.text=vt[0],lt.sectionIndex=vt[1],lt.sections=ne.sections,ue.push(lt)}}else ue=function(ct,$t){for(var Nt=[],ur=ct.text,xt=0,yr=0,ii=$t;yr<ii.length;yr+=1){var Ai=ii[yr];Nt.push(ct.substring(xt,Ai)),xt=Ai}return xt<ur.length&&Nt.push(ct.substring(xt,ur.length)),Nt}(ne,ip(ne,k,f,t,l,U,$));var Xt=[],Tt={positionedLines:Xt,text:ne.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:D,iconsInText:!1,verticalizable:!1};return function(ct,$t,Nt,ur,xt,yr,ii,Ai,vi,ni,Pi,an){for(var sn=0,mo=-17,_n=0,yo=0,Oi=Ai==="right"?1:Ai==="left"?0:.5,vn=0,nr=0,jr=xt;nr<jr.length;nr+=1){var Mr=jr[nr];Mr.trim();var fr=Mr.getMaxScale(),Po=24*(fr-1),Hn={positionedGlyphs:[],lineOffset:0};ct.positionedLines[vn]=Hn;var Jr=Hn.positionedGlyphs,qi=0;if(Mr.length()){for(var Jn=0;Jn<Mr.length();Jn++){var gr=Mr.getSection(Jn),Ys=Mr.getSectionIndex(Jn),Oa=Mr.getCharCode(Jn),Qs=0,Fi=null,$s=null,vs=null,Du=24,su=!(vi===Ba.horizontal||!Pi&&!Pa(Oa)||Pi&&($c[Oa]||(Sl=Oa,Ye.Arabic(Sl)||Ye["Arabic Supplement"](Sl)||Ye["Arabic Extended-A"](Sl)||Ye["Arabic Presentation Forms-A"](Sl)||Ye["Arabic Presentation Forms-B"](Sl))));if(gr.imageName){var Lu=ur[gr.imageName];if(!Lu)continue;vs=gr.imageName,ct.iconsInText=ct.iconsInText||!0,$s=Lu.paddedRect;var wl=Lu.displaySize;gr.scale=24*gr.scale/an,Qs=Po+(24-wl[1]*gr.scale),Du=(Fi={width:wl[0],height:wl[1],left:1,top:-3,advance:su?wl[1]:wl[0]}).advance;var Ru=su?wl[0]*gr.scale-24*fr:wl[1]*gr.scale-24*fr;Ru>0&&Ru>qi&&(qi=Ru)}else{var lh=Nt[gr.fontStack],Bu=lh&&lh[Oa];if(Bu&&Bu.rect)$s=Bu.rect,Fi=Bu.metrics;else{var uc=$t[gr.fontStack],uh=uc&&uc[Oa];if(!uh)continue;Fi=uh.metrics}Qs=24*(fr-gr.scale)}su?(ct.verticalizable=!0,Jr.push({glyph:Oa,imageName:vs,x:sn,y:mo+Qs,vertical:su,scale:gr.scale,fontStack:gr.fontStack,sectionIndex:Ys,metrics:Fi,rect:$s}),sn+=Du*gr.scale+ni):(Jr.push({glyph:Oa,imageName:vs,x:sn,y:mo+Qs,vertical:su,scale:gr.scale,fontStack:gr.fontStack,sectionIndex:Ys,metrics:Fi,rect:$s}),sn+=Fi.advance*gr.scale+ni)}Jr.length!==0&&(_n=Math.max(sn-ni,_n),Qy(Jr,0,Jr.length-1,Oi,qi)),sn=0;var ch=yr*fr+qi;Hn.lineOffset=Math.max(qi,Po),mo+=ch,yo=Math.max(ch,yo),++vn}else mo+=yr,++vn}var Sl,cc=mo- -17,Ou=np(ii),Gl=Ou.horizontalAlign,Fu=Ou.verticalAlign;(function(hh,ph,hc,pc,fh,fc,dc,mc,dh){var Vu,mh=(ph-hc)*fh;Vu=fc!==dc?-mc*pc- -17:(-pc*dh+.5)*dc;for(var Nu=0,yc=hh;Nu<yc.length;Nu+=1)for(var lu=0,gc=yc[Nu].positionedGlyphs;lu<gc.length;lu+=1){var Uu=gc[lu];Uu.x+=mh,Uu.y+=Vu}})(ct.positionedLines,Oi,Gl,Fu,_n,yo,yr,cc,xt.length),ct.top+=-Fu*cc,ct.bottom=ct.top+cc,ct.left+=-Gl*_n,ct.right=ct.left+_n}(Tt,t,i,l,ue,y,w,I,D,k,B,te),!function(ct){for(var $t=0,Nt=ct;$t<Nt.length;$t+=1)if(Nt[$t].positionedGlyphs.length!==0)return!1;return!0}(Xt)&&Tt}fo.fromFeature=function(e,t){for(var i=new fo,l=0;l<e.sections.length;l++){var h=e.sections[l];h.image?i.addImageSection(h):i.addTextSection(h,t)}return i},fo.prototype.length=function(){return this.text.length},fo.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},fo.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},fo.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},fo.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",i=0;i<e.length;i++){var l=e.charCodeAt(i+1)||null,h=e.charCodeAt(i-1)||null;t+=l&&ds(l)&&!nc[e[i+1]]||h&&ds(h)&&!nc[e[i-1]]||!nc[e[i]]?e[i]:nc[e[i]]}return t}(this.text)},fo.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&$c[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,l=this.text.length-1;l>=0&&l>=e&&$c[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)},fo.prototype.substring=function(e,t){var i=new fo;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i},fo.prototype.toString=function(){return this.text},fo.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,i){return Math.max(t,e.sections[i].scale)},0)},fo.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(Tu.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,l=0;l<e.text.length;++l)this.sectionIndex.push(i)},fo.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(Tu.forImage(t)),this.sectionIndex.push(this.sections.length-1)):It("Reached maximum number of images 6401")}else It("Can't add FormattedSection with an empty image.")},fo.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var $c={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ma={};function yf(e,t,i,l,h,f){if(t.imageName){var y=l[t.imageName];return y?y.displaySize[0]*t.scale*24/f+h:0}var w=i[t.fontStack],I=w&&w[e];return I?I.metrics.advance*t.scale+h:0}function gf(e,t,i,l){var h=Math.pow(e-t,2);return l?e<t?h/2:2*h:h+Math.abs(i)*i}function Yy(e,t,i){var l=0;return e===10&&(l-=1e4),i&&(l+=150),e!==40&&e!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function _f(e,t,i,l,h,f){for(var y=null,w=gf(t,i,h,f),I=0,k=l;I<k.length;I+=1){var P=k[I],D=gf(t-P.x,i,h,f)+P.badness;D<=w&&(y=P,w=D)}return{index:e,x:t,priorBreak:y,badness:w}}function ip(e,t,i,l,h,f,y){if(f!=="point")return[];if(!e)return[];for(var w,I=[],k=function(ue,ne,de,ge,xe,Ee){for(var Me=0,Fe=0;Fe<ue.length();Fe++){var We=ue.getSection(Fe);Me+=yf(ue.getCharCode(Fe),We,ge,xe,ne,Ee)}return Me/Math.max(1,Math.ceil(Me/de))}(e,t,i,l,h,y),P=e.text.indexOf("\u200B")>=0,D=0,B=0;B<e.length();B++){var U=e.getSection(B),$=e.getCharCode(B);if($c[$]||(D+=yf($,U,l,h,t,y)),B<e.length()-1){var te=!((w=$)<11904||!(Ye["Bopomofo Extended"](w)||Ye.Bopomofo(w)||Ye["CJK Compatibility Forms"](w)||Ye["CJK Compatibility Ideographs"](w)||Ye["CJK Compatibility"](w)||Ye["CJK Radicals Supplement"](w)||Ye["CJK Strokes"](w)||Ye["CJK Symbols and Punctuation"](w)||Ye["CJK Unified Ideographs Extension A"](w)||Ye["CJK Unified Ideographs"](w)||Ye["Enclosed CJK Letters and Months"](w)||Ye["Halfwidth and Fullwidth Forms"](w)||Ye.Hiragana(w)||Ye["Ideographic Description Characters"](w)||Ye["Kangxi Radicals"](w)||Ye["Katakana Phonetic Extensions"](w)||Ye.Katakana(w)||Ye["Vertical Forms"](w)||Ye["Yi Radicals"](w)||Ye["Yi Syllables"](w)));(ma[$]||te||U.imageName)&&I.push(_f(B+1,D,k,I,Yy($,e.getCharCode(B+1),te&&P),!1))}}return function ue(ne){return ne?ue(ne.priorBreak).concat(ne.index):[]}(_f(e.length(),D,k,I,0,!0))}function np(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Qy(e,t,i,l,h){if(l||h)for(var f=e[i],y=(e[i].x+f.metrics.advance*f.scale)*l,w=t;w<=i;w++)e[w].x-=y,e[w].y+=h}function vf(e,t,i,l,h,f){var y,w=e.image;if(w.content){var I=w.content,k=w.pixelRatio||1;y=[I[0]/k,I[1]/k,w.displaySize[0]-I[2]/k,w.displaySize[1]-I[3]/k]}var P,D,B,U,$=t.left*f,te=t.right*f;i==="width"||i==="both"?(U=h[0]+$-l[3],D=h[0]+te+l[1]):D=(U=h[0]+($+te-w.displaySize[0])/2)+w.displaySize[0];var ue=t.top*f,ne=t.bottom*f;return i==="height"||i==="both"?(P=h[1]+ue-l[0],B=h[1]+ne+l[2]):B=(P=h[1]+(ue+ne-w.displaySize[1])/2)+w.displaySize[1],{image:w,top:P,right:D,bottom:B,left:U,collisionPadding:y}}ma[10]=!0,ma[32]=!0,ma[38]=!0,ma[40]=!0,ma[41]=!0,ma[43]=!0,ma[45]=!0,ma[47]=!0,ma[173]=!0,ma[183]=!0,ma[8203]=!0,ma[8208]=!0,ma[8211]=!0,ma[8231]=!0;var Iu=function(e){function t(i,l,h,f){e.call(this,i,l),this.angle=h,f!==void 0&&(this.segment=f)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(N);function op(e,t){var i=t.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new Yt(e+1))};if(i.kind==="source")return{kind:"source"};for(var l=i.zoomStops,h=i.interpolationType,f=0;f<l.length&&l[f]<=e;)f++;for(var y=f=Math.max(0,f-1);y<l.length&&l[y]<e+1;)y++;y=Math.min(l.length-1,y);var w=l[f],I=l[y];return i.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:I,interpolationType:h}:{kind:"camera",minZoom:w,maxZoom:I,minSize:i.evaluate(new Yt(w)),maxSize:i.evaluate(new Yt(I)),interpolationType:h}}function xf(e,t,i){var l=t.uSize,h=i.lowerSize;return e.kind==="source"?h/128:e.kind==="composite"?qr(h/128,i.upperSize/128,t.uSizeT):l}function bf(e,t){var i=0,l=0;if(e.kind==="constant")l=e.layoutSize;else if(e.kind!=="source"){var h=e.interpolationType,f=h?ze(_i.interpolationFactor(h,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?l=qr(e.minSize,e.maxSize,f):i=f}return{uSizeT:i,uSize:l}}$e("Anchor",Iu);var $y=Object.freeze({__proto__:null,getSizeData:op,evaluateSizeForFeature:xf,evaluateSizeForZoom:bf,SIZE_PACK_FACTOR:128});function wf(e,t,i,l,h){if(t.segment===void 0)return!0;for(var f=t,y=t.segment+1,w=0;w>-i/2;){if(--y<0)return!1;w-=e[y].dist(f),f=e[y]}w+=e[y].dist(e[y+1]),y++;for(var I=[],k=0;w<i/2;){var P=e[y],D=e[y+1];if(!D)return!1;var B=e[y-1].angleTo(P)-P.angleTo(D);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:w,angleDelta:B}),k+=B;w-I[0].distance>l;)k-=I.shift().angleDelta;if(k>h)return!1;y++,w+=P.dist(D)}return!0}function Sf(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function Ef(e,t,i){return e?.6*t*i:0}function Tf(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function eg(e,t,i,l,h,f){for(var y=Ef(i,h,f),w=Tf(i,l)*f,I=0,k=Sf(e)/2,P=0;P<e.length-1;P++){var D=e[P],B=e[P+1],U=D.dist(B);if(I+U>k){var $=(k-I)/U,te=qr(D.x,B.x,$),ue=qr(D.y,B.y,$),ne=new Iu(te,ue,B.angleTo(D),P);return ne._round(),!y||wf(e,ne,w,y,t)?ne:void 0}I+=U}}function tg(e,t,i,l,h,f,y,w,I){var k=Ef(l,f,y),P=Tf(l,h),D=P*y,B=e[0].x===0||e[0].x===I||e[0].y===0||e[0].y===I;return t-D<t/4&&(t=D+t/4),function U($,te,ue,ne,de,ge,xe,Ee,Me){for(var Fe=ge/2,We=Sf($),gt=0,st=te-ue,vt=[],lt=0;lt<$.length-1;lt++){for(var Xt=$[lt],Tt=$[lt+1],ct=Xt.dist(Tt),$t=Tt.angleTo(Xt);st+ue<gt+ct;){var Nt=((st+=ue)-gt)/ct,ur=qr(Xt.x,Tt.x,Nt),xt=qr(Xt.y,Tt.y,Nt);if(ur>=0&&ur<Me&&xt>=0&&xt<Me&&st-Fe>=0&&st+Fe<=We){var yr=new Iu(ur,xt,$t,lt);yr._round(),ne&&!wf($,yr,ge,ne,de)||vt.push(yr)}}gt+=ct}return Ee||vt.length||xe||(vt=U($,gt/2,ue,ne,de,ge,xe,!0,Me)),vt}(e,B?t/2*w%t:(P/2+2*f)*y*w%t,t,k,i,D,B,!1,I)}function If(e,t,i,l,h){for(var f=[],y=0;y<e.length;y++)for(var w=e[y],I=void 0,k=0;k<w.length-1;k++){var P=w[k],D=w[k+1];P.x<t&&D.x<t||(P.x<t?P=new N(t,P.y+(t-P.x)/(D.x-P.x)*(D.y-P.y))._round():D.x<t&&(D=new N(t,P.y+(t-P.x)/(D.x-P.x)*(D.y-P.y))._round()),P.y<i&&D.y<i||(P.y<i?P=new N(P.x+(i-P.y)/(D.y-P.y)*(D.x-P.x),i)._round():D.y<i&&(D=new N(P.x+(i-P.y)/(D.y-P.y)*(D.x-P.x),i)._round()),P.x>=l&&D.x>=l||(P.x>=l?P=new N(l,P.y+(l-P.x)/(D.x-P.x)*(D.y-P.y))._round():D.x>=l&&(D=new N(l,P.y+(l-P.x)/(D.x-P.x)*(D.y-P.y))._round()),P.y>=h&&D.y>=h||(P.y>=h?P=new N(P.x+(h-P.y)/(D.y-P.y)*(D.x-P.x),h)._round():D.y>=h&&(D=new N(P.x+(h-P.y)/(D.y-P.y)*(D.x-P.x),h)._round()),I&&P.equals(I[I.length-1])||f.push(I=[P]),I.push(D)))))}return f}function kf(e,t,i,l){var h=[],f=e.image,y=f.pixelRatio,w=f.paddedRect.w-2,I=f.paddedRect.h-2,k=e.right-e.left,P=e.bottom-e.top,D=f.stretchX||[[0,w]],B=f.stretchY||[[0,I]],U=function(ur,xt){return ur+xt[1]-xt[0]},$=D.reduce(U,0),te=B.reduce(U,0),ue=w-$,ne=I-te,de=0,ge=$,xe=0,Ee=te,Me=0,Fe=ue,We=0,gt=ne;if(f.content&&l){var st=f.content;de=eh(D,0,st[0]),xe=eh(B,0,st[1]),ge=eh(D,st[0],st[2]),Ee=eh(B,st[1],st[3]),Me=st[0]-de,We=st[1]-xe,Fe=st[2]-st[0]-ge,gt=st[3]-st[1]-Ee}var vt=function(ur,xt,yr,ii){var Ai=th(ur.stretch-de,ge,k,e.left),vi=rh(ur.fixed-Me,Fe,ur.stretch,$),ni=th(xt.stretch-xe,Ee,P,e.top),Pi=rh(xt.fixed-We,gt,xt.stretch,te),an=th(yr.stretch-de,ge,k,e.left),sn=rh(yr.fixed-Me,Fe,yr.stretch,$),mo=th(ii.stretch-xe,Ee,P,e.top),_n=rh(ii.fixed-We,gt,ii.stretch,te),yo=new N(Ai,ni),Oi=new N(an,ni),vn=new N(an,mo),nr=new N(Ai,mo),jr=new N(vi/y,Pi/y),Mr=new N(sn/y,_n/y),fr=t*Math.PI/180;if(fr){var Po=Math.sin(fr),Hn=Math.cos(fr),Jr=[Hn,-Po,Po,Hn];yo._matMult(Jr),Oi._matMult(Jr),nr._matMult(Jr),vn._matMult(Jr)}var qi=ur.stretch+ur.fixed,Jn=xt.stretch+xt.fixed;return{tl:yo,tr:Oi,bl:nr,br:vn,tex:{x:f.paddedRect.x+1+qi,y:f.paddedRect.y+1+Jn,w:yr.stretch+yr.fixed-qi,h:ii.stretch+ii.fixed-Jn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:jr,pixelOffsetBR:Mr,minFontScaleX:Fe/y/k,minFontScaleY:gt/y/P,isSDF:i}};if(l&&(f.stretchX||f.stretchY))for(var lt=zf(D,ue,$),Xt=zf(B,ne,te),Tt=0;Tt<lt.length-1;Tt++)for(var ct=lt[Tt],$t=lt[Tt+1],Nt=0;Nt<Xt.length-1;Nt++)h.push(vt(ct,Xt[Nt],$t,Xt[Nt+1]));else h.push(vt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:I+1}));return h}function eh(e,t,i){for(var l=0,h=0,f=e;h<f.length;h+=1){var y=f[h];l+=Math.max(t,Math.min(i,y[1]))-Math.max(t,Math.min(i,y[0]))}return l}function zf(e,t,i){for(var l=[{fixed:-1,stretch:0}],h=0,f=e;h<f.length;h+=1){var y=f[h],w=y[0],I=y[1],k=l[l.length-1];l.push({fixed:w-k.stretch,stretch:k.stretch}),l.push({fixed:w-k.stretch,stretch:k.stretch+(I-w)})}return l.push({fixed:t+1,stretch:i}),l}function th(e,t,i,l){return e/t*i+l}function rh(e,t,i,l){return e-t*i/l}var ih=function(e,t,i,l,h,f,y,w,I,k){if(this.boxStartIndex=e.length,I){var P=f.top,D=f.bottom,B=f.collisionPadding;B&&(P-=B[1],D+=B[3]);var U=D-P;U>0&&(U=Math.max(10,U),this.circleDiameter=U)}else{var $=f.top*y-w,te=f.bottom*y+w,ue=f.left*y-w,ne=f.right*y+w,de=f.collisionPadding;if(de&&(ue-=de[0]*y,$-=de[1]*y,ne+=de[2]*y,te+=de[3]*y),k){var ge=new N(ue,$),xe=new N(ne,$),Ee=new N(ue,te),Me=new N(ne,te),Fe=k*Math.PI/180;ge._rotate(Fe),xe._rotate(Fe),Ee._rotate(Fe),Me._rotate(Fe),ue=Math.min(ge.x,xe.x,Ee.x,Me.x),ne=Math.max(ge.x,xe.x,Ee.x,Me.x),$=Math.min(ge.y,xe.y,Ee.y,Me.y),te=Math.max(ge.y,xe.y,Ee.y,Me.y)}e.emplaceBack(t.x,t.y,ue,$,ne,te,i,l,h)}this.boxEndIndex=e.length},ku=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=rg),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function rg(e,t){return e<t?-1:e>t?1:0}function ig(e,t,i){t===void 0&&(t=1),i===void 0&&(i=!1);for(var l=1/0,h=1/0,f=-1/0,y=-1/0,w=e[0],I=0;I<w.length;I++){var k=w[I];(!I||k.x<l)&&(l=k.x),(!I||k.y<h)&&(h=k.y),(!I||k.x>f)&&(f=k.x),(!I||k.y>y)&&(y=k.y)}var P=Math.min(f-l,y-h),D=P/2,B=new ku([],ng);if(P===0)return new N(l,h);for(var U=l;U<f;U+=P)for(var $=h;$<y;$+=P)B.push(new zu(U+D,$+D,D,e));for(var te=function(de){for(var ge=0,xe=0,Ee=0,Me=de[0],Fe=0,We=Me.length,gt=We-1;Fe<We;gt=Fe++){var st=Me[Fe],vt=Me[gt],lt=st.x*vt.y-vt.x*st.y;xe+=(st.x+vt.x)*lt,Ee+=(st.y+vt.y)*lt,ge+=3*lt}return new zu(xe/ge,Ee/ge,0,de)}(e),ue=B.length;B.length;){var ne=B.pop();(ne.d>te.d||!te.d)&&(te=ne,i&&console.log("found best %d after %d probes",Math.round(1e4*ne.d)/1e4,ue)),ne.max-te.d<=t||(B.push(new zu(ne.p.x-(D=ne.h/2),ne.p.y-D,D,e)),B.push(new zu(ne.p.x+D,ne.p.y-D,D,e)),B.push(new zu(ne.p.x-D,ne.p.y+D,D,e)),B.push(new zu(ne.p.x+D,ne.p.y+D,D,e)),ue+=4)}return i&&(console.log("num probes: "+ue),console.log("best distance: "+te.d)),te.p}function ng(e,t){return t.max-e.max}function zu(e,t,i,l){this.p=new N(e,t),this.h=i,this.d=function(h,f){for(var y=!1,w=1/0,I=0;I<f.length;I++)for(var k=f[I],P=0,D=k.length,B=D-1;P<D;B=P++){var U=k[P],$=k[B];U.y>h.y!=$.y>h.y&&h.x<($.x-U.x)*(h.y-U.y)/($.y-U.y)+U.x&&(y=!y),w=Math.min(w,Ps(h,U,$))}return(y?1:-1)*Math.sqrt(w)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}ku.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},ku.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},ku.prototype.peek=function(){return this.data[0]},ku.prototype._up=function(e){for(var t=this.data,i=this.compare,l=t[e];e>0;){var h=e-1>>1,f=t[h];if(i(l,f)>=0)break;t[e]=f,e=h}t[e]=l},ku.prototype._down=function(e){for(var t=this.data,i=this.compare,l=this.length>>1,h=t[e];e<l;){var f=1+(e<<1),y=t[f],w=f+1;if(w<this.length&&i(t[w],y)<0&&(f=w,y=t[w]),i(y,h)>=0)break;t[e]=y,e=f}t[e]=h};var ap=Number.POSITIVE_INFINITY;function Af(e,t){return t[1]!==ap?function(i,l,h){var f=0,y=0;switch(l=Math.abs(l),h=Math.abs(h),i){case"top-right":case"top-left":case"top":y=h-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-h}switch(i){case"top-right":case"bottom-right":case"right":f=-l;break;case"top-left":case"bottom-left":case"left":f=l}return[f,y]}(e,t[0],t[1]):function(i,l){var h=0,f=0;l<0&&(l=0);var y=l/Math.sqrt(2);switch(i){case"top-right":case"top-left":f=y-7;break;case"bottom-right":case"bottom-left":f=7-y;break;case"bottom":f=7-l;break;case"top":f=l-7}switch(i){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=l;break;case"right":h=-l}return[h,f]}(e,t[0])}function sp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Pf(e,t,i,l,h,f,y,w,I,k,P,D,B,U,$){var te=function(xe,Ee,Me,Fe,We,gt,st,vt){for(var lt=Fe.layout.get("text-rotate").evaluate(gt,{})*Math.PI/180,Xt=[],Tt=0,ct=Ee.positionedLines;Tt<ct.length;Tt+=1)for(var $t=ct[Tt],Nt=0,ur=$t.positionedGlyphs;Nt<ur.length;Nt+=1){var xt=ur[Nt];if(xt.rect){var yr=xt.rect||{},ii=4,Ai=!0,vi=1,ni=0,Pi=(We||vt)&&xt.vertical,an=xt.metrics.advance*xt.scale/2;if(vt&&Ee.verticalizable&&(ni=$t.lineOffset/2-(xt.imageName?-(24-xt.metrics.width*xt.scale)/2:24*(xt.scale-1))),xt.imageName){var sn=st[xt.imageName];Ai=sn.sdf,ii=1/(vi=sn.pixelRatio)}var mo=We?[xt.x+an,xt.y]:[0,0],_n=We?[0,0]:[xt.x+an+Me[0],xt.y+Me[1]-ni],yo=[0,0];Pi&&(yo=_n,_n=[0,0]);var Oi=(xt.metrics.left-ii)*xt.scale-an+_n[0],vn=(-xt.metrics.top-ii)*xt.scale+_n[1],nr=Oi+yr.w*xt.scale/vi,jr=vn+yr.h*xt.scale/vi,Mr=new N(Oi,vn),fr=new N(nr,vn),Po=new N(Oi,jr),Hn=new N(nr,jr);if(Pi){var Jr=new N(-an,an- -17),qi=-Math.PI/2,Jn=12-an,gr=new N(22-Jn,-(xt.imageName?Jn:0)),Ys=new(Function.prototype.bind.apply(N,[null].concat(yo)));Mr._rotateAround(qi,Jr)._add(gr)._add(Ys),fr._rotateAround(qi,Jr)._add(gr)._add(Ys),Po._rotateAround(qi,Jr)._add(gr)._add(Ys),Hn._rotateAround(qi,Jr)._add(gr)._add(Ys)}if(lt){var Oa=Math.sin(lt),Qs=Math.cos(lt),Fi=[Qs,-Oa,Oa,Qs];Mr._matMult(Fi),fr._matMult(Fi),Po._matMult(Fi),Hn._matMult(Fi)}var $s=new N(0,0),vs=new N(0,0);Xt.push({tl:Mr,tr:fr,bl:Po,br:Hn,tex:yr,writingMode:Ee.writingMode,glyphOffset:mo,sectionIndex:xt.sectionIndex,isSDF:Ai,pixelOffsetTL:$s,pixelOffsetBR:vs,minFontScaleX:0,minFontScaleY:0})}}return Xt}(0,i,w,h,f,y,l,e.allowVerticalPlacement),ue=e.textSizeData,ne=null;ue.kind==="source"?(ne=[128*h.layout.get("text-size").evaluate(y,{})])[0]>32640&&It(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):ue.kind==="composite"&&((ne=[128*U.compositeTextSizes[0].evaluate(y,{},$),128*U.compositeTextSizes[1].evaluate(y,{},$)])[0]>32640||ne[1]>32640)&&It(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,te,ne,w,f,y,k,t,I.lineStartIndex,I.lineLength,B,$);for(var de=0,ge=P;de<ge.length;de+=1)D[ge[de]]=e.text.placedSymbolArray.length-1;return 4*te.length}function Cf(e){for(var t in e)return e[t];return null}function og(e,t,i,l){var h=e.compareText;if(t in h){for(var f=h[t],y=f.length-1;y>=0;y--)if(l.dist(f[y])<i)return!0}else h[t]=[];return h[t].push(l),!1}var ag=wu.VectorTileFeature.types,sg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function nh(e,t,i,l,h,f,y,w,I,k,P,D,B){var U=w?Math.min(32640,Math.round(w[0])):0,$=w?Math.min(32640,Math.round(w[1])):0;e.emplaceBack(t,i,Math.round(32*l),Math.round(32*h),f,y,(U<<1)+(I?1:0),$,16*k,16*P,256*D,256*B)}function lp(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function lg(e){for(var t=0,i=e.sections;t<i.length;t+=1)if(la(i[t].text))return!0;return!1}var Au=function(e){this.layoutVertexArray=new dl,this.indexArray=new es,this.programConfigurations=e,this.segments=new q,this.dynamicLayoutVertexArray=new jo,this.opacityVertexArray=new Zs,this.placedSymbolArray=new u};Au.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Au.prototype.upload=function(e,t,i,l){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ly.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Ry.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,sg,!0),this.opacityVertexBuffer.itemSize=1),(i||l)&&this.programConfigurations.upload(e))},Au.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},$e("SymbolBuffers",Au);var sc=function(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new q,this.collisionVertexArray=new Nl};sc.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,By.members,!0)},sc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},$e("CollisionBuffers",sc);var Br=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(f){return f.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=po([]),this.placementViewportMatrix=po([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=op(this.zoom,t["text-size"]),this.iconSizeData=op(this.zoom,t["icon-size"]);var i=this.layers[0].layout,l=i.get("symbol-sort-key"),h=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(f){return Ba[f]})),this.stateDependentLayerIds=this.layers.filter(function(f){return f.isStateDependent()}).map(function(f){return f.id}),this.sourceID=e.sourceID};Br.prototype.createArrays=function(){this.text=new Au(new wt(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new Au(new wt(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new x,this.lineVertexArray=new T,this.symbolInstances=new _},Br.prototype.calculateGlyphDependencies=function(e,t,i,l,h){for(var f=0;f<e.length;f++)if(t[e.charCodeAt(f)]=!0,(i||l)&&h){var y=nc[e.charAt(f)];y&&(t[y.charCodeAt(0)]=!0)}},Br.prototype.populate=function(e,t,i){var l=this.layers[0],h=l.layout,f=h.get("text-font"),y=h.get("text-field"),w=h.get("icon-image"),I=(y.value.kind!=="constant"||y.value.value instanceof Cr&&!y.value.value.isEmpty()||y.value.value.toString().length>0)&&(f.value.kind!=="constant"||f.value.value.length>0),k=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,P=h.get("symbol-sort-key");if(this.features=[],I||k){for(var D=t.iconDependencies,B=t.glyphDependencies,U=t.availableImages,$=new Yt(this.zoom),te=0,ue=e;te<ue.length;te+=1){var ne=ue[te],de=ne.feature,ge=ne.id,xe=ne.index,Ee=ne.sourceLayerIndex,Me=l._featureFilter.needGeometry,Fe=ci(de,Me);if(l._featureFilter.filter($,Fe,i)){Me||(Fe.geometry=Rr(de));var We=void 0;if(I){var gt=l.getValueAndResolveTokens("text-field",Fe,i,U),st=Cr.factory(gt);lg(st)&&(this.hasRTLText=!0),(!this.hasRTLText||qs()==="unavailable"||this.hasRTLText&&Zr.isParsed())&&(We=Fy(st,l,Fe))}var vt=void 0;if(k){var lt=l.getValueAndResolveTokens("icon-image",Fe,i,U);vt=lt instanceof ai?lt:ai.fromString(lt)}if(We||vt){var Xt=this.sortFeaturesByKey?P.evaluate(Fe,{},i):void 0;if(this.features.push({id:ge,text:We,icon:vt,index:xe,sourceLayerIndex:Ee,geometry:Fe.geometry,properties:de.properties,type:ag[de.type],sortKey:Xt}),vt&&(D[vt.name]=!0),We){var Tt=f.evaluate(Fe,{},i).join(","),ct=h.get("text-rotation-alignment")==="map"&&h.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ba.vertical)>=0;for(var $t=0,Nt=We.sections;$t<Nt.length;$t+=1){var ur=Nt[$t];if(ur.image)D[ur.image.name]=!0;else{var xt=fl(We.toString()),yr=ur.fontStack||Tt,ii=B[yr]=B[yr]||{};this.calculateGlyphDependencies(ur.text,ii,ct,this.allowVerticalPlacement,xt)}}}}}}h.get("symbol-placement")==="line"&&(this.features=function(Ai){var vi={},ni={},Pi=[],an=0;function sn(Jr){Pi.push(Ai[Jr]),an++}function mo(Jr,qi,Jn){var gr=ni[Jr];return delete ni[Jr],ni[qi]=gr,Pi[gr].geometry[0].pop(),Pi[gr].geometry[0]=Pi[gr].geometry[0].concat(Jn[0]),gr}function _n(Jr,qi,Jn){var gr=vi[qi];return delete vi[qi],vi[Jr]=gr,Pi[gr].geometry[0].shift(),Pi[gr].geometry[0]=Jn[0].concat(Pi[gr].geometry[0]),gr}function yo(Jr,qi,Jn){var gr=Jn?qi[0][qi[0].length-1]:qi[0][0];return Jr+":"+gr.x+":"+gr.y}for(var Oi=0;Oi<Ai.length;Oi++){var vn=Ai[Oi],nr=vn.geometry,jr=vn.text?vn.text.toString():null;if(jr){var Mr=yo(jr,nr),fr=yo(jr,nr,!0);if(Mr in ni&&fr in vi&&ni[Mr]!==vi[fr]){var Po=_n(Mr,fr,nr),Hn=mo(Mr,fr,Pi[Po].geometry);delete vi[Mr],delete ni[fr],ni[yo(jr,Pi[Hn].geometry,!0)]=Hn,Pi[Po].geometry=null}else Mr in ni?mo(Mr,fr,nr):fr in vi?_n(Mr,fr,nr):(sn(Oi),vi[Mr]=an-1,ni[fr]=an-1)}else sn(Oi)}return Pi.filter(function(Jr){return Jr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ai,vi){return Ai.sortKey-vi.sortKey})}},Br.prototype.update=function(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))},Br.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Br.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Br.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Br.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Br.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Br.prototype.addToLineVertexArray=function(e,t){var i=this.lineVertexArray.length;if(e.segment!==void 0){for(var l=e.dist(t[e.segment+1]),h=e.dist(t[e.segment]),f={},y=e.segment+1;y<t.length;y++)f[y]={x:t[y].x,y:t[y].y,tileUnitDistanceFromAnchor:l},y<t.length-1&&(l+=t[y+1].dist(t[y]));for(var w=e.segment||0;w>=0;w--)f[w]={x:t[w].x,y:t[w].y,tileUnitDistanceFromAnchor:h},w>0&&(h+=t[w-1].dist(t[w]));for(var I=0;I<t.length;I++){var k=f[I];this.lineVertexArray.emplaceBack(k.x,k.y,k.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Br.prototype.addSymbols=function(e,t,i,l,h,f,y,w,I,k,P,D){for(var B=e.indexArray,U=e.layoutVertexArray,$=e.segments.prepareSegment(4*t.length,U,B,this.canOverlap?f.sortKey:void 0),te=this.glyphOffsetArray.length,ue=$.vertexLength,ne=this.allowVerticalPlacement&&y===Ba.vertical?Math.PI/2:0,de=f.text&&f.text.sections,ge=0;ge<t.length;ge++){var xe=t[ge],Ee=xe.tl,Me=xe.tr,Fe=xe.bl,We=xe.br,gt=xe.tex,st=xe.pixelOffsetTL,vt=xe.pixelOffsetBR,lt=xe.minFontScaleX,Xt=xe.minFontScaleY,Tt=xe.glyphOffset,ct=xe.isSDF,$t=xe.sectionIndex,Nt=$.vertexLength,ur=Tt[1];nh(U,w.x,w.y,Ee.x,ur+Ee.y,gt.x,gt.y,i,ct,st.x,st.y,lt,Xt),nh(U,w.x,w.y,Me.x,ur+Me.y,gt.x+gt.w,gt.y,i,ct,vt.x,st.y,lt,Xt),nh(U,w.x,w.y,Fe.x,ur+Fe.y,gt.x,gt.y+gt.h,i,ct,st.x,vt.y,lt,Xt),nh(U,w.x,w.y,We.x,ur+We.y,gt.x+gt.w,gt.y+gt.h,i,ct,vt.x,vt.y,lt,Xt),lp(e.dynamicLayoutVertexArray,w,ne),B.emplaceBack(Nt,Nt+1,Nt+2),B.emplaceBack(Nt+1,Nt+2,Nt+3),$.vertexLength+=4,$.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Tt[0]),ge!==t.length-1&&$t===t[ge+1].sectionIndex||e.programConfigurations.populatePaintArrays(U.length,f,f.index,{},D,de&&de[$t])}e.placedSymbolArray.emplaceBack(w.x,w.y,te,this.glyphOffsetArray.length-te,ue,I,k,w.segment,i?i[0]:0,i?i[1]:0,l[0],l[1],y,0,!1,0,P)},Br.prototype._addCollisionDebugVertex=function(e,t,i,l,h,f){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,l,h,Math.round(f.x),Math.round(f.y))},Br.prototype.addCollisionDebugVertices=function(e,t,i,l,h,f,y){var w=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),I=w.vertexLength,k=h.layoutVertexArray,P=h.collisionVertexArray,D=y.anchorX,B=y.anchorY;this._addCollisionDebugVertex(k,P,f,D,B,new N(e,t)),this._addCollisionDebugVertex(k,P,f,D,B,new N(i,t)),this._addCollisionDebugVertex(k,P,f,D,B,new N(i,l)),this._addCollisionDebugVertex(k,P,f,D,B,new N(e,l)),w.vertexLength+=4;var U=h.indexArray;U.emplaceBack(I,I+1),U.emplaceBack(I+1,I+2),U.emplaceBack(I+2,I+3),U.emplaceBack(I+3,I),w.primitiveLength+=4},Br.prototype.addDebugCollisionBoxes=function(e,t,i,l){for(var h=e;h<t;h++){var f=this.collisionBoxArray.get(h);this.addCollisionDebugVertices(f.x1,f.y1,f.x2,f.y2,l?this.textCollisionBox:this.iconCollisionBox,f.anchorPoint,i)}},Br.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new sc(Gs,uf.members,Ks),this.iconCollisionBox=new sc(Gs,uf.members,Ks);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Br.prototype._deserializeCollisionBoxesForSymbol=function(e,t,i,l,h,f,y,w,I){for(var k={},P=t;P<i;P++){var D=e.get(P);k.textBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},k.textFeatureIndex=D.featureIndex;break}for(var B=l;B<h;B++){var U=e.get(B);k.verticalTextBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},k.verticalTextFeatureIndex=U.featureIndex;break}for(var $=f;$<y;$++){var te=e.get($);k.iconBox={x1:te.x1,y1:te.y1,x2:te.x2,y2:te.y2,anchorPointX:te.anchorPointX,anchorPointY:te.anchorPointY},k.iconFeatureIndex=te.featureIndex;break}for(var ue=w;ue<I;ue++){var ne=e.get(ue);k.verticalIconBox={x1:ne.x1,y1:ne.y1,x2:ne.x2,y2:ne.y2,anchorPointX:ne.anchorPointX,anchorPointY:ne.anchorPointY},k.verticalIconFeatureIndex=ne.featureIndex;break}return k},Br.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Br.prototype.hasTextData=function(){return this.text.segments.get().length>0},Br.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Br.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Br.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Br.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Br.prototype.addIndicesForPlacedSymbol=function(e,t){for(var i=e.placedSymbolArray.get(t),l=i.vertexStartIndex+4*i.numGlyphs,h=i.vertexStartIndex;h<l;h+=4)e.indexArray.emplaceBack(h,h+1,h+2),e.indexArray.emplaceBack(h+1,h+2,h+3)},Br.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),l=[],h=[],f=[],y=0;y<this.symbolInstances.length;++y){f.push(y);var w=this.symbolInstances.get(y);l.push(0|Math.round(t*w.anchorX+i*w.anchorY)),h.push(w.featureIndex)}return f.sort(function(I,k){return l[I]-l[k]||h[k]-h[I]}),f},Br.prototype.addToSortKeyRanges=function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Br.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,l=this.symbolInstanceIndexes;i<l.length;i+=1){var h=this.symbolInstances.get(l[i]);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach(function(f,y,w){f>=0&&w.indexOf(f)===y&&t.addIndicesForPlacedSymbol(t.text,f)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},$e("SymbolBucket",Br,{omit:["layers","collisionBoxArray","features","compareText"]}),Br.MAX_GLYPHS=65535,Br.addDynamicAttributes=lp;var ug=new Ur({"symbol-placement":new Pe(F.layout_symbol["symbol-placement"]),"symbol-spacing":new Pe(F.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Pe(F.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ot(F.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Pe(F.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Pe(F.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Pe(F.layout_symbol["icon-ignore-placement"]),"icon-optional":new Pe(F.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Pe(F.layout_symbol["icon-rotation-alignment"]),"icon-size":new ot(F.layout_symbol["icon-size"]),"icon-text-fit":new Pe(F.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Pe(F.layout_symbol["icon-text-fit-padding"]),"icon-image":new ot(F.layout_symbol["icon-image"]),"icon-rotate":new ot(F.layout_symbol["icon-rotate"]),"icon-padding":new Pe(F.layout_symbol["icon-padding"]),"icon-keep-upright":new Pe(F.layout_symbol["icon-keep-upright"]),"icon-offset":new ot(F.layout_symbol["icon-offset"]),"icon-anchor":new ot(F.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Pe(F.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Pe(F.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Pe(F.layout_symbol["text-rotation-alignment"]),"text-field":new ot(F.layout_symbol["text-field"]),"text-font":new ot(F.layout_symbol["text-font"]),"text-size":new ot(F.layout_symbol["text-size"]),"text-max-width":new ot(F.layout_symbol["text-max-width"]),"text-line-height":new Pe(F.layout_symbol["text-line-height"]),"text-letter-spacing":new ot(F.layout_symbol["text-letter-spacing"]),"text-justify":new ot(F.layout_symbol["text-justify"]),"text-radial-offset":new ot(F.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Pe(F.layout_symbol["text-variable-anchor"]),"text-anchor":new ot(F.layout_symbol["text-anchor"]),"text-max-angle":new Pe(F.layout_symbol["text-max-angle"]),"text-writing-mode":new Pe(F.layout_symbol["text-writing-mode"]),"text-rotate":new ot(F.layout_symbol["text-rotate"]),"text-padding":new Pe(F.layout_symbol["text-padding"]),"text-keep-upright":new Pe(F.layout_symbol["text-keep-upright"]),"text-transform":new ot(F.layout_symbol["text-transform"]),"text-offset":new ot(F.layout_symbol["text-offset"]),"text-allow-overlap":new Pe(F.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Pe(F.layout_symbol["text-ignore-placement"]),"text-optional":new Pe(F.layout_symbol["text-optional"])}),up={paint:new Ur({"icon-opacity":new ot(F.paint_symbol["icon-opacity"]),"icon-color":new ot(F.paint_symbol["icon-color"]),"icon-halo-color":new ot(F.paint_symbol["icon-halo-color"]),"icon-halo-width":new ot(F.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ot(F.paint_symbol["icon-halo-blur"]),"icon-translate":new Pe(F.paint_symbol["icon-translate"]),"icon-translate-anchor":new Pe(F.paint_symbol["icon-translate-anchor"]),"text-opacity":new ot(F.paint_symbol["text-opacity"]),"text-color":new ot(F.paint_symbol["text-color"],{runtimeType:Ge,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new ot(F.paint_symbol["text-halo-color"]),"text-halo-width":new ot(F.paint_symbol["text-halo-width"]),"text-halo-blur":new ot(F.paint_symbol["text-halo-blur"]),"text-translate":new Pe(F.paint_symbol["text-translate"]),"text-translate-anchor":new Pe(F.paint_symbol["text-translate-anchor"])}),layout:ug},Pu=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Qe,this.defaultValue=e};Pu.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},Pu.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},Pu.prototype.outputDefined=function(){return!1},Pu.prototype.serialize=function(){return null},$e("FormatSectionOverride",Pu,{omit:["defaultValue"]});var cg=function(e){function t(i){e.call(this,i,up)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){if(e.prototype.recalculate.call(this,i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var h=this.layout.get("text-writing-mode");if(h){for(var f=[],y=0,w=h;y<w.length;y+=1){var I=w[y];f.indexOf(I)<0&&f.push(I)}this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(i,l,h,f){var y=this.layout.get(i).evaluate(l,{},h,f),w=this._unevaluatedLayout._values[i];return w.isDataDriven()||ao(w.value)||!y?y:function(I,k){return k.replace(/{([^{}]+)}/g,function(P,D){return D in I?String(I[D]):""})}(l.properties,y)},t.prototype.createBucket=function(i){return new Br(i)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var i=0,l=up.paint.overridableProperties;i<l.length;i+=1){var h=l[i];if(t.hasPaintOverride(this.layout,h)){var f,y=this.paint.get(h),w=new Pu(y),I=new us(w,y.property.specification);f=y.value.kind==="constant"||y.value.kind==="source"?new To("source",I):new cs("composite",I,y.value.zoomStops,y.value._interpolationType),this.paint._values[h]=new Hr(y.property,f,y.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,h){return!(!this.layout||l.isDataDriven()||h.isDataDriven())&&t.hasPaintOverride(this.layout,i)},t.hasPaintOverride=function(i,l){var h=i.get("text-field"),f=up.paint.properties[l],y=!1,w=function(P){for(var D=0,B=P;D<B.length;D+=1)if(f.overrides&&f.overrides.hasOverride(B[D]))return void(y=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Cr)w(h.value.value.sections);else if(h.value.kind==="source"){var I=function(P){y||(P instanceof fi&&Ar(P.value)===ar?w(P.value.sections):P instanceof pn?w(P.sections):P.eachChild(I))},k=h.value;k._styleExpression&&I(k._styleExpression.expression)}return y},t}(Pn),hg={paint:new Ur({"background-color":new Pe(F.paint_background["background-color"]),"background-pattern":new Bi(F.paint_background["background-pattern"]),"background-opacity":new Pe(F.paint_background["background-opacity"])})},pg=function(e){function t(i){e.call(this,i,hg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Pn),fg={paint:new Ur({"raster-opacity":new Pe(F.paint_raster["raster-opacity"]),"raster-hue-rotate":new Pe(F.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Pe(F.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Pe(F.paint_raster["raster-brightness-max"]),"raster-saturation":new Pe(F.paint_raster["raster-saturation"]),"raster-contrast":new Pe(F.paint_raster["raster-contrast"]),"raster-resampling":new Pe(F.paint_raster["raster-resampling"]),"raster-fade-duration":new Pe(F.paint_raster["raster-fade-duration"])})},dg=function(e){function t(i){e.call(this,i,fg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Pn),mg=function(e){function t(i){e.call(this,i,{}),this.implementation=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},t.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},t}(Pn),yg={circle:Ju,heatmap:$m,hillshade:ty,fill:_y,"fill-extrusion":ky,line:Dy,symbol:cg,background:pg,raster:dg},Mf=K.HTMLImageElement,Df=K.HTMLCanvasElement,Lf=K.HTMLVideoElement,Rf=K.ImageData,oh=K.ImageBitmap,nu=function(e,t,i,l){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,l)};nu.prototype.update=function(e,t,i){var l=e.width,h=e.height,f=!(this.size&&this.size[0]===l&&this.size[1]===h||i),y=this.context,w=y.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),w.bindTexture(w.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!t||t.premultiply!==!1)),f)this.size=[l,h],e instanceof Mf||e instanceof Df||e instanceof Lf||e instanceof Rf||oh&&e instanceof oh?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,e):w.texImage2D(w.TEXTURE_2D,0,this.format,l,h,0,this.format,w.UNSIGNED_BYTE,e.data);else{var I=i||{x:0,y:0},k=I.x,P=I.y;e instanceof Mf||e instanceof Df||e instanceof Lf||e instanceof Rf||oh&&e instanceof oh?w.texSubImage2D(w.TEXTURE_2D,0,k,P,w.RGBA,w.UNSIGNED_BYTE,e):w.texSubImage2D(w.TEXTURE_2D,0,k,P,l,h,w.RGBA,w.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&w.generateMipmap(w.TEXTURE_2D)},nu.prototype.bind=function(e,t,i){var l=this.context.gl;l.bindTexture(l.TEXTURE_2D,this.texture),i!==l.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=l.LINEAR),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,t),this.wrap=t)},nu.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},nu.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var cp=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};cp.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},cp.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Cu=function(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},xr(["receive","process"],this),this.invoker=new cp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=hr()?e:K};function Bf(e,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[e*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}Cu.prototype.send=function(e,t,i,l,h){var f=this;h===void 0&&(h=!1);var y=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[y]=i);var w=er(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:e,hasCallback:!!i,targetMapId:l,mustQueue:h,sourceMapId:this.mapId,data:Ki(t,w)},w),{cancel:function(){i&&delete f.callbacks[y],f.target.postMessage({id:y,type:"<cancel>",targetMapId:l,sourceMapId:f.mapId})}}},Cu.prototype.receive=function(e){var t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[i];var l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l()}else hr()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},Cu.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},Cu.prototype.processTask=function(e,t){var i=this;if(t.type==="<response>"){var l=this.callbacks[e];delete this.callbacks[e],l&&(t.error?l(zn(t.error)):l(null,zn(t.data)))}else{var h=!1,f=er(this.globalScope)?void 0:[],y=t.hasCallback?function(P,D){h=!0,delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:P?Ki(P):null,data:Ki(D,f)},f)}:function(P){h=!0},w=null,I=zn(t.data);if(this.parent[t.type])w=this.parent[t.type](t.sourceMapId,I,y);else if(this.parent.getWorkerSource){var k=t.type.split(".");w=this.parent.getWorkerSource(t.sourceMapId,k[0],I.source)[k[1]](I,y)}else y(new Error("Could not find function "+t.type));!h&&w&&w.cancel&&(this.cancelCallbacks[e]=w.cancel)}},Cu.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Wi=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Wi.prototype.setNorthEast=function(e){return this._ne=e instanceof ri?new ri(e.lng,e.lat):ri.convert(e),this},Wi.prototype.setSouthWest=function(e){return this._sw=e instanceof ri?new ri(e.lng,e.lat):ri.convert(e),this},Wi.prototype.extend=function(e){var t,i,l=this._sw,h=this._ne;if(e instanceof ri)t=e,i=e;else{if(!(e instanceof Wi))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Wi.convert(e)):this.extend(ri.convert(e)):this;if(i=e._ne,!(t=e._sw)||!i)return this}return l||h?(l.lng=Math.min(t.lng,l.lng),l.lat=Math.min(t.lat,l.lat),h.lng=Math.max(i.lng,h.lng),h.lat=Math.max(i.lat,h.lat)):(this._sw=new ri(t.lng,t.lat),this._ne=new ri(i.lng,i.lat)),this},Wi.prototype.getCenter=function(){return new ri((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Wi.prototype.getSouthWest=function(){return this._sw},Wi.prototype.getNorthEast=function(){return this._ne},Wi.prototype.getNorthWest=function(){return new ri(this.getWest(),this.getNorth())},Wi.prototype.getSouthEast=function(){return new ri(this.getEast(),this.getSouth())},Wi.prototype.getWest=function(){return this._sw.lng},Wi.prototype.getSouth=function(){return this._sw.lat},Wi.prototype.getEast=function(){return this._ne.lng},Wi.prototype.getNorth=function(){return this._ne.lat},Wi.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Wi.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Wi.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Wi.prototype.contains=function(e){var t=ri.convert(e),i=t.lng,l=t.lat,h=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&h},Wi.convert=function(e){return!e||e instanceof Wi?e:new Wi(e)};var ri=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};ri.prototype.wrap=function(){return new ri(Ke(this.lng,-180,180),this.lat)},ri.prototype.toArray=function(){return[this.lng,this.lat]},ri.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},ri.prototype.distanceTo=function(e){var t=Math.PI/180,i=this.lat*t,l=e.lat*t,h=Math.sin(i)*Math.sin(l)+Math.cos(i)*Math.cos(l)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(h,1))},ri.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new Wi(new ri(this.lng-i,this.lat-t),new ri(this.lng+i,this.lat+t))},ri.convert=function(e){if(e instanceof ri)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new ri(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new ri(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Of=2*Math.PI*63710088e-1;function Ff(e){return Of*Math.cos(e*Math.PI/180)}function Vf(e){return(180+e)/360}function Nf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Uf(e,t){return e/Ff(t)}function hp(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var ou=function(e,t,i){i===void 0&&(i=0),this.x=+e,this.y=+t,this.z=+i};ou.fromLngLat=function(e,t){t===void 0&&(t=0);var i=ri.convert(e);return new ou(Vf(i.lng),Nf(i.lat),Uf(t,i.lat))},ou.prototype.toLngLat=function(){return new ri(360*this.x-180,hp(this.y))},ou.prototype.toAltitude=function(){return this.z*Ff(hp(this.y))},ou.prototype.meterInMercatorCoordinateUnits=function(){return 1/Of*(e=hp(this.y),1/Math.cos(e*Math.PI/180));var e};var au=function(e,t,i){this.z=e,this.x=t,this.y=i,this.key=lc(0,e,e,t,i)};au.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},au.prototype.url=function(e,t){var i,l,h,f,y,w=(l=this.y,h=this.z,f=Bf(256*(i=this.x),256*(l=Math.pow(2,h)-l-1),h),y=Bf(256*(i+1),256*(l+1),h),f[0]+","+f[1]+","+y[0]+","+y[1]),I=function(k,P,D){for(var B,U="",$=k;$>0;$--)U+=(P&(B=1<<$-1)?1:0)+(D&B?2:0);return U}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",I).replace("{bbox-epsg-3857}",w)},au.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new N(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},au.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var jf=function(e,t){this.wrap=e,this.canonical=t,this.key=lc(e,t.z,t.z,t.x,t.y)},Hi=function(e,t,i,l,h){this.overscaledZ=e,this.wrap=t,this.canonical=new au(i,+l,+h),this.key=lc(t,e,i,l,h)};function lc(e,t,i,l,h){(e*=2)<0&&(e=-1*e-1);var f=1<<i;return(f*f*e+f*h+l).toString(36)+i.toString(36)+t.toString(36)}Hi.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Hi.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Hi(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Hi(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Hi.prototype.calculateScaledKey=function(e,t){var i=this.canonical.z-e;return e>this.canonical.z?lc(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):lc(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)},Hi.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Hi.prototype.children=function(e){if(this.overscaledZ>=e)return[new Hi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,i=2*this.canonical.x,l=2*this.canonical.y;return[new Hi(t,this.wrap,t,i,l),new Hi(t,this.wrap,t,i+1,l),new Hi(t,this.wrap,t,i,l+1),new Hi(t,this.wrap,t,i+1,l+1)]},Hi.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Hi.prototype.wrapped=function(){return new Hi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Hi.prototype.unwrapTo=function(e){return new Hi(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Hi.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Hi.prototype.toUnwrapped=function(){return new jf(this.wrap,this.canonical)},Hi.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Hi.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new ou(e.x-this.wrap,e.y))},$e("CanonicalTileID",au),$e("OverscaledTileID",Hi,{omit:["posMatrix"]});var xl=function(e,t,i){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return It('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var l=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=i||"mapbox";for(var h=0;h<l;h++)this.data[this._idx(-1,h)]=this.data[this._idx(0,h)],this.data[this._idx(l,h)]=this.data[this._idx(l-1,h)],this.data[this._idx(h,-1)]=this.data[this._idx(h,0)],this.data[this._idx(h,l)]=this.data[this._idx(h,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)]};xl.prototype.get=function(e,t){var i=new Uint8Array(this.data.buffer),l=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[l],i[l+1],i[l+2])},xl.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},xl.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},xl.prototype._unpackMapbox=function(e,t,i){return(256*e*256+256*t+i)/10-1e4},xl.prototype._unpackTerrarium=function(e,t,i){return 256*e+t+i/256-32768},xl.prototype.getPixels=function(){return new Wn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},xl.prototype.backfillBorder=function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var l=t*this.dim,h=t*this.dim+this.dim,f=i*this.dim,y=i*this.dim+this.dim;switch(t){case-1:l=h-1;break;case 1:h=l+1}switch(i){case-1:f=y-1;break;case 1:y=f+1}for(var w=-t*this.dim,I=-i*this.dim,k=f;k<y;k++)for(var P=l;P<h;P++)this.data[this._idx(P,k)]=e.data[this._idx(P+w,k+I)]},$e("DEMData",xl);var ah=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}};ah.prototype.encode=function(e){return this._stringToNumber[e]},ah.prototype.decode=function(e){return this._numberToString[e]};var sh=function(e,t,i,l,h){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=l,this.properties=e.properties,this.id=h},pp={geometry:{configurable:!0}};pp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},pp.geometry.set=function(e){this._geometry=e},sh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(sh.prototype,pp);var Mu=function(){this.state={},this.stateChanges={},this.deletedStates={}};Mu.prototype.updateState=function(e,t,i){var l=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},Xe(this.stateChanges[e][l],i),this.deletedStates[e]===null)for(var h in this.deletedStates[e]={},this.state[e])h!==l&&(this.deletedStates[e][h]=null);else if(this.deletedStates[e]&&this.deletedStates[e][l]===null)for(var f in this.deletedStates[e][l]={},this.state[e][l])i[f]||(this.deletedStates[e][l][f]=null);else for(var y in i)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][y]===null&&delete this.deletedStates[e][l][y]},Mu.prototype.removeFeatureState=function(e,t,i){if(this.deletedStates[e]!==null){var l=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&t!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][i]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(i in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][i]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}},Mu.prototype.getState=function(e,t){var i=String(t),l=Xe({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var h=this.deletedStates[e][t];if(h===null)return{};for(var f in h)delete l[f]}return l},Mu.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},Mu.prototype.coalesceChanges=function(e,t){var i={};for(var l in this.stateChanges){this.state[l]=this.state[l]||{};var h={};for(var f in this.stateChanges[l])this.state[l][f]||(this.state[l][f]={}),Xe(this.state[l][f],this.stateChanges[l][f]),h[f]=this.state[l][f];i[l]=h}for(var y in this.deletedStates){this.state[y]=this.state[y]||{};var w={};if(this.deletedStates[y]===null)for(var I in this.state[y])w[I]={},this.state[y][I]={};else for(var k in this.deletedStates[y]){if(this.deletedStates[y][k]===null)this.state[y][k]={};else for(var P=0,D=Object.keys(this.deletedStates[y][k]);P<D.length;P+=1)delete this.state[y][k][D[P]];w[k]=this.state[y][k]}i[y]=i[y]||{},Xe(i[y],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var B in e)e[B].setFeatureState(i,t)};var bl=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new sa(8192,16,0),this.grid3D=new sa(8192,16,0),this.featureIndexArray=new L,this.promoteId=t};function qf(e,t,i,l,h){return Wt(e,function(f,y){var w=t instanceof _e?t.get(y):null;return w&&w.evaluate?w.evaluate(i,l,h):w})}function Zf(e){for(var t=1/0,i=1/0,l=-1/0,h=-1/0,f=0,y=e;f<y.length;f+=1){var w=y[f];t=Math.min(t,w.x),i=Math.min(i,w.y),l=Math.max(l,w.x),h=Math.max(h,w.y)}return{minX:t,minY:i,maxX:l,maxY:h}}function gg(e,t){return t-e}bl.prototype.insert=function(e,t,i,l,h,f){var y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,l,h);for(var w=f?this.grid3D:this.grid,I=0;I<t.length;I++){for(var k=t[I],P=[1/0,1/0,-1/0,-1/0],D=0;D<k.length;D++){var B=k[D];P[0]=Math.min(P[0],B.x),P[1]=Math.min(P[1],B.y),P[2]=Math.max(P[2],B.x),P[3]=Math.max(P[3],B.y)}P[0]<8192&&P[1]<8192&&P[2]>=0&&P[3]>=0&&w.insert(y,P[0],P[1],P[2],P[3])}},bl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new wu.VectorTile(new Hc(this.rawTileData)).layers,this.sourceLayerCoder=new ah(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},bl.prototype.query=function(e,t,i,l){var h=this;this.loadVTLayers();for(var f=e.params||{},y=8192/e.tileSize/e.scale,w=Ta(f.filter),I=e.queryGeometry,k=e.queryPadding*y,P=Zf(I),D=this.grid.query(P.minX-k,P.minY-k,P.maxX+k,P.maxY+k),B=Zf(e.cameraQueryGeometry),U=this.grid3D.query(B.minX-k,B.minY-k,B.maxX+k,B.maxY+k,function(xe,Ee,Me,Fe){return function(We,gt,st,vt,lt){for(var Xt=0,Tt=We;Xt<Tt.length;Xt+=1){var ct=Tt[Xt];if(gt<=ct.x&&st<=ct.y&&vt>=ct.x&&lt>=ct.y)return!0}var $t=[new N(gt,st),new N(gt,lt),new N(vt,lt),new N(vt,st)];if(We.length>2){for(var Nt=0,ur=$t;Nt<ur.length;Nt+=1)if(fa(We,ur[Nt]))return!0}for(var xt=0;xt<We.length-1;xt++)if(Cs(We[xt],We[xt+1],$t))return!0;return!1}(e.cameraQueryGeometry,xe-k,Ee-k,Me+k,Fe+k)}),$=0,te=U;$<te.length;$+=1)D.push(te[$]);D.sort(gg);for(var ue,ne={},de=function(xe){var Ee=D[xe];if(Ee!==ue){ue=Ee;var Me=h.featureIndexArray.get(Ee),Fe=null;h.loadMatchingFeature(ne,Me.bucketIndex,Me.sourceLayerIndex,Me.featureIndex,w,f.layers,f.availableImages,t,i,l,function(We,gt,st){return Fe||(Fe=Rr(We)),gt.queryIntersectsFeature(I,We,st,Fe,h.z,e.transform,y,e.pixelPosMatrix)})}},ge=0;ge<D.length;ge++)de(ge);return ne},bl.prototype.loadMatchingFeature=function(e,t,i,l,h,f,y,w,I,k,P){var D=this.bucketLayerIDs[t];if(!f||function(We,gt){for(var st=0;st<We.length;st++)if(gt.indexOf(We[st])>=0)return!0;return!1}(f,D)){var B=this.sourceLayerCoder.decode(i),U=this.vtLayers[B].feature(l);if(h.needGeometry){var $=ci(U,!0);if(!h.filter(new Yt(this.tileID.overscaledZ),$,this.tileID.canonical))return}else if(!h.filter(new Yt(this.tileID.overscaledZ),U))return;for(var te=this.getId(U,B),ue=0;ue<D.length;ue++){var ne=D[ue];if(!(f&&f.indexOf(ne)<0)){var de=w[ne];if(de){var ge={};te!==void 0&&k&&(ge=k.getState(de.sourceLayer||"_geojsonTileLayer",te));var xe=Xe({},I[ne]);xe.paint=qf(xe.paint,de.paint,U,ge,y),xe.layout=qf(xe.layout,de.layout,U,ge,y);var Ee=!P||P(U,de,ge);if(Ee){var Me=new sh(U,this.z,this.x,this.y,te);Me.layer=xe;var Fe=e[ne];Fe===void 0&&(Fe=e[ne]=[]),Fe.push({featureIndex:l,feature:Me,intersectionZ:Ee})}}}}}},bl.prototype.lookupSymbolFeatures=function(e,t,i,l,h,f,y,w){var I={};this.loadVTLayers();for(var k=Ta(h),P=0,D=e;P<D.length;P+=1)this.loadMatchingFeature(I,i,l,D[P],k,f,y,w,t);return I},bl.prototype.hasLayer=function(e){for(var t=0,i=this.bucketLayerIDs;t<i.length;t+=1)for(var l=0,h=i[t];l<h.length;l+=1)if(e===h[l])return!0;return!1},bl.prototype.getId=function(e,t){var i=e.id;return this.promoteId&&typeof(i=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(i=Number(i)),i},$e("FeatureIndex",bl,{omit:["rawTileData","sourceLayerCoder"]});var gn=function(e,t){this.tileID=e,this.uid=Lt(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};gn.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<_r.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},gn.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},gn.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var l in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(k,P){var D={};if(!P)return D;for(var B=function(){var te=$[U],ue=te.layerIds.map(function(ge){return P.getLayer(ge)}).filter(Boolean);if(ue.length!==0){te.layers=ue,te.stateDependentLayerIds&&(te.stateDependentLayers=te.stateDependentLayerIds.map(function(ge){return ue.filter(function(xe){return xe.id===ge})[0]}));for(var ne=0,de=ue;ne<de.length;ne+=1)D[de[ne].id]=te}},U=0,$=k;U<$.length;U+=1)B();return D}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var h=this.buckets[l];if(h instanceof Br){if(this.hasSymbolBuckets=!0,!i)break;h.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var f in this.buckets){var y=this.buckets[f];if(y instanceof Br&&y.hasRTLText){this.hasRTLText=!0,Zr.isLoading()||Zr.isLoaded()||qs()!=="deferred"||Li();break}}for(var w in this.queryPadding=0,this.buckets){var I=this.buckets[w];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(w).queryRadius(I))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new a},gn.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},gn.prototype.getBucket=function(e){return this.buckets[e.id]},gn.prototype.upload=function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var l=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new nu(e,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new nu(e,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)},gn.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},gn.prototype.queryRenderedFeatures=function(e,t,i,l,h,f,y,w,I,k){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:h,scale:f,tileSize:this.tileSize,pixelPosMatrix:k,transform:w,params:y,queryPadding:this.queryPadding*I},e,t,i):{}},gn.prototype.querySourceFeatures=function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var l=i.loadVTLayers(),h=t?t.sourceLayer:"",f=l._geojsonTileLayer||l[h];if(f)for(var y=Ta(t&&t.filter),w=this.tileID.canonical,I=w.z,k=w.x,P=w.y,D={z:I,x:k,y:P},B=0;B<f.length;B++){var U=f.feature(B);if(y.needGeometry){var $=ci(U,!0);if(!y.filter(new Yt(this.tileID.overscaledZ),$,this.tileID.canonical))continue}else if(!y.filter(new Yt(this.tileID.overscaledZ),U))continue;var te=i.getId(U,h),ue=new sh(U,I,k,P,te);ue.tile=D,e.push(ue)}}},gn.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},gn.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},gn.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=Or(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var l=Date.now(),h=!1;if(this.expirationTime>l)h=!1;else if(t)if(this.expirationTime<t)h=!0;else{var f=this.expirationTime-t;f?this.expirationTime=l+Math.max(f,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},gn.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},gn.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var l in this.buckets)if(t.style.hasLayer(l)){var h=this.buckets[l],f=h.layers[0].sourceLayer||"_geojsonTileLayer",y=i[f],w=e[f];if(y&&w&&Object.keys(w).length!==0){h.update(w,y,this.imageAtlas&&this.imageAtlas.patternPositions||{});var I=t&&t.style&&t.style.getLayer(l);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(h)))}}}},gn.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},gn.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<_r.now()},gn.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},gn.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=_r.now()+e},gn.prototype.setDependencies=function(e,t){for(var i={},l=0,h=t;l<h.length;l+=1)i[h[l]]=!0;this.dependencies[e]=i},gn.prototype.hasDependency=function(e,t){for(var i=0,l=e;i<l.length;i+=1){var h=this.dependencies[l[i]];if(h){for(var f=0,y=t;f<y.length;f+=1)if(h[y[f]])return!0}}return!1};var Zl=K.performance,Gf=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},Zl.mark(this._marks.start)};Gf.prototype.finish=function(){Zl.mark(this._marks.end);var e=Zl.getEntriesByName(this._marks.measure);return e.length===0&&(Zl.measure(this._marks.measure,this._marks.start,this._marks.end),e=Zl.getEntriesByName(this._marks.measure),Zl.clearMarks(this._marks.start),Zl.clearMarks(this._marks.end),Zl.clearMeasures(this._marks.measure)),e},s.Actor=Cu,s.AlphaImage=_l,s.CanonicalTileID=au,s.CollisionBoxArray=a,s.Color=Zt,s.DEMData=xl,s.DataConstantProperty=Pe,s.DictionaryCoder=ah,s.EXTENT=8192,s.ErrorEvent=le,s.EvaluationParameters=Yt,s.Event=ee,s.Evented=ce,s.FeatureIndex=bl,s.FillBucket=Ds,s.FillExtrusionBucket=Ls,s.ImageAtlas=ac,s.ImagePosition=Yc,s.LineBucket=Ao,s.LngLat=ri,s.LngLatBounds=Wi,s.MercatorCoordinate=ou,s.ONE_EM=24,s.OverscaledTileID=Hi,s.Point=N,s.Point$1=N,s.Properties=Ur,s.Protobuf=Hc,s.RGBAImage=Wn,s.RequestManager=Ei,s.RequestPerformance=Gf,s.ResourceType=Ho,s.SegmentVector=q,s.SourceFeatureState=Mu,s.StructArrayLayout1ui2=jl,s.StructArrayLayout2f1f2i16=ys,s.StructArrayLayout2i4=Uo,s.StructArrayLayout3ui6=es,s.StructArrayLayout4i8=Vl,s.SymbolBucket=Br,s.Texture=nu,s.Tile=gn,s.Transitionable=Ri,s.Uniform1f=Ue,s.Uniform1i=Re,s.Uniform2f=Ve,s.Uniform3f=at,s.Uniform4f=yt,s.UniformColor=mt,s.UniformMatrix4f=ir,s.UnwrappedTileID=jf,s.ValidationError=re,s.WritingMode=Ba,s.ZoomHistory=Ya,s.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},s.addDynamicAttributes=lp,s.asyncAll=function(e,t,i){if(!e.length)return i(null,[]);var l=e.length,h=new Array(e.length),f=null;e.forEach(function(y,w){t(y,function(I,k){I&&(f=I),h[w]=k,--l==0&&i(f,h)})})},s.bezier=fe,s.bindAll=xr,s.browser=_r,s.cacheEntryPossiblyAdded=function(e){++eo>$n&&(e.getActor().send("enforceCacheSizeLimit",hn),eo=0)},s.clamp=ze,s.clearTileCache=function(e){var t=K.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},s.clipLine=If,s.clone=function(e){var t=new pr(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},s.clone$1=qe,s.clone$2=function(e){var t=new pr(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},s.collisionCircleLayout=Oy,s.config=Rt,s.create=function(){var e=new pr(16);return pr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},s.create$1=function(){var e=new pr(9);return pr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},s.create$2=function(){var e=new pr(4);return pr!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},s.createCommonjsModule=M,s.createExpression=Zn,s.createLayout=ei,s.createStyleLayer=function(e){return e.type==="custom"?new mg(e):new yg[e.type](e)},s.cross=function(e,t,i){var l=t[0],h=t[1],f=t[2],y=i[0],w=i[1],I=i[2];return e[0]=h*I-f*w,e[1]=f*y-l*I,e[2]=l*w-h*y,e},s.deepEqual=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],i[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(var h in t)if(!e(t[h],i[h]))return!1;return!0}return t===i},s.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},s.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},s.ease=Oe,s.emitValidationErrors=pl,s.endsWith=cr,s.enforceCacheSizeLimit=function(e){_o(),Fr&&Fr.then(function(t){t.keys().then(function(i){for(var l=0;l<i.length-e;l++)t.delete(i[l])})})},s.evaluateSizeForFeature=xf,s.evaluateSizeForZoom=bf,s.evaluateVariableOffset=Af,s.evented=Fl,s.extend=Xe,s.featureFilter=Ta,s.filterObject=Ht,s.fromRotation=function(e,t){var i=Math.sin(t),l=Math.cos(t);return e[0]=l,e[1]=i,e[2]=0,e[3]=-i,e[4]=l,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},s.getAnchorAlignment=np,s.getAnchorJustification=sp,s.getArrayBuffer=en,s.getImage=R,s.getJSON=function(e,t){return xo(Xe(e,{type:"json"}),t)},s.getRTLTextPluginStatus=qs,s.getReferrer=Ti,s.getVideo=function(e,t){var i,l,h=K.document.createElement("video");h.muted=!0,h.onloadstart=function(){t(null,h)};for(var f=0;f<e.length;f++){var y=K.document.createElement("source");i=e[f],l=void 0,(l=K.document.createElement("a")).href=i,(l.protocol!==K.document.location.protocol||l.host!==K.document.location.host)&&(h.crossOrigin="Anonymous"),y.src=e[f],h.appendChild(y)}return{cancel:function(){}}},s.identity=po,s.invert=function(e,t){var i=t[0],l=t[1],h=t[2],f=t[3],y=t[4],w=t[5],I=t[6],k=t[7],P=t[8],D=t[9],B=t[10],U=t[11],$=t[12],te=t[13],ue=t[14],ne=t[15],de=i*w-l*y,ge=i*I-h*y,xe=i*k-f*y,Ee=l*I-h*w,Me=l*k-f*w,Fe=h*k-f*I,We=P*te-D*$,gt=P*ue-B*$,st=P*ne-U*$,vt=D*ue-B*te,lt=D*ne-U*te,Xt=B*ne-U*ue,Tt=de*Xt-ge*lt+xe*vt+Ee*st-Me*gt+Fe*We;return Tt?(e[0]=(w*Xt-I*lt+k*vt)*(Tt=1/Tt),e[1]=(h*lt-l*Xt-f*vt)*Tt,e[2]=(te*Fe-ue*Me+ne*Ee)*Tt,e[3]=(B*Me-D*Fe-U*Ee)*Tt,e[4]=(I*st-y*Xt-k*gt)*Tt,e[5]=(i*Xt-h*st+f*gt)*Tt,e[6]=(ue*xe-$*Fe-ne*ge)*Tt,e[7]=(P*Fe-B*xe+U*ge)*Tt,e[8]=(y*lt-w*st+k*We)*Tt,e[9]=(l*st-i*lt-f*We)*Tt,e[10]=($*Me-te*xe+ne*de)*Tt,e[11]=(D*xe-P*Me-U*de)*Tt,e[12]=(w*gt-y*vt-I*We)*Tt,e[13]=(i*vt-l*gt+h*We)*Tt,e[14]=(te*ge-$*Ee-ue*de)*Tt,e[15]=(P*Ee-D*ge+B*de)*Tt,e):null},s.isChar=Ye,s.isMapboxURL=Ci,s.keysDifference=function(e,t){var i=[];for(var l in e)l in t||i.push(l);return i},s.makeRequest=xo,s.mapObject=Wt,s.mercatorXfromLng=Vf,s.mercatorYfromLat=Nf,s.mercatorZfromAltitude=Uf,s.mul=vu,s.multiply=Ln,s.mvt=wu,s.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},s.normalize=function(e,t){var i=t[0],l=t[1],h=t[2],f=i*i+l*l+h*h;return f>0&&(f=1/Math.sqrt(f)),e[0]=t[0]*f,e[1]=t[1]*f,e[2]=t[2]*f,e},s.number=qr,s.offscreenCanvasSupported=vo,s.ortho=function(e,t,i,l,h,f,y){var w=1/(t-i),I=1/(l-h),k=1/(f-y);return e[0]=-2*w,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*I,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*k,e[11]=0,e[12]=(t+i)*w,e[13]=(h+l)*I,e[14]=(y+f)*k,e[15]=1,e},s.parseGlyphPBF=function(e){return new Hc(e).readFields(Wy,[])},s.pbf=Hc,s.performSymbolLayout=function(e,t,i,l,h,f,y){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var w=e.layers[0].layout,I=e.layers[0]._unevaluatedLayout._values,k={};if(e.textSizeData.kind==="composite"){var P=e.textSizeData,D=P.maxZoom;k.compositeTextSizes=[I["text-size"].possiblyEvaluate(new Yt(P.minZoom),y),I["text-size"].possiblyEvaluate(new Yt(D),y)]}if(e.iconSizeData.kind==="composite"){var B=e.iconSizeData,U=B.maxZoom;k.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new Yt(B.minZoom),y),I["icon-size"].possiblyEvaluate(new Yt(U),y)]}k.layoutTextSize=I["text-size"].possiblyEvaluate(new Yt(e.zoom+1),y),k.layoutIconSize=I["icon-size"].possiblyEvaluate(new Yt(e.zoom+1),y),k.textMaxSize=I["text-size"].possiblyEvaluate(new Yt(18));for(var $=24*w.get("text-line-height"),te=w.get("text-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point",ue=w.get("text-keep-upright"),ne=w.get("text-size"),de=function(){var Ee=xe[ge],Me=w.get("text-font").evaluate(Ee,{},y).join(","),Fe=ne.evaluate(Ee,{},y),We=k.layoutTextSize.evaluate(Ee,{},y),gt=k.layoutIconSize.evaluate(Ee,{},y),st={horizontal:{},vertical:void 0},vt=Ee.text,lt=[0,0];if(vt){var Xt=vt.toString(),Tt=24*w.get("text-letter-spacing").evaluate(Ee,{},y),ct=function(nr){for(var jr=0,Mr=nr;jr<Mr.length;jr+=1)if(fr=Mr[jr].charCodeAt(0),Ye.Arabic(fr)||Ye["Arabic Supplement"](fr)||Ye["Arabic Extended-A"](fr)||Ye["Arabic Presentation Forms-A"](fr)||Ye["Arabic Presentation Forms-B"](fr))return!1;var fr;return!0}(Xt)?Tt:0,$t=w.get("text-anchor").evaluate(Ee,{},y),Nt=w.get("text-variable-anchor");if(!Nt){var ur=w.get("text-radial-offset").evaluate(Ee,{},y);lt=ur?Af($t,[24*ur,ap]):w.get("text-offset").evaluate(Ee,{},y).map(function(nr){return 24*nr})}var xt=te?"center":w.get("text-justify").evaluate(Ee,{},y),yr=w.get("symbol-placement"),ii=yr==="point"?24*w.get("text-max-width").evaluate(Ee,{},y):0,Ai=function(){e.allowVerticalPlacement&&fl(Xt)&&(st.vertical=Qc(vt,t,i,h,Me,ii,$,$t,"left",ct,lt,Ba.vertical,!0,yr,We,Fe))};if(!te&&Nt){for(var vi=xt==="auto"?Nt.map(function(nr){return sp(nr)}):[xt],ni=!1,Pi=0;Pi<vi.length;Pi++){var an=vi[Pi];if(!st.horizontal[an])if(ni)st.horizontal[an]=st.horizontal[0];else{var sn=Qc(vt,t,i,h,Me,ii,$,"center",an,ct,lt,Ba.horizontal,!1,yr,We,Fe);sn&&(st.horizontal[an]=sn,ni=sn.positionedLines.length===1)}}Ai()}else{xt==="auto"&&(xt=sp($t));var mo=Qc(vt,t,i,h,Me,ii,$,$t,xt,ct,lt,Ba.horizontal,!1,yr,We,Fe);mo&&(st.horizontal[xt]=mo),Ai(),fl(Xt)&&te&&ue&&(st.vertical=Qc(vt,t,i,h,Me,ii,$,$t,xt,ct,lt,Ba.vertical,!1,yr,We,Fe))}}var _n=void 0,yo=!1;if(Ee.icon&&Ee.icon.name){var Oi=l[Ee.icon.name];Oi&&(_n=function(nr,jr,Mr){var fr=np(Mr),Po=jr[0]-nr.displaySize[0]*fr.horizontalAlign,Hn=jr[1]-nr.displaySize[1]*fr.verticalAlign;return{image:nr,top:Hn,bottom:Hn+nr.displaySize[1],left:Po,right:Po+nr.displaySize[0]}}(h[Ee.icon.name],w.get("icon-offset").evaluate(Ee,{},y),w.get("icon-anchor").evaluate(Ee,{},y)),yo=Oi.sdf,e.sdfIcons===void 0?e.sdfIcons=Oi.sdf:e.sdfIcons!==Oi.sdf&&It("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Oi.pixelRatio!==e.pixelRatio||w.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var vn=Cf(st.horizontal)||st.vertical;e.iconsInText=!!vn&&vn.iconsInText,(vn||_n)&&function(nr,jr,Mr,fr,Po,Hn,Jr,qi,Jn,gr,Ys){var Oa=Hn.textMaxSize.evaluate(jr,{});Oa===void 0&&(Oa=Jr);var Qs,Fi=nr.layers[0].layout,$s=Fi.get("icon-offset").evaluate(jr,{},Ys),vs=Cf(Mr.horizontal),Du=Jr/24,su=nr.tilePixelRatio*Du,Lu=nr.tilePixelRatio*Oa/24,wl=nr.tilePixelRatio*qi,Ru=nr.tilePixelRatio*Fi.get("symbol-spacing"),lh=Fi.get("text-padding")*nr.tilePixelRatio,Bu=Fi.get("icon-padding")*nr.tilePixelRatio,uc=Fi.get("text-max-angle")/180*Math.PI,uh=Fi.get("text-rotation-alignment")==="map"&&Fi.get("symbol-placement")!=="point",ch=Fi.get("icon-rotation-alignment")==="map"&&Fi.get("symbol-placement")!=="point",Sl=Fi.get("symbol-placement"),cc=Ru/2,Ou=Fi.get("icon-text-fit");fr&&Ou!=="none"&&(nr.allowVerticalPlacement&&Mr.vertical&&(Qs=vf(fr,Mr.vertical,Ou,Fi.get("icon-text-fit-padding"),$s,Du)),vs&&(fr=vf(fr,vs,Ou,Fi.get("icon-text-fit-padding"),$s,Du)));var Gl=function(_g,_c){_c.x<0||_c.x>=8192||_c.y<0||_c.y>=8192||function(Vi,Rs,vg,Kl,yp,Wf,yh,el,gh,vc,_h,vh,gp,Hf,xc,Jf,Yf,Qf,$f,ed,Fa,xh,td,tl,xg){var rd,uu,ju,qu,Zu,Gu=Vi.addToLineVertexArray(Rs,vg),id=0,nd=0,od=0,ad=0,_p=-1,vp=-1,El={},sd=Y(""),xp=0,bp=0;if(el._unevaluatedLayout.getValue("text-radial-offset")===void 0?(xp=(rd=el.layout.get("text-offset").evaluate(Fa,{},tl).map(function(wc){return 24*wc}))[0],bp=rd[1]):(xp=24*el.layout.get("text-radial-offset").evaluate(Fa,{},tl),bp=ap),Vi.allowVerticalPlacement&&Kl.vertical){var ld=el.layout.get("text-rotate").evaluate(Fa,{},tl)+90;qu=new ih(gh,Rs,vc,_h,vh,Kl.vertical,gp,Hf,xc,ld),yh&&(Zu=new ih(gh,Rs,vc,_h,vh,yh,Yf,Qf,xc,ld))}if(yp){var wp=el.layout.get("icon-rotate").evaluate(Fa,{}),ud=el.layout.get("icon-text-fit")!=="none",cd=kf(yp,wp,td,ud),Sp=yh?kf(yh,wp,td,ud):void 0;ju=new ih(gh,Rs,vc,_h,vh,yp,Yf,Qf,!1,wp),id=4*cd.length;var hd=Vi.iconSizeData,bc=null;hd.kind==="source"?(bc=[128*el.layout.get("icon-size").evaluate(Fa,{})])[0]>32640&&It(Vi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):hd.kind==="composite"&&((bc=[128*xh.compositeIconSizes[0].evaluate(Fa,{},tl),128*xh.compositeIconSizes[1].evaluate(Fa,{},tl)])[0]>32640||bc[1]>32640)&&It(Vi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Vi.addSymbols(Vi.icon,cd,bc,ed,$f,Fa,!1,Rs,Gu.lineStartIndex,Gu.lineLength,-1,tl),_p=Vi.icon.placedSymbolArray.length-1,Sp&&(nd=4*Sp.length,Vi.addSymbols(Vi.icon,Sp,bc,ed,$f,Fa,Ba.vertical,Rs,Gu.lineStartIndex,Gu.lineLength,-1,tl),vp=Vi.icon.placedSymbolArray.length-1)}for(var pd in Kl.horizontal){var bh=Kl.horizontal[pd];if(!uu){sd=Y(bh.text);var bg=el.layout.get("text-rotate").evaluate(Fa,{},tl);uu=new ih(gh,Rs,vc,_h,vh,bh,gp,Hf,xc,bg)}var fd=bh.positionedLines.length===1;if(od+=Pf(Vi,Rs,bh,Wf,el,xc,Fa,Jf,Gu,Kl.vertical?Ba.horizontal:Ba.horizontalOnly,fd?Object.keys(Kl.horizontal):[pd],El,_p,xh,tl),fd)break}Kl.vertical&&(ad+=Pf(Vi,Rs,Kl.vertical,Wf,el,xc,Fa,Jf,Gu,Ba.vertical,["vertical"],El,vp,xh,tl));var wg=uu?uu.boxStartIndex:Vi.collisionBoxArray.length,Sg=uu?uu.boxEndIndex:Vi.collisionBoxArray.length,Eg=qu?qu.boxStartIndex:Vi.collisionBoxArray.length,Tg=qu?qu.boxEndIndex:Vi.collisionBoxArray.length,Ig=ju?ju.boxStartIndex:Vi.collisionBoxArray.length,kg=ju?ju.boxEndIndex:Vi.collisionBoxArray.length,zg=Zu?Zu.boxStartIndex:Vi.collisionBoxArray.length,Ag=Zu?Zu.boxEndIndex:Vi.collisionBoxArray.length,rl=-1,wh=function(wc,md){return wc&&wc.circleDiameter?Math.max(wc.circleDiameter,md):md};rl=wh(uu,rl),rl=wh(qu,rl),rl=wh(ju,rl);var dd=(rl=wh(Zu,rl))>-1?1:0;dd&&(rl*=xg/24),Vi.glyphOffsetArray.length>=Br.MAX_GLYPHS&&It("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Fa.sortKey!==void 0&&Vi.addToSortKeyRanges(Vi.symbolInstances.length,Fa.sortKey),Vi.symbolInstances.emplaceBack(Rs.x,Rs.y,El.right>=0?El.right:-1,El.center>=0?El.center:-1,El.left>=0?El.left:-1,El.vertical||-1,_p,vp,sd,wg,Sg,Eg,Tg,Ig,kg,zg,Ag,vc,od,ad,id,nd,dd,0,gp,xp,bp,rl)}(nr,_c,_g,Mr,fr,Po,Qs,nr.layers[0],nr.collisionBoxArray,jr.index,jr.sourceLayerIndex,nr.index,su,lh,uh,Jn,wl,Bu,ch,$s,jr,Hn,gr,Ys,Jr)};if(Sl==="line")for(var Fu=0,hh=If(jr.geometry,0,0,8192,8192);Fu<hh.length;Fu+=1)for(var ph=hh[Fu],hc=0,pc=tg(ph,Ru,uc,Mr.vertical||vs,fr,24,Lu,nr.overscaling,8192);hc<pc.length;hc+=1){var fh=pc[hc];vs&&og(nr,vs.text,cc,fh)||Gl(ph,fh)}else if(Sl==="line-center")for(var fc=0,dc=jr.geometry;fc<dc.length;fc+=1){var mc=dc[fc];if(mc.length>1){var dh=eg(mc,uc,Mr.vertical||vs,fr,24,Lu);dh&&Gl(mc,dh)}}else if(jr.type==="Polygon")for(var Vu=0,mh=$h(jr.geometry,0);Vu<mh.length;Vu+=1){var Nu=mh[Vu],yc=ig(Nu,16);Gl(Nu[0],new Iu(yc.x,yc.y,0))}else if(jr.type==="LineString")for(var lu=0,gc=jr.geometry;lu<gc.length;lu+=1){var Uu=gc[lu];Gl(Uu,new Iu(Uu[0].x,Uu[0].y,0))}else if(jr.type==="Point")for(var fp=0,Kf=jr.geometry;fp<Kf.length;fp+=1)for(var dp=0,Xf=Kf[fp];dp<Xf.length;dp+=1){var mp=Xf[dp];Gl([mp],new Iu(mp.x,mp.y,0))}}(e,Ee,st,_n,l,k,We,gt,lt,yo,y)},ge=0,xe=e.features;ge<xe.length;ge+=1)de();f&&e.generateCollisionDebugBuffers()},s.perspective=function(e,t,i,l,h){var f,y=1/Math.tan(t/2);return e[0]=y/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,h!=null&&h!==1/0?(e[10]=(h+l)*(f=1/(l-h)),e[14]=2*h*l*f):(e[10]=-1,e[14]=-2*l),e},s.pick=function(e,t){for(var i={},l=0;l<t.length;l++){var h=t[l];h in e&&(i[h]=e[h])}return i},s.plugin=Zr,s.polygonIntersectsPolygon=ts,s.postMapLoadEvent=Co,s.postTurnstileEvent=On,s.potpack=mf,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.register=$e,s.registerForPluginStateChange=function(e){return e({pluginStatus:Kn,pluginURL:Lr}),Fl.on("pluginStateChange",e),e},s.renderColorRamp=Yu,s.rotate=function(e,t,i){var l=t[0],h=t[1],f=t[2],y=t[3],w=Math.sin(i),I=Math.cos(i);return e[0]=l*I+f*w,e[1]=h*I+y*w,e[2]=l*-w+f*I,e[3]=h*-w+y*I,e},s.rotateX=function(e,t,i){var l=Math.sin(i),h=Math.cos(i),f=t[4],y=t[5],w=t[6],I=t[7],k=t[8],P=t[9],D=t[10],B=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=f*h+k*l,e[5]=y*h+P*l,e[6]=w*h+D*l,e[7]=I*h+B*l,e[8]=k*h-f*l,e[9]=P*h-y*l,e[10]=D*h-w*l,e[11]=B*h-I*l,e},s.rotateZ=function(e,t,i){var l=Math.sin(i),h=Math.cos(i),f=t[0],y=t[1],w=t[2],I=t[3],k=t[4],P=t[5],D=t[6],B=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=f*h+k*l,e[1]=y*h+P*l,e[2]=w*h+D*l,e[3]=I*h+B*l,e[4]=k*h-f*l,e[5]=P*h-y*l,e[6]=D*h-w*l,e[7]=B*h-I*l,e},s.scale=function(e,t,i){var l=i[0],h=i[1],f=i[2];return e[0]=t[0]*l,e[1]=t[1]*l,e[2]=t[2]*l,e[3]=t[3]*l,e[4]=t[4]*h,e[5]=t[5]*h,e[6]=t[6]*h,e[7]=t[7]*h,e[8]=t[8]*f,e[9]=t[9]*f,e[10]=t[10]*f,e[11]=t[11]*f,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},s.scale$1=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},s.scale$2=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},s.setCacheLimits=function(e,t){hn=e,$n=t},s.setRTLTextPlugin=function(e,t,i){if(i===void 0&&(i=!1),Kn==="deferred"||Kn==="loading"||Kn==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Lr=_r.resolveURL(e),Kn="deferred",ua=t,js(),i||Li()},s.sphericalToCartesian=function(e){var t=e[0],i=e[1],l=e[2];return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(l),y:t*Math.sin(i)*Math.sin(l),z:t*Math.cos(l)}},s.sqrLen=function(e){var t=e[0],i=e[1];return t*t+i*i},s.styleSpec=F,s.sub=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},s.symbolSize=$y,s.transformMat3=function(e,t,i){var l=t[0],h=t[1],f=t[2];return e[0]=l*i[0]+h*i[3]+f*i[6],e[1]=l*i[1]+h*i[4]+f*i[7],e[2]=l*i[2]+h*i[5]+f*i[8],e},s.transformMat4=Hs,s.translate=function(e,t,i){var l,h,f,y,w,I,k,P,D,B,U,$,te=i[0],ue=i[1],ne=i[2];return t===e?(e[12]=t[0]*te+t[4]*ue+t[8]*ne+t[12],e[13]=t[1]*te+t[5]*ue+t[9]*ne+t[13],e[14]=t[2]*te+t[6]*ue+t[10]*ne+t[14],e[15]=t[3]*te+t[7]*ue+t[11]*ne+t[15]):(h=t[1],f=t[2],y=t[3],w=t[4],I=t[5],k=t[6],P=t[7],D=t[8],B=t[9],U=t[10],$=t[11],e[0]=l=t[0],e[1]=h,e[2]=f,e[3]=y,e[4]=w,e[5]=I,e[6]=k,e[7]=P,e[8]=D,e[9]=B,e[10]=U,e[11]=$,e[12]=l*te+w*ue+D*ne+t[12],e[13]=h*te+I*ue+B*ne+t[13],e[14]=f*te+k*ue+U*ne+t[14],e[15]=y*te+P*ue+$*ne+t[15]),e},s.triggerPluginCompletionEvent=Ol,s.uniqueId=Lt,s.validateCustomStyleLayer=function(e){var t=[],i=e.id;return i===void 0&&t.push({message:"layers."+i+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+i+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),t},s.validateLight=Ja,s.validateStyle=In,s.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},s.vectorTile=wu,s.version="1.13.2",s.warnOnce=It,s.webpSupported=kr,s.window=K,s.wrap=Ke}),E(["./shared"],function(s){function M(C){var R=typeof C;if(R==="number"||R==="boolean"||R==="string"||C==null)return JSON.stringify(C);if(Array.isArray(C)){for(var O="[",G=0,ee=C;G<ee.length;G+=1)O+=M(ee[G])+",";return O+"]"}for(var le=Object.keys(C).sort(),ce="{",F=0;F<le.length;F++)ce+=JSON.stringify(le[F])+":"+M(C[le[F]])+",";return ce+"}"}function A(C){for(var R="",O=0,G=s.refProperties;O<G.length;O+=1)R+="/"+M(C[G[O]]);return R}var V=function(C){this.keyCache={},C&&this.replace(C)};V.prototype.replace=function(C){this._layerConfigs={},this._layers={},this.update(C,[])},V.prototype.update=function(C,R){for(var O=this,G=0,ee=C;G<ee.length;G+=1){var le=ee[G];this._layerConfigs[le.id]=le;var ce=this._layers[le.id]=s.createStyleLayer(le);ce._featureFilter=s.featureFilter(ce.filter),this.keyCache[le.id]&&delete this.keyCache[le.id]}for(var F=0,re=R;F<re.length;F+=1){var me=re[F];delete this.keyCache[me],delete this._layerConfigs[me],delete this._layers[me]}this.familiesBySource={};for(var Ce=0,Le=function(Ne,Ge){for(var At={},je=0;je<Ne.length;je++){var Pt=Ge&&Ge[Ne[je].id]||A(Ne[je]);Ge&&(Ge[Ne[je].id]=Pt);var ar=At[Pt];ar||(ar=At[Pt]=[]),ar.push(Ne[je])}var Ct=[];for(var Vt in At)Ct.push(At[Vt]);return Ct}(s.values(this._layerConfigs),this.keyCache);Ce<Le.length;Ce+=1){var be=Le[Ce].map(function(Ne){return O._layers[Ne.id]}),Be=be[0];if(Be.visibility!=="none"){var et=Be.source||"",Qe=this.familiesBySource[et];Qe||(Qe=this.familiesBySource[et]={});var Se=Be.sourceLayer||"_geojsonTileLayer",Je=Qe[Se];Je||(Je=Qe[Se]=[]),Je.push(be)}}};var N=function(C){var R={},O=[];for(var G in C){var ee=C[G],le=R[G]={};for(var ce in ee){var F=ee[+ce];if(F&&F.bitmap.width!==0&&F.bitmap.height!==0){var re={x:0,y:0,w:F.bitmap.width+2,h:F.bitmap.height+2};O.push(re),le[ce]={rect:re,metrics:F.metrics}}}}var me=s.potpack(O),Ce=new s.AlphaImage({width:me.w||1,height:me.h||1});for(var Le in C){var be=C[Le];for(var Be in be){var et=be[+Be];if(et&&et.bitmap.width!==0&&et.bitmap.height!==0){var Qe=R[Le][Be].rect;s.AlphaImage.copy(et.bitmap,Ce,{x:0,y:0},{x:Qe.x+1,y:Qe.y+1},et.bitmap)}}}this.image=Ce,this.positions=R};s.register("GlyphAtlas",N);var W=function(C){this.tileID=new s.OverscaledTileID(C.tileID.overscaledZ,C.tileID.wrap,C.tileID.canonical.z,C.tileID.canonical.x,C.tileID.canonical.y),this.uid=C.uid,this.zoom=C.zoom,this.pixelRatio=C.pixelRatio,this.tileSize=C.tileSize,this.source=C.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=C.showCollisionBoxes,this.collectResourceTiming=!!C.collectResourceTiming,this.returnDependencies=!!C.returnDependencies,this.promoteId=C.promoteId};function K(C,R,O){for(var G=new s.EvaluationParameters(R),ee=0,le=C;ee<le.length;ee+=1)le[ee].recalculate(G,O)}function H(C,R){var O=s.getArrayBuffer(C.request,function(G,ee,le,ce){G?R(G):ee&&R(null,{vectorTile:new s.vectorTile.VectorTile(new s.pbf(ee)),rawData:ee,cacheControl:le,expires:ce})});return function(){O.cancel(),R()}}W.prototype.parse=function(C,R,O,G,ee){var le=this;this.status="parsing",this.data=C,this.collisionBoxArray=new s.CollisionBoxArray;var ce=new s.DictionaryCoder(Object.keys(C.layers).sort()),F=new s.FeatureIndex(this.tileID,this.promoteId);F.bucketLayerIDs=[];var re,me,Ce,Le,be={},Be={featureIndex:F,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:O},et=R.familiesBySource[this.source];for(var Qe in et){var Se=C.layers[Qe];if(Se){Se.version===1&&s.warnOnce('Vector tile source "'+this.source+'" layer "'+Qe+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Je=ce.encode(Qe),Ne=[],Ge=0;Ge<Se.length;Ge++){var At=Se.feature(Ge),je=F.getId(At,Qe);Ne.push({feature:At,id:je,index:Ge,sourceLayerIndex:Je})}for(var Pt=0,ar=et[Qe];Pt<ar.length;Pt+=1){var Ct=ar[Pt],Vt=Ct[0];Vt.minzoom&&this.zoom<Math.floor(Vt.minzoom)||Vt.maxzoom&&this.zoom>=Vt.maxzoom||Vt.visibility!=="none"&&(K(Ct,this.zoom,O),(be[Vt.id]=Vt.createBucket({index:F.bucketLayerIDs.length,layers:Ct,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Je,sourceID:this.source})).populate(Ne,Be,this.tileID.canonical),F.bucketLayerIDs.push(Ct.map(function(or){return or.id})))}}}var Mt=s.mapObject(Be.glyphDependencies,function(or){return Object.keys(or).map(Number)});Object.keys(Mt).length?G.send("getGlyphs",{uid:this.uid,stacks:Mt},function(or,Bt){re||(re=or,me=Bt,zr.call(le))}):me={};var oi=Object.keys(Be.iconDependencies);oi.length?G.send("getImages",{icons:oi,source:this.source,tileID:this.tileID,type:"icons"},function(or,Bt){re||(re=or,Ce=Bt,zr.call(le))}):Ce={};var Jt=Object.keys(Be.patternDependencies);function zr(){if(re)return ee(re);if(me&&Ce&&Le){var or=new N(me),Bt=new s.ImageAtlas(Ce,Le);for(var Zt in be){var pi=be[Zt];pi instanceof s.SymbolBucket?(K(pi.layers,this.zoom,O),s.performSymbolLayout(pi,me,or.positions,Ce,Bt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):pi.hasPattern&&(pi instanceof s.LineBucket||pi instanceof s.FillBucket||pi instanceof s.FillExtrusionBucket)&&(K(pi.layers,this.zoom,O),pi.addFeatures(Be,this.tileID.canonical,Bt.patternPositions))}this.status="done",ee(null,{buckets:s.values(be).filter(function(tn){return!tn.isEmpty()}),featureIndex:F,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:or.image,imageAtlas:Bt,glyphMap:this.returnDependencies?me:null,iconMap:this.returnDependencies?Ce:null,glyphPositions:this.returnDependencies?or.positions:null})}}Jt.length?G.send("getImages",{icons:Jt,source:this.source,tileID:this.tileID,type:"patterns"},function(or,Bt){re||(re=or,Le=Bt,zr.call(le))}):Le={},zr.call(this)};var fe=function(C,R,O,G){this.actor=C,this.layerIndex=R,this.availableImages=O,this.loadVectorData=G||H,this.loading={},this.loaded={}};fe.prototype.loadTile=function(C,R){var O=this,G=C.uid;this.loading||(this.loading={});var ee=!!(C&&C.request&&C.request.collectResourceTiming)&&new s.RequestPerformance(C.request),le=this.loading[G]=new W(C);le.abort=this.loadVectorData(C,function(ce,F){if(delete O.loading[G],ce||!F)return le.status="done",O.loaded[G]=le,R(ce);var re=F.rawData,me={};F.expires&&(me.expires=F.expires),F.cacheControl&&(me.cacheControl=F.cacheControl);var Ce={};if(ee){var Le=ee.finish();Le&&(Ce.resourceTiming=JSON.parse(JSON.stringify(Le)))}le.vectorTile=F.vectorTile,le.parse(F.vectorTile,O.layerIndex,O.availableImages,O.actor,function(be,Be){if(be||!Be)return R(be);R(null,s.extend({rawTileData:re.slice(0)},Be,me,Ce))}),O.loaded=O.loaded||{},O.loaded[G]=le})},fe.prototype.reloadTile=function(C,R){var O=this,G=this.loaded,ee=C.uid,le=this;if(G&&G[ee]){var ce=G[ee];ce.showCollisionBoxes=C.showCollisionBoxes;var F=function(re,me){var Ce=ce.reloadCallback;Ce&&(delete ce.reloadCallback,ce.parse(ce.vectorTile,le.layerIndex,O.availableImages,le.actor,Ce)),R(re,me)};ce.status==="parsing"?ce.reloadCallback=F:ce.status==="done"&&(ce.vectorTile?ce.parse(ce.vectorTile,this.layerIndex,this.availableImages,this.actor,F):F())}},fe.prototype.abortTile=function(C,R){var O=this.loading,G=C.uid;O&&O[G]&&O[G].abort&&(O[G].abort(),delete O[G]),R()},fe.prototype.removeTile=function(C,R){var O=this.loaded,G=C.uid;O&&O[G]&&delete O[G],R()};var Oe=s.window.ImageBitmap,ze=function(){this.loaded={}};function Ke(C,R){if(C.length!==0){Xe(C[0],R);for(var O=1;O<C.length;O++)Xe(C[O],!R)}}function Xe(C,R){for(var O=0,G=0,ee=C.length,le=ee-1;G<ee;le=G++)O+=(C[G][0]-C[le][0])*(C[le][1]+C[G][1]);O>=0!=!!R&&C.reverse()}ze.prototype.loadTile=function(C,R){var O=C.uid,G=C.encoding,ee=C.rawImageData,le=Oe&&ee instanceof Oe?this.getImageData(ee):ee,ce=new s.DEMData(O,le,G);this.loaded=this.loaded||{},this.loaded[O]=ce,R(null,ce)},ze.prototype.getImageData=function(C){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(C.width,C.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=C.width,this.offscreenCanvas.height=C.height,this.offscreenCanvasContext.drawImage(C,0,0,C.width,C.height);var R=this.offscreenCanvasContext.getImageData(-1,-1,C.width+2,C.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new s.RGBAImage({width:R.width,height:R.height},R.data)},ze.prototype.removeTile=function(C){var R=this.loaded,O=C.uid;R&&R[O]&&delete R[O]};var Ft=s.vectorTile.VectorTileFeature.prototype.toGeoJSON,Lt=function(C){this._feature=C,this.extent=s.EXTENT,this.type=C.type,this.properties=C.tags,"id"in C&&!isNaN(C.id)&&(this.id=parseInt(C.id,10))};Lt.prototype.loadGeometry=function(){if(this._feature.type===1){for(var C=[],R=0,O=this._feature.geometry;R<O.length;R+=1){var G=O[R];C.push([new s.Point$1(G[0],G[1])])}return C}for(var ee=[],le=0,ce=this._feature.geometry;le<ce.length;le+=1){for(var F=[],re=0,me=ce[le];re<me.length;re+=1){var Ce=me[re];F.push(new s.Point$1(Ce[0],Ce[1]))}ee.push(F)}return ee},Lt.prototype.toGeoJSON=function(C,R,O){return Ft.call(this,C,R,O)};var ft=function(C){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=C.length,this._features=C};ft.prototype.feature=function(C){return new Lt(this._features[C])};var He=s.vectorTile.VectorTileFeature,xr=cr;function cr(C,R){this.options=R||{},this.features=C,this.length=C.length}function Wt(C,R){this.id=typeof C.id=="number"?C.id:void 0,this.type=C.type,this.rawGeometry=C.type===1?[C.geometry]:C.geometry,this.properties=C.tags,this.extent=R||4096}cr.prototype.feature=function(C){return new Wt(this.features[C],this.options.extent)},Wt.prototype.loadGeometry=function(){var C=this.rawGeometry;this.geometry=[];for(var R=0;R<C.length;R++){for(var O=C[R],G=[],ee=0;ee<O.length;ee++)G.push(new s.Point$1(O[ee][0],O[ee][1]));this.geometry.push(G)}return this.geometry},Wt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var C=this.geometry,R=1/0,O=-1/0,G=1/0,ee=-1/0,le=0;le<C.length;le++)for(var ce=C[le],F=0;F<ce.length;F++){var re=ce[F];R=Math.min(R,re.x),O=Math.max(O,re.x),G=Math.min(G,re.y),ee=Math.max(ee,re.y)}return[R,G,O,ee]},Wt.prototype.toGeoJSON=He.prototype.toGeoJSON;var Ht=mr,qe=xr;function mr(C){var R=new s.pbf;return function(O,G){for(var ee in O.layers)G.writeMessage(3,It,O.layers[ee])}(C,R),R.finish()}function It(C,R){var O;R.writeVarintField(15,C.version||1),R.writeStringField(1,C.name||""),R.writeVarintField(5,C.extent||4096);var G={keys:[],values:[],keycache:{},valuecache:{}};for(O=0;O<C.length;O++)G.feature=C.feature(O),R.writeMessage(2,rr,G);var ee=G.keys;for(O=0;O<ee.length;O++)R.writeStringField(3,ee[O]);var le=G.values;for(O=0;O<le.length;O++)R.writeMessage(4,er,le[O])}function rr(C,R){var O=C.feature;O.id!==void 0&&R.writeVarintField(1,O.id),R.writeMessage(2,it,C),R.writeVarintField(3,O.type),R.writeMessage(4,kt,O)}function it(C,R){var O=C.feature,G=C.keys,ee=C.values,le=C.keycache,ce=C.valuecache;for(var F in O.properties){var re=le[F];re===void 0&&(G.push(F),le[F]=re=G.length-1),R.writeVarint(re);var me=O.properties[F],Ce=typeof me;Ce!=="string"&&Ce!=="boolean"&&Ce!=="number"&&(me=JSON.stringify(me));var Le=Ce+":"+me,be=ce[Le];be===void 0&&(ee.push(me),ce[Le]=be=ee.length-1),R.writeVarint(be)}}function hr(C,R){return(R<<3)+(7&C)}function Or(C){return C<<1^C>>31}function kt(C,R){for(var O=C.loadGeometry(),G=C.type,ee=0,le=0,ce=O.length,F=0;F<ce;F++){var re=O[F],me=1;G===1&&(me=re.length),R.writeVarint(hr(1,me));for(var Ce=G===3?re.length-1:re.length,Le=0;Le<Ce;Le++){Le===1&&G!==1&&R.writeVarint(hr(2,Ce-1));var be=re[Le].x-ee,Be=re[Le].y-le;R.writeVarint(Or(be)),R.writeVarint(Or(Be)),ee+=be,le+=Be}G===3&&R.writeVarint(hr(7,1))}}function er(C,R){var O=typeof C;O==="string"?R.writeStringField(1,C):O==="boolean"?R.writeBooleanField(7,C):O==="number"&&(C%1!=0?R.writeDoubleField(3,C):C<0?R.writeSVarintField(6,C):R.writeVarintField(5,C))}function nt(C,R,O,G){Ze(C,O,G),Ze(R,2*O,2*G),Ze(R,2*O+1,2*G+1)}function Ze(C,R,O){var G=C[R];C[R]=C[O],C[O]=G}function lr(C,R,O,G){var ee=C-O,le=R-G;return ee*ee+le*le}Ht.fromVectorTileJs=mr,Ht.fromGeojsonVt=function(C,R){R=R||{};var O={};for(var G in C)O[G]=new xr(C[G].features,R),O[G].name=G,O[G].version=R.version,O[G].extent=R.extent;return mr({layers:O})},Ht.GeoJSONWrapper=qe;var br=function(C){return C[0]},Yi=function(C){return C[1]},Qi=function(C,R,O,G,ee){R===void 0&&(R=br),O===void 0&&(O=Yi),G===void 0&&(G=64),ee===void 0&&(ee=Float64Array),this.nodeSize=G,this.points=C;for(var le=C.length<65536?Uint16Array:Uint32Array,ce=this.ids=new le(C.length),F=this.coords=new ee(2*C.length),re=0;re<C.length;re++)ce[re]=re,F[2*re]=R(C[re]),F[2*re+1]=O(C[re]);(function me(Ce,Le,be,Be,et,Qe){if(!(et-Be<=be)){var Se=Be+et>>1;(function Je(Ne,Ge,At,je,Pt,ar){for(;Pt>je;){if(Pt-je>600){var Ct=Pt-je+1,Vt=At-je+1,Mt=Math.log(Ct),oi=.5*Math.exp(2*Mt/3),Jt=.5*Math.sqrt(Mt*oi*(Ct-oi)/Ct)*(Vt-Ct/2<0?-1:1);Je(Ne,Ge,At,Math.max(je,Math.floor(At-Vt*oi/Ct+Jt)),Math.min(Pt,Math.floor(At+(Ct-Vt)*oi/Ct+Jt)),ar)}var zr=Ge[2*At+ar],or=je,Bt=Pt;for(nt(Ne,Ge,je,At),Ge[2*Pt+ar]>zr&&nt(Ne,Ge,je,Pt);or<Bt;){for(nt(Ne,Ge,or,Bt),or++,Bt--;Ge[2*or+ar]<zr;)or++;for(;Ge[2*Bt+ar]>zr;)Bt--}Ge[2*je+ar]===zr?nt(Ne,Ge,je,Bt):nt(Ne,Ge,++Bt,Pt),Bt<=At&&(je=Bt+1),At<=Bt&&(Pt=Bt-1)}})(Ce,Le,Se,Be,et,Qe%2),me(Ce,Le,be,Be,Se-1,Qe+1),me(Ce,Le,be,Se+1,et,Qe+1)}})(ce,F,G,0,ce.length-1,0)};Qi.prototype.range=function(C,R,O,G){return function(ee,le,ce,F,re,me,Ce){for(var Le,be,Be=[0,ee.length-1,0],et=[];Be.length;){var Qe=Be.pop(),Se=Be.pop(),Je=Be.pop();if(Se-Je<=Ce)for(var Ne=Je;Ne<=Se;Ne++)be=le[2*Ne+1],(Le=le[2*Ne])>=ce&&Le<=re&&be>=F&&be<=me&&et.push(ee[Ne]);else{var Ge=Math.floor((Je+Se)/2);be=le[2*Ge+1],(Le=le[2*Ge])>=ce&&Le<=re&&be>=F&&be<=me&&et.push(ee[Ge]);var At=(Qe+1)%2;(Qe===0?ce<=Le:F<=be)&&(Be.push(Je),Be.push(Ge-1),Be.push(At)),(Qe===0?re>=Le:me>=be)&&(Be.push(Ge+1),Be.push(Se),Be.push(At))}}return et}(this.ids,this.coords,C,R,O,G,this.nodeSize)},Qi.prototype.within=function(C,R,O){return function(G,ee,le,ce,F,re){for(var me=[0,G.length-1,0],Ce=[],Le=F*F;me.length;){var be=me.pop(),Be=me.pop(),et=me.pop();if(Be-et<=re)for(var Qe=et;Qe<=Be;Qe++)lr(ee[2*Qe],ee[2*Qe+1],le,ce)<=Le&&Ce.push(G[Qe]);else{var Se=Math.floor((et+Be)/2),Je=ee[2*Se],Ne=ee[2*Se+1];lr(Je,Ne,le,ce)<=Le&&Ce.push(G[Se]);var Ge=(be+1)%2;(be===0?le-F<=Je:ce-F<=Ne)&&(me.push(et),me.push(Se-1),me.push(Ge)),(be===0?le+F>=Je:ce+F>=Ne)&&(me.push(Se+1),me.push(Be),me.push(Ge))}}return Ce}(this.ids,this.coords,C,R,O,this.nodeSize)};var Ni={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(C){return C}},Gt=function(C){this.options=wn(Object.create(Ni),C),this.trees=new Array(this.options.maxZoom+1)};function _r(C,R,O,G,ee){return{x:C,y:R,zoom:1/0,id:O,parentId:-1,numPoints:G,properties:ee}}function Rt(C,R){var O=C.geometry.coordinates,G=O[1];return{x:bn(O[0]),y:qt(G),zoom:1/0,index:R,parentId:-1}}function kr(C){return{type:"Feature",id:C.id,properties:xn(C),geometry:{type:"Point",coordinates:[(G=C.x,360*(G-.5)),(R=C.y,O=(180-360*R)*Math.PI/180,360*Math.atan(Math.exp(O))/Math.PI-90)]}};var R,O,G}function xn(C){var R=C.numPoints,O=R>=1e4?Math.round(R/1e3)+"k":R>=1e3?Math.round(R/100)/10+"k":R;return wn(wn({},C.properties),{cluster:!0,cluster_id:C.id,point_count:R,point_count_abbreviated:O})}function bn(C){return C/360+.5}function qt(C){var R=Math.sin(C*Math.PI/180),O=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return O<0?0:O>1?1:O}function wn(C,R){for(var O in R)C[O]=R[O];return C}function Ei(C){return C.x}function Ci(C){return C.y}function Yn(C,R,O,G,ee,le){var ce=ee-O,F=le-G;if(ce!==0||F!==0){var re=((C-O)*ce+(R-G)*F)/(ce*ce+F*F);re>1?(O=ee,G=le):re>0&&(O+=ce*re,G+=F*re)}return(ce=C-O)*ce+(F=R-G)*F}function Zi(C,R,O,G){var ee={id:C===void 0?null:C,type:R,geometry:O,tags:G,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(le){var ce=le.geometry,F=le.type;if(F==="Point"||F==="MultiPoint"||F==="LineString")Qn(le,ce);else if(F==="Polygon"||F==="MultiLineString")for(var re=0;re<ce.length;re++)Qn(le,ce[re]);else if(F==="MultiPolygon")for(re=0;re<ce.length;re++)for(var me=0;me<ce[re].length;me++)Qn(le,ce[re][me])}(ee),ee}function Qn(C,R){for(var O=0;O<R.length;O+=3)C.minX=Math.min(C.minX,R[O]),C.minY=Math.min(C.minY,R[O+1]),C.maxX=Math.max(C.maxX,R[O]),C.maxY=Math.max(C.maxY,R[O+1])}function hi(C,R,O,G){if(R.geometry){var ee=R.geometry.coordinates,le=R.geometry.type,ce=Math.pow(O.tolerance/((1<<O.maxZoom)*O.extent),2),F=[],re=R.id;if(O.promoteId?re=R.properties[O.promoteId]:O.generateId&&(re=G||0),le==="Point")cn(ee,F);else if(le==="MultiPoint")for(var me=0;me<ee.length;me++)cn(ee[me],F);else if(le==="LineString")Bn(ee,F,ce,!1);else if(le==="MultiLineString"){if(O.lineMetrics){for(me=0;me<ee.length;me++)Bn(ee[me],F=[],ce,!1),C.push(Zi(re,"LineString",F,R.properties));return}Mi(ee,F,ce,!1)}else if(le==="Polygon")Mi(ee,F,ce,!0);else{if(le!=="MultiPolygon"){if(le==="GeometryCollection"){for(me=0;me<R.geometry.geometries.length;me++)hi(C,{id:re,geometry:R.geometry.geometries[me],properties:R.properties},O,G);return}throw new Error("Input data is not a valid GeoJSON object.")}for(me=0;me<ee.length;me++){var Ce=[];Mi(ee[me],Ce,ce,!0),F.push(Ce)}}C.push(Zi(re,le,F,R.properties))}}function cn(C,R){R.push(Fr(C[0])),R.push(Yr(C[1])),R.push(0)}function Bn(C,R,O,G){for(var ee,le,ce=0,F=0;F<C.length;F++){var re=Fr(C[F][0]),me=Yr(C[F][1]);R.push(re),R.push(me),R.push(0),F>0&&(ce+=G?(ee*me-re*le)/2:Math.sqrt(Math.pow(re-ee,2)+Math.pow(me-le,2))),ee=re,le=me}var Ce=R.length-3;R[2]=1,function Le(be,Be,et,Qe){for(var Se,Je=Qe,Ne=et-Be>>1,Ge=et-Be,At=be[Be],je=be[Be+1],Pt=be[et],ar=be[et+1],Ct=Be+3;Ct<et;Ct+=3){var Vt=Yn(be[Ct],be[Ct+1],At,je,Pt,ar);if(Vt>Je)Se=Ct,Je=Vt;else if(Vt===Je){var Mt=Math.abs(Ct-Ne);Mt<Ge&&(Se=Ct,Ge=Mt)}}Je>Qe&&(Se-Be>3&&Le(be,Be,Se,Qe),be[Se+2]=Je,et-Se>3&&Le(be,Se,et,Qe))}(R,0,Ce,O),R[Ce+2]=1,R.size=Math.abs(ce),R.start=0,R.end=R.size}function Mi(C,R,O,G){for(var ee=0;ee<C.length;ee++){var le=[];Bn(C[ee],le,O,G),R.push(le)}}function Fr(C){return C/360+.5}function Yr(C){var R=Math.sin(C*Math.PI/180),O=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return O<0?0:O>1?1:O}function Xr(C,R,O,G,ee,le,ce,F){if(G/=R,le>=(O/=R)&&ce<G)return C;if(ce<O||le>=G)return null;for(var re=[],me=0;me<C.length;me++){var Ce=C[me],Le=Ce.geometry,be=Ce.type,Be=ee===0?Ce.minX:Ce.minY,et=ee===0?Ce.maxX:Ce.maxY;if(Be>=O&&et<G)re.push(Ce);else if(!(et<O||Be>=G)){var Qe=[];if(be==="Point"||be==="MultiPoint")go(Le,Qe,O,G,ee);else if(be==="LineString")On(Le,Qe,O,G,ee,!1,F.lineMetrics);else if(be==="MultiLineString")Co(Le,Qe,O,G,ee,!1);else if(be==="Polygon")Co(Le,Qe,O,G,ee,!0);else if(be==="MultiPolygon")for(var Se=0;Se<Le.length;Se++){var Je=[];Co(Le[Se],Je,O,G,ee,!0),Je.length&&Qe.push(Je)}if(Qe.length){if(F.lineMetrics&&be==="LineString"){for(Se=0;Se<Qe.length;Se++)re.push(Zi(Ce.id,be,Qe[Se],Ce.tags));continue}be!=="LineString"&&be!=="MultiLineString"||(Qe.length===1?(be="LineString",Qe=Qe[0]):be="MultiLineString"),be!=="Point"&&be!=="MultiPoint"||(be=Qe.length===3?"Point":"MultiPoint"),re.push(Zi(Ce.id,be,Qe,Ce.tags))}}}return re.length?re:null}function go(C,R,O,G,ee){for(var le=0;le<C.length;le+=3){var ce=C[le+ee];ce>=O&&ce<=G&&(R.push(C[le]),R.push(C[le+1]),R.push(C[le+2]))}}function On(C,R,O,G,ee,le,ce){for(var F,re,me=ya(C),Ce=ee===0?$n:_o,Le=C.start,be=0;be<C.length-3;be+=3){var Be=C[be],et=C[be+1],Qe=C[be+2],Se=C[be+3],Je=C[be+4],Ne=ee===0?Be:et,Ge=ee===0?Se:Je,At=!1;ce&&(F=Math.sqrt(Math.pow(Be-Se,2)+Math.pow(et-Je,2))),Ne<O?Ge>O&&(re=Ce(me,Be,et,Se,Je,O),ce&&(me.start=Le+F*re)):Ne>G?Ge<G&&(re=Ce(me,Be,et,Se,Je,G),ce&&(me.start=Le+F*re)):hn(me,Be,et,Qe),Ge<O&&Ne>=O&&(re=Ce(me,Be,et,Se,Je,O),At=!0),Ge>G&&Ne<=G&&(re=Ce(me,Be,et,Se,Je,G),At=!0),!le&&At&&(ce&&(me.end=Le+F*re),R.push(me),me=ya(C)),ce&&(Le+=F)}var je=C.length-3;Be=C[je],et=C[je+1],Qe=C[je+2],(Ne=ee===0?Be:et)>=O&&Ne<=G&&hn(me,Be,et,Qe),je=me.length-3,le&&je>=3&&(me[je]!==me[0]||me[je+1]!==me[1])&&hn(me,me[0],me[1],me[2]),me.length&&R.push(me)}function ya(C){var R=[];return R.size=C.size,R.start=C.start,R.end=C.end,R}function Co(C,R,O,G,ee,le){for(var ce=0;ce<C.length;ce++)On(C[ce],R,O,G,ee,le,!1)}function hn(C,R,O,G){C.push(R),C.push(O),C.push(G)}function $n(C,R,O,G,ee,le){var ce=(le-R)/(G-R);return C.push(le),C.push(O+(ee-O)*ce),C.push(1),ce}function _o(C,R,O,G,ee,le){var ce=(le-O)/(ee-O);return C.push(R+(G-R)*ce),C.push(le),C.push(1),ce}function Mo(C,R){for(var O=[],G=0;G<C.length;G++){var ee,le=C[G],ce=le.type;if(ce==="Point"||ce==="MultiPoint"||ce==="LineString")ee=$i(le.geometry,R);else if(ce==="MultiLineString"||ce==="Polygon"){ee=[];for(var F=0;F<le.geometry.length;F++)ee.push($i(le.geometry[F],R))}else if(ce==="MultiPolygon")for(ee=[],F=0;F<le.geometry.length;F++){for(var re=[],me=0;me<le.geometry[F].length;me++)re.push($i(le.geometry[F][me],R));ee.push(re)}O.push(Zi(le.id,ce,ee,le.tags))}return O}function $i(C,R){var O=[];O.size=C.size,C.start!==void 0&&(O.start=C.start,O.end=C.end);for(var G=0;G<C.length;G+=3)O.push(C[G]+R,C[G+1],C[G+2]);return O}function eo(C,R){if(C.transformed)return C;var O,G,ee,le=1<<C.z,ce=C.x,F=C.y;for(O=0;O<C.features.length;O++){var re=C.features[O],me=re.geometry,Ce=re.type;if(re.geometry=[],Ce===1)for(G=0;G<me.length;G+=2)re.geometry.push(vo(me[G],me[G+1],R,le,ce,F));else for(G=0;G<me.length;G++){var Le=[];for(ee=0;ee<me[G].length;ee+=2)Le.push(vo(me[G][ee],me[G][ee+1],R,le,ce,F));re.geometry.push(Le)}}return C.transformed=!0,C}function vo(C,R,O,G,ee,le){return[Math.round(O*(C*G-ee)),Math.round(O*(R*G-le))]}function Ho(C,R,O,G,ee){for(var le=R===ee.maxZoom?0:ee.tolerance/((1<<R)*ee.extent),ce={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:O,y:G,z:R,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},F=0;F<C.length;F++){ce.numFeatures++,Jo(ce,C[F],le,ee);var re=C[F].minX,me=C[F].minY,Ce=C[F].maxX,Le=C[F].maxY;re<ce.minX&&(ce.minX=re),me<ce.minY&&(ce.minY=me),Ce>ce.maxX&&(ce.maxX=Ce),Le>ce.maxY&&(ce.maxY=Le)}return ce}function Jo(C,R,O,G){var ee=R.geometry,le=R.type,ce=[];if(le==="Point"||le==="MultiPoint")for(var F=0;F<ee.length;F+=3)ce.push(ee[F]),ce.push(ee[F+1]),C.numPoints++,C.numSimplified++;else if(le==="LineString")Ti(ce,ee,C,O,!1,!1);else if(le==="MultiLineString"||le==="Polygon")for(F=0;F<ee.length;F++)Ti(ce,ee[F],C,O,le==="Polygon",F===0);else if(le==="MultiPolygon")for(var re=0;re<ee.length;re++){var me=ee[re];for(F=0;F<me.length;F++)Ti(ce,me[F],C,O,!0,F===0)}if(ce.length){var Ce=R.tags||null;if(le==="LineString"&&G.lineMetrics){for(var Le in Ce={},R.tags)Ce[Le]=R.tags[Le];Ce.mapbox_clip_start=ee.start/ee.size,Ce.mapbox_clip_end=ee.end/ee.size}var be={geometry:ce,type:le==="Polygon"||le==="MultiPolygon"?3:le==="LineString"||le==="MultiLineString"?2:1,tags:Ce};R.id!==null&&(be.id=R.id),C.features.push(be)}}function Ti(C,R,O,G,ee,le){var ce=G*G;if(G>0&&R.size<(ee?ce:G))O.numPoints+=R.length/3;else{for(var F=[],re=0;re<R.length;re+=3)(G===0||R[re+2]>ce)&&(O.numSimplified++,F.push(R[re]),F.push(R[re+1])),O.numPoints++;ee&&function(me,Ce){for(var Le=0,be=0,Be=me.length,et=Be-2;be<Be;et=be,be+=2)Le+=(me[be]-me[et])*(me[be+1]+me[et+1]);if(Le>0===Ce)for(be=0,Be=me.length;be<Be/2;be+=2){var Qe=me[be],Se=me[be+1];me[be]=me[Be-2-be],me[be+1]=me[Be-1-be],me[Be-2-be]=Qe,me[Be-1-be]=Se}}(F,le),C.push(F)}}function Qr(C,R){var O=(R=this.options=function(ee,le){for(var ce in le)ee[ce]=le[ce];return ee}(Object.create(this.options),R)).debug;if(O&&console.time("preprocess data"),R.maxZoom<0||R.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(R.promoteId&&R.generateId)throw new Error("promoteId and generateId cannot be used together.");var G=function(ee,le){var ce=[];if(ee.type==="FeatureCollection")for(var F=0;F<ee.features.length;F++)hi(ce,ee.features[F],le,F);else hi(ce,ee.type==="Feature"?ee:{geometry:ee},le);return ce}(C,R);this.tiles={},this.tileCoords=[],O&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",R.indexMaxZoom,R.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(G=function(ee,le){var ce=le.buffer/le.extent,F=ee,re=Xr(ee,1,-1-ce,ce,0,-1,2,le),me=Xr(ee,1,1-ce,2+ce,0,-1,2,le);return(re||me)&&(F=Xr(ee,1,-ce,1+ce,0,-1,2,le)||[],re&&(F=Mo(re,1).concat(F)),me&&(F=F.concat(Mo(me,-1)))),F}(G,R)).length&&this.splitTile(G,0,0,0),O&&(G.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ii(C,R,O){return 32*((1<<C)*O+R)+C}function xo(C,R){var O=C.tileID.canonical;if(!this._geoJSONIndex)return R(null,null);var G=this._geoJSONIndex.getTile(O.z,O.x,O.y);if(!G)return R(null,null);var ee=new ft(G.features),le=Ht(ee);le.byteOffset===0&&le.byteLength===le.buffer.byteLength||(le=new Uint8Array(le)),R(null,{vectorTile:ee,rawData:le.buffer})}Gt.prototype.load=function(C){var R=this.options,O=R.log,G=R.minZoom,ee=R.maxZoom,le=R.nodeSize;O&&console.time("total time");var ce="prepare "+C.length+" points";O&&console.time(ce),this.points=C;for(var F=[],re=0;re<C.length;re++)C[re].geometry&&F.push(Rt(C[re],re));this.trees[ee+1]=new Qi(F,Ei,Ci,le,Float32Array),O&&console.timeEnd(ce);for(var me=ee;me>=G;me--){var Ce=+Date.now();F=this._cluster(F,me),this.trees[me]=new Qi(F,Ei,Ci,le,Float32Array),O&&console.log("z%d: %d clusters in %dms",me,F.length,+Date.now()-Ce)}return O&&console.timeEnd("total time"),this},Gt.prototype.getClusters=function(C,R){var O=((C[0]+180)%360+360)%360-180,G=Math.max(-90,Math.min(90,C[1])),ee=C[2]===180?180:((C[2]+180)%360+360)%360-180,le=Math.max(-90,Math.min(90,C[3]));if(C[2]-C[0]>=360)O=-180,ee=180;else if(O>ee){var ce=this.getClusters([O,G,180,le],R),F=this.getClusters([-180,G,ee,le],R);return ce.concat(F)}for(var re=this.trees[this._limitZoom(R)],me=[],Ce=0,Le=re.range(bn(O),qt(le),bn(ee),qt(G));Ce<Le.length;Ce+=1){var be=re.points[Le[Ce]];me.push(be.numPoints?kr(be):this.points[be.index])}return me},Gt.prototype.getChildren=function(C){var R=this._getOriginId(C),O=this._getOriginZoom(C),G="No cluster with the specified id.",ee=this.trees[O];if(!ee)throw new Error(G);var le=ee.points[R];if(!le)throw new Error(G);for(var ce=this.options.radius/(this.options.extent*Math.pow(2,O-1)),F=[],re=0,me=ee.within(le.x,le.y,ce);re<me.length;re+=1){var Ce=ee.points[me[re]];Ce.parentId===C&&F.push(Ce.numPoints?kr(Ce):this.points[Ce.index])}if(F.length===0)throw new Error(G);return F},Gt.prototype.getLeaves=function(C,R,O){var G=[];return this._appendLeaves(G,C,R=R||10,O=O||0,0),G},Gt.prototype.getTile=function(C,R,O){var G=this.trees[this._limitZoom(C)],ee=Math.pow(2,C),le=this.options,ce=le.radius/le.extent,F=(O-ce)/ee,re=(O+1+ce)/ee,me={features:[]};return this._addTileFeatures(G.range((R-ce)/ee,F,(R+1+ce)/ee,re),G.points,R,O,ee,me),R===0&&this._addTileFeatures(G.range(1-ce/ee,F,1,re),G.points,ee,O,ee,me),R===ee-1&&this._addTileFeatures(G.range(0,F,ce/ee,re),G.points,-1,O,ee,me),me.features.length?me:null},Gt.prototype.getClusterExpansionZoom=function(C){for(var R=this._getOriginZoom(C)-1;R<=this.options.maxZoom;){var O=this.getChildren(C);if(R++,O.length!==1)break;C=O[0].properties.cluster_id}return R},Gt.prototype._appendLeaves=function(C,R,O,G,ee){for(var le=0,ce=this.getChildren(R);le<ce.length;le+=1){var F=ce[le],re=F.properties;if(re&&re.cluster?ee+re.point_count<=G?ee+=re.point_count:ee=this._appendLeaves(C,re.cluster_id,O,G,ee):ee<G?ee++:C.push(F),C.length===O)break}return ee},Gt.prototype._addTileFeatures=function(C,R,O,G,ee,le){for(var ce=0,F=C;ce<F.length;ce+=1){var re=R[F[ce]],me=re.numPoints,Ce={type:1,geometry:[[Math.round(this.options.extent*(re.x*ee-O)),Math.round(this.options.extent*(re.y*ee-G))]],tags:me?xn(re):this.points[re.index].properties},Le=void 0;me?Le=re.id:this.options.generateId?Le=re.index:this.points[re.index].id&&(Le=this.points[re.index].id),Le!==void 0&&(Ce.id=Le),le.features.push(Ce)}},Gt.prototype._limitZoom=function(C){return Math.max(this.options.minZoom,Math.min(+C,this.options.maxZoom+1))},Gt.prototype._cluster=function(C,R){for(var O=[],G=this.options,ee=G.reduce,le=G.minPoints,ce=G.radius/(G.extent*Math.pow(2,R)),F=0;F<C.length;F++){var re=C[F];if(!(re.zoom<=R)){re.zoom=R;for(var me=this.trees[R+1],Ce=me.within(re.x,re.y,ce),Le=re.numPoints||1,be=Le,Be=0,et=Ce;Be<et.length;Be+=1){var Qe=me.points[et[Be]];Qe.zoom>R&&(be+=Qe.numPoints||1)}if(be>=le){for(var Se=re.x*Le,Je=re.y*Le,Ne=ee&&Le>1?this._map(re,!0):null,Ge=(F<<5)+(R+1)+this.points.length,At=0,je=Ce;At<je.length;At+=1){var Pt=me.points[je[At]];if(!(Pt.zoom<=R)){Pt.zoom=R;var ar=Pt.numPoints||1;Se+=Pt.x*ar,Je+=Pt.y*ar,Pt.parentId=Ge,ee&&(Ne||(Ne=this._map(re,!0)),ee(Ne,this._map(Pt)))}}re.parentId=Ge,O.push(_r(Se/be,Je/be,Ge,be,Ne))}else if(O.push(re),be>1)for(var Ct=0,Vt=Ce;Ct<Vt.length;Ct+=1){var Mt=me.points[Vt[Ct]];Mt.zoom<=R||(Mt.zoom=R,O.push(Mt))}}}return O},Gt.prototype._getOriginId=function(C){return C-this.points.length>>5},Gt.prototype._getOriginZoom=function(C){return(C-this.points.length)%32},Gt.prototype._map=function(C,R){if(C.numPoints)return R?wn({},C.properties):C.properties;var O=this.points[C.index].properties,G=this.options.map(O);return R&&G===O?wn({},G):G},Qr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Qr.prototype.splitTile=function(C,R,O,G,ee,le,ce){for(var F=[C,R,O,G],re=this.options,me=re.debug;F.length;){G=F.pop(),O=F.pop(),R=F.pop(),C=F.pop();var Ce=1<<R,Le=Ii(R,O,G),be=this.tiles[Le];if(!be&&(me>1&&console.time("creation"),be=this.tiles[Le]=Ho(C,R,O,G,re),this.tileCoords.push({z:R,x:O,y:G}),me)){me>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",R,O,G,be.numFeatures,be.numPoints,be.numSimplified),console.timeEnd("creation"));var Be="z"+R;this.stats[Be]=(this.stats[Be]||0)+1,this.total++}if(be.source=C,ee){if(R===re.maxZoom||R===ee)continue;var et=1<<ee-R;if(O!==Math.floor(le/et)||G!==Math.floor(ce/et))continue}else if(R===re.indexMaxZoom||be.numPoints<=re.indexMaxPoints)continue;if(be.source=null,C.length!==0){me>1&&console.time("clipping");var Qe,Se,Je,Ne,Ge,At,je=.5*re.buffer/re.extent,Pt=.5-je,ar=.5+je,Ct=1+je;Qe=Se=Je=Ne=null,Ge=Xr(C,Ce,O-je,O+ar,0,be.minX,be.maxX,re),At=Xr(C,Ce,O+Pt,O+Ct,0,be.minX,be.maxX,re),C=null,Ge&&(Qe=Xr(Ge,Ce,G-je,G+ar,1,be.minY,be.maxY,re),Se=Xr(Ge,Ce,G+Pt,G+Ct,1,be.minY,be.maxY,re),Ge=null),At&&(Je=Xr(At,Ce,G-je,G+ar,1,be.minY,be.maxY,re),Ne=Xr(At,Ce,G+Pt,G+Ct,1,be.minY,be.maxY,re),At=null),me>1&&console.timeEnd("clipping"),F.push(Qe||[],R+1,2*O,2*G),F.push(Se||[],R+1,2*O,2*G+1),F.push(Je||[],R+1,2*O+1,2*G),F.push(Ne||[],R+1,2*O+1,2*G+1)}}},Qr.prototype.getTile=function(C,R,O){var G=this.options,ee=G.extent,le=G.debug;if(C<0||C>24)return null;var ce=1<<C,F=Ii(C,R=(R%ce+ce)%ce,O);if(this.tiles[F])return eo(this.tiles[F],ee);le>1&&console.log("drilling down to z%d-%d-%d",C,R,O);for(var re,me=C,Ce=R,Le=O;!re&&me>0;)me--,Ce=Math.floor(Ce/2),Le=Math.floor(Le/2),re=this.tiles[Ii(me,Ce,Le)];return re&&re.source?(le>1&&console.log("found parent tile z%d-%d-%d",me,Ce,Le),le>1&&console.time("drilling down"),this.splitTile(re.source,me,Ce,Le,C,R,O),le>1&&console.timeEnd("drilling down"),this.tiles[F]?eo(this.tiles[F],ee):null):null};var en=function(C){function R(O,G,ee,le){C.call(this,O,G,ee,xo),le&&(this.loadGeoJSON=le)}return C&&(R.__proto__=C),(R.prototype=Object.create(C&&C.prototype)).constructor=R,R.prototype.loadData=function(O,G){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=G,this._pendingLoadDataParams=O,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},R.prototype._loadData=function(){var O=this;if(this._pendingCallback&&this._pendingLoadDataParams){var G=this._pendingCallback,ee=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var le=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new s.RequestPerformance(ee.request);this.loadGeoJSON(ee,function(ce,F){if(ce||!F)return G(ce);if(typeof F!="object")return G(new Error("Input data given to '"+ee.source+"' is not a valid GeoJSON object."));(function be(Be,et){var Qe,Se=Be&&Be.type;if(Se==="FeatureCollection")for(Qe=0;Qe<Be.features.length;Qe++)be(Be.features[Qe],et);else if(Se==="GeometryCollection")for(Qe=0;Qe<Be.geometries.length;Qe++)be(Be.geometries[Qe],et);else if(Se==="Feature")be(Be.geometry,et);else if(Se==="Polygon")Ke(Be.coordinates,et);else if(Se==="MultiPolygon")for(Qe=0;Qe<Be.coordinates.length;Qe++)Ke(Be.coordinates[Qe],et);return Be})(F,!0);try{if(ee.filter){var re=s.createExpression(ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(re.result==="error")throw new Error(re.value.map(function(be){return be.key+": "+be.message}).join(", "));var me=F.features.filter(function(be){return re.value.evaluate({zoom:0},be)});F={type:"FeatureCollection",features:me}}O._geoJSONIndex=ee.cluster?new Gt(function(be){var Be=be.superclusterOptions,et=be.clusterProperties;if(!et||!Be)return Be;for(var Qe={},Se={},Je={accumulated:null,zoom:0},Ne={properties:null},Ge=Object.keys(et),At=0,je=Ge;At<je.length;At+=1){var Pt=je[At],ar=et[Pt],Ct=ar[0],Vt=s.createExpression(ar[1]),Mt=s.createExpression(typeof Ct=="string"?[Ct,["accumulated"],["get",Pt]]:Ct);Qe[Pt]=Vt.value,Se[Pt]=Mt.value}return Be.map=function(oi){Ne.properties=oi;for(var Jt={},zr=0,or=Ge;zr<or.length;zr+=1){var Bt=or[zr];Jt[Bt]=Qe[Bt].evaluate(Je,Ne)}return Jt},Be.reduce=function(oi,Jt){Ne.properties=Jt;for(var zr=0,or=Ge;zr<or.length;zr+=1){var Bt=or[zr];Je.accumulated=oi[Bt],oi[Bt]=Se[Bt].evaluate(Je,Ne)}},Be}(ee)).load(F.features):function(be,Be){return new Qr(be,Be)}(F,ee.geojsonVtOptions)}catch(be){return G(be)}O.loaded={};var Ce={};if(le){var Le=le.finish();Le&&(Ce.resourceTiming={},Ce.resourceTiming[ee.source]=JSON.parse(JSON.stringify(Le)))}G(null,Ce)})}},R.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},R.prototype.reloadTile=function(O,G){var ee=this.loaded;return ee&&ee[O.uid]?C.prototype.reloadTile.call(this,O,G):this.loadTile(O,G)},R.prototype.loadGeoJSON=function(O,G){if(O.request)s.getJSON(O.request,G);else{if(typeof O.data!="string")return G(new Error("Input data given to '"+O.source+"' is not a valid GeoJSON object."));try{return G(null,JSON.parse(O.data))}catch{return G(new Error("Input data given to '"+O.source+"' is not a valid GeoJSON object."))}}},R.prototype.removeSource=function(O,G){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),G()},R.prototype.getClusterExpansionZoom=function(O,G){try{G(null,this._geoJSONIndex.getClusterExpansionZoom(O.clusterId))}catch(ee){G(ee)}},R.prototype.getClusterChildren=function(O,G){try{G(null,this._geoJSONIndex.getChildren(O.clusterId))}catch(ee){G(ee)}},R.prototype.getClusterLeaves=function(O,G){try{G(null,this._geoJSONIndex.getLeaves(O.clusterId,O.limit,O.offset))}catch(ee){G(ee)}},R}(fe),Dr=function(C){var R=this;this.self=C,this.actor=new s.Actor(C,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:fe,geojson:en},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(O,G){if(R.workerSourceTypes[O])throw new Error('Worker source with name "'+O+'" already registered.');R.workerSourceTypes[O]=G},this.self.registerRTLTextPlugin=function(O){if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=O.applyArabicShaping,s.plugin.processBidirectionalText=O.processBidirectionalText,s.plugin.processStyledBidirectionalText=O.processStyledBidirectionalText}};return Dr.prototype.setReferrer=function(C,R){this.referrer=R},Dr.prototype.setImages=function(C,R,O){for(var G in this.availableImages[C]=R,this.workerSources[C]){var ee=this.workerSources[C][G];for(var le in ee)ee[le].availableImages=R}O()},Dr.prototype.setLayers=function(C,R,O){this.getLayerIndex(C).replace(R),O()},Dr.prototype.updateLayers=function(C,R,O){this.getLayerIndex(C).update(R.layers,R.removedIds),O()},Dr.prototype.loadTile=function(C,R,O){this.getWorkerSource(C,R.type,R.source).loadTile(R,O)},Dr.prototype.loadDEMTile=function(C,R,O){this.getDEMWorkerSource(C,R.source).loadTile(R,O)},Dr.prototype.reloadTile=function(C,R,O){this.getWorkerSource(C,R.type,R.source).reloadTile(R,O)},Dr.prototype.abortTile=function(C,R,O){this.getWorkerSource(C,R.type,R.source).abortTile(R,O)},Dr.prototype.removeTile=function(C,R,O){this.getWorkerSource(C,R.type,R.source).removeTile(R,O)},Dr.prototype.removeDEMTile=function(C,R){this.getDEMWorkerSource(C,R.source).removeTile(R)},Dr.prototype.removeSource=function(C,R,O){if(this.workerSources[C]&&this.workerSources[C][R.type]&&this.workerSources[C][R.type][R.source]){var G=this.workerSources[C][R.type][R.source];delete this.workerSources[C][R.type][R.source],G.removeSource!==void 0?G.removeSource(R,O):O()}},Dr.prototype.loadWorkerSource=function(C,R,O){try{this.self.importScripts(R.url),O()}catch(G){O(G.toString())}},Dr.prototype.syncRTLPluginState=function(C,R,O){try{s.plugin.setState(R);var G=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&G!=null){this.self.importScripts(G);var ee=s.plugin.isParsed();O(ee?void 0:new Error("RTL Text Plugin failed to import scripts from "+G),ee)}}catch(le){O(le.toString())}},Dr.prototype.getAvailableImages=function(C){var R=this.availableImages[C];return R||(R=[]),R},Dr.prototype.getLayerIndex=function(C){var R=this.layerIndexes[C];return R||(R=this.layerIndexes[C]=new V),R},Dr.prototype.getWorkerSource=function(C,R,O){var G=this;return this.workerSources[C]||(this.workerSources[C]={}),this.workerSources[C][R]||(this.workerSources[C][R]={}),this.workerSources[C][R][O]||(this.workerSources[C][R][O]=new this.workerSourceTypes[R]({send:function(ee,le,ce){G.actor.send(ee,le,ce,C)}},this.getLayerIndex(C),this.getAvailableImages(C))),this.workerSources[C][R][O]},Dr.prototype.getDEMWorkerSource=function(C,R){return this.demWorkerSources[C]||(this.demWorkerSources[C]={}),this.demWorkerSources[C][R]||(this.demWorkerSources[C][R]=new ze),this.demWorkerSources[C][R]},Dr.prototype.enforceCacheSizeLimit=function(C,R){s.enforceCacheSizeLimit(R)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Dr(self)),Dr}),E(["./shared"],function(s){var M=s.createCommonjsModule(function(n){function a(d){return!o(d)}function o(d){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var x,T,z=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(z);try{T=new Worker(L),x=!0}catch{x=!1}return T&&T.terminate(),URL.revokeObjectURL(L),x}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var x=document.createElement("canvas");x.width=x.height=1;var T=x.getContext("2d");if(!T)return!1;var z=T.getImageData(0,0,1,1);return z&&z.width===x.width}()?(u[_=d&&d.failIfMajorPerformanceCaveat]===void 0&&(u[_]=function(x){var T=function(L){var j=document.createElement("canvas"),q=Object.create(a.webGLContextAttributes);return q.failIfMajorPerformanceCaveat=L,j.probablySupportsContext?j.probablySupportsContext("webgl",q)||j.probablySupportsContext("experimental-webgl",q):j.supportsContext?j.supportsContext("webgl",q)||j.supportsContext("experimental-webgl",q):j.getContext("webgl",q)||j.getContext("experimental-webgl",q)}(x);if(!T)return!1;var z=T.createShader(T.VERTEX_SHADER);return!(!z||T.isContextLost())&&(T.shaderSource(z,"void main() {}"),T.compileShader(z),T.getShaderParameter(z,T.COMPILE_STATUS)===!0)}(_)),u[_]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var _}n.exports?n.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=o);var u={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),A={create:function(n,a,o){var u=s.window.document.createElement(n);return a!==void 0&&(u.className=a),o&&o.appendChild(u),u},createNS:function(n,a){return s.window.document.createElementNS(n,a)}},V=s.window.document&&s.window.document.documentElement.style;function N(n){if(!V)return n[0];for(var a=0;a<n.length;a++)if(n[a]in V)return n[a];return n[0]}var W,K=N(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);A.disableDrag=function(){V&&K&&(W=V[K],V[K]="none")},A.enableDrag=function(){V&&K&&(V[K]=W)};var H=N(["transform","WebkitTransform"]);A.setTransform=function(n,a){n.style[H]=a};var fe=!1;try{var Oe=Object.defineProperty({},"passive",{get:function(){fe=!0}});s.window.addEventListener("test",Oe,Oe),s.window.removeEventListener("test",Oe,Oe)}catch{fe=!1}A.addEventListener=function(n,a,o,u){u===void 0&&(u={}),n.addEventListener(a,o,"passive"in u&&fe?u:u.capture)},A.removeEventListener=function(n,a,o,u){u===void 0&&(u={}),n.removeEventListener(a,o,"passive"in u&&fe?u:u.capture)};var ze=function(n){n.preventDefault(),n.stopPropagation(),s.window.removeEventListener("click",ze,!0)};function Ke(n){var a=n.userImage;return!!(a&&a.render&&a.render())&&(n.data.replace(new Uint8Array(a.data.buffer)),!0)}A.suppressClick=function(){s.window.addEventListener("click",ze,!0),s.window.setTimeout(function(){s.window.removeEventListener("click",ze,!0)},0)},A.mousePos=function(n,a){var o=n.getBoundingClientRect();return new s.Point(a.clientX-o.left-n.clientLeft,a.clientY-o.top-n.clientTop)},A.touchPos=function(n,a){for(var o=n.getBoundingClientRect(),u=[],d=0;d<a.length;d++)u.push(new s.Point(a[d].clientX-o.left-n.clientLeft,a[d].clientY-o.top-n.clientTop));return u},A.mouseButton=function(n){return s.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},A.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var Xe=function(n){function a(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.isLoaded=function(){return this.loaded},a.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var u=0,d=this.requestors;u<d.length;u+=1){var _=d[u];this._notify(_.ids,_.callback)}this.requestors=[]}},a.prototype.getImage=function(o){return this.images[o]},a.prototype.addImage=function(o,u){this._validate(o,u)&&(this.images[o]=u)},a.prototype._validate=function(o,u){var d=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new s.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),d=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new s.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),d=!1),this._validateContent(u.content,u)||(this.fire(new s.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),d=!1),d},a.prototype._validateStretch=function(o,u){if(!o)return!0;for(var d=0,_=0,x=o;_<x.length;_+=1){var T=x[_];if(T[0]<d||T[1]<T[0]||u<T[1])return!1;d=T[1]}return!0},a.prototype._validateContent=function(o,u){return!(o&&(o.length!==4||o[0]<0||u.data.width<o[0]||o[1]<0||u.data.height<o[1]||o[2]<0||u.data.width<o[2]||o[3]<0||u.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},a.prototype.updateImage=function(o,u){u.version=this.images[o].version+1,this.images[o]=u,this.updatedImages[o]=!0},a.prototype.removeImage=function(o){var u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()},a.prototype.listImages=function(){return Object.keys(this.images)},a.prototype.getImages=function(o,u){var d=!0;if(!this.isLoaded())for(var _=0,x=o;_<x.length;_+=1)this.images[x[_]]||(d=!1);this.isLoaded()||d?this._notify(o,u):this.requestors.push({ids:o,callback:u})},a.prototype._notify=function(o,u){for(var d={},_=0,x=o;_<x.length;_+=1){var T=x[_];this.images[T]||this.fire(new s.Event("styleimagemissing",{id:T}));var z=this.images[T];z?d[T]={data:z.data.clone(),pixelRatio:z.pixelRatio,sdf:z.sdf,version:z.version,stretchX:z.stretchX,stretchY:z.stretchY,content:z.content,hasRenderCallback:Boolean(z.userImage&&z.userImage.render)}:s.warnOnce('Image "'+T+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}u(null,d)},a.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},a.prototype.getPattern=function(o){var u=this.patterns[o],d=this.getImage(o);if(!d)return null;if(u&&u.position.version===d.version)return u.position;if(u)u.position.version=d.version;else{var _={w:d.data.width+2,h:d.data.height+2,x:0,y:0},x=new s.ImagePosition(_,d);this.patterns[o]={bin:_,position:x}}return this._updatePatternAtlas(),this.patterns[o].position},a.prototype.bind=function(o){var u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(o,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)},a.prototype._updatePatternAtlas=function(){var o=[];for(var u in this.patterns)o.push(this.patterns[u].bin);var d=s.potpack(o),_=d.w,x=d.h,T=this.atlasImage;for(var z in T.resize({width:_||1,height:x||1}),this.patterns){var L=this.patterns[z].bin,j=L.x+1,q=L.y+1,Z=this.images[z].data,J=Z.width,Q=Z.height;s.RGBAImage.copy(Z,T,{x:0,y:0},{x:j,y:q},{width:J,height:Q}),s.RGBAImage.copy(Z,T,{x:0,y:Q-1},{x:j,y:q-1},{width:J,height:1}),s.RGBAImage.copy(Z,T,{x:0,y:0},{x:j,y:q+Q},{width:J,height:1}),s.RGBAImage.copy(Z,T,{x:J-1,y:0},{x:j-1,y:q},{width:1,height:Q}),s.RGBAImage.copy(Z,T,{x:0,y:0},{x:j+J,y:q},{width:1,height:Q})}this.dirty=!0},a.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},a.prototype.dispatchRenderCallbacks=function(o){for(var u=0,d=o;u<d.length;u+=1){var _=d[u];if(!this.callbackDispatchedThisFrame[_]){this.callbackDispatchedThisFrame[_]=!0;var x=this.images[_];Ke(x)&&this.updateImage(_,x)}}},a}(s.Evented),Ft=He,Lt=He,ft=1e20;function He(n,a,o,u,d,_){this.fontSize=n||24,this.buffer=a===void 0?3:a,this.cutoff=u||.25,this.fontFamily=d||"sans-serif",this.fontWeight=_||"normal",this.radius=o||8;var x=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=x,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.d=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Int16Array(x),this.middle=Math.round(x/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function xr(n,a,o,u,d,_,x){for(var T=0;T<a;T++){for(var z=0;z<o;z++)u[z]=n[z*a+T];for(cr(u,d,_,x,o),z=0;z<o;z++)n[z*a+T]=d[z]}for(z=0;z<o;z++){for(T=0;T<a;T++)u[T]=n[z*a+T];for(cr(u,d,_,x,a),T=0;T<a;T++)n[z*a+T]=Math.sqrt(d[T])}}function cr(n,a,o,u,d){o[0]=0,u[0]=-ft,u[1]=+ft;for(var _=1,x=0;_<d;_++){for(var T=(n[_]+_*_-(n[o[x]]+o[x]*o[x]))/(2*_-2*o[x]);T<=u[x];)x--,T=(n[_]+_*_-(n[o[x]]+o[x]*o[x]))/(2*_-2*o[x]);o[++x]=_,u[x]=T,u[x+1]=+ft}for(_=0,x=0;_<d;_++){for(;u[x+1]<_;)x++;a[_]=(_-o[x])*(_-o[x])+n[o[x]]}}He.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),u=0;u<this.size*this.size;u++){var d=a.data[4*u+3]/255;this.gridOuter[u]=d===1?0:d===0?ft:Math.pow(Math.max(0,.5-d),2),this.gridInner[u]=d===1?ft:d===0?0:Math.pow(Math.max(0,d-.5),2)}for(xr(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),xr(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),u=0;u<this.size*this.size;u++)o[u]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[u]-this.gridInner[u])/this.radius+this.cutoff))));return o},Ft.default=Lt;var Wt=function(n,a){this.requestManager=n,this.localIdeographFontFamily=a,this.entries={}};Wt.prototype.setURL=function(n){this.url=n},Wt.prototype.getGlyphs=function(n,a){var o=this,u=[];for(var d in n)for(var _=0,x=n[d];_<x.length;_+=1)u.push({stack:d,id:x[_]});s.asyncAll(u,function(T,z){var L=T.stack,j=T.id,q=o.entries[L];q||(q=o.entries[L]={glyphs:{},requests:{},ranges:{}});var Z=q.glyphs[j];if(Z===void 0){if(Z=o._tinySDF(q,L,j))return q.glyphs[j]=Z,void z(null,{stack:L,id:j,glyph:Z});var J=Math.floor(j/256);if(256*J>65535)z(new Error("glyphs > 65535 not supported"));else if(q.ranges[J])z(null,{stack:L,id:j,glyph:Z});else{var Q=q.requests[J];Q||(Q=q.requests[J]=[],Wt.loadGlyphRange(L,J,o.url,o.requestManager,function(oe,Y){if(Y){for(var ae in Y)o._doesCharSupportLocalGlyph(+ae)||(q.glyphs[+ae]=Y[+ae]);q.ranges[J]=!0}for(var he=0,ye=Q;he<ye.length;he+=1)(0,ye[he])(oe,Y);delete q.requests[J]})),Q.push(function(oe,Y){oe?z(oe):Y&&z(null,{stack:L,id:j,glyph:Y[j]||null})})}}else z(null,{stack:L,id:j,glyph:Z})},function(T,z){if(T)a(T);else if(z){for(var L={},j=0,q=z;j<q.length;j+=1){var Z=q[j],J=Z.stack,Q=Z.id,oe=Z.glyph;(L[J]||(L[J]={}))[Q]=oe&&{id:oe.id,bitmap:oe.bitmap.clone(),metrics:oe.metrics}}a(null,L)}})},Wt.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(s.isChar["CJK Unified Ideographs"](n)||s.isChar["Hangul Syllables"](n)||s.isChar.Hiragana(n)||s.isChar.Katakana(n))},Wt.prototype._tinySDF=function(n,a,o){var u=this.localIdeographFontFamily;if(u&&this._doesCharSupportLocalGlyph(o)){var d=n.tinySDF;if(!d){var _="400";/bold/i.test(a)?_="900":/medium/i.test(a)?_="500":/light/i.test(a)&&(_="200"),d=n.tinySDF=new Wt.TinySDF(24,3,8,.25,u,_)}return{id:o,bitmap:new s.AlphaImage({width:30,height:30},d.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Wt.loadGlyphRange=function(n,a,o,u,d){var _=256*a,x=_+255,T=u.transformRequest(u.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",_+"-"+x),s.ResourceType.Glyphs);s.getArrayBuffer(T,function(z,L){if(z)d(z);else if(L){for(var j={},q=0,Z=s.parseGlyphPBF(L);q<Z.length;q+=1){var J=Z[q];j[J.id]=J}d(null,j)}})},Wt.TinySDF=Ft;var Ht=function(){this.specification=s.styleSpec.light.position};Ht.prototype.possiblyEvaluate=function(n,a){return s.sphericalToCartesian(n.expression.evaluate(a))},Ht.prototype.interpolate=function(n,a,o){return{x:s.number(n.x,a.x,o),y:s.number(n.y,a.y,o),z:s.number(n.z,a.z,o)}};var qe=new s.Properties({anchor:new s.DataConstantProperty(s.styleSpec.light.anchor),position:new Ht,color:new s.DataConstantProperty(s.styleSpec.light.color),intensity:new s.DataConstantProperty(s.styleSpec.light.intensity)}),mr=function(n){function a(o){n.call(this),this._transitionable=new s.Transitionable(qe),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getLight=function(){return this._transitionable.serialize()},a.prototype.setLight=function(o,u){if(u===void 0&&(u={}),!this._validate(s.validateLight,o,u))for(var d in o){var _=o[d];s.endsWith(d,"-transition")?this._transitionable.setTransition(d.slice(0,-11),_):this._transitionable.setValue(d,_)}},a.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},a.prototype.hasTransition=function(){return this._transitioning.hasTransition()},a.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},a.prototype._validate=function(o,u,d){return(!d||d.validate!==!1)&&s.emitValidationErrors(this,o.call(s.validateStyle,s.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.styleSpec})))},a}(s.Evented),It=function(n,a){this.width=n,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};It.prototype.getDash=function(n,a){var o=n.join(",")+String(a);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,a)),this.dashEntry[o]},It.prototype.getDashRanges=function(n,a,o){var u=[],d=n.length%2==1?-n[n.length-1]*o:0,_=n[0]*o,x=!0;u.push({left:d,right:_,isDash:x,zeroLength:n[0]===0});for(var T=n[0],z=1;z<n.length;z++){var L=n[z];u.push({left:d=T*o,right:_=(T+=L)*o,isDash:x=!x,zeroLength:L===0})}return u},It.prototype.addRoundDash=function(n,a,o){for(var u=a/2,d=-o;d<=o;d++)for(var _=this.width*(this.nextRow+o+d),x=0,T=n[x],z=0;z<this.width;z++){z/T.right>1&&(T=n[++x]);var L=Math.abs(z-T.left),j=Math.abs(z-T.right),q=Math.min(L,j),Z=void 0,J=d/o*(u+1);if(T.isDash){var Q=u-Math.abs(J);Z=Math.sqrt(q*q+Q*Q)}else Z=u-Math.sqrt(q*q+J*J);this.data[_+z]=Math.max(0,Math.min(255,Z+128))}},It.prototype.addRegularDash=function(n){for(var a=n.length-1;a>=0;--a){var o=n[a],u=n[a+1];o.zeroLength?n.splice(a,1):u&&u.isDash===o.isDash&&(u.left=o.left,n.splice(a,1))}var d=n[0],_=n[n.length-1];d.isDash===_.isDash&&(d.left=_.left-this.width,_.right=d.right+this.width);for(var x=this.width*this.nextRow,T=0,z=n[T],L=0;L<this.width;L++){L/z.right>1&&(z=n[++T]);var j=Math.abs(L-z.left),q=Math.abs(L-z.right),Z=Math.min(j,q);this.data[x+L]=Math.max(0,Math.min(255,(z.isDash?Z:-Z)+128))}},It.prototype.addDash=function(n,a){var o=a?7:0,u=2*o+1;if(this.nextRow+u>this.height)return s.warnOnce("LineAtlas out of space"),null;for(var d=0,_=0;_<n.length;_++)d+=n[_];if(d!==0){var x=this.width/d,T=this.getDashRanges(n,this.width,x);a?this.addRoundDash(T,x,o):this.addRegularDash(T)}var z={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:d};return this.nextRow+=u,this.dirty=!0,z},It.prototype.bind=function(n){var a=n.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var rr=function n(a,o){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=s.uniqueId();for(var u=this.workerPool.acquire(this.id),d=0;d<u.length;d++){var _=new n.Actor(u[d],o,this.id);_.name="Worker "+d,this.actors.push(_)}};function it(n,a,o){var u=function(d,_){if(d)return o(d);if(_){var x=s.pick(s.extend(_,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);_.vector_layers&&(x.vectorLayers=_.vector_layers,x.vectorLayerIds=x.vectorLayers.map(function(T){return T.id})),x.tiles=a.canonicalizeTileset(x,n.url),o(null,x)}};return n.url?s.getJSON(a.transformRequest(a.normalizeSourceURL(n.url),s.ResourceType.Source),u):s.browser.frame(function(){return u(null,n)})}rr.prototype.broadcast=function(n,a,o){s.asyncAll(this.actors,function(u,d){u.send(n,a,d)},o=o||function(){})},rr.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},rr.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},rr.Actor=s.Actor;var hr=function(n,a,o){this.bounds=s.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=a||0,this.maxzoom=o||24};hr.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},hr.prototype.contains=function(n){var a=Math.pow(2,n.z),o=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*a),u=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*a),d=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*a),_=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*a);return n.x>=o&&n.x<d&&n.y>=u&&n.y<_};var Or=function(n){function a(o,u,d,_){if(n.call(this),this.id=o,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(u,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=it(this._options,this.map._requestManager,function(u,d){o._tileJSONRequest=null,o._loaded=!0,u?o.fire(new s.ErrorEvent(u)):d&&(s.extend(o,d),d.bounds&&(o.tileBounds=new hr(d.bounds,o.minzoom,o.maxzoom)),s.postTurnstileEvent(d.tiles,o.map._requestManager._customAccessToken),s.postMapLoadEvent(d.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},a.prototype.setTiles=function(o){var u=this;return this.setSourceProperty(function(){u._options.tiles=o}),this},a.prototype.setUrl=function(o){var u=this;return this.setSourceProperty(function(){u.url=o,u._options.url=o}),this},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return s.extend({},this._options)},a.prototype.loadTile=function(o,u){var d=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(d,s.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function x(T,z){return delete o.request,o.aborted?u(null):T&&T.status!==404?u(T):(z&&z.resourceTiming&&(o.resourceTiming=z.resourceTiming),this.map._refreshExpiredTiles&&z&&o.setExpiryData(z),o.loadVectorData(z,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}_.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=u:o.request=o.actor.send("reloadTile",_,x.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",_,x.bind(this)))},a.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},a.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},a.prototype.hasTransition=function(){return!1},a}(s.Evented),kt=function(n){function a(o,u,d,_){n.call(this),this.id=o,this.dispatcher=d,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},u),s.extend(this,s.pick(u,["url","scheme","tileSize"]))}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=it(this._options,this.map._requestManager,function(u,d){o._tileJSONRequest=null,o._loaded=!0,u?o.fire(new s.ErrorEvent(u)):d&&(s.extend(o,d),d.bounds&&(o.tileBounds=new hr(d.bounds,o.minzoom,o.maxzoom)),s.postTurnstileEvent(d.tiles),s.postMapLoadEvent(d.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return s.extend({},this._options)},a.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},a.prototype.loadTile=function(o,u){var d=this,_=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=s.getImage(this.map._requestManager.transformRequest(_,s.ResourceType.Tile),function(x,T){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(x)o.state="errored",u(x);else if(T){d.map._refreshExpiredTiles&&o.setExpiryData(T),delete T.cacheControl,delete T.expires;var z=d.map.painter.context,L=z.gl;o.texture=d.map.painter.getTileTexture(T.width),o.texture?o.texture.update(T,{useMipmap:!0}):(o.texture=new s.Texture(z,T,L.RGBA,{useMipmap:!0}),o.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),z.extTextureFilterAnisotropic&&L.texParameterf(L.TEXTURE_2D,z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,z.extTextureFilterAnisotropicMax)),o.state="loaded",s.cacheEntryPossiblyAdded(d.dispatcher),u(null)}})},a.prototype.abortTile=function(o,u){o.request&&(o.request.cancel(),delete o.request),u()},a.prototype.unloadTile=function(o,u){o.texture&&this.map.painter.saveTileTexture(o.texture),u()},a.prototype.hasTransition=function(){return!1},a}(s.Evented),er=function(n){function a(o,u,d,_){n.call(this,o,u,d,_),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},a.prototype.loadTile=function(o,u){var d=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function _(x,T){x&&(o.state="errored",u(x)),T&&(o.dem=T,o.needsHillshadePrepare=!0,o.state="loaded",u(null))}o.request=s.getImage(this.map._requestManager.transformRequest(d,s.ResourceType.Tile),function(x,T){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(x)o.state="errored",u(x);else if(T){this.map._refreshExpiredTiles&&o.setExpiryData(T),delete T.cacheControl,delete T.expires;var z=s.window.ImageBitmap&&T instanceof s.window.ImageBitmap&&s.offscreenCanvasSupported()?T:s.browser.getImageData(T,1),L={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:z,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",L,_.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},a.prototype._getNeighboringTiles=function(o){var u=o.canonical,d=Math.pow(2,u.z),_=(u.x-1+d)%d,x=u.x===0?o.wrap-1:o.wrap,T=(u.x+1+d)%d,z=u.x+1===d?o.wrap+1:o.wrap,L={};return L[new s.OverscaledTileID(o.overscaledZ,x,u.z,_,u.y).key]={backfilled:!1},L[new s.OverscaledTileID(o.overscaledZ,z,u.z,T,u.y).key]={backfilled:!1},u.y>0&&(L[new s.OverscaledTileID(o.overscaledZ,x,u.z,_,u.y-1).key]={backfilled:!1},L[new s.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},L[new s.OverscaledTileID(o.overscaledZ,z,u.z,T,u.y-1).key]={backfilled:!1}),u.y+1<d&&(L[new s.OverscaledTileID(o.overscaledZ,x,u.z,_,u.y+1).key]={backfilled:!1},L[new s.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},L[new s.OverscaledTileID(o.overscaledZ,z,u.z,T,u.y+1).key]={backfilled:!1}),L},a.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},a}(kt),nt=function(n){function a(o,u,d,_){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(_),this._data=u.data,this._options=s.extend({},u),this._collectResourceTiming=u.collectResourceTiming,this._resourceTiming=[],u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;var x=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*x,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*x,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?Math.min(u.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:s.EXTENT,radius:(u.clusterRadius||50)*x,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this.fire(new s.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(u){if(u)o.fire(new s.ErrorEvent(u));else{var d={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(d.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new s.Event("data",d))}})},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setData=function(o){var u=this;return this._data=o,this.fire(new s.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(d){if(d)u.fire(new s.ErrorEvent(d));else{var _={dataType:"source",sourceDataType:"content"};u._collectResourceTiming&&u._resourceTiming&&u._resourceTiming.length>0&&(_.resourceTiming=u._resourceTiming,u._resourceTiming=[]),u.fire(new s.Event("data",_))}}),this},a.prototype.getClusterExpansionZoom=function(o,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},u),this},a.prototype.getClusterChildren=function(o,u){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},u),this},a.prototype.getClusterLeaves=function(o,u,d,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:u,offset:d},_),this},a.prototype._updateWorkerData=function(o){var u=this;this._loaded=!1;var d=s.extend({},this.workerOptions),_=this._data;typeof _=="string"?(d.request=this.map._requestManager.transformRequest(s.browser.resolveURL(_),s.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(_),this.actor.send(this.type+".loadData",d,function(x,T){u._removed||T&&T.abandoned||(u._loaded=!0,T&&T.resourceTiming&&T.resourceTiming[u.id]&&(u._resourceTiming=T.resourceTiming[u.id].slice(0)),u.actor.send(u.type+".coalesce",{source:d.source},null),o(x))})},a.prototype.loaded=function(){return this._loaded},a.prototype.loadTile=function(o,u){var d=this,_=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(_,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(x,T){return delete o.request,o.unloadVectorData(),o.aborted?u(null):x?u(x):(o.loadVectorData(T,d.map.painter,_==="reloadTile"),u(null))})},a.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},a.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},a.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},a.prototype.serialize=function(){return s.extend({},this._options,{type:this.type,data:this._data})},a.prototype.hasTransition=function(){return!1},a}(s.Evented),Ze=s.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),lr=function(n){function a(o,u,d,_){n.call(this),this.id=o,this.dispatcher=d,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=u}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(o,u){var d=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),function(_,x){d._loaded=!0,_?d.fire(new s.ErrorEvent(_)):x&&(d.image=x,o&&(d.coordinates=o),u&&u(),d._finishLoading())})},a.prototype.loaded=function(){return this._loaded},a.prototype.updateImage=function(o){var u=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){u.texture=null}),this):this},a.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setCoordinates=function(o){var u=this;this.coordinates=o;var d=o.map(s.MercatorCoordinate.fromLngLat);this.tileID=function(x){for(var T=1/0,z=1/0,L=-1/0,j=-1/0,q=0,Z=x;q<Z.length;q+=1){var J=Z[q];T=Math.min(T,J.x),z=Math.min(z,J.y),L=Math.max(L,J.x),j=Math.max(j,J.y)}var Q=Math.max(L-T,j-z),oe=Math.max(0,Math.floor(-Math.log(Q)/Math.LN2)),Y=Math.pow(2,oe);return new s.CanonicalTileID(oe,Math.floor((T+L)/2*Y),Math.floor((z+j)/2*Y))}(d),this.minzoom=this.maxzoom=this.tileID.z;var _=d.map(function(x){return u.tileID.getTilePoint(x)._round()});return this._boundsArray=new s.StructArrayLayout4i8,this._boundsArray.emplaceBack(_[0].x,_[0].y,0,0),this._boundsArray.emplaceBack(_[1].x,_[1].y,s.EXTENT,0),this._boundsArray.emplaceBack(_[3].x,_[3].y,0,s.EXTENT),this._boundsArray.emplaceBack(_[2].x,_[2].y,s.EXTENT,s.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this},a.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var o=this.map.painter.context,u=o.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ze.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new s.Texture(o,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var _=this.tiles[d];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}},a.prototype.loadTile=function(o,u){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},u(null)):(o.state="errored",u(null))},a.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return!1},a}(s.Evented),br=function(n){function a(o,u,d,_){n.call(this,o,u,d,_),this.roundZoom=!0,this.type="video",this.options=u}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1;var u=this.options;this.urls=[];for(var d=0,_=u.urls;d<_.length;d+=1)this.urls.push(this.map._requestManager.transformRequest(_[d],s.ResourceType.Source).url);s.getVideo(this.urls,function(x,T){o._loaded=!0,x?o.fire(new s.ErrorEvent(x)):T&&(o.video=T,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},a.prototype.pause=function(){this.video&&this.video.pause()},a.prototype.play=function(){this.video&&this.video.play()},a.prototype.seek=function(o){if(this.video){var u=this.video.seekable;o<u.start(0)||o>u.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+u.start(0)+" and "+u.end(0)+"-second mark."))):this.video.currentTime=o}},a.prototype.getVideo=function(){return this.video},a.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},a.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var o=this.map.painter.context,u=o.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ze.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(o,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var _=this.tiles[d];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this.video&&!this.video.paused},a}(lr),Yi=function(n){function a(o,u,d,_){n.call(this,o,u,d,_),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(function(x){return!Array.isArray(x)||x.length!==2||x.some(function(T){return typeof T!="number"})})||this.fire(new s.ErrorEvent(new s.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError("sources."+o,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},a.prototype.getCanvas=function(){return this.canvas},a.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},a.prototype.onRemove=function(){this.pause()},a.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var u=this.map.painter.context,d=u.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,Ze.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(u,this.canvas,d.RGBA,{premultiply:!0}),this.tiles){var x=this.tiles[_];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this._playing},a.prototype._hasInvalidDimensions=function(){for(var o=0,u=[this.canvas.width,this.canvas.height];o<u.length;o+=1){var d=u[o];if(isNaN(d)||d<=0)return!0}return!1},a}(lr),Qi={vector:Or,raster:kt,"raster-dem":er,geojson:nt,video:br,image:lr,canvas:Yi};function Ni(n,a){var o=s.identity([]);return s.translate(o,o,[1,1,0]),s.scale(o,o,[.5*n.width,.5*n.height,1]),s.multiply(o,o,n.calculatePosMatrix(a.toUnwrapped()))}function Gt(n,a,o,u,d,_){var x=function(oe,Y,ae){if(oe)for(var he=0,ye=oe;he<ye.length;he+=1){var Te=Y[ye[he]];if(Te&&Te.source===ae&&Te.type==="fill-extrusion")return!0}else for(var ve in Y){var Ae=Y[ve];if(Ae.source===ae&&Ae.type==="fill-extrusion")return!0}return!1}(d&&d.layers,a,n.id),T=_.maxPitchScaleFactor(),z=n.tilesIn(u,T,x);z.sort(_r);for(var L=[],j=0,q=z;j<q.length;j+=1){var Z=q[j];L.push({wrappedTileID:Z.tileID.wrapped().key,queryResults:Z.tile.queryRenderedFeatures(a,o,n._state,Z.queryGeometry,Z.cameraQueryGeometry,Z.scale,d,_,T,Ni(n.transform,Z.tileID))})}var J=function(oe){for(var Y={},ae={},he=0,ye=oe;he<ye.length;he+=1){var Te=ye[he],ve=Te.queryResults,Ae=Te.wrappedTileID,Re=ae[Ae]=ae[Ae]||{};for(var Ue in ve)for(var Ve=ve[Ue],at=Re[Ue]=Re[Ue]||{},yt=Y[Ue]=Y[Ue]||[],mt=0,_t=Ve;mt<_t.length;mt+=1){var ir=_t[mt];at[ir.featureIndex]||(at[ir.featureIndex]=!0,yt.push(ir))}}return Y}(L);for(var Q in J)J[Q].forEach(function(oe){var Y=oe.feature,ae=n.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=ae});return J}function _r(n,a){var o=n.tileID,u=a.tileID;return o.overscaledZ-u.overscaledZ||o.canonical.y-u.canonical.y||o.wrap-u.wrap||o.canonical.x-u.canonical.x}var Rt=function(n,a){this.max=n,this.onRemove=a,this.reset()};Rt.prototype.reset=function(){for(var n in this.data)for(var a=0,o=this.data[n];a<o.length;a+=1){var u=o[a];u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value)}return this.data={},this.order=[],this},Rt.prototype.add=function(n,a,o){var u=this,d=n.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);var _={value:a,timeout:void 0};if(o!==void 0&&(_.timeout=setTimeout(function(){u.remove(n,_)},o)),this.data[d].push(_),this.order.push(d),this.order.length>this.max){var x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this},Rt.prototype.has=function(n){return n.wrapped().key in this.data},Rt.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},Rt.prototype._getAndRemoveByKey=function(n){var a=this.data[n].shift();return a.timeout&&clearTimeout(a.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),a.value},Rt.prototype.getByKey=function(n){var a=this.data[n];return a?a[0].value:null},Rt.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},Rt.prototype.remove=function(n,a){if(!this.has(n))return this;var o=n.wrapped().key,u=a===void 0?0:this.data[o].indexOf(a),d=this.data[o][u];return this.data[o].splice(u,1),d.timeout&&clearTimeout(d.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(d.value),this.order.splice(this.order.indexOf(o),1),this},Rt.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},Rt.prototype.filter=function(n){var a=[];for(var o in this.data)for(var u=0,d=this.data[o];u<d.length;u+=1){var _=d[u];n(_.value)||a.push(_)}for(var x=0,T=a;x<T.length;x+=1){var z=T[x];this.remove(z.value.tileID,z)}};var kr=function(n,a,o){this.context=n;var u=n.gl;this.buffer=u.createBuffer(),this.dynamicDraw=Boolean(o),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer};kr.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},kr.prototype.updateData=function(n){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},kr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var xn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},bn=function(n,a,o,u){this.length=a.length,this.attributes=o,this.itemSize=a.bytesPerElement,this.dynamicDraw=u,this.context=n;var d=n.gl;this.buffer=d.createBuffer(),n.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer};bn.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},bn.prototype.updateData=function(n){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,n.arrayBuffer)},bn.prototype.enableAttributes=function(n,a){for(var o=0;o<this.attributes.length;o++){var u=a.attributes[this.attributes[o].name];u!==void 0&&n.enableVertexAttribArray(u)}},bn.prototype.setVertexAttribPointers=function(n,a,o){for(var u=0;u<this.attributes.length;u++){var d=this.attributes[u],_=a.attributes[d.name];_!==void 0&&n.vertexAttribPointer(_,d.components,n[xn[d.type]],!1,this.itemSize,d.offset+this.itemSize*(o||0))}},bn.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var qt=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};qt.prototype.get=function(){return this.current},qt.prototype.set=function(n){},qt.prototype.getDefault=function(){return this.default},qt.prototype.setDefault=function(){this.set(this.default)};var wn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return s.Color.transparent},a.prototype.set=function(o){var u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},a}(qt),Ei=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},a}(qt),Ci=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},a}(qt),Yn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},a}(qt),Zi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},a}(qt),Qn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},a}(qt),hi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(o){var u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},a}(qt),cn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},a.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},a}(qt),Bn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}},a}(qt),Mi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},a}(qt),Fr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}},a}(qt),Yr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},a}(qt),Xr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}},a}(qt),go=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},a.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},a}(qt),On=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return s.Color.transparent},a.prototype.set=function(o){var u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},a}(qt),ya=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},a}(qt),Co=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}},a}(qt),hn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},a}(qt),$n=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},a}(qt),_o=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},a}(qt),Mo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},a}(qt),$i=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},a.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},a}(qt),eo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},a}(qt),vo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}},a}(qt),Ho=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}},a}(qt),Jo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},a}(qt),Ti=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){var u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},a}(qt),Qr=function(n){function a(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},a}(qt),Ii=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},a}(qt),xo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},a}(qt),en=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},a}(qt),Dr=function(n){function a(o,u){n.call(this,o),this.context=o,this.parent=u}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a}(qt),C=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},a}(Dr),R=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}},a}(Dr),O=function(n,a,o,u){this.context=n,this.width=a,this.height=o;var d=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new C(n,d),u&&(this.depthAttachment=new R(n,d))};O.prototype.destroy=function(){var n=this.context.gl,a=this.colorAttachment.get();if(a&&n.deleteTexture(a),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var G=function(n,a,o){this.func=n,this.mask=a,this.range=o};G.ReadOnly=!1,G.ReadWrite=!0,G.disabled=new G(519,G.ReadOnly,[0,1]);var ee=function(n,a,o,u,d,_){this.test=n,this.ref=a,this.mask=o,this.fail=u,this.depthFail=d,this.pass=_};ee.disabled=new ee({func:519,mask:0},0,0,7680,7680,7680);var le=function(n,a,o){this.blendFunction=n,this.blendColor=a,this.mask=o};le.disabled=new le(le.Replace=[1,0],s.Color.transparent,[!1,!1,!1,!1]),le.unblended=new le(le.Replace,s.Color.transparent,[!0,!0,!0,!0]),le.alphaBlended=new le([1,771],s.Color.transparent,[!0,!0,!0,!0]);var ce=function(n,a,o){this.enable=n,this.mode=a,this.frontFace=o};ce.disabled=new ce(!1,1029,2305),ce.backCCW=new ce(!0,1029,2305);var F=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new wn(this),this.clearDepth=new Ei(this),this.clearStencil=new Ci(this),this.colorMask=new Yn(this),this.depthMask=new Zi(this),this.stencilMask=new Qn(this),this.stencilFunc=new hi(this),this.stencilOp=new cn(this),this.stencilTest=new Bn(this),this.depthRange=new Mi(this),this.depthTest=new Fr(this),this.depthFunc=new Yr(this),this.blend=new Xr(this),this.blendFunc=new go(this),this.blendColor=new On(this),this.blendEquation=new ya(this),this.cullFace=new Co(this),this.cullFaceSide=new hn(this),this.frontFace=new $n(this),this.program=new _o(this),this.activeTexture=new Mo(this),this.viewport=new $i(this),this.bindFramebuffer=new eo(this),this.bindRenderbuffer=new vo(this),this.bindTexture=new Ho(this),this.bindVertexBuffer=new Jo(this),this.bindElementBuffer=new Ti(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Qr(this),this.pixelStoreUnpack=new Ii(this),this.pixelStoreUnpackPremultiplyAlpha=new xo(this),this.pixelStoreUnpackFlipY=new en(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};F.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},F.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},F.prototype.createIndexBuffer=function(n,a){return new kr(this,n,a)},F.prototype.createVertexBuffer=function(n,a,o){return new bn(this,n,a,o)},F.prototype.createRenderbuffer=function(n,a,o){var u=this.gl,d=u.createRenderbuffer();return this.bindRenderbuffer.set(d),u.renderbufferStorage(u.RENDERBUFFER,n,a,o),this.bindRenderbuffer.set(null),d},F.prototype.createFramebuffer=function(n,a,o){return new O(this,n,a,o)},F.prototype.clear=function(n){var a=n.color,o=n.depth,u=this.gl,d=0;a&&(d|=u.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(d|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),u.clear(d)},F.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},F.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},F.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},F.prototype.setColorMode=function(n){s.deepEqual(n.blendFunction,le.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},F.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var re=function(n){function a(o,u,d){var _=this;n.call(this),this.id=o,this.dispatcher=d,this.on("data",function(x){x.dataType==="source"&&x.sourceDataType==="metadata"&&(_._sourceLoaded=!0),_._sourceLoaded&&!_._paused&&x.dataType==="source"&&x.sourceDataType==="content"&&(_.reload(),_.transform&&_.update(_.transform))}),this.on("error",function(){_._sourceErrored=!0}),this._source=function(x,T,z,L){var j=new Qi[T.type](x,T,z,L);if(j.id!==x)throw new Error("Expected Source id to be "+x+" instead of "+j.id);return s.bindAll(["load","abort","unload","serialize","prepare"],j),j}(o,u,d,this),this._tiles={},this._cache=new Rt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new s.SourceFeatureState}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},a.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},a.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var u=this._tiles[o];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0},a.prototype.getSource=function(){return this._source},a.prototype.pause=function(){this._paused=!0},a.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},a.prototype._loadTile=function(o,u){return this._source.loadTile(o,u)},a.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},a.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},a.prototype.serialize=function(){return this._source.serialize()},a.prototype.prepare=function(o){for(var u in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var d=this._tiles[u];d.upload(o),d.prepare(this.map.style.imageManager)}},a.prototype.getIds=function(){return s.values(this._tiles).map(function(o){return o.tileID}).sort(me).map(function(o){return o.key})},a.prototype.getRenderableIds=function(o){var u=this,d=[];for(var _ in this._tiles)this._isIdRenderable(_,o)&&d.push(this._tiles[_]);return o?d.sort(function(x,T){var z=x.tileID,L=T.tileID,j=new s.Point(z.canonical.x,z.canonical.y)._rotate(u.transform.angle),q=new s.Point(L.canonical.x,L.canonical.y)._rotate(u.transform.angle);return z.overscaledZ-L.overscaledZ||q.y-j.y||q.x-j.x}).map(function(x){return x.tileID.key}):d.map(function(x){return x.tileID}).sort(me).map(function(x){return x.key})},a.prototype.hasRenderableParent=function(o){var u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)},a.prototype._isIdRenderable=function(o,u){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())},a.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")},a.prototype._reloadTile=function(o,u){var d=this._tiles[o];d&&(d.state!=="loading"&&(d.state=u),this._loadTile(d,this._tileLoaded.bind(this,d,o,u)))},a.prototype._tileLoaded=function(o,u,d,_){if(_)return o.state="errored",void(_.status!==404?this._source.fire(new s.ErrorEvent(_,{tile:o})):this.update(this.transform));o.timeAdded=s.browser.now(),d==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new s.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},a.prototype._backfillDEM=function(o){for(var u=this.getRenderableIds(),d=0;d<u.length;d++){var _=u[d];if(o.neighboringTiles&&o.neighboringTiles[_]){var x=this.getTileByID(_);T(o,x),T(x,o)}}function T(z,L){z.needsHillshadePrepare=!0;var j=L.tileID.canonical.x-z.tileID.canonical.x,q=L.tileID.canonical.y-z.tileID.canonical.y,Z=Math.pow(2,z.tileID.canonical.z),J=L.tileID.key;j===0&&q===0||Math.abs(q)>1||(Math.abs(j)>1&&(Math.abs(j+Z)===1?j+=Z:Math.abs(j-Z)===1&&(j-=Z)),L.dem&&z.dem&&(z.dem.backfillBorder(L.dem,j,q),z.neighboringTiles&&z.neighboringTiles[J]&&(z.neighboringTiles[J].backfilled=!0)))}},a.prototype.getTile=function(o){return this.getTileByID(o.key)},a.prototype.getTileByID=function(o){return this._tiles[o]},a.prototype._retainLoadedChildren=function(o,u,d,_){for(var x in this._tiles){var T=this._tiles[x];if(!(_[x]||!T.hasData()||T.tileID.overscaledZ<=u||T.tileID.overscaledZ>d)){for(var z=T.tileID;T&&T.tileID.overscaledZ>u+1;){var L=T.tileID.scaledTo(T.tileID.overscaledZ-1);(T=this._tiles[L.key])&&T.hasData()&&(z=L)}for(var j=z;j.overscaledZ>u;)if(o[(j=j.scaledTo(j.overscaledZ-1)).key]){_[z.key]=z;break}}}},a.prototype.findLoadedParent=function(o,u){if(o.key in this._loadedParentTiles){var d=this._loadedParentTiles[o.key];return d&&d.tileID.overscaledZ>=u?d:null}for(var _=o.overscaledZ-1;_>=u;_--){var x=o.scaledTo(_),T=this._getLoadedTile(x);if(T)return T}},a.prototype._getLoadedTile=function(o){var u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(o.wrapped().key)},a.prototype.updateCacheSize=function(o){var u=Math.ceil(o.width/this._source.tileSize)+1,d=Math.ceil(o.height/this._source.tileSize)+1,_=Math.floor(u*d*5),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(x)},a.prototype.handleWrapJump=function(o){var u=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,u){var d={};for(var _ in this._tiles){var x=this._tiles[_];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+u),d[x.tileID.key]=x}for(var T in this._tiles=d,this._timers)clearTimeout(this._timers[T]),delete this._timers[T];for(var z in this._tiles)this._setTileReloadTimer(z,this._tiles[z])}},a.prototype.update=function(o){var u=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var d;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?d=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Re){return new s.OverscaledTileID(Re.canonical.z,Re.wrap,Re.canonical.z,Re.canonical.x,Re.canonical.y)}):(d=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(d=d.filter(function(Re){return u._source.hasTile(Re)}))):d=[];var _=o.coveringZoomLevel(this._source),x=Math.max(_-a.maxOverzooming,this._source.minzoom),T=Math.max(_+a.maxUnderzooming,this._source.minzoom),z=this._updateRetainedTiles(d,_);if(Ce(this._source.type)){for(var L={},j={},q=0,Z=Object.keys(z);q<Z.length;q+=1){var J=Z[q],Q=z[J],oe=this._tiles[J];if(oe&&!(oe.fadeEndTime&&oe.fadeEndTime<=s.browser.now())){var Y=this.findLoadedParent(Q,x);Y&&(this._addTile(Y.tileID),L[Y.tileID.key]=Y.tileID),j[J]=Q}}for(var ae in this._retainLoadedChildren(j,_,T,z),L)z[ae]||(this._coveredTiles[ae]=!0,z[ae]=L[ae])}for(var he in z)this._tiles[he].clearFadeHold();for(var ye=0,Te=s.keysDifference(this._tiles,z);ye<Te.length;ye+=1){var ve=Te[ye],Ae=this._tiles[ve];Ae.hasSymbolBuckets&&!Ae.holdingForFade()?Ae.setHoldDuration(this.map._fadeDuration):Ae.hasSymbolBuckets&&!Ae.symbolFadeFinished()||this._removeTile(ve)}this._updateLoadedParentTileCache()}},a.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},a.prototype._updateRetainedTiles=function(o,u){for(var d={},_={},x=Math.max(u-a.maxOverzooming,this._source.minzoom),T=Math.max(u+a.maxUnderzooming,this._source.minzoom),z={},L=0,j=o;L<j.length;L+=1){var q=j[L],Z=this._addTile(q);d[q.key]=q,Z.hasData()||u<this._source.maxzoom&&(z[q.key]=q)}this._retainLoadedChildren(z,u,T,d);for(var J=0,Q=o;J<Q.length;J+=1){var oe=Q[J],Y=this._tiles[oe.key];if(!Y.hasData()){if(u+1>this._source.maxzoom){var ae=oe.children(this._source.maxzoom)[0],he=this.getTile(ae);if(he&&he.hasData()){d[ae.key]=ae;continue}}else{var ye=oe.children(this._source.maxzoom);if(d[ye[0].key]&&d[ye[1].key]&&d[ye[2].key]&&d[ye[3].key])continue}for(var Te=Y.wasRequested(),ve=oe.overscaledZ-1;ve>=x;--ve){var Ae=oe.scaledTo(ve);if(_[Ae.key]||(_[Ae.key]=!0,!(Y=this.getTile(Ae))&&Te&&(Y=this._addTile(Ae)),Y&&(d[Ae.key]=Ae,Te=Y.wasRequested(),Y.hasData())))break}}}return d},a.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var u=[],d=void 0,_=this._tiles[o].tileID;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){d=this._loadedParentTiles[_.key];break}u.push(_.key);var x=_.scaledTo(_.overscaledZ-1);if(d=this._getLoadedTile(x))break;_=x}for(var T=0,z=u;T<z.length;T+=1)this._loadedParentTiles[z[T]]=d}},a.prototype._addTile=function(o){var u=this._tiles[o.key];if(u)return u;(u=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));var d=Boolean(u);return d||(u=new s.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,o.key,u.state))),u?(u.uses++,this._tiles[o.key]=u,d||this._source.fire(new s.Event("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null},a.prototype._setTileReloadTimer=function(o,u){var d=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var _=u.getExpiryTimeout();_&&(this._timers[o]=setTimeout(function(){d._reloadTile(o,"expired"),delete d._timers[o]},_))},a.prototype._removeTile=function(o){var u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))},a.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},a.prototype.tilesIn=function(o,u,d){var _=this,x=[],T=this.transform;if(!T)return x;for(var z=d?T.getCameraQueryGeometry(o):o,L=o.map(function(ve){return T.pointCoordinate(ve)}),j=z.map(function(ve){return T.pointCoordinate(ve)}),q=this.getIds(),Z=1/0,J=1/0,Q=-1/0,oe=-1/0,Y=0,ae=j;Y<ae.length;Y+=1){var he=ae[Y];Z=Math.min(Z,he.x),J=Math.min(J,he.y),Q=Math.max(Q,he.x),oe=Math.max(oe,he.y)}for(var ye=function(ve){var Ae=_._tiles[q[ve]];if(!Ae.holdingForFade()){var Re=Ae.tileID,Ue=Math.pow(2,T.zoom-Ae.tileID.overscaledZ),Ve=u*Ae.queryPadding*s.EXTENT/Ae.tileSize/Ue,at=[Re.getTilePoint(new s.MercatorCoordinate(Z,J)),Re.getTilePoint(new s.MercatorCoordinate(Q,oe))];if(at[0].x-Ve<s.EXTENT&&at[0].y-Ve<s.EXTENT&&at[1].x+Ve>=0&&at[1].y+Ve>=0){var yt=L.map(function(_t){return Re.getTilePoint(_t)}),mt=j.map(function(_t){return Re.getTilePoint(_t)});x.push({tile:Ae,tileID:Re,queryGeometry:yt,cameraQueryGeometry:mt,scale:Ue})}}},Te=0;Te<q.length;Te++)ye(Te);return x},a.prototype.getVisibleCoordinates=function(o){for(var u=this,d=this.getRenderableIds(o).map(function(z){return u._tiles[z].tileID}),_=0,x=d;_<x.length;_+=1){var T=x[_];T.posMatrix=this.transform.calculatePosMatrix(T.toUnwrapped())}return d},a.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ce(this._source.type))for(var o in this._tiles){var u=this._tiles[o];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=s.browser.now())return!0}return!1},a.prototype.setFeatureState=function(o,u,d){this._state.updateState(o=o||"_geojsonTileLayer",u,d)},a.prototype.removeFeatureState=function(o,u,d){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,d)},a.prototype.getFeatureState=function(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)},a.prototype.setDependencies=function(o,u,d){var _=this._tiles[o];_&&_.setDependencies(u,d)},a.prototype.reloadTilesForDependencies=function(o,u){for(var d in this._tiles)this._tiles[d].hasDependency(o,u)&&this._reloadTile(d,"reloading");this._cache.filter(function(_){return!_.hasDependency(o,u)})},a}(s.Evented);function me(n,a){var o=Math.abs(2*n.wrap)-+(n.wrap<0),u=Math.abs(2*a.wrap)-+(a.wrap<0);return n.overscaledZ-a.overscaledZ||u-o||a.canonical.y-n.canonical.y||a.canonical.x-n.canonical.x}function Ce(n){return n==="raster"||n==="image"||n==="video"}function Le(){return new s.window.Worker(pa.workerUrl)}re.maxOverzooming=10,re.maxUnderzooming=3;var be="mapboxgl_preloaded_worker_pool",Be=function(){this.active={}};Be.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<Be.workerCount;)this.workers.push(new Le);return this.active[n]=!0,this.workers.slice()},Be.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},Be.prototype.isPreloaded=function(){return!!this.active[be]},Be.prototype.numActive=function(){return Object.keys(this.active).length};var et,Qe=Math.floor(s.browser.hardwareConcurrency/2);function Se(){return et||(et=new Be),et}function Je(n,a){var o={};for(var u in n)u!=="ref"&&(o[u]=n[u]);return s.refProperties.forEach(function(d){d in a&&(o[d]=a[d])}),o}function Ne(n){n=n.slice();for(var a=Object.create(null),o=0;o<n.length;o++)a[n[o].id]=n[o];for(var u=0;u<n.length;u++)"ref"in n[u]&&(n[u]=Je(n[u],a[n[u].ref]));return n}Be.workerCount=Math.max(Math.min(Qe,6),1);var Ge={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function At(n,a,o){o.push({command:Ge.addSource,args:[n,a[n]]})}function je(n,a,o){a.push({command:Ge.removeSource,args:[n]}),o[n]=!0}function Pt(n,a,o,u){je(n,o,u),At(n,a,o)}function ar(n,a,o){var u;for(u in n[o])if(n[o].hasOwnProperty(u)&&u!=="data"&&!s.deepEqual(n[o][u],a[o][u]))return!1;for(u in a[o])if(a[o].hasOwnProperty(u)&&u!=="data"&&!s.deepEqual(n[o][u],a[o][u]))return!1;return!0}function Ct(n,a,o,u,d,_){var x;for(x in a=a||{},n=n||{})n.hasOwnProperty(x)&&(s.deepEqual(n[x],a[x])||o.push({command:_,args:[u,x,a[x],d]}));for(x in a)a.hasOwnProperty(x)&&!n.hasOwnProperty(x)&&(s.deepEqual(n[x],a[x])||o.push({command:_,args:[u,x,a[x],d]}))}function Vt(n){return n.id}function Mt(n,a){return n[a.id]=a,n}var oi=function(n,a){this.reset(n,a)};oi.prototype.reset=function(n,a){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding},oi.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=s.clamp(n,0,1);for(var a=1,o=this._distances[a],u=n*this.paddedLength+this.padding;o<u&&a<this._distances.length;)o=this._distances[++a];var d=a-1,_=this._distances[d],x=o-_,T=x>0?(u-_)/x:0;return this.points[d].mult(1-T).add(this.points[a].mult(T))};var Jt=function(n,a,o){var u=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(a/o);for(var _=0;_<this.xCellCount*this.yCellCount;_++)u.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=a,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0};function zr(n,a,o,u,d){var _=s.create();return a?(s.scale(_,_,[1/d,1/d,1]),o||s.rotateZ(_,_,u.angle)):s.multiply(_,u.labelPlaneMatrix,n),_}function or(n,a,o,u,d){if(a){var _=s.clone(n);return s.scale(_,_,[d,d,1]),o||s.rotateZ(_,_,-u.angle),_}return u.glCoordMatrix}function Bt(n,a){var o=[n.x,n.y,0,1];Wr(o,o,a);var u=o[3];return{point:new s.Point(o[0]/u,o[1]/u),signedDistanceFromCamera:u}}function Zt(n,a){return .5+n/a*.5}function pi(n,a){var o=n[0]/n[3],u=n[1]/n[3];return o>=-a[0]&&o<=a[0]&&u>=-a[1]&&u<=a[1]}function tn(n,a,o,u,d,_,x,T){var z=u?n.textSizeData:n.iconSizeData,L=s.evaluateSizeForZoom(z,o.transform.zoom),j=[256/o.width*2+1,256/o.height*2+1],q=u?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;q.clear();for(var Z=n.lineVertexArray,J=u?n.text.placedSymbolArray:n.icon.placedSymbolArray,Q=o.transform.width/o.transform.height,oe=!1,Y=0;Y<J.length;Y++){var ae=J.get(Y);if(ae.hidden||ae.writingMode===s.WritingMode.vertical&&!oe)fi(ae.numGlyphs,q);else{oe=!1;var he=[ae.anchorX,ae.anchorY,0,1];if(s.transformMat4(he,he,a),pi(he,j)){var ye=Zt(o.transform.cameraToCenterDistance,he[3]),Te=s.evaluateSizeForFeature(z,L,ae),ve=x?Te/ye:Te*ye,Ae=new s.Point(ae.anchorX,ae.anchorY),Re=Bt(Ae,d).point,Ue={},Ve=Yo(ae,ve,!1,T,a,d,_,n.glyphOffsetArray,Z,q,Re,Ae,Ue,Q);oe=Ve.useVertical,(Ve.notEnoughRoom||oe||Ve.needsFlipping&&Yo(ae,ve,!0,T,a,d,_,n.glyphOffsetArray,Z,q,Re,Ae,Ue,Q).notEnoughRoom)&&fi(ae.numGlyphs,q)}else fi(ae.numGlyphs,q)}}u?n.text.dynamicLayoutVertexBuffer.updateData(q):n.icon.dynamicLayoutVertexBuffer.updateData(q)}function Cr(n,a,o,u,d,_,x,T,z,L,j){var q=T.glyphStartIndex+T.numGlyphs,Z=T.lineStartIndex,J=T.lineStartIndex+T.lineLength,Q=a.getoffsetX(T.glyphStartIndex),oe=a.getoffsetX(q-1),Y=Ar(n*Q,o,u,d,_,x,T.segment,Z,J,z,L,j);if(!Y)return null;var ae=Ar(n*oe,o,u,d,_,x,T.segment,Z,J,z,L,j);return ae?{first:Y,last:ae}:null}function ai(n,a,o,u){return n===s.WritingMode.horizontal&&Math.abs(o.y-a.y)>Math.abs(o.x-a.x)*u?{useVertical:!0}:(n===s.WritingMode.vertical?a.y<o.y:a.x>o.x)?{needsFlipping:!0}:null}function Yo(n,a,o,u,d,_,x,T,z,L,j,q,Z,J){var Q,oe=a/24,Y=n.lineOffsetX*oe,ae=n.lineOffsetY*oe;if(n.numGlyphs>1){var he=n.glyphStartIndex+n.numGlyphs,ye=n.lineStartIndex,Te=n.lineStartIndex+n.lineLength,ve=Cr(oe,T,Y,ae,o,j,q,n,z,_,Z);if(!ve)return{notEnoughRoom:!0};var Ae=Bt(ve.first.point,x).point,Re=Bt(ve.last.point,x).point;if(u&&!o){var Ue=ai(n.writingMode,Ae,Re,J);if(Ue)return Ue}Q=[ve.first];for(var Ve=n.glyphStartIndex+1;Ve<he-1;Ve++)Q.push(Ar(oe*T.getoffsetX(Ve),Y,ae,o,j,q,n.segment,ye,Te,z,_,Z));Q.push(ve.last)}else{if(u&&!o){var at=Bt(q,d).point,yt=n.lineStartIndex+n.segment+1,mt=new s.Point(z.getx(yt),z.gety(yt)),_t=Bt(mt,d),ir=_t.signedDistanceFromCamera>0?_t.point:Do(q,mt,at,1,d),ut=ai(n.writingMode,at,ir,J);if(ut)return ut}var zt=Ar(oe*T.getoffsetX(n.glyphStartIndex),Y,ae,o,j,q,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,z,_,Z);if(!zt)return{notEnoughRoom:!0};Q=[zt]}for(var Ot=0,Et=Q;Ot<Et.length;Ot+=1){var St=Et[Ot];s.addDynamicAttributes(L,St.point,St.angle)}return{}}function Do(n,a,o,u,d){var _=Bt(n.add(n.sub(a)._unit()),d).point,x=o.sub(_);return o.add(x._mult(u/x.mag()))}function Ar(n,a,o,u,d,_,x,T,z,L,j,q){var Z=u?n-a:n+a,J=Z>0?1:-1,Q=0;u&&(J*=-1,Q=Math.PI),J<0&&(Q+=Math.PI);for(var oe=J>0?T+x:T+x+1,Y=d,ae=d,he=0,ye=0,Te=Math.abs(Z),ve=[];he+ye<=Te;){if((oe+=J)<T||oe>=z)return null;if(ae=Y,ve.push(Y),(Y=q[oe])===void 0){var Ae=new s.Point(L.getx(oe),L.gety(oe)),Re=Bt(Ae,j);if(Re.signedDistanceFromCamera>0)Y=q[oe]=Re.point;else{var Ue=oe-J;Y=Do(he===0?_:new s.Point(L.getx(Ue),L.gety(Ue)),Ae,ae,Te-he+1,j)}}he+=ye,ye=ae.dist(Y)}var Ve=(Te-he)/ye,at=Y.sub(ae),yt=at.mult(Ve)._add(ae);yt._add(at._unit()._perp()._mult(o*J));var mt=Q+Math.atan2(Y.y-ae.y,Y.x-ae.x);return ve.push(yt),{point:yt,angle:mt,path:ve}}Jt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Jt.prototype.insert=function(n,a,o,u,d){this._forEachCell(a,o,u,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(a),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(d)},Jt.prototype.insertCircle=function(n,a,o,u){this._forEachCell(a-u,o-u,a+u,o+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(a),this.circles.push(o),this.circles.push(u)},Jt.prototype._insertBoxCell=function(n,a,o,u,d,_){this.boxCells[d].push(_)},Jt.prototype._insertCircleCell=function(n,a,o,u,d,_){this.circleCells[d].push(_)},Jt.prototype._query=function(n,a,o,u,d,_){if(o<0||n>this.width||u<0||a>this.height)return!d&&[];var x=[];if(n<=0&&a<=0&&this.width<=o&&this.height<=u){if(d)return!0;for(var T=0;T<this.boxKeys.length;T++)x.push({key:this.boxKeys[T],x1:this.bboxes[4*T],y1:this.bboxes[4*T+1],x2:this.bboxes[4*T+2],y2:this.bboxes[4*T+3]});for(var z=0;z<this.circleKeys.length;z++){var L=this.circles[3*z],j=this.circles[3*z+1],q=this.circles[3*z+2];x.push({key:this.circleKeys[z],x1:L-q,y1:j-q,x2:L+q,y2:j+q})}return _?x.filter(_):x}return this._forEachCell(n,a,o,u,this._queryCell,x,{hitTest:d,seenUids:{box:{},circle:{}}},_),d?x.length>0:x},Jt.prototype._queryCircle=function(n,a,o,u,d){var _=n-o,x=n+o,T=a-o,z=a+o;if(x<0||_>this.width||z<0||T>this.height)return!u&&[];var L=[];return this._forEachCell(_,T,x,z,this._queryCellCircle,L,{hitTest:u,circle:{x:n,y:a,radius:o},seenUids:{box:{},circle:{}}},d),u?L.length>0:L},Jt.prototype.query=function(n,a,o,u,d){return this._query(n,a,o,u,!1,d)},Jt.prototype.hitTest=function(n,a,o,u,d){return this._query(n,a,o,u,!0,d)},Jt.prototype.hitTestCircle=function(n,a,o,u){return this._queryCircle(n,a,o,!0,u)},Jt.prototype._queryCell=function(n,a,o,u,d,_,x,T){var z=x.seenUids,L=this.boxCells[d];if(L!==null)for(var j=this.bboxes,q=0,Z=L;q<Z.length;q+=1){var J=Z[q];if(!z.box[J]){z.box[J]=!0;var Q=4*J;if(n<=j[Q+2]&&a<=j[Q+3]&&o>=j[Q+0]&&u>=j[Q+1]&&(!T||T(this.boxKeys[J]))){if(x.hitTest)return _.push(!0),!0;_.push({key:this.boxKeys[J],x1:j[Q],y1:j[Q+1],x2:j[Q+2],y2:j[Q+3]})}}}var oe=this.circleCells[d];if(oe!==null)for(var Y=this.circles,ae=0,he=oe;ae<he.length;ae+=1){var ye=he[ae];if(!z.circle[ye]){z.circle[ye]=!0;var Te=3*ye;if(this._circleAndRectCollide(Y[Te],Y[Te+1],Y[Te+2],n,a,o,u)&&(!T||T(this.circleKeys[ye]))){if(x.hitTest)return _.push(!0),!0;var ve=Y[Te],Ae=Y[Te+1],Re=Y[Te+2];_.push({key:this.circleKeys[ye],x1:ve-Re,y1:Ae-Re,x2:ve+Re,y2:Ae+Re})}}}},Jt.prototype._queryCellCircle=function(n,a,o,u,d,_,x,T){var z=x.circle,L=x.seenUids,j=this.boxCells[d];if(j!==null)for(var q=this.bboxes,Z=0,J=j;Z<J.length;Z+=1){var Q=J[Z];if(!L.box[Q]){L.box[Q]=!0;var oe=4*Q;if(this._circleAndRectCollide(z.x,z.y,z.radius,q[oe+0],q[oe+1],q[oe+2],q[oe+3])&&(!T||T(this.boxKeys[Q])))return _.push(!0),!0}}var Y=this.circleCells[d];if(Y!==null)for(var ae=this.circles,he=0,ye=Y;he<ye.length;he+=1){var Te=ye[he];if(!L.circle[Te]){L.circle[Te]=!0;var ve=3*Te;if(this._circlesCollide(ae[ve],ae[ve+1],ae[ve+2],z.x,z.y,z.radius)&&(!T||T(this.circleKeys[Te])))return _.push(!0),!0}}},Jt.prototype._forEachCell=function(n,a,o,u,d,_,x,T){for(var z=this._convertToXCellCoord(n),L=this._convertToYCellCoord(a),j=this._convertToXCellCoord(o),q=this._convertToYCellCoord(u),Z=z;Z<=j;Z++)for(var J=L;J<=q;J++)if(d.call(this,n,a,o,u,this.xCellCount*J+Z,_,x,T))return},Jt.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},Jt.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},Jt.prototype._circlesCollide=function(n,a,o,u,d,_){var x=u-n,T=d-a,z=o+_;return z*z>x*x+T*T},Jt.prototype._circleAndRectCollide=function(n,a,o,u,d,_,x){var T=(_-u)/2,z=Math.abs(n-(u+T));if(z>T+o)return!1;var L=(x-d)/2,j=Math.abs(a-(d+L));if(j>L+o)return!1;if(z<=T||j<=L)return!0;var q=z-T,Z=j-L;return q*q+Z*Z<=o*o};var bo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function fi(n,a){for(var o=0;o<n;o++){var u=a.length;a.resize(u+4),a.float32.set(bo,3*u)}}function Wr(n,a,o){var u=a[0],d=a[1];return n[0]=o[0]*u+o[4]*d+o[12],n[1]=o[1]*u+o[5]*d+o[13],n[3]=o[3]*u+o[7]*d+o[15],n}var di=function(n,a,o){a===void 0&&(a=new Jt(n.width+200,n.height+200,25)),o===void 0&&(o=new Jt(n.width+200,n.height+200,25)),this.transform=n,this.grid=a,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function wr(n,a,o){return a*(s.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}di.prototype.placeCollisionBox=function(n,a,o,u,d){var _=this.projectAndGetPerspectiveRatio(u,n.anchorPointX,n.anchorPointY),x=o*_.perspectiveRatio,T=n.x1*x+_.point.x,z=n.y1*x+_.point.y,L=n.x2*x+_.point.x,j=n.y2*x+_.point.y;return!this.isInsideGrid(T,z,L,j)||!a&&this.grid.hitTest(T,z,L,j,d)?{box:[],offscreen:!1}:{box:[T,z,L,j],offscreen:this.isOffscreen(T,z,L,j)}},di.prototype.placeCollisionCircles=function(n,a,o,u,d,_,x,T,z,L,j,q,Z){var J=[],Q=new s.Point(a.anchorX,a.anchorY),oe=Bt(Q,_),Y=Zt(this.transform.cameraToCenterDistance,oe.signedDistanceFromCamera),ae=(L?d/Y:d*Y)/s.ONE_EM,he=Bt(Q,x).point,ye=Cr(ae,u,a.lineOffsetX*ae,a.lineOffsetY*ae,!1,he,Q,a,o,x,{}),Te=!1,ve=!1,Ae=!0;if(ye){for(var Re=.5*q*Y+Z,Ue=new s.Point(-100,-100),Ve=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),at=new oi,yt=ye.first,mt=ye.last,_t=[],ir=yt.path.length-1;ir>=1;ir--)_t.push(yt.path[ir]);for(var ut=1;ut<mt.path.length;ut++)_t.push(mt.path[ut]);var zt=2.5*Re;if(T){var Ot=_t.map(function(yn){return Bt(yn,T)});_t=Ot.some(function(yn){return yn.signedDistanceFromCamera<=0})?[]:Ot.map(function(yn){return yn.point})}var Et=[];if(_t.length>0){for(var St=_t[0].clone(),Dt=_t[0].clone(),bt=1;bt<_t.length;bt++)St.x=Math.min(St.x,_t[bt].x),St.y=Math.min(St.y,_t[bt].y),Dt.x=Math.max(Dt.x,_t[bt].x),Dt.y=Math.max(Dt.y,_t[bt].y);Et=St.x>=Ue.x&&Dt.x<=Ve.x&&St.y>=Ue.y&&Dt.y<=Ve.y?[_t]:Dt.x<Ue.x||St.x>Ve.x||Dt.y<Ue.y||St.y>Ve.y?[]:s.clipLine([_t],Ue.x,Ue.y,Ve.x,Ve.y)}for(var wt=0,zi=Et;wt<zi.length;wt+=1){var ui;at.reset(zi[wt],.25*Re),ui=at.length<=.5*Re?1:Math.ceil(at.paddedLength/zt)+1;for(var on=0;on<ui;on++){var ji=on/Math.max(ui-1,1),Rr=at.lerp(ji),ci=Rr.x+100,Cn=Rr.y+100;J.push(ci,Cn,Re,0);var Mn=ci-Re,ts=Cn-Re,Dn=ci+Re,Zo=Cn+Re;if(Ae=Ae&&this.isOffscreen(Mn,ts,Dn,Zo),ve=ve||this.isInsideGrid(Mn,ts,Dn,Zo),!n&&this.grid.hitTestCircle(ci,Cn,Re,j)&&(Te=!0,!z))return{circles:[],offscreen:!1,collisionDetected:Te}}}}return{circles:!z&&Te||!ve?[]:J,offscreen:Ae,collisionDetected:Te}},di.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var a=[],o=1/0,u=1/0,d=-1/0,_=-1/0,x=0,T=n;x<T.length;x+=1){var z=T[x],L=new s.Point(z.x+100,z.y+100);o=Math.min(o,L.x),u=Math.min(u,L.y),d=Math.max(d,L.x),_=Math.max(_,L.y),a.push(L)}for(var j={},q={},Z=0,J=this.grid.query(o,u,d,_).concat(this.ignoredGrid.query(o,u,d,_));Z<J.length;Z+=1){var Q=J[Z],oe=Q.key;if(j[oe.bucketInstanceId]===void 0&&(j[oe.bucketInstanceId]={}),!j[oe.bucketInstanceId][oe.featureIndex]){var Y=[new s.Point(Q.x1,Q.y1),new s.Point(Q.x2,Q.y1),new s.Point(Q.x2,Q.y2),new s.Point(Q.x1,Q.y2)];s.polygonIntersectsPolygon(a,Y)&&(j[oe.bucketInstanceId][oe.featureIndex]=!0,q[oe.bucketInstanceId]===void 0&&(q[oe.bucketInstanceId]=[]),q[oe.bucketInstanceId].push(oe.featureIndex))}}return q},di.prototype.insertCollisionBox=function(n,a,o,u,d){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:u,collisionGroupID:d},n[0],n[1],n[2],n[3])},di.prototype.insertCollisionCircles=function(n,a,o,u,d){for(var _=a?this.ignoredGrid:this.grid,x={bucketInstanceId:o,featureIndex:u,collisionGroupID:d},T=0;T<n.length;T+=4)_.insertCircle(x,n[T],n[T+1],n[T+2])},di.prototype.projectAndGetPerspectiveRatio=function(n,a,o){var u=[a,o,0,1];return Wr(u,u,n),{point:new s.Point((u[0]/u[3]+1)/2*this.transform.width+100,(-u[1]/u[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/u[3]*.5}},di.prototype.isOffscreen=function(n,a,o,u){return o<100||n>=this.screenRightBoundary||u<100||a>this.screenBottomBoundary},di.prototype.isInsideGrid=function(n,a,o,u){return o>=0&&n<this.gridRightBoundary&&u>=0&&a<this.gridBottomBoundary},di.prototype.getViewportMatrix=function(){var n=s.identity([]);return s.translate(n,n,[-100,-100,0]),n};var pn=function(n,a,o,u){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?a:-a))):u&&o?1:0,this.placed=o};pn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var mi=function(n,a,o,u,d){this.text=new pn(n?n.text:null,a,o,d),this.icon=new pn(n?n.icon:null,a,u,d)};mi.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Qo=function(n,a,o){this.text=n,this.icon=a,this.skipFade=o},yi=function(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]},Sn=function(n,a,o,u,d){this.bucketInstanceId=n,this.featureIndex=a,this.sourceLayerIndex=o,this.bucketIndex=u,this.tileID=d},gi=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function si(n,a,o,u,d){var _=s.getAnchorAlignment(n),x=-(_.horizontalAlign-.5)*a,T=-(_.verticalAlign-.5)*o,z=s.evaluateVariableOffset(n,u);return new s.Point(x+z[0]*d,T+z[1]*d)}function Fn(n,a,o,u,d,_){var x=n.x1,T=n.x2,z=n.y1,L=n.y2,j=n.anchorPointX,q=n.anchorPointY,Z=new s.Point(a,o);return u&&Z._rotate(d?_:-_),{x1:x+Z.x,y1:z+Z.y,x2:T+Z.x,y2:L+Z.y,anchorPointX:j,anchorPointY:q}}gi.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var a=++this.maxGroupID;this.collisionGroups[n]={ID:a,predicate:function(o){return o.collisionGroupID===a}}}return this.collisionGroups[n]};var ki=function(n,a,o,u){this.transform=n.clone(),this.collisionIndex=new di(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=a,this.retainedQueryData={},this.collisionGroups=new gi(o),this.collisionCircleArrays={},this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}};function sr(n,a,o,u,d){n.emplaceBack(a?1:0,o?1:0,u||0,d||0),n.emplaceBack(a?1:0,o?1:0,u||0,d||0),n.emplaceBack(a?1:0,o?1:0,u||0,d||0),n.emplaceBack(a?1:0,o?1:0,u||0,d||0)}ki.prototype.getBucketParts=function(n,a,o,u){var d=o.getBucket(a),_=o.latestFeatureIndex;if(d&&_&&a.id===d.layerIds[0]){var x=o.collisionBoxArray,T=d.layers[0].layout,z=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),L=o.tileSize/s.EXTENT,j=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),q=T.get("text-pitch-alignment")==="map",Z=T.get("text-rotation-alignment")==="map",J=wr(o,1,this.transform.zoom),Q=zr(j,q,Z,this.transform,J),oe=null;if(q){var Y=or(j,q,Z,this.transform,J);oe=s.multiply([],this.transform.labelPlaneMatrix,Y)}this.retainedQueryData[d.bucketInstanceId]=new Sn(d.bucketInstanceId,_,d.sourceLayerIndex,d.index,o.tileID);var ae={bucket:d,layout:T,posMatrix:j,textLabelPlaneMatrix:Q,labelToScreenMatrix:oe,scale:z,textPixelRatio:L,holdingForFade:o.holdingForFade(),collisionBoxArray:x,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(u)for(var he=0,ye=d.sortKeyRanges;he<ye.length;he+=1){var Te=ye[he];n.push({sortKey:Te.sortKey,symbolInstanceStart:Te.symbolInstanceStart,symbolInstanceEnd:Te.symbolInstanceEnd,parameters:ae})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:ae})}},ki.prototype.attemptAnchorPlacement=function(n,a,o,u,d,_,x,T,z,L,j,q,Z,J,Q){var oe,Y=[q.textOffset0,q.textOffset1],ae=si(n,o,u,Y,d),he=this.collisionIndex.placeCollisionBox(Fn(a,ae.x,ae.y,_,x,this.transform.angle),j,T,z,L.predicate);if(!Q||this.collisionIndex.placeCollisionBox(Fn(Q,ae.x,ae.y,_,x,this.transform.angle),j,T,z,L.predicate).box.length!==0)return he.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[q.crossTileID]&&this.prevPlacement.placements[q.crossTileID]&&this.prevPlacement.placements[q.crossTileID].text&&(oe=this.prevPlacement.variableOffsets[q.crossTileID].anchor),this.variableOffsets[q.crossTileID]={textOffset:Y,width:o,height:u,anchor:n,textBoxScale:d,prevAnchor:oe},this.markUsedJustification(Z,n,q,J),Z.allowVerticalPlacement&&(this.markUsedOrientation(Z,J,q),this.placedOrientations[q.crossTileID]=J),{shift:ae,placedGlyphBoxes:he}):void 0},ki.prototype.placeLayerBucketPart=function(n,a,o){var u=this,d=n.parameters,_=d.bucket,x=d.layout,T=d.posMatrix,z=d.textLabelPlaneMatrix,L=d.labelToScreenMatrix,j=d.textPixelRatio,q=d.holdingForFade,Z=d.collisionBoxArray,J=d.partiallyEvaluatedTextSize,Q=d.collisionGroup,oe=x.get("text-optional"),Y=x.get("icon-optional"),ae=x.get("text-allow-overlap"),he=x.get("icon-allow-overlap"),ye=x.get("text-rotation-alignment")==="map",Te=x.get("text-pitch-alignment")==="map",ve=x.get("icon-text-fit")!=="none",Ae=x.get("symbol-z-order")==="viewport-y",Re=ae&&(he||!_.hasIconData()||Y),Ue=he&&(ae||!_.hasTextData()||oe);!_.collisionArrays&&Z&&_.deserializeCollisionBoxes(Z);var Ve=function(ut,zt){if(!a[ut.crossTileID])if(q)u.placements[ut.crossTileID]=new Qo(!1,!1,!1);else{var Ot,Et=!1,St=!1,Dt=!0,bt=null,wt={box:null,offscreen:null},zi={box:null,offscreen:null},ui=null,on=null,ji=0,Rr=0,ci=0;zt.textFeatureIndex?ji=zt.textFeatureIndex:ut.useRuntimeCollisionCircles&&(ji=ut.featureIndex),zt.verticalTextFeatureIndex&&(Rr=zt.verticalTextFeatureIndex);var Cn=zt.textBox;if(Cn){var Mn=function(pr){var po=s.WritingMode.horizontal;if(_.allowVerticalPlacement&&!pr&&u.prevPlacement){var Ln=u.prevPlacement.placedOrientations[ut.crossTileID];Ln&&(u.placedOrientations[ut.crossTileID]=Ln,u.markUsedOrientation(_,po=Ln,ut))}return po},ts=function(pr,po){if(_.allowVerticalPlacement&&ut.numVerticalGlyphVertices>0&&zt.verticalTextBox)for(var Ln=0,Ko=_.writingModes;Ln<Ko.length&&(Ko[Ln]===s.WritingMode.vertical?(wt=po(),zi=wt):wt=pr(),!(wt&&wt.box&&wt.box.length));Ln+=1);else wt=pr()};if(x.get("text-variable-anchor")){var Dn=x.get("text-variable-anchor");if(u.prevPlacement&&u.prevPlacement.variableOffsets[ut.crossTileID]){var Zo=u.prevPlacement.variableOffsets[ut.crossTileID];Dn.indexOf(Zo.anchor)>0&&(Dn=Dn.filter(function(pr){return pr!==Zo.anchor})).unshift(Zo.anchor)}var yn=function(pr,po,Ln){for(var Ko=pr.x2-pr.x1,vu=pr.y2-pr.y1,Hs=ut.textBoxScale,Ju=ve&&!he?po:null,Js={box:[],offscreen:!1},ru=ae?2*Dn.length:Dn.length,da=0;da<ru;++da){var gl=u.attemptAnchorPlacement(Dn[da%Dn.length],pr,Ko,vu,Hs,ye,Te,j,T,Q,da>=Dn.length,ut,_,Ln,Ju);if(gl&&(Js=gl.placedGlyphBoxes)&&Js.box&&Js.box.length){Et=!0,bt=gl.shift;break}}return Js};ts(function(){return yn(Cn,zt.iconBox,s.WritingMode.horizontal)},function(){var pr=zt.verticalTextBox;return _.allowVerticalPlacement&&!(wt&&wt.box&&wt.box.length)&&ut.numVerticalGlyphVertices>0&&pr?yn(pr,zt.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null}}),wt&&(Et=wt.box,Dt=wt.offscreen);var Xs=Mn(wt&&wt.box);if(!Et&&u.prevPlacement){var gs=u.prevPlacement.variableOffsets[ut.crossTileID];gs&&(u.variableOffsets[ut.crossTileID]=gs,u.markUsedJustification(_,gs.anchor,ut,Xs))}}else{var _s=function(pr,po){var Ln=u.collisionIndex.placeCollisionBox(pr,ae,j,T,Q.predicate);return Ln&&Ln.box&&Ln.box.length&&(u.markUsedOrientation(_,po,ut),u.placedOrientations[ut.crossTileID]=po),Ln};ts(function(){return _s(Cn,s.WritingMode.horizontal)},function(){var pr=zt.verticalTextBox;return _.allowVerticalPlacement&&ut.numVerticalGlyphVertices>0&&pr?_s(pr,s.WritingMode.vertical):{box:null,offscreen:null}}),Mn(wt&&wt.box&&wt.box.length)}}if(Et=(Ot=wt)&&Ot.box&&Ot.box.length>0,Dt=Ot&&Ot.offscreen,ut.useRuntimeCollisionCircles){var Ps=_.text.placedSymbolArray.get(ut.centerJustifiedTextSymbolIndex),Ws=s.evaluateSizeForFeature(_.textSizeData,J,Ps),fa=x.get("text-padding");ui=u.collisionIndex.placeCollisionCircles(ae,Ps,_.lineVertexArray,_.glyphOffsetArray,Ws,T,z,L,o,Te,Q.predicate,ut.collisionCircleDiameter,fa),Et=ae||ui.circles.length>0&&!ui.collisionDetected,Dt=Dt&&ui.offscreen}if(zt.iconFeatureIndex&&(ci=zt.iconFeatureIndex),zt.iconBox){var Cs=function(pr){var po=ve&&bt?Fn(pr,bt.x,bt.y,ye,Te,u.transform.angle):pr;return u.collisionIndex.placeCollisionBox(po,he,j,T,Q.predicate)};St=zi&&zi.box&&zi.box.length&&zt.verticalIconBox?(on=Cs(zt.verticalIconBox)).box.length>0:(on=Cs(zt.iconBox)).box.length>0,Dt=Dt&&on.offscreen}var Go=oe||ut.numHorizontalGlyphVertices===0&&ut.numVerticalGlyphVertices===0,ti=Y||ut.numIconVertices===0;if(Go||ti?ti?Go||(St=St&&Et):Et=St&&Et:St=Et=St&&Et,Et&&Ot&&Ot.box&&u.collisionIndex.insertCollisionBox(Ot.box,x.get("text-ignore-placement"),_.bucketInstanceId,zi&&zi.box&&Rr?Rr:ji,Q.ID),St&&on&&u.collisionIndex.insertCollisionBox(on.box,x.get("icon-ignore-placement"),_.bucketInstanceId,ci,Q.ID),ui&&(Et&&u.collisionIndex.insertCollisionCircles(ui.circles,x.get("text-ignore-placement"),_.bucketInstanceId,ji,Q.ID),o)){var La=_.bucketInstanceId,Ra=u.collisionCircleArrays[La];Ra===void 0&&(Ra=u.collisionCircleArrays[La]=new yi);for(var Ms=0;Ms<ui.circles.length;Ms+=4)Ra.circles.push(ui.circles[Ms+0]),Ra.circles.push(ui.circles[Ms+1]),Ra.circles.push(ui.circles[Ms+2]),Ra.circles.push(ui.collisionDetected?1:0)}u.placements[ut.crossTileID]=new Qo(Et||Re,St||Ue,Dt||_.justReloaded),a[ut.crossTileID]=!0}};if(Ae)for(var at=_.getSortedSymbolIndexes(this.transform.angle),yt=at.length-1;yt>=0;--yt){var mt=at[yt];Ve(_.symbolInstances.get(mt),_.collisionArrays[mt])}else for(var _t=n.symbolInstanceStart;_t<n.symbolInstanceEnd;_t++)Ve(_.symbolInstances.get(_t),_.collisionArrays[_t]);if(o&&_.bucketInstanceId in this.collisionCircleArrays){var ir=this.collisionCircleArrays[_.bucketInstanceId];s.invert(ir.invProjMatrix,T),ir.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1},ki.prototype.markUsedJustification=function(n,a,o,u){var d;d=u===s.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[s.getAnchorJustification(a)];for(var _=0,x=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];_<x.length;_+=1){var T=x[_];T>=0&&(n.text.placedSymbolArray.get(T).crossTileID=d>=0&&T!==d?0:o.crossTileID)}},ki.prototype.markUsedOrientation=function(n,a,o){for(var u=a===s.WritingMode.horizontal||a===s.WritingMode.horizontalOnly?a:0,d=a===s.WritingMode.vertical?a:0,_=0,x=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];_<x.length;_+=1)n.text.placedSymbolArray.get(x[_]).placedOrientation=u;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=d)},ki.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,o=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var u=a?a.symbolFadeChange(n):1,d=a?a.opacities:{},_=a?a.variableOffsets:{},x=a?a.placedOrientations:{};for(var T in this.placements){var z=this.placements[T],L=d[T];L?(this.opacities[T]=new mi(L,u,z.text,z.icon),o=o||z.text!==L.text.placed||z.icon!==L.icon.placed):(this.opacities[T]=new mi(null,u,z.text,z.icon,z.skipFade),o=o||z.text||z.icon)}for(var j in d){var q=d[j];if(!this.opacities[j]){var Z=new mi(q,u,!1,!1);Z.isHidden()||(this.opacities[j]=Z,o=o||q.text.placed||q.icon.placed)}}for(var J in _)this.variableOffsets[J]||!this.opacities[J]||this.opacities[J].isHidden()||(this.variableOffsets[J]=_[J]);for(var Q in x)this.placedOrientations[Q]||!this.opacities[Q]||this.opacities[Q].isHidden()||(this.placedOrientations[Q]=x[Q]);o?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:n)},ki.prototype.updateLayerOpacities=function(n,a){for(var o={},u=0,d=a;u<d.length;u+=1){var _=d[u],x=_.getBucket(n);x&&_.latestFeatureIndex&&n.id===x.layerIds[0]&&this.updateBucketOpacities(x,o,_.collisionBoxArray)}},ki.prototype.updateBucketOpacities=function(n,a,o){var u=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var d=n.layers[0].layout,_=new mi(null,0,!1,!1,!0),x=d.get("text-allow-overlap"),T=d.get("icon-allow-overlap"),z=d.get("text-variable-anchor"),L=d.get("text-rotation-alignment")==="map",j=d.get("text-pitch-alignment")==="map",q=d.get("icon-text-fit")!=="none",Z=new mi(null,0,x&&(T||!n.hasIconData()||d.get("icon-optional")),T&&(x||!n.hasTextData()||d.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var J=function(ae,he,ye){for(var Te=0;Te<he/4;Te++)ae.opacityVertexArray.emplaceBack(ye)},Q=function(ae){var he=n.symbolInstances.get(ae),ye=he.numHorizontalGlyphVertices,Te=he.numVerticalGlyphVertices,ve=he.crossTileID,Ae=u.opacities[ve];a[ve]?Ae=_:Ae||(u.opacities[ve]=Ae=Z),a[ve]=!0;var Re=he.numIconVertices>0,Ue=u.placedOrientations[he.crossTileID],Ve=Ue===s.WritingMode.vertical,at=Ue===s.WritingMode.horizontal||Ue===s.WritingMode.horizontalOnly;if(ye>0||Te>0){var yt=ga(Ae.text);J(n.text,ye,Ve?wo:yt),J(n.text,Te,at?wo:yt);var mt=Ae.text.isHidden();[he.rightJustifiedTextSymbolIndex,he.centerJustifiedTextSymbolIndex,he.leftJustifiedTextSymbolIndex].forEach(function(wt){wt>=0&&(n.text.placedSymbolArray.get(wt).hidden=mt||Ve?1:0)}),he.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(he.verticalPlacedTextSymbolIndex).hidden=mt||at?1:0);var _t=u.variableOffsets[he.crossTileID];_t&&u.markUsedJustification(n,_t.anchor,he,Ue);var ir=u.placedOrientations[he.crossTileID];ir&&(u.markUsedJustification(n,"left",he,ir),u.markUsedOrientation(n,ir,he))}if(Re){var ut=ga(Ae.icon),zt=!(q&&he.verticalPlacedIconSymbolIndex&&Ve);he.placedIconSymbolIndex>=0&&(J(n.icon,he.numIconVertices,zt?ut:wo),n.icon.placedSymbolArray.get(he.placedIconSymbolIndex).hidden=Ae.icon.isHidden()),he.verticalPlacedIconSymbolIndex>=0&&(J(n.icon,he.numVerticalIconVertices,zt?wo:ut),n.icon.placedSymbolArray.get(he.verticalPlacedIconSymbolIndex).hidden=Ae.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Ot=n.collisionArrays[ae];if(Ot){var Et=new s.Point(0,0);if(Ot.textBox||Ot.verticalTextBox){var St=!0;if(z){var Dt=u.variableOffsets[ve];Dt?(Et=si(Dt.anchor,Dt.width,Dt.height,Dt.textOffset,Dt.textBoxScale),L&&Et._rotate(j?u.transform.angle:-u.transform.angle)):St=!1}Ot.textBox&&sr(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!St||Ve,Et.x,Et.y),Ot.verticalTextBox&&sr(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!St||at,Et.x,Et.y)}var bt=Boolean(!at&&Ot.verticalIconBox);Ot.iconBox&&sr(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,bt,q?Et.x:0,q?Et.y:0),Ot.verticalIconBox&&sr(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,!bt,q?Et.x:0,q?Et.y:0)}}},oe=0;oe<n.symbolInstances.length;oe++)Q(oe);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var Y=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Y.invProjMatrix,n.placementViewportMatrix=Y.viewportMatrix,n.collisionCircleArray=Y.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},ki.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},ki.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},ki.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},ki.prototype.stillRecent=function(n,a){var o=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*o>n},ki.prototype.setStale=function(){this.stale=!0};var to=Math.pow(2,25),ro=Math.pow(2,24),Vn=Math.pow(2,17),al=Math.pow(2,16),Lo=Math.pow(2,9),Yl=Math.pow(2,8),os=Math.pow(2,1);function ga(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var a=n.placed?1:0,o=Math.floor(127*n.opacity);return o*to+a*ro+o*Vn+a*al+o*Lo+a*Yl+o*os+a}var wo=0,bs=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};bs.prototype.continuePlacement=function(n,a,o,u,d){for(var _=this._bucketParts;this._currentTileIndex<n.length;)if(a.getBucketParts(_,u,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,_.sort(function(x,T){return x.sortKey-T.sortKey}));this._currentPartIndex<_.length;)if(a.placeLayerBucketPart(_[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,d())return!0;return!1};var ja=function(n,a,o,u,d,_,x){this.placement=new ki(n,d,_,x),this._currentPlacementIndex=a.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=u,this._done=!1};ja.prototype.isDone=function(){return this._done},ja.prototype.continuePlacement=function(n,a,o){for(var u=this,d=s.browser.now(),_=function(){var z=s.browser.now()-d;return!u._forceFullPlacement&&z>2};this._currentPlacementIndex>=0;){var x=a[n[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=T)&&(!x.maxzoom||x.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new bs(x)),this._inProgressLayer.continuePlacement(o[x.source],this.placement,this._showCollisionBoxes,x,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ja.prototype.commit=function(n){return this.placement.commit(n),this.placement};var $o=512/s.EXTENT/2,Nn=function(n,a,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var u=0;u<a.length;u++){var d=a.get(u),_=d.key;this.indexedSymbolInstances[_]||(this.indexedSymbolInstances[_]=[]),this.indexedSymbolInstances[_].push({crossTileID:d.crossTileID,coord:this.getScaledCoordinates(d,n)})}};Nn.prototype.getScaledCoordinates=function(n,a){var o=$o/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*s.EXTENT+n.anchorX)*o),y:Math.floor((a.canonical.y*s.EXTENT+n.anchorY)*o)}},Nn.prototype.findMatches=function(n,a,o){for(var u=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),d=0;d<n.length;d++){var _=n.get(d);if(!_.crossTileID){var x=this.indexedSymbolInstances[_.key];if(x)for(var T=this.getScaledCoordinates(_,a),z=0,L=x;z<L.length;z+=1){var j=L[z];if(Math.abs(j.coord.x-T.x)<=u&&Math.abs(j.coord.y-T.y)<=u&&!o[j.crossTileID]){o[j.crossTileID]=!0,_.crossTileID=j.crossTileID;break}}}}};var En=function(){this.maxCrossTileID=0};En.prototype.generate=function(){return++this.maxCrossTileID};var Gi=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Gi.prototype.handleWrapJump=function(n){var a=Math.round((n-this.lng)/360);if(a!==0)for(var o in this.indexes){var u=this.indexes[o],d={};for(var _ in u){var x=u[_];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+a),d[x.tileID.key]=x}this.indexes[o]=d}this.lng=n},Gi.prototype.addBucket=function(n,a,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var u=0;u<a.symbolInstances.length;u++)a.symbolInstances.get(u).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var d=this.usedCrossTileIDs[n.overscaledZ];for(var _ in this.indexes){var x=this.indexes[_];if(Number(_)>n.overscaledZ)for(var T in x){var z=x[T];z.tileID.isChildOf(n)&&z.findMatches(a.symbolInstances,n,d)}else{var L=x[n.scaledTo(Number(_)).key];L&&L.findMatches(a.symbolInstances,n,d)}}for(var j=0;j<a.symbolInstances.length;j++){var q=a.symbolInstances.get(j);q.crossTileID||(q.crossTileID=o.generate(),d[q.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Nn(n,a.symbolInstances,a.bucketInstanceId),!0},Gi.prototype.removeBucketCrossTileIDs=function(n,a){for(var o in a.indexedSymbolInstances)for(var u=0,d=a.indexedSymbolInstances[o];u<d.length;u+=1)delete this.usedCrossTileIDs[n][d[u].crossTileID]},Gi.prototype.removeStaleBuckets=function(n){var a=!1;for(var o in this.indexes){var u=this.indexes[o];for(var d in u)n[u[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,u[d]),delete u[d],a=!0)}return a};var pe=function(){this.layerIndexes={},this.crossTileIDs=new En,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};pe.prototype.addLayer=function(n,a,o){var u=this.layerIndexes[n.id];u===void 0&&(u=this.layerIndexes[n.id]=new Gi);var d=!1,_={};u.handleWrapJump(o);for(var x=0,T=a;x<T.length;x+=1){var z=T[x],L=z.getBucket(n);L&&n.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(z.tileID,L,this.crossTileIDs)&&(d=!0),_[L.bucketInstanceId]=!0)}return u.removeStaleBuckets(_)&&(d=!0),d},pe.prototype.pruneUnusedLayers=function(n){var a={};for(var o in n.forEach(function(u){a[u]=!0}),this.layerIndexes)a[o]||delete this.layerIndexes[o]};var $r=function(n,a){return s.emitValidationErrors(n,a&&a.filter(function(o){return o.identifier!=="source.canvas"}))},Di=s.pick(Ge,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),vr=s.pick(Ge,["setCenter","setZoom","setBearing","setPitch"]),_a=function(){var n={},a=s.styleSpec.$version;for(var o in s.styleSpec.$root){var u,d=s.styleSpec.$root[o];d.required&&(u=o==="version"?a:d.type==="array"?[]:{})!=null&&(n[o]=u)}return n}(),Tn=function(n){function a(o,u){var d=this;u===void 0&&(u={}),n.call(this),this.map=o,this.dispatcher=new rr(Se(),this),this.imageManager=new Xe,this.imageManager.setEventedParent(this),this.glyphManager=new Wt(o._requestManager,u.localIdeographFontFamily),this.lineAtlas=new It(256,512),this.crossTileSymbolIndex=new pe,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());var _=this;this._rtlTextPluginCallback=a.registerForPluginStateChange(function(x){_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},function(T,z){if(s.triggerPluginCompletionEvent(T),z&&z.every(function(j){return j}))for(var L in _.sourceCaches)_.sourceCaches[L].reload()})}),this.on("data",function(x){if(x.dataType==="source"&&x.sourceDataType==="metadata"){var T=d.sourceCaches[x.sourceId];if(T){var z=T.getSource();if(z&&z.vectorLayerIds)for(var L in d._layers){var j=d._layers[L];j.source===z.id&&d._validateLayer(j)}}}})}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.loadURL=function(o,u){var d=this;u===void 0&&(u={}),this.fire(new s.Event("dataloading",{dataType:"style"}));var _=typeof u.validate=="boolean"?u.validate:!s.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,u.accessToken);var x=this.map._requestManager.transformRequest(o,s.ResourceType.Style);this._request=s.getJSON(x,function(T,z){d._request=null,T?d.fire(new s.ErrorEvent(T)):z&&d._load(z,_)})},a.prototype.loadJSON=function(o,u){var d=this;u===void 0&&(u={}),this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.browser.frame(function(){d._request=null,d._load(o,u.validate!==!1)})},a.prototype.loadEmpty=function(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(_a,!1)},a.prototype._load=function(o,u){if(!u||!$r(this,s.validateStyle(o))){for(var d in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(d,o.sources[d],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var _=Ne(this.stylesheet.layers);this._order=_.map(function(L){return L.id}),this._layers={},this._serializedLayers={};for(var x=0,T=_;x<T.length;x+=1){var z=T[x];(z=s.createStyleLayer(z)).setEventedParent(this,{layer:{id:z.id}}),this._layers[z.id]=z,this._serializedLayers[z.id]=z.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new mr(this.stylesheet.light),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}},a.prototype._loadSprite=function(o){var u=this;this._spriteRequest=function(d,_,x){var T,z,L,j=s.browser.devicePixelRatio>1?"@2x":"",q=s.getJSON(_.transformRequest(_.normalizeSpriteURL(d,j,".json"),s.ResourceType.SpriteJSON),function(Q,oe){q=null,L||(L=Q,T=oe,J())}),Z=s.getImage(_.transformRequest(_.normalizeSpriteURL(d,j,".png"),s.ResourceType.SpriteImage),function(Q,oe){Z=null,L||(L=Q,z=oe,J())});function J(){if(L)x(L);else if(T&&z){var Q=s.browser.getImageData(z),oe={};for(var Y in T){var ae=T[Y],he=ae.width,ye=ae.height,Te=ae.x,ve=ae.y,Ae=ae.sdf,Re=ae.pixelRatio,Ue=ae.stretchX,Ve=ae.stretchY,at=ae.content,yt=new s.RGBAImage({width:he,height:ye});s.RGBAImage.copy(Q,yt,{x:Te,y:ve},{x:0,y:0},{width:he,height:ye}),oe[Y]={data:yt,pixelRatio:Re,sdf:Ae,stretchX:Ue,stretchY:Ve,content:at}}x(null,oe)}}return{cancel:function(){q&&(q.cancel(),q=null),Z&&(Z.cancel(),Z=null)}}}(o,this.map._requestManager,function(d,_){if(u._spriteRequest=null,d)u.fire(new s.ErrorEvent(d));else if(_)for(var x in _)u.imageManager.addImage(x,_[x]);u.imageManager.setLoaded(!0),u._availableImages=u.imageManager.listImages(),u.dispatcher.broadcast("setImages",u._availableImages),u.fire(new s.Event("data",{dataType:"style"}))})},a.prototype._validateLayer=function(o){var u=this.sourceCaches[o.source];if(u){var d=o.sourceLayer;if(d){var _=u.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(d)===-1)&&this.fire(new s.ErrorEvent(new Error('Source layer "'+d+'" does not exist on source "'+_.id+'" as specified by style layer "'+o.id+'"')))}}},a.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},a.prototype._serializeLayers=function(o){for(var u=[],d=0,_=o;d<_.length;d+=1){var x=this._layers[_[d]];x.type!=="custom"&&u.push(x.serialize())}return u},a.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var u in this._layers)if(this._layers[u].hasTransition())return!0;return!1},a.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},a.prototype.update=function(o){if(this._loaded){var u=this._changed;if(this._changed){var d=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);for(var x in(d.length||_.length)&&this._updateWorkerLayers(d,_),this._updatedSources){var T=this._updatedSources[x];T==="reload"?this._reloadSource(x):T==="clear"&&this._clearSource(x)}for(var z in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[z].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var L={};for(var j in this.sourceCaches){var q=this.sourceCaches[j];L[j]=q.used,q.used=!1}for(var Z=0,J=this._order;Z<J.length;Z+=1){var Q=this._layers[J[Z]];Q.recalculate(o,this._availableImages),!Q.isHidden(o.zoom)&&Q.source&&(this.sourceCaches[Q.source].used=!0)}for(var oe in L){var Y=this.sourceCaches[oe];L[oe]!==Y.used&&Y.fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:oe}))}this.light.recalculate(o),this.z=o.zoom,u&&this.fire(new s.Event("data",{dataType:"style"}))}},a.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},a.prototype._updateWorkerLayers=function(o,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:u})},a.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},a.prototype.setState=function(o){var u=this;if(this._checkLoaded(),$r(this,s.validateStyle(o)))return!1;(o=s.clone$1(o)).layers=Ne(o.layers);var d=function(x,T){if(!x)return[{command:Ge.setStyle,args:[T]}];var z=[];try{if(!s.deepEqual(x.version,T.version))return[{command:Ge.setStyle,args:[T]}];s.deepEqual(x.center,T.center)||z.push({command:Ge.setCenter,args:[T.center]}),s.deepEqual(x.zoom,T.zoom)||z.push({command:Ge.setZoom,args:[T.zoom]}),s.deepEqual(x.bearing,T.bearing)||z.push({command:Ge.setBearing,args:[T.bearing]}),s.deepEqual(x.pitch,T.pitch)||z.push({command:Ge.setPitch,args:[T.pitch]}),s.deepEqual(x.sprite,T.sprite)||z.push({command:Ge.setSprite,args:[T.sprite]}),s.deepEqual(x.glyphs,T.glyphs)||z.push({command:Ge.setGlyphs,args:[T.glyphs]}),s.deepEqual(x.transition,T.transition)||z.push({command:Ge.setTransition,args:[T.transition]}),s.deepEqual(x.light,T.light)||z.push({command:Ge.setLight,args:[T.light]});var L={},j=[];(function(Z,J,Q,oe){var Y;for(Y in J=J||{},Z=Z||{})Z.hasOwnProperty(Y)&&(J.hasOwnProperty(Y)||je(Y,Q,oe));for(Y in J)J.hasOwnProperty(Y)&&(Z.hasOwnProperty(Y)?s.deepEqual(Z[Y],J[Y])||(Z[Y].type==="geojson"&&J[Y].type==="geojson"&&ar(Z,J,Y)?Q.push({command:Ge.setGeoJSONSourceData,args:[Y,J[Y].data]}):Pt(Y,J,Q,oe)):At(Y,J,Q))})(x.sources,T.sources,j,L);var q=[];x.layers&&x.layers.forEach(function(Z){L[Z.source]?z.push({command:Ge.removeLayer,args:[Z.id]}):q.push(Z)}),z=z.concat(j),function(Z,J,Q){J=J||[];var oe,Y,ae,he,ye,Te,ve,Ae=(Z=Z||[]).map(Vt),Re=J.map(Vt),Ue=Z.reduce(Mt,{}),Ve=J.reduce(Mt,{}),at=Ae.slice(),yt=Object.create(null);for(oe=0,Y=0;oe<Ae.length;oe++)Ve.hasOwnProperty(ae=Ae[oe])?Y++:(Q.push({command:Ge.removeLayer,args:[ae]}),at.splice(at.indexOf(ae,Y),1));for(oe=0,Y=0;oe<Re.length;oe++)at[at.length-1-oe]!==(ae=Re[Re.length-1-oe])&&(Ue.hasOwnProperty(ae)?(Q.push({command:Ge.removeLayer,args:[ae]}),at.splice(at.lastIndexOf(ae,at.length-Y),1)):Y++,Q.push({command:Ge.addLayer,args:[Ve[ae],Te=at[at.length-oe]]}),at.splice(at.length-oe,0,ae),yt[ae]=!0);for(oe=0;oe<Re.length;oe++)if(he=Ue[ae=Re[oe]],ye=Ve[ae],!yt[ae]&&!s.deepEqual(he,ye))if(s.deepEqual(he.source,ye.source)&&s.deepEqual(he["source-layer"],ye["source-layer"])&&s.deepEqual(he.type,ye.type)){for(ve in Ct(he.layout,ye.layout,Q,ae,null,Ge.setLayoutProperty),Ct(he.paint,ye.paint,Q,ae,null,Ge.setPaintProperty),s.deepEqual(he.filter,ye.filter)||Q.push({command:Ge.setFilter,args:[ae,ye.filter]}),s.deepEqual(he.minzoom,ye.minzoom)&&s.deepEqual(he.maxzoom,ye.maxzoom)||Q.push({command:Ge.setLayerZoomRange,args:[ae,ye.minzoom,ye.maxzoom]}),he)he.hasOwnProperty(ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?Ct(he[ve],ye[ve],Q,ae,ve.slice(6),Ge.setPaintProperty):s.deepEqual(he[ve],ye[ve])||Q.push({command:Ge.setLayerProperty,args:[ae,ve,ye[ve]]}));for(ve in ye)ye.hasOwnProperty(ve)&&!he.hasOwnProperty(ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?Ct(he[ve],ye[ve],Q,ae,ve.slice(6),Ge.setPaintProperty):s.deepEqual(he[ve],ye[ve])||Q.push({command:Ge.setLayerProperty,args:[ae,ve,ye[ve]]}))}else Q.push({command:Ge.removeLayer,args:[ae]}),Te=at[at.lastIndexOf(ae)+1],Q.push({command:Ge.addLayer,args:[ye,Te]})}(q,T.layers,z)}catch(Z){console.warn("Unable to compute style diff:",Z),z=[{command:Ge.setStyle,args:[T]}]}return z}(this.serialize(),o).filter(function(x){return!(x.command in vr)});if(d.length===0)return!1;var _=d.filter(function(x){return!(x.command in Di)});if(_.length>0)throw new Error("Unimplemented: "+_.map(function(x){return x.command}).join(", ")+".");return d.forEach(function(x){x.command!=="setTransition"&&u[x.command].apply(u,x.args)}),this.stylesheet=o,!0},a.prototype.addImage=function(o,u){if(this.getImage(o))return this.fire(new s.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,u),this._afterImageUpdated(o)},a.prototype.updateImage=function(o,u){this.imageManager.updateImage(o,u)},a.prototype.getImage=function(o){return this.imageManager.getImage(o)},a.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new s.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},a.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))},a.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},a.prototype.addSource=function(o,u,d){var _=this;if(d===void 0&&(d={}),this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(u).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(s.validateStyle.source,"sources."+o,u,null,d))){this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);var x=this.sourceCaches[o]=new re(o,u,this.dispatcher);x.style=this,x.setEventedParent(this,function(){return{isSourceLoaded:_.loaded(),source:x.serialize(),sourceId:o}}),x.onAdd(this.map),this._changed=!0}},a.prototype.removeSource=function(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(var u in this._layers)if(this._layers[u].source===o)return this.fire(new s.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+u+'" is using it.')));var d=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],d.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),d.setEventedParent(null),d.clearTiles(),d.onRemove&&d.onRemove(this.map),this._changed=!0},a.prototype.setGeoJSONSourceData=function(o,u){this._checkLoaded(),this.sourceCaches[o].getSource().setData(u),this._changed=!0},a.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},a.prototype.addLayer=function(o,u,d){d===void 0&&(d={}),this._checkLoaded();var _=o.id;if(this.getLayer(_))this.fire(new s.ErrorEvent(new Error('Layer with id "'+_+'" already exists on this map')));else{var x;if(o.type==="custom"){if($r(this,s.validateCustomStyleLayer(o)))return;x=s.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(_,o.source),o=s.clone$1(o),o=s.extend(o,{source:_})),this._validate(s.validateStyle.layer,"layers."+_,o,{arrayIndex:-1},d))return;x=s.createStyleLayer(o),this._validateLayer(x),x.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[x.id]=x.serialize()}var T=u?this._order.indexOf(u):this._order.length;if(u&&T===-1)this.fire(new s.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.')));else{if(this._order.splice(T,0,_),this._layerOrderChanged=!0,this._layers[_]=x,this._removedLayers[_]&&x.source&&x.type!=="custom"){var z=this._removedLayers[_];delete this._removedLayers[_],z.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}},a.prototype.moveLayer=function(o,u){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==u){var d=this._order.indexOf(o);this._order.splice(d,1);var _=u?this._order.indexOf(u):this._order.length;u&&_===-1?this.fire(new s.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.'))):(this._order.splice(_,0,o),this._layerOrderChanged=!0)}}else this.fire(new s.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},a.prototype.removeLayer=function(o){this._checkLoaded();var u=this._layers[o];if(u){u.setEventedParent(null);var d=this._order.indexOf(o);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map)}else this.fire(new s.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},a.prototype.getLayer=function(o){return this._layers[o]},a.prototype.hasLayer=function(o){return o in this._layers},a.prototype.setLayerZoomRange=function(o,u,d){this._checkLoaded();var _=this.getLayer(o);_?_.minzoom===u&&_.maxzoom===d||(u!=null&&(_.minzoom=u),d!=null&&(_.maxzoom=d),this._updateLayer(_)):this.fire(new s.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},a.prototype.setFilter=function(o,u,d){d===void 0&&(d={}),this._checkLoaded();var _=this.getLayer(o);if(_){if(!s.deepEqual(_.filter,u))return u==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(s.validateStyle.filter,"layers."+_.id+".filter",u,null,d)||(_.filter=s.clone$1(u),this._updateLayer(_)))}else this.fire(new s.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},a.prototype.getFilter=function(o){return s.clone$1(this.getLayer(o).filter)},a.prototype.setLayoutProperty=function(o,u,d,_){_===void 0&&(_={}),this._checkLoaded();var x=this.getLayer(o);x?s.deepEqual(x.getLayoutProperty(u),d)||(x.setLayoutProperty(u,d,_),this._updateLayer(x)):this.fire(new s.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getLayoutProperty=function(o,u){var d=this.getLayer(o);if(d)return d.getLayoutProperty(u);this.fire(new s.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},a.prototype.setPaintProperty=function(o,u,d,_){_===void 0&&(_={}),this._checkLoaded();var x=this.getLayer(o);x?s.deepEqual(x.getPaintProperty(u),d)||(x.setPaintProperty(u,d,_)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new s.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getPaintProperty=function(o,u){return this.getLayer(o).getPaintProperty(u)},a.prototype.setFeatureState=function(o,u){this._checkLoaded();var d=o.source,_=o.sourceLayer,x=this.sourceCaches[d];if(x!==void 0){var T=x.getSource().type;T==="geojson"&&_?this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):T!=="vector"||_?(o.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),x.setFeatureState(_,o.id,u)):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},a.prototype.removeFeatureState=function(o,u){this._checkLoaded();var d=o.source,_=this.sourceCaches[d];if(_!==void 0){var x=_.getSource().type,T=x==="vector"?o.sourceLayer:void 0;x!=="vector"||T?u&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(T,o.id,u):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},a.prototype.getFeatureState=function(o){this._checkLoaded();var u=o.source,d=o.sourceLayer,_=this.sourceCaches[u];if(_!==void 0){if(_.getSource().type!=="vector"||d)return o.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),_.getFeatureState(d,o.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+u+"' does not exist in the map's style.")))},a.prototype.getTransition=function(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},a.prototype.serialize=function(){return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:s.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return o!==void 0})},a.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},a.prototype._flattenAndSortRenderedFeatures=function(o){for(var u=this,d=function(Ue){return u._layers[Ue].type==="fill-extrusion"},_={},x=[],T=this._order.length-1;T>=0;T--){var z=this._order[T];if(d(z)){_[z]=T;for(var L=0,j=o;L<j.length;L+=1){var q=j[L][z];if(q)for(var Z=0,J=q;Z<J.length;Z+=1)x.push(J[Z])}}}x.sort(function(Ue,Ve){return Ve.intersectionZ-Ue.intersectionZ});for(var Q=[],oe=this._order.length-1;oe>=0;oe--){var Y=this._order[oe];if(d(Y))for(var ae=x.length-1;ae>=0;ae--){var he=x[ae].feature;if(_[he.layer.id]<oe)break;Q.push(he),x.pop()}else for(var ye=0,Te=o;ye<Te.length;ye+=1){var ve=Te[ye][Y];if(ve)for(var Ae=0,Re=ve;Ae<Re.length;Ae+=1)Q.push(Re[Ae].feature)}}return Q},a.prototype.queryRenderedFeatures=function(o,u,d){u&&u.filter&&this._validate(s.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);var _={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var x=0,T=u.layers;x<T.length;x+=1){var z=T[x],L=this._layers[z];if(!L)return this.fire(new s.ErrorEvent(new Error("The layer '"+z+"' does not exist in the map's style and cannot be queried for features."))),[];_[L.source]=!0}}var j=[];for(var q in u.availableImages=this._availableImages,this.sourceCaches)u.layers&&!_[q]||j.push(Gt(this.sourceCaches[q],this._layers,this._serializedLayers,o,u,d));return this.placement&&j.push(function(Z,J,Q,oe,Y,ae,he){for(var ye={},Te=ae.queryRenderedSymbols(oe),ve=[],Ae=0,Re=Object.keys(Te).map(Number);Ae<Re.length;Ae+=1)ve.push(he[Re[Ae]]);ve.sort(_r);for(var Ue=function(){var _t=at[Ve],ir=_t.featureIndex.lookupSymbolFeatures(Te[_t.bucketInstanceId],J,_t.bucketIndex,_t.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,Z);for(var ut in ir){var zt=ye[ut]=ye[ut]||[],Ot=ir[ut];Ot.sort(function(Dt,bt){var wt=_t.featureSortOrder;if(wt){var zi=wt.indexOf(Dt.featureIndex);return wt.indexOf(bt.featureIndex)-zi}return bt.featureIndex-Dt.featureIndex});for(var Et=0,St=Ot;Et<St.length;Et+=1)zt.push(St[Et])}},Ve=0,at=ve;Ve<at.length;Ve+=1)Ue();var yt=function(_t){ye[_t].forEach(function(ir){var ut=ir.feature,zt=Q[Z[_t].source].getFeatureState(ut.layer["source-layer"],ut.id);ut.source=ut.layer.source,ut.layer["source-layer"]&&(ut.sourceLayer=ut.layer["source-layer"]),ut.state=zt})};for(var mt in ye)yt(mt);return ye}(this._layers,this._serializedLayers,this.sourceCaches,o,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(j)},a.prototype.querySourceFeatures=function(o,u){u&&u.filter&&this._validate(s.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);var d=this.sourceCaches[o];return d?function(_,x){for(var T=_.getRenderableIds().map(function(J){return _.getTileByID(J)}),z=[],L={},j=0;j<T.length;j++){var q=T[j],Z=q.tileID.canonical.key;L[Z]||(L[Z]=!0,q.querySourceFeatures(z,x))}return z}(d,u):[]},a.prototype.addSourceType=function(o,u,d){return a.getSourceType(o)?d(new Error('A source type called "'+o+'" already exists.')):(a.setSourceType(o,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:u.workerSourceURL},d):d(null,null))},a.prototype.getLight=function(){return this.light.getLight()},a.prototype.setLight=function(o,u){u===void 0&&(u={}),this._checkLoaded();var d=this.light.getLight(),_=!1;for(var x in o)if(!s.deepEqual(o[x],d[x])){_=!0;break}if(_){var T={now:s.browser.now(),transition:s.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,u),this.light.updateTransitions(T)}},a.prototype._validate=function(o,u,d,_,x){return x===void 0&&(x={}),(!x||x.validate!==!1)&&$r(this,o.call(s.validateStyle,s.extend({key:u,style:this.serialize(),value:d,styleSpec:s.styleSpec},_)))},a.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var u in this.sourceCaches)this.sourceCaches[u].clearTiles(),this.sourceCaches[u].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},a.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},a.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},a.prototype._updateSources=function(o){for(var u in this.sourceCaches)this.sourceCaches[u].update(o)},a.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},a.prototype._updatePlacement=function(o,u,d,_,x){x===void 0&&(x=!1);for(var T=!1,z=!1,L={},j=0,q=this._order;j<q.length;j+=1){var Z=this._layers[q[j]];if(Z.type==="symbol"){if(!L[Z.source]){var J=this.sourceCaches[Z.source];L[Z.source]=J.getRenderableIds(!0).map(function(he){return J.getTileByID(he)}).sort(function(he,ye){return ye.tileID.overscaledZ-he.tileID.overscaledZ||(he.tileID.isLessThan(ye.tileID)?-1:1)})}var Q=this.crossTileSymbolIndex.addLayer(Z,L[Z.source],o.center.lng);T=T||Q}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.browser.now(),o.zoom))&&(this.pauseablePlacement=new ja(o,this._order,x,u,d,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.browser.now()),z=!0),T&&this.pauseablePlacement.placement.setStale()),z||T)for(var oe=0,Y=this._order;oe<Y.length;oe+=1){var ae=this._layers[Y[oe]];ae.type==="symbol"&&this.placement.updateLayerOpacities(ae,L[ae.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.browser.now())},a.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},a.prototype.getImages=function(o,u,d){this.imageManager.getImages(u.icons,d),this._updateTilesForChangedImages();var _=this.sourceCaches[u.source];_&&_.setDependencies(u.tileID.key,u.type,u.icons)},a.prototype.getGlyphs=function(o,u,d){this.glyphManager.getGlyphs(u.stacks,d)},a.prototype.getResource=function(o,u,d){return s.makeRequest(u,d)},a}(s.Evented);Tn.getSourceType=function(n){return Qi[n]},Tn.setSourceType=function(n,a){Qi[n]=a},Tn.registerForPluginStateChange=s.registerForPluginStateChange;var qr=s.createLayout([{name:"a_pos",type:"Int16",components:2}]),ea=Sr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Il=Sr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ql=Sr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),as=Sr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),va=Sr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),sl=Sr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Ro=Sr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),io=Sr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),xa=Sr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),kl=Sr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),ws=Sr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),ll=Sr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Ss=Sr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ss=Sr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),_i=Sr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),ul=Sr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),ba=Sr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Un=Sr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),qa=Sr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),So=Sr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),no=Sr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Za=Sr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Eo=Sr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Bo=Sr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),cl=Sr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),zl=Sr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Sr(n,a){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=a.match(/attribute ([\w]+) ([\w]+)/g),d=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=_?_.concat(d):d,T={};return{fragmentSource:n=n.replace(o,function(z,L,j,q,Z){return T[Z]=!0,L==="define"?`
#ifndef HAS_UNIFORM_u_`+Z+`
varying `+j+" "+q+" "+Z+`;
#else
uniform `+j+" "+q+" u_"+Z+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Z+`
    `+j+" "+q+" "+Z+" = u_"+Z+`;
#endif
`}),vertexSource:a=a.replace(o,function(z,L,j,q,Z){var J=q==="float"?"vec2":"vec4",Q=Z.match(/color/)?"color":J;return T[Z]?L==="define"?`
#ifndef HAS_UNIFORM_u_`+Z+`
uniform lowp float u_`+Z+`_t;
attribute `+j+" "+J+" a_"+Z+`;
varying `+j+" "+q+" "+Z+`;
#else
uniform `+j+" "+q+" u_"+Z+`;
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Z+`
    `+Z+" = a_"+Z+`;
#else
    `+j+" "+q+" "+Z+" = u_"+Z+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Z+`
    `+Z+" = unpack_mix_"+Q+"(a_"+Z+", u_"+Z+`_t);
#else
    `+j+" "+q+" "+Z+" = u_"+Z+`;
#endif
`:L==="define"?`
#ifndef HAS_UNIFORM_u_`+Z+`
uniform lowp float u_`+Z+`_t;
attribute `+j+" "+J+" a_"+Z+`;
#else
uniform `+j+" "+q+" u_"+Z+`;
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Z+`
    `+j+" "+q+" "+Z+" = a_"+Z+`;
#else
    `+j+" "+q+" "+Z+" = u_"+Z+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Z+`
    `+j+" "+q+" "+Z+" = unpack_mix_"+Q+"(a_"+Z+", u_"+Z+`_t);
#else
    `+j+" "+q+" "+Z+" = u_"+Z+`;
#endif
`}),staticAttributes:u,staticUniforms:x}}var wa=Object.freeze({__proto__:null,prelude:ea,background:Il,backgroundPattern:Ql,circle:as,clippingMask:va,heatmap:sl,heatmapTexture:Ro,collisionBox:io,collisionCircle:xa,debug:kl,fill:ws,fillOutline:ll,fillOutlinePattern:Ss,fillPattern:ss,fillExtrusion:_i,fillExtrusionPattern:ul,hillshadePrepare:ba,hillshade:Un,line:qa,lineGradient:So,linePattern:no,lineSDF:Za,raster:Eo,symbolIcon:Bo,symbolSDF:cl,symbolTextAndIcon:zl}),jn=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Sa(n){for(var a=[],o=0;o<n.length;o++)if(n[o]!==null){var u=n[o].split(" ");a.push(u.pop())}return a}jn.prototype.bind=function(n,a,o,u,d,_,x,T){this.context=n;for(var z=this.boundPaintVertexBuffers.length!==u.length,L=0;!z&&L<u.length;L++)this.boundPaintVertexBuffers[L]!==u[L]&&(z=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===o&&!z&&this.boundIndexBuffer===d&&this.boundVertexOffset===_&&this.boundDynamicVertexBuffer===x&&this.boundDynamicVertexBuffer2===T?(n.bindVertexArrayOES.set(this.vao),x&&x.bind(),d&&d.dynamicDraw&&d.bind(),T&&T.bind()):this.freshBind(a,o,u,d,_,x,T)},jn.prototype.freshBind=function(n,a,o,u,d,_,x){var T,z=n.numAttributes,L=this.context,j=L.gl;if(L.extVertexArrayObject)this.vao&&this.destroy(),this.vao=L.extVertexArrayObject.createVertexArrayOES(),L.bindVertexArrayOES.set(this.vao),T=0,this.boundProgram=n,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=u,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=_,this.boundDynamicVertexBuffer2=x;else{T=L.currentNumAttributes||0;for(var q=z;q<T;q++)j.disableVertexAttribArray(q)}a.enableAttributes(j,n);for(var Z=0,J=o;Z<J.length;Z+=1)J[Z].enableAttributes(j,n);_&&_.enableAttributes(j,n),x&&x.enableAttributes(j,n),a.bind(),a.setVertexAttribPointers(j,n,d);for(var Q=0,oe=o;Q<oe.length;Q+=1){var Y=oe[Q];Y.bind(),Y.setVertexAttribPointers(j,n,d)}_&&(_.bind(),_.setVertexAttribPointers(j,n,d)),u&&u.bind(),x&&(x.bind(),x.setVertexAttribPointers(j,n,d)),L.currentNumAttributes=z},jn.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Al=function(n,a,o,u,d,_){var x=n.gl;this.program=x.createProgram();for(var T=Sa(o.staticAttributes),z=u?u.getBinderAttributes():[],L=T.concat(z),j=o.staticUniforms?Sa(o.staticUniforms):[],q=u?u.getBinderUniforms():[],Z=[],J=0,Q=j.concat(q);J<Q.length;J+=1){var oe=Q[J];Z.indexOf(oe)<0&&Z.push(oe)}var Y=u?u.defines():[];_&&Y.push("#define OVERDRAW_INSPECTOR;");var ae=Y.concat(ea.fragmentSource,o.fragmentSource).join(`
`),he=Y.concat(ea.vertexSource,o.vertexSource).join(`
`),ye=x.createShader(x.FRAGMENT_SHADER);if(x.isContextLost())this.failedToCreate=!0;else{x.shaderSource(ye,ae),x.compileShader(ye),x.attachShader(this.program,ye);var Te=x.createShader(x.VERTEX_SHADER);if(x.isContextLost())this.failedToCreate=!0;else{x.shaderSource(Te,he),x.compileShader(Te),x.attachShader(this.program,Te),this.attributes={};var ve={};this.numAttributes=L.length;for(var Ae=0;Ae<this.numAttributes;Ae++)L[Ae]&&(x.bindAttribLocation(this.program,Ae,L[Ae]),this.attributes[L[Ae]]=Ae);x.linkProgram(this.program),x.deleteShader(Te),x.deleteShader(ye);for(var Re=0;Re<Z.length;Re++){var Ue=Z[Re];if(Ue&&!ve[Ue]){var Ve=x.getUniformLocation(this.program,Ue);Ve&&(ve[Ue]=Ve)}}this.fixedUniforms=d(n,ve),this.binderUniforms=u?u.getUniforms(n,ve):[]}}};function ls(n,a,o){var u=1/wr(o,1,a.transform.tileZoom),d=Math.pow(2,o.tileID.overscaledZ),_=o.tileSize*Math.pow(2,a.transform.tileZoom)/d,x=_*(o.tileID.canonical.x+o.tileID.wrap*d),T=_*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[u,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[x>>16,T>>16],u_pixel_coord_lower:[65535&x,65535&T]}}Al.prototype.draw=function(n,a,o,u,d,_,x,T,z,L,j,q,Z,J,Q,oe){var Y,ae=n.gl;if(!this.failedToCreate){for(var he in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(u),n.setColorMode(d),n.setCullFace(_),this.fixedUniforms)this.fixedUniforms[he].set(x[he]);J&&J.setUniforms(n,this.binderUniforms,q,{zoom:Z});for(var ye=(Y={},Y[ae.LINES]=2,Y[ae.TRIANGLES]=3,Y[ae.LINE_STRIP]=1,Y)[a],Te=0,ve=j.get();Te<ve.length;Te+=1){var Ae=ve[Te],Re=Ae.vaos||(Ae.vaos={});(Re[T]||(Re[T]=new jn)).bind(n,this,z,J?J.getPaintVertexBuffers():[],L,Ae.vertexOffset,Q,oe),ae.drawElements(a,Ae.primitiveLength*ye,ae.UNSIGNED_SHORT,Ae.primitiveOffset*ye*2)}}};var _u=function(n,a,o,u){var d=a.style.light,_=d.properties.get("position"),x=[_.x,_.y,_.z],T=s.create$1();d.properties.get("anchor")==="viewport"&&s.fromRotation(T,-a.transform.angle),s.transformMat3(x,x,T);var z=d.properties.get("color");return{u_matrix:n,u_lightpos:x,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[z.r,z.g,z.b],u_vertical_gradient:+o,u_opacity:u}},Ga=function(n,a,o,u,d,_,x){return s.extend(_u(n,a,o,u),ls(_,a,x),{u_height_factor:-Math.pow(2,d.overscaledZ)/x.tileSize/8})},oo=function(n){return{u_matrix:n}},Oo=function(n,a,o,u){return s.extend(oo(n),ls(o,a,u))},Pl=function(n,a){return{u_matrix:n,u_world:a}},Cl=function(n,a,o,u,d){return s.extend(Oo(n,a,o,u),{u_world:d})},Ea=function(n,a,o,u){var d,_,x=n.transform;if(u.paint.get("circle-pitch-alignment")==="map"){var T=wr(o,1,x.zoom);d=!0,_=[T,T]}else d=!1,_=x.pixelsToGLUnits;return{u_camera_to_center_distance:x.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(a.posMatrix,o,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:s.browser.devicePixelRatio,u_extrude_scale:_}},Ka=function(n,a,o){var u=wr(o,1,a.zoom),d=Math.pow(2,a.zoom-o.tileID.overscaledZ),_=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:a.cameraToCenterDistance,u_pixels_to_tile_units:u,u_extrude_scale:[a.pixelsToGLUnits[0]/(u*d),a.pixelsToGLUnits[1]/(u*d)],u_overscale_factor:_}},ta=function(n,a,o){return{u_matrix:n,u_inv_matrix:a,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},rn=function(n,a,o){return o===void 0&&(o=1),{u_matrix:n,u_color:a,u_overlay:0,u_overlay_scale:o}},qn=function(n){return{u_matrix:n}},Ml=function(n,a,o,u){return{u_matrix:n,u_extrude_scale:wr(a,1,o),u_intensity:u}},ra=function(n,a,o){var u=n.transform;return{u_matrix:Dl(n,a,o),u_ratio:1/wr(a,1,u.zoom),u_device_pixel_ratio:s.browser.devicePixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},Vr=function(n,a,o,u){return s.extend(ra(n,a,o),{u_image:0,u_image_height:u})},Fs=function(n,a,o,u){var d=n.transform,_=ia(a,d);return{u_matrix:Dl(n,a,o),u_texsize:a.imageAtlasTexture.size,u_ratio:1/wr(a,1,d.zoom),u_device_pixel_ratio:s.browser.devicePixelRatio,u_image:0,u_scale:[_,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Es=function(n,a,o,u,d){var _=n.lineAtlas,x=ia(a,n.transform),T=o.layout.get("line-cap")==="round",z=_.getDash(u.from,T),L=_.getDash(u.to,T),j=z.width*d.fromScale,q=L.width*d.toScale;return s.extend(ra(n,a,o),{u_patternscale_a:[x/j,-z.height/2],u_patternscale_b:[x/q,-L.height/2],u_sdfgamma:_.width/(256*Math.min(j,q)*s.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:L.y,u_mix:d.t})};function ia(n,a){return 1/wr(n,1,a.tileZoom)}function Dl(n,a,o){return n.translatePosMatrix(a.tileID.posMatrix,a,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var $l=function(n,a,o,u,d){return{u_matrix:n,u_tl_parent:a,u_scale_parent:o,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(x=d.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(_=d.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:Xa(d.paint.get("raster-hue-rotate"))};var _,x};function Xa(n){n*=Math.PI/180;var a=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*a-o+1)/3,(Math.sqrt(3)*a-o+1)/3]}var na,us=function(n,a,o,u,d,_,x,T,z,L){var j=d.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:j.cameraToCenterDistance,u_pitch:j.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:j.width/j.height,u_fade_change:d.options.fadeDuration?d.symbolFadeChange:1,u_matrix:_,u_label_plane_matrix:x,u_coord_matrix:T,u_is_text:+z,u_pitch_with_map:+u,u_texsize:L,u_texture:0}},ao=function(n,a,o,u,d,_,x,T,z,L,j){var q=d.transform;return s.extend(us(n,a,o,u,d,_,x,T,z,L),{u_gamma_scale:u?Math.cos(q._pitch)*q.cameraToCenterDistance:1,u_device_pixel_ratio:s.browser.devicePixelRatio,u_is_halo:+j})},Zn=function(n,a,o,u,d,_,x,T,z,L){return s.extend(ao(n,a,o,u,d,_,x,T,!0,z,!0),{u_texsize_icon:L,u_texture_icon:1})},To=function(n,a,o){return{u_matrix:n,u_opacity:a,u_color:o}},cs=function(n,a,o,u,d,_){return s.extend(function(x,T,z,L){var j=z.imageManager.getPattern(x.from.toString()),q=z.imageManager.getPattern(x.to.toString()),Z=z.imageManager.getPixelSize(),J=Z.width,Q=Z.height,oe=Math.pow(2,L.tileID.overscaledZ),Y=L.tileSize*Math.pow(2,z.transform.tileZoom)/oe,ae=Y*(L.tileID.canonical.x+L.tileID.wrap*oe),he=Y*L.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:q.tl,u_pattern_br_b:q.br,u_texsize:[J,Q],u_mix:T.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:q.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/wr(L,1,z.transform.tileZoom),u_pixel_coord_upper:[ae>>16,he>>16],u_pixel_coord_lower:[65535&ae,65535&he]}}(u,_,o,d),{u_matrix:n,u_opacity:a})},hs={fillExtrusion:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_lightpos:new s.Uniform3f(n,a.u_lightpos),u_lightintensity:new s.Uniform1f(n,a.u_lightintensity),u_lightcolor:new s.Uniform3f(n,a.u_lightcolor),u_vertical_gradient:new s.Uniform1f(n,a.u_vertical_gradient),u_opacity:new s.Uniform1f(n,a.u_opacity)}},fillExtrusionPattern:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_lightpos:new s.Uniform3f(n,a.u_lightpos),u_lightintensity:new s.Uniform1f(n,a.u_lightintensity),u_lightcolor:new s.Uniform3f(n,a.u_lightcolor),u_vertical_gradient:new s.Uniform1f(n,a.u_vertical_gradient),u_height_factor:new s.Uniform1f(n,a.u_height_factor),u_image:new s.Uniform1i(n,a.u_image),u_texsize:new s.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new s.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new s.Uniform3f(n,a.u_scale),u_fade:new s.Uniform1f(n,a.u_fade),u_opacity:new s.Uniform1f(n,a.u_opacity)}},fill:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix)}},fillPattern:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_image:new s.Uniform1i(n,a.u_image),u_texsize:new s.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new s.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new s.Uniform3f(n,a.u_scale),u_fade:new s.Uniform1f(n,a.u_fade)}},fillOutline:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_world:new s.Uniform2f(n,a.u_world)}},fillOutlinePattern:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_world:new s.Uniform2f(n,a.u_world),u_image:new s.Uniform1i(n,a.u_image),u_texsize:new s.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new s.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new s.Uniform3f(n,a.u_scale),u_fade:new s.Uniform1f(n,a.u_fade)}},circle:function(n,a){return{u_camera_to_center_distance:new s.Uniform1f(n,a.u_camera_to_center_distance),u_scale_with_map:new s.Uniform1i(n,a.u_scale_with_map),u_pitch_with_map:new s.Uniform1i(n,a.u_pitch_with_map),u_extrude_scale:new s.Uniform2f(n,a.u_extrude_scale),u_device_pixel_ratio:new s.Uniform1f(n,a.u_device_pixel_ratio),u_matrix:new s.UniformMatrix4f(n,a.u_matrix)}},collisionBox:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_camera_to_center_distance:new s.Uniform1f(n,a.u_camera_to_center_distance),u_pixels_to_tile_units:new s.Uniform1f(n,a.u_pixels_to_tile_units),u_extrude_scale:new s.Uniform2f(n,a.u_extrude_scale),u_overscale_factor:new s.Uniform1f(n,a.u_overscale_factor)}},collisionCircle:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_inv_matrix:new s.UniformMatrix4f(n,a.u_inv_matrix),u_camera_to_center_distance:new s.Uniform1f(n,a.u_camera_to_center_distance),u_viewport_size:new s.Uniform2f(n,a.u_viewport_size)}},debug:function(n,a){return{u_color:new s.UniformColor(n,a.u_color),u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_overlay:new s.Uniform1i(n,a.u_overlay),u_overlay_scale:new s.Uniform1f(n,a.u_overlay_scale)}},clippingMask:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix)}},heatmap:function(n,a){return{u_extrude_scale:new s.Uniform1f(n,a.u_extrude_scale),u_intensity:new s.Uniform1f(n,a.u_intensity),u_matrix:new s.UniformMatrix4f(n,a.u_matrix)}},heatmapTexture:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_world:new s.Uniform2f(n,a.u_world),u_image:new s.Uniform1i(n,a.u_image),u_color_ramp:new s.Uniform1i(n,a.u_color_ramp),u_opacity:new s.Uniform1f(n,a.u_opacity)}},hillshade:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_image:new s.Uniform1i(n,a.u_image),u_latrange:new s.Uniform2f(n,a.u_latrange),u_light:new s.Uniform2f(n,a.u_light),u_shadow:new s.UniformColor(n,a.u_shadow),u_highlight:new s.UniformColor(n,a.u_highlight),u_accent:new s.UniformColor(n,a.u_accent)}},hillshadePrepare:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_image:new s.Uniform1i(n,a.u_image),u_dimension:new s.Uniform2f(n,a.u_dimension),u_zoom:new s.Uniform1f(n,a.u_zoom),u_unpack:new s.Uniform4f(n,a.u_unpack)}},line:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_ratio:new s.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new s.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(n,a.u_units_to_pixels)}},lineGradient:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_ratio:new s.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new s.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(n,a.u_units_to_pixels),u_image:new s.Uniform1i(n,a.u_image),u_image_height:new s.Uniform1f(n,a.u_image_height)}},linePattern:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_texsize:new s.Uniform2f(n,a.u_texsize),u_ratio:new s.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new s.Uniform1f(n,a.u_device_pixel_ratio),u_image:new s.Uniform1i(n,a.u_image),u_units_to_pixels:new s.Uniform2f(n,a.u_units_to_pixels),u_scale:new s.Uniform3f(n,a.u_scale),u_fade:new s.Uniform1f(n,a.u_fade)}},lineSDF:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_ratio:new s.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new s.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(n,a.u_units_to_pixels),u_patternscale_a:new s.Uniform2f(n,a.u_patternscale_a),u_patternscale_b:new s.Uniform2f(n,a.u_patternscale_b),u_sdfgamma:new s.Uniform1f(n,a.u_sdfgamma),u_image:new s.Uniform1i(n,a.u_image),u_tex_y_a:new s.Uniform1f(n,a.u_tex_y_a),u_tex_y_b:new s.Uniform1f(n,a.u_tex_y_b),u_mix:new s.Uniform1f(n,a.u_mix)}},raster:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_tl_parent:new s.Uniform2f(n,a.u_tl_parent),u_scale_parent:new s.Uniform1f(n,a.u_scale_parent),u_buffer_scale:new s.Uniform1f(n,a.u_buffer_scale),u_fade_t:new s.Uniform1f(n,a.u_fade_t),u_opacity:new s.Uniform1f(n,a.u_opacity),u_image0:new s.Uniform1i(n,a.u_image0),u_image1:new s.Uniform1i(n,a.u_image1),u_brightness_low:new s.Uniform1f(n,a.u_brightness_low),u_brightness_high:new s.Uniform1f(n,a.u_brightness_high),u_saturation_factor:new s.Uniform1f(n,a.u_saturation_factor),u_contrast_factor:new s.Uniform1f(n,a.u_contrast_factor),u_spin_weights:new s.Uniform3f(n,a.u_spin_weights)}},symbolIcon:function(n,a){return{u_is_size_zoom_constant:new s.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new s.Uniform1f(n,a.u_size_t),u_size:new s.Uniform1f(n,a.u_size),u_camera_to_center_distance:new s.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new s.Uniform1f(n,a.u_pitch),u_rotate_symbol:new s.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new s.Uniform1f(n,a.u_fade_change),u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new s.Uniform1i(n,a.u_is_text),u_pitch_with_map:new s.Uniform1i(n,a.u_pitch_with_map),u_texsize:new s.Uniform2f(n,a.u_texsize),u_texture:new s.Uniform1i(n,a.u_texture)}},symbolSDF:function(n,a){return{u_is_size_zoom_constant:new s.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new s.Uniform1f(n,a.u_size_t),u_size:new s.Uniform1f(n,a.u_size),u_camera_to_center_distance:new s.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new s.Uniform1f(n,a.u_pitch),u_rotate_symbol:new s.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new s.Uniform1f(n,a.u_fade_change),u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new s.Uniform1i(n,a.u_is_text),u_pitch_with_map:new s.Uniform1i(n,a.u_pitch_with_map),u_texsize:new s.Uniform2f(n,a.u_texsize),u_texture:new s.Uniform1i(n,a.u_texture),u_gamma_scale:new s.Uniform1f(n,a.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(n,a.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(n,a.u_is_halo)}},symbolTextAndIcon:function(n,a){return{u_is_size_zoom_constant:new s.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new s.Uniform1f(n,a.u_size_t),u_size:new s.Uniform1f(n,a.u_size),u_camera_to_center_distance:new s.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new s.Uniform1f(n,a.u_pitch),u_rotate_symbol:new s.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new s.Uniform1f(n,a.u_fade_change),u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new s.Uniform1i(n,a.u_is_text),u_pitch_with_map:new s.Uniform1i(n,a.u_pitch_with_map),u_texsize:new s.Uniform2f(n,a.u_texsize),u_texsize_icon:new s.Uniform2f(n,a.u_texsize_icon),u_texture:new s.Uniform1i(n,a.u_texture),u_texture_icon:new s.Uniform1i(n,a.u_texture_icon),u_gamma_scale:new s.Uniform1f(n,a.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(n,a.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(n,a.u_is_halo)}},background:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_opacity:new s.Uniform1f(n,a.u_opacity),u_color:new s.UniformColor(n,a.u_color)}},backgroundPattern:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_opacity:new s.Uniform1f(n,a.u_opacity),u_image:new s.Uniform1i(n,a.u_image),u_pattern_tl_a:new s.Uniform2f(n,a.u_pattern_tl_a),u_pattern_br_a:new s.Uniform2f(n,a.u_pattern_br_a),u_pattern_tl_b:new s.Uniform2f(n,a.u_pattern_tl_b),u_pattern_br_b:new s.Uniform2f(n,a.u_pattern_br_b),u_texsize:new s.Uniform2f(n,a.u_texsize),u_mix:new s.Uniform1f(n,a.u_mix),u_pattern_size_a:new s.Uniform2f(n,a.u_pattern_size_a),u_pattern_size_b:new s.Uniform2f(n,a.u_pattern_size_b),u_scale_a:new s.Uniform1f(n,a.u_scale_a),u_scale_b:new s.Uniform1f(n,a.u_scale_b),u_pixel_coord_upper:new s.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(n,a.u_pixel_coord_lower),u_tile_units_to_pixels:new s.Uniform1f(n,a.u_tile_units_to_pixels)}}};function Vs(n,a,o,u,d,_,x){for(var T=n.context,z=T.gl,L=n.useProgram("collisionBox"),j=[],q=0,Z=0,J=0;J<u.length;J++){var Q=u[J],oe=a.getTile(Q),Y=oe.getBucket(o);if(Y){var ae=Q.posMatrix;d[0]===0&&d[1]===0||(ae=n.translatePosMatrix(Q.posMatrix,oe,d,_));var he=x?Y.textCollisionBox:Y.iconCollisionBox,ye=Y.collisionCircleArray;if(ye.length>0){var Te=s.create(),ve=ae;s.mul(Te,Y.placementInvProjMatrix,n.transform.glCoordMatrix),s.mul(Te,Te,Y.placementViewportMatrix),j.push({circleArray:ye,circleOffset:Z,transform:ve,invTransform:Te}),Z=q+=ye.length/4}he&&L.draw(T,z.LINES,G.disabled,ee.disabled,n.colorModeForRenderPass(),ce.disabled,Ka(ae,n.transform,oe),o.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,null,n.transform.zoom,null,null,he.collisionVertexBuffer)}}if(x&&j.length){var Ae=n.useProgram("collisionCircle"),Re=new s.StructArrayLayout2f1f2i16;Re.resize(4*q),Re._trim();for(var Ue=0,Ve=0,at=j;Ve<at.length;Ve+=1)for(var yt=at[Ve],mt=0;mt<yt.circleArray.length/4;mt++){var _t=4*mt,ir=yt.circleArray[_t+0],ut=yt.circleArray[_t+1],zt=yt.circleArray[_t+2],Ot=yt.circleArray[_t+3];Re.emplace(Ue++,ir,ut,zt,Ot,0),Re.emplace(Ue++,ir,ut,zt,Ot,1),Re.emplace(Ue++,ir,ut,zt,Ot,2),Re.emplace(Ue++,ir,ut,zt,Ot,3)}(!na||na.length<2*q)&&(na=function(ui){var on=2*ui,ji=new s.StructArrayLayout3ui6;ji.resize(on),ji._trim();for(var Rr=0;Rr<on;Rr++){var ci=6*Rr;ji.uint16[ci+0]=4*Rr+0,ji.uint16[ci+1]=4*Rr+1,ji.uint16[ci+2]=4*Rr+2,ji.uint16[ci+3]=4*Rr+2,ji.uint16[ci+4]=4*Rr+3,ji.uint16[ci+5]=4*Rr+0}return ji}(q));for(var Et=T.createIndexBuffer(na,!0),St=T.createVertexBuffer(Re,s.collisionCircleLayout.members,!0),Dt=0,bt=j;Dt<bt.length;Dt+=1){var wt=bt[Dt],zi=ta(wt.transform,wt.invTransform,n.transform);Ae.draw(T,z.TRIANGLES,G.disabled,ee.disabled,n.colorModeForRenderPass(),ce.disabled,zi,o.id,St,Et,s.SegmentVector.simpleSegment(0,2*wt.circleOffset,wt.circleArray.length,wt.circleArray.length/2),null,n.transform.zoom,null,null,null)}St.destroy(),Et.destroy()}}var Io=s.identity(new Float32Array(16));function ps(n,a,o,u,d,_){var x=s.getAnchorAlignment(n),T=-(x.horizontalAlign-.5)*a,z=-(x.verticalAlign-.5)*o,L=s.evaluateVariableOffset(n,u);return new s.Point((T/d+L[0])*_,(z/d+L[1])*_)}function Ts(n,a,o,u,d,_,x,T,z,L,j){var q=n.text.placedSymbolArray,Z=n.text.dynamicLayoutVertexArray,J=n.icon.dynamicLayoutVertexArray,Q={};Z.clear();for(var oe=0;oe<q.length;oe++){var Y=q.get(oe),ae=Y.hidden||!Y.crossTileID||n.allowVerticalPlacement&&!Y.placedOrientation?null:u[Y.crossTileID];if(ae){var he=new s.Point(Y.anchorX,Y.anchorY),ye=Bt(he,o?T:x),Te=Zt(_.cameraToCenterDistance,ye.signedDistanceFromCamera),ve=d.evaluateSizeForFeature(n.textSizeData,L,Y)*Te/s.ONE_EM;o&&(ve*=n.tilePixelRatio/z);for(var Ae=ps(ae.anchor,ae.width,ae.height,ae.textOffset,ae.textBoxScale,ve),Re=o?Bt(he.add(Ae),x).point:ye.point.add(a?Ae.rotate(-_.angle):Ae),Ue=n.allowVerticalPlacement&&Y.placedOrientation===s.WritingMode.vertical?Math.PI/2:0,Ve=0;Ve<Y.numGlyphs;Ve++)s.addDynamicAttributes(Z,Re,Ue);j&&Y.associatedIconIndex>=0&&(Q[Y.associatedIconIndex]={shiftedAnchor:Re,angle:Ue})}else fi(Y.numGlyphs,Z)}if(j){J.clear();for(var at=n.icon.placedSymbolArray,yt=0;yt<at.length;yt++){var mt=at.get(yt);if(mt.hidden)fi(mt.numGlyphs,J);else{var _t=Q[yt];if(_t)for(var ir=0;ir<mt.numGlyphs;ir++)s.addDynamicAttributes(J,_t.shiftedAnchor,_t.angle);else fi(mt.numGlyphs,J)}}n.icon.dynamicLayoutVertexBuffer.updateData(J)}n.text.dynamicLayoutVertexBuffer.updateData(Z)}function Ll(n,a,o){return o.iconsInText&&a?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function Wa(n,a,o,u,d,_,x,T,z,L,j,q){for(var Z=n.context,J=Z.gl,Q=n.transform,oe=T==="map",Y=z==="map",ae=oe&&o.layout.get("symbol-placement")!=="point",he=oe&&!Y&&!ae,ye=o.layout.get("symbol-sort-key").constantOr(1)!==void 0,Te=!1,ve=n.depthModeForSublayer(0,G.ReadOnly),Ae=o.layout.get("text-variable-anchor"),Re=[],Ue=0,Ve=u;Ue<Ve.length;Ue+=1){var at=Ve[Ue],yt=a.getTile(at),mt=yt.getBucket(o);if(mt){var _t=d?mt.text:mt.icon;if(_t&&_t.segments.get().length){var ir=_t.programConfigurations.get(o.id),ut=d||mt.sdfIcons,zt=d?mt.textSizeData:mt.iconSizeData,Ot=Y||Q.pitch!==0,Et=n.useProgram(Ll(ut,d,mt),ir),St=s.evaluateSizeForZoom(zt,Q.zoom),Dt=void 0,bt=[0,0],wt=void 0,zi=void 0,ui=null,on=void 0;if(d)wt=yt.glyphAtlasTexture,zi=J.LINEAR,Dt=yt.glyphAtlasTexture.size,mt.iconsInText&&(bt=yt.imageAtlasTexture.size,ui=yt.imageAtlasTexture,on=Ot||n.options.rotating||n.options.zooming||zt.kind==="composite"||zt.kind==="camera"?J.LINEAR:J.NEAREST);else{var ji=o.layout.get("icon-size").constantOr(0)!==1||mt.iconsNeedLinear;wt=yt.imageAtlasTexture,zi=ut||n.options.rotating||n.options.zooming||ji||Ot?J.LINEAR:J.NEAREST,Dt=yt.imageAtlasTexture.size}var Rr=wr(yt,1,n.transform.zoom),ci=zr(at.posMatrix,Y,oe,n.transform,Rr),Cn=or(at.posMatrix,Y,oe,n.transform,Rr),Mn=Ae&&mt.hasTextData(),ts=o.layout.get("icon-text-fit")!=="none"&&Mn&&mt.hasIconData();ae&&tn(mt,at.posMatrix,n,d,ci,Cn,Y,L);var Dn=n.translatePosMatrix(at.posMatrix,yt,_,x),Zo=ae||d&&Ae||ts?Io:ci,yn=n.translatePosMatrix(Cn,yt,_,x,!0),Xs=ut&&o.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0,gs={program:Et,buffers:_t,uniformValues:ut?mt.iconsInText?Zn(zt.kind,St,he,Y,n,Dn,Zo,yn,Dt,bt):ao(zt.kind,St,he,Y,n,Dn,Zo,yn,d,Dt,!0):us(zt.kind,St,he,Y,n,Dn,Zo,yn,d,Dt),atlasTexture:wt,atlasTextureIcon:ui,atlasInterpolation:zi,atlasInterpolationIcon:on,isSDF:ut,hasHalo:Xs};if(ye&&mt.canOverlap){Te=!0;for(var _s=0,Ps=_t.segments.get();_s<Ps.length;_s+=1){var Ws=Ps[_s];Re.push({segments:new s.SegmentVector([Ws]),sortKey:Ws.sortKey,state:gs})}}else Re.push({segments:_t.segments,sortKey:0,state:gs})}}}Te&&Re.sort(function(Ra,Ms){return Ra.sortKey-Ms.sortKey});for(var fa=0,Cs=Re;fa<Cs.length;fa+=1){var Go=Cs[fa],ti=Go.state;if(Z.activeTexture.set(J.TEXTURE0),ti.atlasTexture.bind(ti.atlasInterpolation,J.CLAMP_TO_EDGE),ti.atlasTextureIcon&&(Z.activeTexture.set(J.TEXTURE1),ti.atlasTextureIcon&&ti.atlasTextureIcon.bind(ti.atlasInterpolationIcon,J.CLAMP_TO_EDGE)),ti.isSDF){var La=ti.uniformValues;ti.hasHalo&&(La.u_is_halo=1,Fo(ti.buffers,Go.segments,o,n,ti.program,ve,j,q,La)),La.u_is_halo=0}Fo(ti.buffers,Go.segments,o,n,ti.program,ve,j,q,ti.uniformValues)}}function Fo(n,a,o,u,d,_,x,T,z){var L=u.context;d.draw(L,L.gl.TRIANGLES,_,x,T,ce.disabled,z,o.id,n.layoutVertexBuffer,n.indexBuffer,a,o.paint,u.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function Ns(n,a,o,u,d,_,x){var T,z,L,j,q,Z=n.context.gl,J=o.paint.get("fill-pattern"),Q=J&&J.constantOr(1),oe=o.getCrossfadeParameters();x?(z=Q&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",T=Z.LINES):(z=Q?"fillPattern":"fill",T=Z.TRIANGLES);for(var Y=0,ae=u;Y<ae.length;Y+=1){var he=ae[Y],ye=a.getTile(he);if(!Q||ye.patternsLoaded()){var Te=ye.getBucket(o);if(Te){var ve=Te.programConfigurations.get(o.id),Ae=n.useProgram(z,ve);Q&&(n.context.activeTexture.set(Z.TEXTURE0),ye.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),ve.updatePaintBuffers(oe));var Re=J.constantOr(null);if(Re&&ye.imageAtlas){var Ue=ye.imageAtlas,Ve=Ue.patternPositions[Re.to.toString()],at=Ue.patternPositions[Re.from.toString()];Ve&&at&&ve.setConstantPatternPositions(Ve,at)}var yt=n.translatePosMatrix(he.posMatrix,ye,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(x){j=Te.indexBuffer2,q=Te.segments2;var mt=[Z.drawingBufferWidth,Z.drawingBufferHeight];L=z==="fillOutlinePattern"&&Q?Cl(yt,n,oe,ye,mt):Pl(yt,mt)}else j=Te.indexBuffer,q=Te.segments,L=Q?Oo(yt,n,oe,ye):oo(yt);Ae.draw(n.context,T,d,n.stencilModeForClipping(he),_,ce.disabled,L,o.id,Te.layoutVertexBuffer,j,q,o.paint,n.transform.zoom,ve)}}}}function Ha(n,a,o,u,d,_,x){for(var T=n.context,z=T.gl,L=o.paint.get("fill-extrusion-pattern"),j=L.constantOr(1),q=o.getCrossfadeParameters(),Z=o.paint.get("fill-extrusion-opacity"),J=0,Q=u;J<Q.length;J+=1){var oe=Q[J],Y=a.getTile(oe),ae=Y.getBucket(o);if(ae){var he=ae.programConfigurations.get(o.id),ye=n.useProgram(j?"fillExtrusionPattern":"fillExtrusion",he);j&&(n.context.activeTexture.set(z.TEXTURE0),Y.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),he.updatePaintBuffers(q));var Te=L.constantOr(null);if(Te&&Y.imageAtlas){var ve=Y.imageAtlas,Ae=ve.patternPositions[Te.to.toString()],Re=ve.patternPositions[Te.from.toString()];Ae&&Re&&he.setConstantPatternPositions(Ae,Re)}var Ue=n.translatePosMatrix(oe.posMatrix,Y,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Ve=o.paint.get("fill-extrusion-vertical-gradient"),at=j?Ga(Ue,n,Ve,Z,oe,q,Y):_u(Ue,n,Ve,Z);ye.draw(T,T.gl.TRIANGLES,d,_,x,ce.backCCW,at,o.id,ae.layoutVertexBuffer,ae.indexBuffer,ae.segments,o.paint,n.transform.zoom,he)}}}function Ta(n,a,o,u,d,_){var x=n.context,T=x.gl,z=a.fbo;if(z){var L=n.useProgram("hillshade");x.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,z.colorAttachment.get());var j=function(q,Z,J){var Q=J.paint.get("hillshade-shadow-color"),oe=J.paint.get("hillshade-highlight-color"),Y=J.paint.get("hillshade-accent-color"),ae=J.paint.get("hillshade-illumination-direction")*(Math.PI/180);J.paint.get("hillshade-illumination-anchor")==="viewport"&&(ae-=q.transform.angle);var he,ye,Te,ve=!q.options.moving;return{u_matrix:q.transform.calculatePosMatrix(Z.tileID.toUnwrapped(),ve),u_image:0,u_latrange:(he=Z.tileID,ye=Math.pow(2,he.canonical.z),Te=he.canonical.y,[new s.MercatorCoordinate(0,Te/ye).toLngLat().lat,new s.MercatorCoordinate(0,(Te+1)/ye).toLngLat().lat]),u_light:[J.paint.get("hillshade-exaggeration"),ae],u_shadow:Q,u_highlight:oe,u_accent:Y}}(n,a,o);L.draw(x,T.TRIANGLES,u,d,_,ce.disabled,j,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function eu(n,a,o,u,d,_){var x=n.context,T=x.gl,z=a.dem;if(z&&z.data){var L=z.dim,j=z.stride,q=z.getPixels();if(x.activeTexture.set(T.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||n.getTileTexture(j),a.demTexture){var Z=a.demTexture;Z.update(q,{premultiply:!1}),Z.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else a.demTexture=new s.Texture(x,q,T.RGBA,{premultiply:!1}),a.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);x.activeTexture.set(T.TEXTURE0);var J=a.fbo;if(!J){var Q=new s.Texture(x,{width:L,height:L,data:null},T.RGBA);Q.bind(T.LINEAR,T.CLAMP_TO_EDGE),(J=a.fbo=x.createFramebuffer(L,L,!0)).colorAttachment.set(Q.texture)}x.bindFramebuffer.set(J.framebuffer),x.viewport.set([0,0,L,L]),n.useProgram("hillshadePrepare").draw(x,T.TRIANGLES,u,d,_,ce.disabled,function(oe,Y){var ae=Y.stride,he=s.create();return s.ortho(he,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(he,he,[0,-s.EXTENT,0]),{u_matrix:he,u_image:1,u_dimension:[ae,ae],u_zoom:oe.overscaledZ,u_unpack:Y.getUnpackVector()}}(a.tileID,z),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function Ia(n,a,o,u,d){var _=u.paint.get("raster-fade-duration");if(_>0){var x=s.browser.now(),T=(x-n.timeAdded)/_,z=a?(x-a.timeAdded)/_:-1,L=o.getSource(),j=d.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),q=!a||Math.abs(a.tileID.overscaledZ-j)>Math.abs(n.tileID.overscaledZ-j),Z=q&&n.refreshedUponExpiration?1:s.clamp(q?T:1-z,0,1);return n.refreshedUponExpiration&&T>=1&&(n.refreshedUponExpiration=!1),a?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}var Is=new s.Color(1,0,0,1),hl=new s.Color(0,1,0,1),Rl=new s.Color(0,0,1,1),Us=new s.Color(1,0,1,1),Vo=new s.Color(0,1,1,1);function so(n,a,o,u){ks(n,0,a+o/2,n.transform.width,o,u)}function oa(n,a,o,u){ks(n,a-o/2,0,o,n.transform.height,u)}function ks(n,a,o,u,d,_){var x=n.context,T=x.gl;T.enable(T.SCISSOR_TEST),T.scissor(a*s.browser.devicePixelRatio,o*s.browser.devicePixelRatio,u*s.browser.devicePixelRatio,d*s.browser.devicePixelRatio),x.clear({color:_}),T.disable(T.SCISSOR_TEST)}function fs(n,a,o){var u=n.context,d=u.gl,_=o.posMatrix,x=n.useProgram("debug"),T=G.disabled,z=ee.disabled,L=n.colorModeForRenderPass();u.activeTexture.set(d.TEXTURE0),n.emptyTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE),x.draw(u,d.LINE_STRIP,T,z,L,ce.disabled,rn(_,s.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var j=a.getTileByID(o.key).latestRawTileData,q=Math.floor((j&&j.byteLength||0)/1024),Z=a.getTile(o).tileSize,J=512/Math.min(Z,512)*(o.overscaledZ/n.transform.zoom)*.5,Q=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(Q+=" => "+o.overscaledZ),function(oe,Y){oe.initDebugOverlayCanvas();var ae=oe.debugOverlayCanvas,he=oe.context.gl,ye=oe.debugOverlayCanvas.getContext("2d");ye.clearRect(0,0,ae.width,ae.height),ye.shadowColor="white",ye.shadowBlur=2,ye.lineWidth=1.5,ye.strokeStyle="white",ye.textBaseline="top",ye.font="bold 36px Open Sans, sans-serif",ye.fillText(Y,5,5),ye.strokeText(Y,5,5),oe.debugOverlayTexture.update(ae),oe.debugOverlayTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE)}(n,Q+" "+q+"kb"),x.draw(u,d.TRIANGLES,T,z,le.alphaBlended,ce.disabled,rn(_,s.Color.transparent,J),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var zs={symbol:function(n,a,o,u,d){if(n.renderPass==="translucent"){var _=ee.disabled,x=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(T,z,L,j,q,Z,J){for(var Q=z.transform,oe=q==="map",Y=Z==="map",ae=0,he=T;ae<he.length;ae+=1){var ye=he[ae],Te=j.getTile(ye),ve=Te.getBucket(L);if(ve&&ve.text&&ve.text.segments.get().length){var Ae=s.evaluateSizeForZoom(ve.textSizeData,Q.zoom),Re=wr(Te,1,z.transform.zoom),Ue=zr(ye.posMatrix,Y,oe,z.transform,Re),Ve=L.layout.get("icon-text-fit")!=="none"&&ve.hasIconData();if(Ae){var at=Math.pow(2,Q.zoom-Te.tileID.overscaledZ);Ts(ve,oe,Y,J,s.symbolSize,Q,Ue,ye.posMatrix,at,Ae,Ve)}}}}(u,n,o,a,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),d),o.paint.get("icon-opacity").constantOr(1)!==0&&Wa(n,a,o,u,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),_,x),o.paint.get("text-opacity").constantOr(1)!==0&&Wa(n,a,o,u,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),_,x),a.map.showCollisionBoxes&&(Vs(n,a,o,u,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Vs(n,a,o,u,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,a,o,u){if(n.renderPass==="translucent"){var d=o.paint.get("circle-opacity"),_=o.paint.get("circle-stroke-width"),x=o.paint.get("circle-stroke-opacity"),T=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(d.constantOr(1)!==0||_.constantOr(1)!==0&&x.constantOr(1)!==0){for(var z=n.context,L=z.gl,j=n.depthModeForSublayer(0,G.ReadOnly),q=ee.disabled,Z=n.colorModeForRenderPass(),J=[],Q=0;Q<u.length;Q++){var oe=u[Q],Y=a.getTile(oe),ae=Y.getBucket(o);if(ae){var he=ae.programConfigurations.get(o.id),ye={programConfiguration:he,program:n.useProgram("circle",he),layoutVertexBuffer:ae.layoutVertexBuffer,indexBuffer:ae.indexBuffer,uniformValues:Ea(n,oe,Y,o)};if(T)for(var Te=0,ve=ae.segments.get();Te<ve.length;Te+=1){var Ae=ve[Te];J.push({segments:new s.SegmentVector([Ae]),sortKey:Ae.sortKey,state:ye})}else J.push({segments:ae.segments,sortKey:0,state:ye})}}T&&J.sort(function(yt,mt){return yt.sortKey-mt.sortKey});for(var Re=0,Ue=J;Re<Ue.length;Re+=1){var Ve=Ue[Re],at=Ve.state;at.program.draw(z,L.TRIANGLES,j,q,Z,ce.disabled,at.uniformValues,o.id,at.layoutVertexBuffer,at.indexBuffer,Ve.segments,o.paint,n.transform.zoom,at.programConfiguration)}}}},heatmap:function(n,a,o,u){if(o.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var d=n.context,_=d.gl,x=ee.disabled,T=new le([_.ONE,_.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(J,Q,oe){var Y=J.gl;J.activeTexture.set(Y.TEXTURE1),J.viewport.set([0,0,Q.width/4,Q.height/4]);var ae=oe.heatmapFbo;if(ae)Y.bindTexture(Y.TEXTURE_2D,ae.colorAttachment.get()),J.bindFramebuffer.set(ae.framebuffer);else{var he=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,he),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),ae=oe.heatmapFbo=J.createFramebuffer(Q.width/4,Q.height/4,!1),function(ye,Te,ve,Ae){var Re=ye.gl;Re.texImage2D(Re.TEXTURE_2D,0,Re.RGBA,Te.width/4,Te.height/4,0,Re.RGBA,ye.extRenderToTextureHalfFloat?ye.extTextureHalfFloat.HALF_FLOAT_OES:Re.UNSIGNED_BYTE,null),Ae.colorAttachment.set(ve)}(J,Q,he,ae)}})(d,n,o),d.clear({color:s.Color.transparent});for(var z=0;z<u.length;z++){var L=u[z];if(!a.hasRenderableParent(L)){var j=a.getTile(L),q=j.getBucket(o);if(q){var Z=q.programConfigurations.get(o.id);n.useProgram("heatmap",Z).draw(d,_.TRIANGLES,G.disabled,x,T,ce.disabled,Ml(L.posMatrix,j,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,q.layoutVertexBuffer,q.indexBuffer,q.segments,o.paint,n.transform.zoom,Z)}}}d.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(J,Q){var oe=J.context,Y=oe.gl,ae=Q.heatmapFbo;if(ae){oe.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,ae.colorAttachment.get()),oe.activeTexture.set(Y.TEXTURE1);var he=Q.colorRampTexture;he||(he=Q.colorRampTexture=new s.Texture(oe,Q.colorRamp,Y.RGBA)),he.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),J.useProgram("heatmapTexture").draw(oe,Y.TRIANGLES,G.disabled,ee.disabled,J.colorModeForRenderPass(),ce.disabled,function(ye,Te,ve,Ae){var Re=s.create();s.ortho(Re,0,ye.width,ye.height,0,0,1);var Ue=ye.context.gl;return{u_matrix:Re,u_world:[Ue.drawingBufferWidth,Ue.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Te.paint.get("heatmap-opacity")}}(J,Q),Q.id,J.viewportBuffer,J.quadTriangleIndexBuffer,J.viewportSegments,Q.paint,J.transform.zoom)}}(n,o))},line:function(n,a,o,u){if(n.renderPass==="translucent"){var d=o.paint.get("line-opacity"),_=o.paint.get("line-width");if(d.constantOr(1)!==0&&_.constantOr(1)!==0)for(var x=n.depthModeForSublayer(0,G.ReadOnly),T=n.colorModeForRenderPass(),z=o.paint.get("line-dasharray"),L=o.paint.get("line-pattern"),j=L.constantOr(1),q=o.paint.get("line-gradient"),Z=o.getCrossfadeParameters(),J=j?"linePattern":z?"lineSDF":q?"lineGradient":"line",Q=n.context,oe=Q.gl,Y=!0,ae=0,he=u;ae<he.length;ae+=1){var ye=he[ae],Te=a.getTile(ye);if(!j||Te.patternsLoaded()){var ve=Te.getBucket(o);if(ve){var Ae=ve.programConfigurations.get(o.id),Re=n.context.program.get(),Ue=n.useProgram(J,Ae),Ve=Y||Ue.program!==Re,at=L.constantOr(null);if(at&&Te.imageAtlas){var yt=Te.imageAtlas,mt=yt.patternPositions[at.to.toString()],_t=yt.patternPositions[at.from.toString()];mt&&_t&&Ae.setConstantPatternPositions(mt,_t)}var ir=j?Fs(n,Te,o,Z):z?Es(n,Te,o,z,Z):q?Vr(n,Te,o,ve.lineClipsArray.length):ra(n,Te,o);if(j)Q.activeTexture.set(oe.TEXTURE0),Te.imageAtlasTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE),Ae.updatePaintBuffers(Z);else if(z&&(Ve||n.lineAtlas.dirty))Q.activeTexture.set(oe.TEXTURE0),n.lineAtlas.bind(Q);else if(q){var ut=ve.gradients[o.id],zt=ut.texture;if(o.gradientVersion!==ut.version){var Ot=256;if(o.stepInterpolant){var Et=a.getSource().maxzoom,St=ye.canonical.z===Et?Math.ceil(1<<n.transform.maxZoom-ye.canonical.z):1;Ot=s.clamp(s.nextPowerOfTwo(ve.maxLineLength/s.EXTENT*1024*St),256,Q.maxTextureSize)}ut.gradient=s.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Ot,image:ut.gradient||void 0,clips:ve.lineClipsArray}),ut.texture?ut.texture.update(ut.gradient):ut.texture=new s.Texture(Q,ut.gradient,oe.RGBA),ut.version=o.gradientVersion,zt=ut.texture}Q.activeTexture.set(oe.TEXTURE0),zt.bind(o.stepInterpolant?oe.NEAREST:oe.LINEAR,oe.CLAMP_TO_EDGE)}Ue.draw(Q,oe.TRIANGLES,x,n.stencilModeForClipping(ye),T,ce.disabled,ir,o.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,o.paint,n.transform.zoom,Ae,ve.layoutVertexBuffer2),Y=!1}}}}},fill:function(n,a,o,u){var d=o.paint.get("fill-color"),_=o.paint.get("fill-opacity");if(_.constantOr(1)!==0){var x=n.colorModeForRenderPass(),T=o.paint.get("fill-pattern"),z=n.opaquePassEnabledForLayer()&&!T.constantOr(1)&&d.constantOr(s.Color.transparent).a===1&&_.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===z){var L=n.depthModeForSublayer(1,n.renderPass==="opaque"?G.ReadWrite:G.ReadOnly);Ns(n,a,o,u,L,x,!1)}if(n.renderPass==="translucent"&&o.paint.get("fill-antialias")){var j=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,G.ReadOnly);Ns(n,a,o,u,j,x,!0)}}},"fill-extrusion":function(n,a,o,u){var d=o.paint.get("fill-extrusion-opacity");if(d!==0&&n.renderPass==="translucent"){var _=new G(n.context.gl.LEQUAL,G.ReadWrite,n.depthRangeFor3D);if(d!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))Ha(n,a,o,u,_,ee.disabled,le.disabled),Ha(n,a,o,u,_,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var x=n.colorModeForRenderPass();Ha(n,a,o,u,_,ee.disabled,x)}}},hillshade:function(n,a,o,u){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var d=n.context,_=n.depthModeForSublayer(0,G.ReadOnly),x=n.colorModeForRenderPass(),T=n.renderPass==="translucent"?n.stencilConfigForOverlap(u):[{},u],z=T[0],L=0,j=T[1];L<j.length;L+=1){var q=j[L],Z=a.getTile(q);Z.needsHillshadePrepare&&n.renderPass==="offscreen"?eu(n,Z,o,_,ee.disabled,x):n.renderPass==="translucent"&&Ta(n,Z,o,_,z[q.overscaledZ],x)}d.viewport.set([0,0,n.width,n.height])}},raster:function(n,a,o,u){if(n.renderPass==="translucent"&&o.paint.get("raster-opacity")!==0&&u.length)for(var d=n.context,_=d.gl,x=a.getSource(),T=n.useProgram("raster"),z=n.colorModeForRenderPass(),L=x instanceof lr?[{},u]:n.stencilConfigForOverlap(u),j=L[0],q=L[1],Z=q[q.length-1].overscaledZ,J=!n.options.moving,Q=0,oe=q;Q<oe.length;Q+=1){var Y=oe[Q],ae=n.depthModeForSublayer(Y.overscaledZ-Z,o.paint.get("raster-opacity")===1?G.ReadWrite:G.ReadOnly,_.LESS),he=a.getTile(Y),ye=n.transform.calculatePosMatrix(Y.toUnwrapped(),J);he.registerFadeDuration(o.paint.get("raster-fade-duration"));var Te=a.findLoadedParent(Y,0),ve=Ia(he,Te,a,o,n.transform),Ae=void 0,Re=void 0,Ue=o.paint.get("raster-resampling")==="nearest"?_.NEAREST:_.LINEAR;d.activeTexture.set(_.TEXTURE0),he.texture.bind(Ue,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST),d.activeTexture.set(_.TEXTURE1),Te?(Te.texture.bind(Ue,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST),Ae=Math.pow(2,Te.tileID.overscaledZ-he.tileID.overscaledZ),Re=[he.tileID.canonical.x*Ae%1,he.tileID.canonical.y*Ae%1]):he.texture.bind(Ue,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST);var Ve=$l(ye,Re||[0,0],Ae||1,ve,o);x instanceof lr?T.draw(d,_.TRIANGLES,ae,ee.disabled,z,ce.disabled,Ve,o.id,x.boundsBuffer,n.quadTriangleIndexBuffer,x.boundsSegments):T.draw(d,_.TRIANGLES,ae,j[Y.overscaledZ],z,ce.disabled,Ve,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,a,o){var u=o.paint.get("background-color"),d=o.paint.get("background-opacity");if(d!==0){var _=n.context,x=_.gl,T=n.transform,z=T.tileSize,L=o.paint.get("background-pattern");if(!n.isPatternMissing(L)){var j=!L&&u.a===1&&d===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===j){var q=ee.disabled,Z=n.depthModeForSublayer(0,j==="opaque"?G.ReadWrite:G.ReadOnly),J=n.colorModeForRenderPass(),Q=n.useProgram(L?"backgroundPattern":"background"),oe=T.coveringTiles({tileSize:z});L&&(_.activeTexture.set(x.TEXTURE0),n.imageManager.bind(n.context));for(var Y=o.getCrossfadeParameters(),ae=0,he=oe;ae<he.length;ae+=1){var ye=he[ae],Te=n.transform.calculatePosMatrix(ye.toUnwrapped()),ve=L?cs(Te,d,n,L,{tileID:ye,tileSize:z},Y):To(Te,d,u);Q.draw(_,x.TRIANGLES,Z,q,J,ce.disabled,ve,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,a,o){for(var u=0;u<o.length;u++)fs(n,a,o[u])},custom:function(n,a,o){var u=n.context,d=o.implementation;if(n.renderPass==="offscreen"){var _=d.prerender;_&&(n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),_.call(d,u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),u.setStencilMode(ee.disabled);var x=d.renderingMode==="3d"?new G(n.context.gl.LEQUAL,G.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,G.ReadOnly);u.setDepthMode(x),d.render(u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState(),u.bindFramebuffer.set(null)}}},Nr=function(n,a){this.context=new F(n),this.transform=a,this._tileTextures={},this.setup(),this.numSublayers=re.maxUnderzooming+re.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new pe,this.gpuTimers={}};Nr.prototype.resize=function(n,a){if(this.width=n*s.browser.devicePixelRatio,this.height=a*s.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,u=this.style._order;o<u.length;o+=1)this.style._layers[u[o]].resize()},Nr.prototype.setup=function(){var n=this.context,a=new s.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(s.EXTENT,0),a.emplaceBack(0,s.EXTENT),a.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(a,qr.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);var o=new s.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(s.EXTENT,0),o.emplaceBack(0,s.EXTENT),o.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=n.createVertexBuffer(o,qr.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);var u=new s.StructArrayLayout4i8;u.emplaceBack(0,0,0,0),u.emplaceBack(s.EXTENT,0,s.EXTENT,0),u.emplaceBack(0,s.EXTENT,0,s.EXTENT),u.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(u,Ze.members),this.rasterBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);var d=new s.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(d,qr.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);var _=new s.StructArrayLayout1ui2;_.emplaceBack(0),_.emplaceBack(1),_.emplaceBack(3),_.emplaceBack(2),_.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(_);var x=new s.StructArrayLayout3ui6;x.emplaceBack(0,1,2),x.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(x),this.emptyTexture=new s.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var T=this.context.gl;this.stencilClearMode=new ee({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO)},Nr.prototype.clearStencil=function(){var n=this.context,a=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=s.create();s.ortho(o,0,this.width,this.height,0,0,1),s.scale(o,o,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,a.TRIANGLES,G.disabled,this.stencilClearMode,le.disabled,ce.disabled,qn(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Nr.prototype._renderTileClippingMasks=function(n,a){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&a&&a.length){this.currentStencilSource=n.source;var o=this.context,u=o.gl;this.nextStencilID+a.length>256&&this.clearStencil(),o.setColorMode(le.disabled),o.setDepthMode(G.disabled);var d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var _=0,x=a;_<x.length;_+=1){var T=x[_],z=this._tileClippingMaskIDs[T.key]=this.nextStencilID++;d.draw(o,u.TRIANGLES,G.disabled,new ee({func:u.ALWAYS,mask:0},z,255,u.KEEP,u.KEEP,u.REPLACE),le.disabled,ce.disabled,qn(T.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Nr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,a=this.context.gl;return new ee({func:a.NOTEQUAL,mask:255},n,255,a.KEEP,a.KEEP,a.REPLACE)},Nr.prototype.stencilModeForClipping=function(n){var a=this.context.gl;return new ee({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,a.KEEP,a.KEEP,a.REPLACE)},Nr.prototype.stencilConfigForOverlap=function(n){var a,o=this.context.gl,u=n.sort(function(z,L){return L.overscaledZ-z.overscaledZ}),d=u[u.length-1].overscaledZ,_=u[0].overscaledZ-d+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();for(var x={},T=0;T<_;T++)x[T+d]=new ee({func:o.GEQUAL,mask:255},T+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=_,[x,u]}return[(a={},a[d]=ee.disabled,a),u]},Nr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new le([n.CONSTANT_COLOR,n.ONE],new s.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?le.unblended:le.alphaBlended},Nr.prototype.depthModeForSublayer=function(n,a,o){if(!this.opaquePassEnabledForLayer())return G.disabled;var u=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new G(o||this.context.gl.LEQUAL,a,[u,u])},Nr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Nr.prototype.render=function(n,a){var o=this;this.style=n,this.options=a,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(s.browser.now()),this.imageManager.beginFrame();var u=this.style._order,d=this.style.sourceCaches;for(var _ in d){var x=d[_];x.used&&x.prepare(this.context)}var T,z,L={},j={},q={};for(var Z in d){var J=d[Z];L[Z]=J.getVisibleCoordinates(),j[Z]=L[Z].slice().reverse(),q[Z]=J.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Q=0;Q<u.length;Q++)if(this.style._layers[u[Q]].is3D()){this.opaquePassCutoff=Q;break}this.renderPass="offscreen";for(var oe=0,Y=u;oe<Y.length;oe+=1){var ae=this.style._layers[Y[oe]];if(ae.hasOffscreenPass()&&!ae.isHidden(this.transform.zoom)){var he=j[ae.source];(ae.type==="custom"||he.length)&&this.renderLayer(this,d[ae.source],ae,he)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){var ye=this.style._layers[u[this.currentLayer]],Te=d[ye.source],ve=L[ye.source];this._renderTileClippingMasks(ye,ve),this.renderLayer(this,Te,ye,ve)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){var Ae=this.style._layers[u[this.currentLayer]],Re=d[Ae.source],Ue=(Ae.type==="symbol"?q:j)[Ae.source];this._renderTileClippingMasks(Ae,L[Ae.source]),this.renderLayer(this,Re,Ae,Ue)}this.options.showTileBoundaries&&(s.values(this.style._layers).forEach(function(Ve){Ve.source&&!Ve.isHidden(o.transform.zoom)&&(Ve.source!==(z&&z.id)&&(z=o.style.sourceCaches[Ve.source]),(!T||T.getSource().maxzoom<z.getSource().maxzoom)&&(T=z))}),T&&zs.debug(this,T,T.getVisibleCoordinates())),this.options.showPadding&&function(Ve){var at=Ve.transform.padding;so(Ve,Ve.transform.height-(at.top||0),3,Is),so(Ve,at.bottom||0,3,hl),oa(Ve,at.left||0,3,Rl),oa(Ve,Ve.transform.width-(at.right||0),3,Us);var yt=Ve.transform.centerPoint;(function(mt,_t,ir,ut){ks(mt,_t-1,ir-10,2,20,ut),ks(mt,_t-10,ir-1,20,2,ut)})(Ve,yt.x,Ve.transform.height-yt.y,Vo)}(this),this.context.setDefault()},Nr.prototype.renderLayer=function(n,a,o,u){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="custom"||u.length)&&(this.id=o.id,this.gpuTimingStart(o),zs[o.type](n,a,o,u,this.style.placement.variableOffsets),this.gpuTimingEnd())},Nr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var a=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),o.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,o.query)}},Nr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Nr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Nr.prototype.queryGpuTimers=function(n){var a={};for(var o in n){var u=n[o],d=this.context.extTimerQuery,_=d.getQueryObjectEXT(u.query,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(u.query),a[o]=_}return a},Nr.prototype.translatePosMatrix=function(n,a,o,u,d){if(!o[0]&&!o[1])return n;var _=d?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(_){var x=Math.sin(_),T=Math.cos(_);o=[o[0]*T-o[1]*x,o[0]*x+o[1]*T]}var z=[d?o[0]:wr(a,o[0],this.transform.zoom),d?o[1]:wr(a,o[1],this.transform.zoom),0],L=new Float32Array(16);return s.translate(L,n,z),L},Nr.prototype.saveTileTexture=function(n){var a=this._tileTextures[n.size[0]];a?a.push(n):this._tileTextures[n.size[0]]=[n]},Nr.prototype.getTileTexture=function(n){var a=this._tileTextures[n];return a&&a.length>0?a.pop():null},Nr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var a=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!a||!o},Nr.prototype.useProgram=function(n,a){this.cache=this.cache||{};var o=""+n+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new Al(this.context,n,wa[n],a,hs[n],this._showOverdrawInspector)),this.cache[o]},Nr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Nr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Nr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Nr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var ka=function(n,a){this.points=n,this.planes=a};ka.fromInvProjectionMatrix=function(n,a,o){var u=Math.pow(2,o),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(x){return s.transformMat4([],x,n)}).map(function(x){return s.scale$1([],x,1/x[3]/a*u)}),_=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(x){var T=s.sub([],d[x[0]],d[x[1]]),z=s.sub([],d[x[2]],d[x[1]]),L=s.normalize([],s.cross([],T,z)),j=-s.dot(L,d[x[1]]);return L.concat(j)});return new ka(d,_)};var No=function(n,a){this.min=n,this.max=a,this.center=s.scale$2([],s.add([],this.min,this.max),.5)};No.prototype.quadrant=function(n){for(var a=[n%2==0,n<2],o=s.clone$2(this.min),u=s.clone$2(this.max),d=0;d<a.length;d++)o[d]=a[d]?this.min[d]:this.center[d],u[d]=a[d]?this.center[d]:this.max[d];return u[2]=this.max[2],new No(o,u)},No.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},No.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},No.prototype.intersects=function(n){for(var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,u=0;u<n.planes.length;u++){for(var d=n.planes[u],_=0,x=0;x<a.length;x++)_+=s.dot$1(d,a[x])>=0;if(_===0)return 0;_!==a.length&&(o=!1)}if(o)return 2;for(var T=0;T<3;T++){for(var z=Number.MAX_VALUE,L=-Number.MAX_VALUE,j=0;j<n.points.length;j++){var q=n.points[j][T]-this.min[T];z=Math.min(z,q),L=Math.max(L,q)}if(L<0||z>this.max[T]-this.min[T])return 0}return 1};var za=function(n,a,o,u){if(n===void 0&&(n=0),a===void 0&&(a=0),o===void 0&&(o=0),u===void 0&&(u=0),isNaN(n)||n<0||isNaN(a)||a<0||isNaN(o)||o<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=a,this.left=o,this.right=u};za.prototype.interpolate=function(n,a,o){return a.top!=null&&n.top!=null&&(this.top=s.number(n.top,a.top,o)),a.bottom!=null&&n.bottom!=null&&(this.bottom=s.number(n.bottom,a.bottom,o)),a.left!=null&&n.left!=null&&(this.left=s.number(n.left,a.left,o)),a.right!=null&&n.right!=null&&(this.right=s.number(n.right,a.right,o)),this},za.prototype.getCenter=function(n,a){var o=s.clamp((this.left+n-this.right)/2,0,n),u=s.clamp((this.top+a-this.bottom)/2,0,a);return new s.Point(o,u)},za.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},za.prototype.clone=function(){return new za(this.top,this.bottom,this.left,this.right)},za.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Qt=function(n,a,o,u,d){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=d===void 0||d,this._minZoom=n||0,this._maxZoom=a||22,this._minPitch=o==null?0:o,this._maxPitch=u==null?60:u,this.setMaxBounds(),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new za,this._posMatrixCache={},this._alignedPosMatrixCache={}},dr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Qt.prototype.clone=function(){var n=new Qt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},dr.minZoom.get=function(){return this._minZoom},dr.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},dr.maxZoom.get=function(){return this._maxZoom},dr.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},dr.minPitch.get=function(){return this._minPitch},dr.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},dr.maxPitch.get=function(){return this._maxPitch},dr.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},dr.renderWorldCopies.get=function(){return this._renderWorldCopies},dr.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},dr.worldSize.get=function(){return this.tileSize*this.scale},dr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},dr.size.get=function(){return new s.Point(this.width,this.height)},dr.bearing.get=function(){return-this.angle/Math.PI*180},dr.bearing.set=function(n){var a=-s.wrap(n,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=s.create$2(),s.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},dr.pitch.get=function(){return this._pitch/Math.PI*180},dr.pitch.set=function(n){var a=s.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())},dr.fov.get=function(){return this._fov/Math.PI*180},dr.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},dr.zoom.get=function(){return this._zoom},dr.zoom.set=function(n){var a=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},dr.center.get=function(){return this._center},dr.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},dr.padding.get=function(){return this._edgeInsets.toJSON()},dr.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},dr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Qt.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},Qt.prototype.interpolatePadding=function(n,a,o){this._unmodified=!1,this._edgeInsets.interpolate(n,a,o),this._constrain(),this._calcMatrices()},Qt.prototype.coveringZoomLevel=function(n){var a=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,a)},Qt.prototype.getVisibleUnwrappedCoordinates=function(n){var a=[new s.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new s.Point(0,0)),u=this.pointCoordinate(new s.Point(this.width,0)),d=this.pointCoordinate(new s.Point(this.width,this.height)),_=this.pointCoordinate(new s.Point(0,this.height)),x=Math.floor(Math.min(o.x,u.x,d.x,_.x)),T=Math.floor(Math.max(o.x,u.x,d.x,_.x)),z=x-1;z<=T+1;z++)z!==0&&a.push(new s.UnwrappedTileID(z,n));return a},Qt.prototype.coveringTiles=function(n){var a=this.coveringZoomLevel(n),o=a;if(n.minzoom!==void 0&&a<n.minzoom)return[];n.maxzoom!==void 0&&a>n.maxzoom&&(a=n.maxzoom);var u=s.MercatorCoordinate.fromLngLat(this.center),d=Math.pow(2,a),_=[d*u.x,d*u.y,0],x=ka.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),T=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(T=a);var z=function(Ve){return{aabb:new No([Ve*d,0,0],[(Ve+1)*d,d,0]),zoom:0,x:0,y:0,wrap:Ve,fullyVisible:!1}},L=[],j=[],q=a,Z=n.reparseOverscaled?o:a;if(this._renderWorldCopies)for(var J=1;J<=3;J++)L.push(z(-J)),L.push(z(J));for(L.push(z(0));L.length>0;){var Q=L.pop(),oe=Q.x,Y=Q.y,ae=Q.fullyVisible;if(!ae){var he=Q.aabb.intersects(x);if(he===0)continue;ae=he===2}var ye=Q.aabb.distanceX(_),Te=Q.aabb.distanceY(_),ve=Math.max(Math.abs(ye),Math.abs(Te));if(Q.zoom===q||ve>3+(1<<q-Q.zoom)-2&&Q.zoom>=T)j.push({tileID:new s.OverscaledTileID(Q.zoom===q?Z:Q.zoom,Q.wrap,Q.zoom,oe,Y),distanceSq:s.sqrLen([_[0]-.5-oe,_[1]-.5-Y])});else for(var Ae=0;Ae<4;Ae++){var Re=(oe<<1)+Ae%2,Ue=(Y<<1)+(Ae>>1);L.push({aabb:Q.aabb.quadrant(Ae),zoom:Q.zoom+1,x:Re,y:Ue,wrap:Q.wrap,fullyVisible:ae})}}return j.sort(function(Ve,at){return Ve.distanceSq-at.distanceSq}).map(function(Ve){return Ve.tileID})},Qt.prototype.resize=function(n,a){this.width=n,this.height=a,this.pixelsToGLUnits=[2/n,-2/a],this._constrain(),this._calcMatrices()},dr.unmodified.get=function(){return this._unmodified},Qt.prototype.zoomScale=function(n){return Math.pow(2,n)},Qt.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},Qt.prototype.project=function(n){var a=s.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new s.Point(s.mercatorXfromLng(n.lng)*this.worldSize,s.mercatorYfromLat(a)*this.worldSize)},Qt.prototype.unproject=function(n){return new s.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},dr.point.get=function(){return this.project(this.center)},Qt.prototype.setLocationAtPoint=function(n,a){var o=this.pointCoordinate(a),u=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(n),_=new s.MercatorCoordinate(d.x-(o.x-u.x),d.y-(o.y-u.y));this.center=this.coordinateLocation(_),this._renderWorldCopies&&(this.center=this.center.wrap())},Qt.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},Qt.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},Qt.prototype.locationCoordinate=function(n){return s.MercatorCoordinate.fromLngLat(n)},Qt.prototype.coordinateLocation=function(n){return n.toLngLat()},Qt.prototype.pointCoordinate=function(n){var a=[n.x,n.y,0,1],o=[n.x,n.y,1,1];s.transformMat4(a,a,this.pixelMatrixInverse),s.transformMat4(o,o,this.pixelMatrixInverse);var u=a[3],d=o[3],_=a[1]/u,x=o[1]/d,T=a[2]/u,z=o[2]/d,L=T===z?0:(0-T)/(z-T);return new s.MercatorCoordinate(s.number(a[0]/u,o[0]/d,L)/this.worldSize,s.number(_,x,L)/this.worldSize)},Qt.prototype.coordinatePoint=function(n){var a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return s.transformMat4(a,a,this.pixelMatrix),new s.Point(a[0]/a[3],a[1]/a[3])},Qt.prototype.getBounds=function(){return new s.LngLatBounds().extend(this.pointLocation(new s.Point(0,0))).extend(this.pointLocation(new s.Point(this.width,0))).extend(this.pointLocation(new s.Point(this.width,this.height))).extend(this.pointLocation(new s.Point(0,this.height)))},Qt.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new s.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Qt.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Qt.prototype.calculatePosMatrix=function(n,a){a===void 0&&(a=!1);var o=n.key,u=a?this._alignedPosMatrixCache:this._posMatrixCache;if(u[o])return u[o];var d=n.canonical,_=this.worldSize/this.zoomScale(d.z),x=d.x+Math.pow(2,d.z)*n.wrap,T=s.identity(new Float64Array(16));return s.translate(T,T,[x*_,d.y*_,0]),s.scale(T,T,[_/s.EXTENT,_/s.EXTENT,1]),s.multiply(T,a?this.alignedProjMatrix:this.projMatrix,T),u[o]=new Float32Array(T),u[o]},Qt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Qt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,a,o,u,d=-90,_=90,x=-180,T=180,z=this.size,L=this._unmodified;if(this.latRange){var j=this.latRange;d=s.mercatorYfromLat(j[1])*this.worldSize,n=(_=s.mercatorYfromLat(j[0])*this.worldSize)-d<z.y?z.y/(_-d):0}if(this.lngRange){var q=this.lngRange;x=s.mercatorXfromLng(q[0])*this.worldSize,a=(T=s.mercatorXfromLng(q[1])*this.worldSize)-x<z.x?z.x/(T-x):0}var Z=this.point,J=Math.max(a||0,n||0);if(J)return this.center=this.unproject(new s.Point(a?(T+x)/2:Z.x,n?(_+d)/2:Z.y)),this.zoom+=this.scaleZoom(J),this._unmodified=L,void(this._constraining=!1);if(this.latRange){var Q=Z.y,oe=z.y/2;Q-oe<d&&(u=d+oe),Q+oe>_&&(u=_-oe)}if(this.lngRange){var Y=Z.x,ae=z.x/2;Y-ae<x&&(o=x+ae),Y+ae>T&&(o=T-ae)}o===void 0&&u===void 0||(this.center=this.unproject(new s.Point(o!==void 0?o:Z.x,u!==void 0?u:Z.y))),this._unmodified=L,this._constraining=!1}},Qt.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),u=Math.sin(o)*this.cameraToCenterDistance/Math.sin(s.clamp(Math.PI-a-o,.01,Math.PI-.01)),d=this.point,_=d.x,x=d.y,T=1.01*(Math.cos(Math.PI/2-this._pitch)*u+this.cameraToCenterDistance),z=this.height/50,L=new Float64Array(16);s.perspective(L,this._fov,this.width/this.height,z,T),L[8]=2*-n.x/this.width,L[9]=2*n.y/this.height,s.scale(L,L,[1,-1,1]),s.translate(L,L,[0,0,-this.cameraToCenterDistance]),s.rotateX(L,L,this._pitch),s.rotateZ(L,L,this.angle),s.translate(L,L,[-_,-x,0]),this.mercatorMatrix=s.scale([],L,[this.worldSize,this.worldSize,this.worldSize]),s.scale(L,L,[1,1,s.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=L,this.invProjMatrix=s.invert([],this.projMatrix);var j=this.width%2/2,q=this.height%2/2,Z=Math.cos(this.angle),J=Math.sin(this.angle),Q=_-Math.round(_)+Z*j+J*q,oe=x-Math.round(x)+Z*q+J*j,Y=new Float64Array(L);if(s.translate(Y,Y,[Q>.5?Q-1:Q,oe>.5?oe-1:oe,0]),this.alignedProjMatrix=Y,L=s.create(),s.scale(L,L,[this.width/2,-this.height/2,1]),s.translate(L,L,[1,-1,0]),this.labelPlaneMatrix=L,L=s.create(),s.scale(L,L,[1,-1,1]),s.translate(L,L,[-1,-1,0]),s.scale(L,L,[2/this.width,2/this.height,1]),this.glCoordMatrix=L,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(L=s.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=L,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Qt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new s.Point(0,0)),a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return s.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance},Qt.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,n))},Qt.prototype.getCameraQueryGeometry=function(n){var a=this.getCameraPoint();if(n.length===1)return[n[0],a];for(var o=a.x,u=a.y,d=a.x,_=a.y,x=0,T=n;x<T.length;x+=1){var z=T[x];o=Math.min(o,z.x),u=Math.min(u,z.y),d=Math.max(d,z.x),_=Math.max(_,z.y)}return[new s.Point(o,u),new s.Point(d,u),new s.Point(d,_),new s.Point(o,_),new s.Point(o,u)]},Object.defineProperties(Qt.prototype,dr);var Ui=function(n){var a,o,u,d;this._hashName=n&&encodeURIComponent(n),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(a=this._updateHashUnthrottled.bind(this),o=!1,u=null,d=function(){u=null,o&&(a(),u=setTimeout(d,300),o=!1)},function(){return o=!0,u||d(),u})};Ui.prototype.addTo=function(n){return this._map=n,s.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ui.prototype.remove=function(){return s.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ui.prototype.getHashString=function(n){var a=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,u=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,u),_=Math.round(a.lng*d)/d,x=Math.round(a.lat*d)/d,T=this._map.getBearing(),z=this._map.getPitch(),L="";if(L+=n?"/"+_+"/"+x+"/"+o:o+"/"+x+"/"+_,(T||z)&&(L+="/"+Math.round(10*T)/10),z&&(L+="/"+Math.round(z)),this._hashName){var j=this._hashName,q=!1,Z=s.window.location.hash.slice(1).split("&").map(function(J){var Q=J.split("=")[0];return Q===j?(q=!0,Q+"="+L):J}).filter(function(J){return J});return q||Z.push(j+"="+L),"#"+Z.join("&")}return"#"+L},Ui.prototype._getCurrentHash=function(){var n,a=this,o=s.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(u){return u.split("=")}).forEach(function(u){u[0]===a._hashName&&(n=u)}),(n&&n[1]||"").split("/")):o.split("/")},Ui.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:a,pitch:+(n[4]||0)}),!0}return!1},Ui.prototype._updateHashUnthrottled=function(){var n=s.window.location.href.replace(/(#.+)?$/,this.getHashString());try{s.window.history.replaceState(s.window.history.state,null,n)}catch{}};var As={linearity:.3,easing:s.bezier(0,0,.3,1)},Gn=s.extend({deceleration:2500,maxSpeed:1400},As),In=s.extend({deceleration:20,maxSpeed:1400},As),Ja=s.extend({deceleration:1e3,maxSpeed:360},As),tu=s.extend({deceleration:1e3,maxSpeed:90},As),aa=function(n){this._map=n,this.clear()};function pl(n,a){(!n.duration||n.duration<a.duration)&&(n.duration=a.duration,n.easing=a.easing)}function sa(n,a,o){var u=o.maxSpeed,d=o.linearity,_=o.deceleration,x=s.clamp(n*d/(a/1e3),-u,u),T=Math.abs(x)/(_*d);return{easing:o.easing,duration:1e3*T,amount:x*(T/2)}}aa.prototype.clear=function(){this._inertiaBuffer=[]},aa.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.browser.now(),settings:n})},aa.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,a=s.browser.now();n.length>0&&a-n[0].time>160;)n.shift()},aa.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var a={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0},o=0,u=this._inertiaBuffer;o<u.length;o+=1){var d=u[o].settings;a.zoom+=d.zoomDelta||0,a.bearing+=d.bearingDelta||0,a.pitch+=d.pitchDelta||0,d.panDelta&&a.pan._add(d.panDelta),d.around&&(a.around=d.around),d.pinchAround&&(a.pinchAround=d.pinchAround)}var _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(a.pan.mag()){var T=sa(a.pan.mag(),_,s.extend({},Gn,n||{}));x.offset=a.pan.mult(T.amount/a.pan.mag()),x.center=this._map.transform.center,pl(x,T)}if(a.zoom){var z=sa(a.zoom,_,In);x.zoom=this._map.transform.zoom+z.amount,pl(x,z)}if(a.bearing){var L=sa(a.bearing,_,Ja);x.bearing=this._map.transform.bearing+s.clamp(L.amount,-179,179),pl(x,L)}if(a.pitch){var j=sa(a.pitch,_,tu);x.pitch=this._map.transform.pitch+j.amount,pl(x,j)}if(x.zoom||x.bearing){var q=a.pinchAround===void 0?a.around:a.pinchAround;x.around=q?this._map.unproject(q):this._map.getCenter()}return this.clear(),s.extend(x,{noMoveStart:!0})}};var Gr=function(n){function a(u,d,_,x){x===void 0&&(x={});var T=A.mousePos(d.getCanvasContainer(),_),z=d.unproject(T);n.call(this,u,s.extend({point:T,lngLat:z,originalEvent:_},x)),this._defaultPrevented=!1,this.target=d}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(s.Event),Aa=function(n){function a(u,d,_){var x=u==="touchend"?_.changedTouches:_.touches,T=A.touchPos(d.getCanvasContainer(),x),z=T.map(function(q){return d.unproject(q)}),L=T.reduce(function(q,Z,J,Q){return q.add(Z.div(Q.length))},new s.Point(0,0)),j=d.unproject(L);n.call(this,u,{points:T,point:L,lngLats:z,lngLat:j,originalEvent:_}),this._defaultPrevented=!1}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(s.Event),Bl=function(n){function a(u,d,_){n.call(this,u,{originalEvent:_}),this._defaultPrevented=!1}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(s.Event),li=function(n,a){this._map=n,this._clickTolerance=a.clickTolerance};li.prototype.reset=function(){delete this._mousedownPos},li.prototype.wheel=function(n){return this._firePreventable(new Bl(n.type,this._map,n))},li.prototype.mousedown=function(n,a){return this._mousedownPos=a,this._firePreventable(new Gr(n.type,this._map,n))},li.prototype.mouseup=function(n){this._map.fire(new Gr(n.type,this._map,n))},li.prototype.click=function(n,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Gr(n.type,this._map,n))},li.prototype.dblclick=function(n){return this._firePreventable(new Gr(n.type,this._map,n))},li.prototype.mouseover=function(n){this._map.fire(new Gr(n.type,this._map,n))},li.prototype.mouseout=function(n){this._map.fire(new Gr(n.type,this._map,n))},li.prototype.touchstart=function(n){return this._firePreventable(new Aa(n.type,this._map,n))},li.prototype.touchmove=function(n){this._map.fire(new Aa(n.type,this._map,n))},li.prototype.touchend=function(n){this._map.fire(new Aa(n.type,this._map,n))},li.prototype.touchcancel=function(n){this._map.fire(new Aa(n.type,this._map,n))},li.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},li.prototype.isEnabled=function(){return!0},li.prototype.isActive=function(){return!1},li.prototype.enable=function(){},li.prototype.disable=function(){};var $e=function(n){this._map=n};$e.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},$e.prototype.mousemove=function(n){this._map.fire(new Gr(n.type,this._map,n))},$e.prototype.mousedown=function(){this._delayContextMenu=!0},$e.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Gr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},$e.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Gr(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},$e.prototype.isEnabled=function(){return!0},$e.prototype.isActive=function(){return!1},$e.prototype.enable=function(){},$e.prototype.disable=function(){};var kn=function(n,a){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=a.clickTolerance||1};function ko(n,a){for(var o={},u=0;u<n.length;u++)o[n[u].identifier]=a[u];return o}kn.prototype.isEnabled=function(){return!!this._enabled},kn.prototype.isActive=function(){return!!this._active},kn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},kn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},kn.prototype.mousedown=function(n,a){this.isEnabled()&&n.shiftKey&&n.button===0&&(A.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)},kn.prototype.mousemoveWindow=function(n,a){if(this._active){var o=a;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var u=this._startPos;this._lastPos=o,this._box||(this._box=A.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var d=Math.min(u.x,o.x),_=Math.max(u.x,o.x),x=Math.min(u.y,o.y),T=Math.max(u.y,o.y);A.setTransform(this._box,"translate("+d+"px,"+x+"px)"),this._box.style.width=_-d+"px",this._box.style.height=T-x+"px"}}},kn.prototype.mouseupWindow=function(n,a){var o=this;if(this._active&&n.button===0){var u=this._startPos,d=a;if(this.reset(),A.suppressClick(),u.x!==d.x||u.y!==d.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(_){return _.fitScreenCoordinates(u,d,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},kn.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},kn.prototype.blur=function(){this.reset()},kn.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(A.remove(this._box),this._box=null),A.enableDrag(),delete this._startPos,delete this._lastPos},kn.prototype._fireEvent=function(n,a){return this._map.fire(new s.Event(n,{originalEvent:a}))};var fn=function(n){this.reset(),this.numTouches=n.numTouches};fn.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},fn.prototype.touchstart=function(n,a,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(u){for(var d=new s.Point(0,0),_=0,x=u;_<x.length;_+=1)d._add(x[_]);return d.div(u.length)}(a),this.touches=ko(o,a)))},fn.prototype.touchmove=function(n,a,o){if(!this.aborted&&this.centroid){var u=ko(o,a);for(var d in this.touches){var _=u[d];(!_||_.dist(this.touches[d])>30)&&(this.aborted=!0)}}},fn.prototype.touchend=function(n,a,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){var u=!this.aborted&&this.centroid;if(this.reset(),u)return u}};var Ki=function(n){this.singleTap=new fn(n),this.numTaps=n.numTaps,this.reset()};Ki.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Ki.prototype.touchstart=function(n,a,o){this.singleTap.touchstart(n,a,o)},Ki.prototype.touchmove=function(n,a,o){this.singleTap.touchmove(n,a,o)},Ki.prototype.touchend=function(n,a,o){var u=this.singleTap.touchend(n,a,o);if(u){var d=n.timeStamp-this.lastTime<500,_=!this.lastTap||this.lastTap.dist(u)<30;if(d&&_||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}};var zn=function(){this._zoomIn=new Ki({numTouches:1,numTaps:2}),this._zoomOut=new Ki({numTouches:2,numTaps:1}),this.reset()};zn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},zn.prototype.touchstart=function(n,a,o){this._zoomIn.touchstart(n,a,o),this._zoomOut.touchstart(n,a,o)},zn.prototype.touchmove=function(n,a,o){this._zoomIn.touchmove(n,a,o),this._zoomOut.touchmove(n,a,o)},zn.prototype.touchend=function(n,a,o){var u=this,d=this._zoomIn.touchend(n,a,o),_=this._zoomOut.touchend(n,a,o);return d?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(x){return x.easeTo({duration:300,zoom:x.getZoom()+1,around:x.unproject(d)},{originalEvent:n})}}):_?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(x){return x.easeTo({duration:300,zoom:x.getZoom()-1,around:x.unproject(_)},{originalEvent:n})}}):void 0},zn.prototype.touchcancel=function(){this.reset()},zn.prototype.enable=function(){this._enabled=!0},zn.prototype.disable=function(){this._enabled=!1,this.reset()},zn.prototype.isEnabled=function(){return this._enabled},zn.prototype.isActive=function(){return this._active};var Ya={0:1,2:2},Ye=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};Ye.prototype.blur=function(){this.reset()},Ye.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ye.prototype._correctButton=function(n,a){return!1},Ye.prototype._move=function(n,a){return{}},Ye.prototype.mousedown=function(n,a){if(!this._lastPoint){var o=A.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=a,this._eventButton=o)}},Ye.prototype.mousemoveWindow=function(n,a){var o=this._lastPoint;if(o){if(n.preventDefault(),function(u,d){var _=Ya[d];return u.buttons===void 0||(u.buttons&_)!==_}(n,this._eventButton))this.reset();else if(this._moved||!(a.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(o,a)}},Ye.prototype.mouseupWindow=function(n){this._lastPoint&&A.mouseButton(n)===this._eventButton&&(this._moved&&A.suppressClick(),this.reset())},Ye.prototype.enable=function(){this._enabled=!0},Ye.prototype.disable=function(){this._enabled=!1,this.reset()},Ye.prototype.isEnabled=function(){return this._enabled},Ye.prototype.isActive=function(){return this._active};var fl=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.mousedown=function(o,u){n.prototype.mousedown.call(this,o,u),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(o,u){return u===0&&!o.ctrlKey},a.prototype._move=function(o,u){return{around:u,panDelta:u.sub(o)}},a}(Ye),Pa=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype._correctButton=function(o,u){return u===0&&o.ctrlKey||u===2},a.prototype._move=function(o,u){var d=.8*(u.x-o.x);if(d)return this._active=!0,{bearingDelta:d}},a.prototype.contextmenu=function(o){o.preventDefault()},a}(Ye),ds=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype._correctButton=function(o,u){return u===0&&o.ctrlKey||u===2},a.prototype._move=function(o,u){var d=-.5*(u.y-o.y);if(d)return this._active=!0,{pitchDelta:d}},a.prototype.contextmenu=function(o){o.preventDefault()},a}(Ye),lo=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};lo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)},lo.prototype.touchstart=function(n,a,o){return this._calculateTransform(n,a,o)},lo.prototype.touchmove=function(n,a,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,a,o)},lo.prototype.touchend=function(n,a,o){this._calculateTransform(n,a,o),this._active&&o.length<this._minTouches&&this.reset()},lo.prototype.touchcancel=function(){this.reset()},lo.prototype._calculateTransform=function(n,a,o){o.length>0&&(this._active=!0);var u=ko(o,a),d=new s.Point(0,0),_=new s.Point(0,0),x=0;for(var T in u){var z=u[T],L=this._touches[T];L&&(d._add(z),_._add(z.sub(L)),x++,u[T]=z)}if(this._touches=u,!(x<this._minTouches)&&_.mag()){var j=_.div(x);if(this._sum._add(j),!(this._sum.mag()<this._clickTolerance))return{around:d.div(x),panDelta:j}}},lo.prototype.enable=function(){this._enabled=!0},lo.prototype.disable=function(){this._enabled=!1,this.reset()},lo.prototype.isEnabled=function(){return this._enabled},lo.prototype.isActive=function(){return this._active};var An=function(){this.reset()};function la(n,a,o){for(var u=0;u<n.length;u++)if(n[u].identifier===o)return a[u]}function ua(n,a){return Math.log(n/a)/Math.LN2}An.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},An.prototype._start=function(n){},An.prototype._move=function(n,a,o){return{}},An.prototype.touchstart=function(n,a,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([a[0],a[1]]))},An.prototype.touchmove=function(n,a,o){if(this._firstTwoTouches){n.preventDefault();var u=this._firstTwoTouches,d=u[1],_=la(o,a,u[0]),x=la(o,a,d);if(_&&x){var T=this._aroundCenter?null:_.add(x).div(2);return this._move([_,x],T,n)}}},An.prototype.touchend=function(n,a,o){if(this._firstTwoTouches){var u=this._firstTwoTouches,d=u[1],_=la(o,a,u[0]),x=la(o,a,d);_&&x||(this._active&&A.suppressClick(),this.reset())}},An.prototype.touchcancel=function(){this.reset()},An.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},An.prototype.disable=function(){this._enabled=!1,this.reset()},An.prototype.isEnabled=function(){return this._enabled},An.prototype.isActive=function(){return this._active};var Kn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},a.prototype._move=function(o,u){var d=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(ua(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ua(this._distance,d),pinchAround:u}},a}(An);function Lr(n,a){return 180*n.angleWith(a)/Math.PI}var Ol=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},a.prototype._move=function(o,u){var d=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Lr(this._vector,d),pinchAround:u}},a.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var u=25/(Math.PI*this._minDiameter)*360,d=Lr(o,this._startVector);return Math.abs(d)<u},a}(An);function js(n){return Math.abs(n.y)>Math.abs(n.x)}var Fl=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(o){this._lastPoints=o,js(o[0].sub(o[1]))&&(this._valid=!1)},a.prototype._move=function(o,u,d){var _=o[0].sub(this._lastPoints[0]),x=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(_,x,d.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(_.y+x.y)/2*-.5}},a.prototype.gestureBeginsVertically=function(o,u,d){if(this._valid!==void 0)return this._valid;var _=o.mag()>=2,x=u.mag()>=2;if(_||x){if(!_||!x)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;var T=o.y>0==u.y>0;return js(o)&&js(u)&&T}},a}(An),qs={panStep:100,bearingStep:15,pitchStep:10},Li=function(){var n=qs;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function Zr(n){return n*(2-n)}Li.prototype.blur=function(){this.reset()},Li.prototype.reset=function(){this._active=!1},Li.prototype.keydown=function(n){var a=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,u=0,d=0,_=0,x=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?u=-1:(n.preventDefault(),_=-1);break;case 39:n.shiftKey?u=1:(n.preventDefault(),_=1);break;case 38:n.shiftKey?d=1:(n.preventDefault(),x=-1);break;case 40:n.shiftKey?d=-1:(n.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(u=0,d=0),{cameraAnimation:function(T){var z=T.getZoom();T.easeTo({duration:300,easeId:"keyboardHandler",easing:Zr,zoom:o?Math.round(z)+o*(n.shiftKey?2:1):z,bearing:T.getBearing()+u*a._bearingStep,pitch:T.getPitch()+d*a._pitchStep,offset:[-_*a._panStep,-x*a._panStep],center:T.getCenter()},{originalEvent:n})}}}},Li.prototype.enable=function(){this._enabled=!0},Li.prototype.disable=function(){this._enabled=!1,this.reset()},Li.prototype.isEnabled=function(){return this._enabled},Li.prototype.isActive=function(){return this._active},Li.prototype.disableRotation=function(){this._rotationDisabled=!0},Li.prototype.enableRotation=function(){this._rotationDisabled=!1};var Yt=function(n,a){this._map=n,this._el=n.getCanvasContainer(),this._handler=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,s.bindAll(["_onTimeout"],this)};Yt.prototype.setZoomRate=function(n){this._defaultZoomRate=n},Yt.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},Yt.prototype.isEnabled=function(){return!!this._enabled},Yt.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Yt.prototype.isZooming=function(){return!!this._zooming},Yt.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},Yt.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Yt.prototype.wheel=function(n){if(this.isEnabled()){var a=n.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=s.browser.now(),u=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,a!==0&&a%4.000244140625==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(u*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),n.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=n,this._delta-=a,this._active||this._start(n)),n.preventDefault()}},Yt.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},Yt.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=A.mousePos(this._el,n);this._around=s.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Yt.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var a=this._map.transform;if(this._delta!==0){var o=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,u=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&u!==0&&(u=1/u);var d=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(d*u))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var _,x=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,T=this._startZoom,z=this._easing,L=!1;if(this._type==="wheel"&&T&&z){var j=Math.min((s.browser.now()-this._lastWheelEventTime)/200,1),q=z(j);_=s.number(T,x,q),j<1?this._frameId||(this._frameId=!0):L=!0}else _=x,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!L,zoomDelta:_-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Yt.prototype._smoothOutEasing=function(n){var a=s.ease;if(this._prevEase){var o=this._prevEase,u=(s.browser.now()-o.start)/o.duration,d=o.easing(u+.01)-o.easing(u),_=.27/Math.sqrt(d*d+1e-4)*.01,x=Math.sqrt(.0729-_*_);a=s.bezier(_,x,.25,1)}return this._prevEase={start:s.browser.now(),duration:n,easing:a},a},Yt.prototype.blur=function(){this.reset()},Yt.prototype.reset=function(){this._active=!1};var ca=function(n,a){this._clickZoom=n,this._tapZoom=a};ca.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},ca.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},ca.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},ca.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var zo=function(){this.reset()};zo.prototype.reset=function(){this._active=!1},zo.prototype.blur=function(){this.reset()},zo.prototype.dblclick=function(n,a){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(a)},{originalEvent:n})}}},zo.prototype.enable=function(){this._enabled=!0},zo.prototype.disable=function(){this._enabled=!1,this.reset()},zo.prototype.isEnabled=function(){return this._enabled},zo.prototype.isActive=function(){return this._active};var Ri=function(){this._tap=new Ki({numTouches:1,numTaps:1}),this.reset()};Ri.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Ri.prototype.touchstart=function(n,a,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=a[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,a,o))},Ri.prototype.touchmove=function(n,a,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var u=a[0],d=u.y-this._swipePoint.y;return this._swipePoint=u,n.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(n,a,o)},Ri.prototype.touchend=function(n,a,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(n,a,o)&&(this._tapTime=n.timeStamp)},Ri.prototype.touchcancel=function(){this.reset()},Ri.prototype.enable=function(){this._enabled=!0},Ri.prototype.disable=function(){this._enabled=!1,this.reset()},Ri.prototype.isEnabled=function(){return this._enabled},Ri.prototype.isActive=function(){return this._active};var dn=function(n,a,o){this._el=n,this._mousePan=a,this._touchPan=o};dn.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},dn.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},dn.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},dn.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Qa=function(n,a,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=a,this._mousePitch=o};Qa.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Qa.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Qa.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Qa.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var uo=function(n,a,o,u){this._el=n,this._touchZoom=a,this._touchRotate=o,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0};uo.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},uo.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},uo.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},uo.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},uo.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},uo.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Hr=function(n){return n.zoom||n.drag||n.pitch||n.rotate},_e=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a}(s.Event);function Pe(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var ot=function(n,a){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new aa(n),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a),s.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[s.window,"blur",void 0]];for(var u=0,d=this._listeners;u<d.length;u+=1){var _=d[u],x=_[0];A.addEventListener(x,_[1],x===s.window.document?this.handleWindowEvent:this.handleEvent,_[2])}};ot.prototype.destroy=function(){for(var n=0,a=this._listeners;n<a.length;n+=1){var o=a[n],u=o[0];A.removeEventListener(u,o[1],u===s.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},ot.prototype._addDefaultHandlers=function(n){var a=this._map,o=a.getCanvasContainer();this._add("mapEvent",new li(a,n));var u=a.boxZoom=new kn(a,n);this._add("boxZoom",u);var d=new zn,_=new zo;a.doubleClickZoom=new ca(_,d),this._add("tapZoom",d),this._add("clickZoom",_);var x=new Ri;this._add("tapDragZoom",x);var T=a.touchPitch=new Fl;this._add("touchPitch",T);var z=new Pa(n),L=new ds(n);a.dragRotate=new Qa(n,z,L),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]);var j=new fl(n),q=new lo(n);a.dragPan=new dn(o,j,q),this._add("mousePan",j),this._add("touchPan",q,["touchZoom","touchRotate"]);var Z=new Ol,J=new Kn;a.touchZoomRotate=new uo(o,J,Z,x),this._add("touchRotate",Z,["touchPan","touchZoom"]),this._add("touchZoom",J,["touchPan","touchRotate"]);var Q=a.scrollZoom=new Yt(a,this);this._add("scrollZoom",Q,["mousePan"]);var oe=a.keyboard=new Li;this._add("keyboard",oe),this._add("blockableMapEvent",new $e(a));for(var Y=0,ae=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Y<ae.length;Y+=1){var he=ae[Y];n.interactive&&n[he]&&a[he].enable(n[he])}},ot.prototype._add=function(n,a,o){this._handlers.push({handlerName:n,handler:a,allowed:o}),this._handlersById[n]=a},ot.prototype.stop=function(n){if(!this._updatingCamera){for(var a=0,o=this._handlers;a<o.length;a+=1)o[a].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},ot.prototype.isActive=function(){for(var n=0,a=this._handlers;n<a.length;n+=1)if(a[n].handler.isActive())return!0;return!1},ot.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},ot.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},ot.prototype.isMoving=function(){return Boolean(Hr(this._eventsInProgress))||this.isZooming()},ot.prototype._blockedByActive=function(n,a,o){for(var u in n)if(u!==o&&(!a||a.indexOf(u)<0))return!0;return!1},ot.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},ot.prototype._getMapTouches=function(n){for(var a=[],o=0,u=n;o<u.length;o+=1){var d=u[o];this._el.contains(d.target)&&a.push(d)}return a},ot.prototype.handleEvent=function(n,a){this._updatingCamera=!0;for(var o=n.type==="renderFrame"?void 0:n,u={needsRenderFrame:!1},d={},_={},x=n.touches?this._getMapTouches(n.touches):void 0,T=x?A.touchPos(this._el,x):A.mousePos(this._el,n),z=0,L=this._handlers;z<L.length;z+=1){var j=L[z],q=j.handlerName,Z=j.handler,J=j.allowed;if(Z.isEnabled()){var Q=void 0;this._blockedByActive(_,J,q)?Z.reset():Z[a||n.type]&&(Q=Z[a||n.type](n,T,x),this.mergeHandlerResult(u,d,Q,q,o),Q&&Q.needsRenderFrame&&this._triggerRenderFrame()),(Q||Z.isActive())&&(_[q]=Z)}}var oe={};for(var Y in this._previousActiveHandlers)_[Y]||(oe[Y]=o);this._previousActiveHandlers=_,(Object.keys(oe).length||Pe(u))&&(this._changes.push([u,d,oe]),this._triggerRenderFrame()),(Object.keys(_).length||Pe(u))&&this._map._stop(!0),this._updatingCamera=!1;var ae=u.cameraAnimation;ae&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ae(this._map))},ot.prototype.mergeHandlerResult=function(n,a,o,u,d){if(o){s.extend(n,o);var _={handlerName:u,originalEvent:o.originalEvent||d};o.zoomDelta!==void 0&&(a.zoom=_),o.panDelta!==void 0&&(a.drag=_),o.pitchDelta!==void 0&&(a.pitch=_),o.bearingDelta!==void 0&&(a.rotate=_)}},ot.prototype._applyChanges=function(){for(var n={},a={},o={},u=0,d=this._changes;u<d.length;u+=1){var _=d[u],x=_[0],T=_[1],z=_[2];x.panDelta&&(n.panDelta=(n.panDelta||new s.Point(0,0))._add(x.panDelta)),x.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(n.around=x.around),x.pinchAround!==void 0&&(n.pinchAround=x.pinchAround),x.noInertia&&(n.noInertia=x.noInertia),s.extend(a,T),s.extend(o,z)}this._updateMapTransform(n,a,o),this._changes=[]},ot.prototype._updateMapTransform=function(n,a,o){var u=this._map,d=u.transform;if(!Pe(n))return this._fireEvents(a,o,!0);var _=n.panDelta,x=n.zoomDelta,T=n.bearingDelta,z=n.pitchDelta,L=n.around,j=n.pinchAround;j!==void 0&&(L=j),u._stop(!0),L=L||u.transform.centerPoint;var q=d.pointLocation(_?L.sub(_):L);T&&(d.bearing+=T),z&&(d.pitch+=z),x&&(d.zoom+=x),d.setLocationAtPoint(q,L),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(a,o,!0)},ot.prototype._fireEvents=function(n,a,o){var u=this,d=Hr(this._eventsInProgress),_=Hr(n),x={};for(var T in n)this._eventsInProgress[T]||(x[T+"start"]=n[T].originalEvent),this._eventsInProgress[T]=n[T];for(var z in!d&&_&&this._fireEvent("movestart",_.originalEvent),x)this._fireEvent(z,x[z]);for(var L in _&&this._fireEvent("move",_.originalEvent),n)this._fireEvent(L,n[L].originalEvent);var j,q={};for(var Z in this._eventsInProgress){var J=this._eventsInProgress[Z],Q=J.handlerName,oe=J.originalEvent;this._handlersById[Q].isActive()||(delete this._eventsInProgress[Z],q[Z+"end"]=j=a[Q]||oe)}for(var Y in q)this._fireEvent(Y,q[Y]);var ae=Hr(this._eventsInProgress);if(o&&(d||_)&&!ae){this._updatingCamera=!0;var he=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ye=function(Te){return Te!==0&&-u._bearingSnap<Te&&Te<u._bearingSnap};he?(ye(he.bearing||this._map.getBearing())&&(he.bearing=0),this._map.easeTo(he,{originalEvent:j})):(this._map.fire(new s.Event("moveend",{originalEvent:j})),ye(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},ot.prototype._fireEvent=function(n,a){this._map.fire(new s.Event(n,a?{originalEvent:a}:{}))},ot.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(a){delete n._frameId,n.handleEvent(new _e("renderFrame",{timeStamp:a})),n._applyChanges()})},ot.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var co=function(n){function a(o,u){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=u.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getCenter=function(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)},a.prototype.setCenter=function(o,u){return this.jumpTo({center:o},u)},a.prototype.panBy=function(o,u,d){return o=s.Point.convert(o).mult(-1),this.panTo(this.transform.center,s.extend({offset:o},u),d)},a.prototype.panTo=function(o,u,d){return this.easeTo(s.extend({center:o},u),d)},a.prototype.getZoom=function(){return this.transform.zoom},a.prototype.setZoom=function(o,u){return this.jumpTo({zoom:o},u),this},a.prototype.zoomTo=function(o,u,d){return this.easeTo(s.extend({zoom:o},u),d)},a.prototype.zoomIn=function(o,u){return this.zoomTo(this.getZoom()+1,o,u),this},a.prototype.zoomOut=function(o,u){return this.zoomTo(this.getZoom()-1,o,u),this},a.prototype.getBearing=function(){return this.transform.bearing},a.prototype.setBearing=function(o,u){return this.jumpTo({bearing:o},u),this},a.prototype.getPadding=function(){return this.transform.padding},a.prototype.setPadding=function(o,u){return this.jumpTo({padding:o},u),this},a.prototype.rotateTo=function(o,u,d){return this.easeTo(s.extend({bearing:o},u),d)},a.prototype.resetNorth=function(o,u){return this.rotateTo(0,s.extend({duration:1e3},o),u),this},a.prototype.resetNorthPitch=function(o,u){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},o),u),this},a.prototype.snapToNorth=function(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this},a.prototype.getPitch=function(){return this.transform.pitch},a.prototype.setPitch=function(o,u){return this.jumpTo({pitch:o},u),this},a.prototype.cameraForBounds=function(o,u){o=s.LngLatBounds.convert(o);var d=u&&u.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),d,u)},a.prototype._cameraForBoxAndBearing=function(o,u,d,_){var x={top:0,bottom:0,right:0,left:0};if(typeof(_=s.extend({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){var T=_.padding;_.padding={top:T,bottom:T,right:T,left:T}}_.padding=s.extend(x,_.padding);var z=this.transform,L=z.padding,j=z.project(s.LngLat.convert(o)),q=z.project(s.LngLat.convert(u)),Z=j.rotate(-d*Math.PI/180),J=q.rotate(-d*Math.PI/180),Q=new s.Point(Math.max(Z.x,J.x),Math.max(Z.y,J.y)),oe=new s.Point(Math.min(Z.x,J.x),Math.min(Z.y,J.y)),Y=Q.sub(oe),ae=(z.width-(L.left+L.right+_.padding.left+_.padding.right))/Y.x,he=(z.height-(L.top+L.bottom+_.padding.top+_.padding.bottom))/Y.y;if(!(he<0||ae<0)){var ye=Math.min(z.scaleZoom(z.scale*Math.min(ae,he)),_.maxZoom),Te=typeof _.offset.x=="number"?new s.Point(_.offset.x,_.offset.y):s.Point.convert(_.offset),ve=new s.Point((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(d*Math.PI/180),Ae=Te.add(ve).mult(z.scale/z.zoomScale(ye));return{center:z.unproject(j.add(q).div(2).sub(Ae)),zoom:ye,bearing:d}}s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},a.prototype.fitBounds=function(o,u,d){return this._fitInternal(this.cameraForBounds(o,u),u,d)},a.prototype.fitScreenCoordinates=function(o,u,d,_,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(s.Point.convert(o)),this.transform.pointLocation(s.Point.convert(u)),d,_),_,x)},a.prototype._fitInternal=function(o,u,d){return o?(delete(u=s.extend(o,u)).padding,u.linear?this.easeTo(u,d):this.flyTo(u,d)):this},a.prototype.jumpTo=function(o,u){this.stop();var d=this.transform,_=!1,x=!1,T=!1;return"zoom"in o&&d.zoom!==+o.zoom&&(_=!0,d.zoom=+o.zoom),o.center!==void 0&&(d.center=s.LngLat.convert(o.center)),"bearing"in o&&d.bearing!==+o.bearing&&(x=!0,d.bearing=+o.bearing),"pitch"in o&&d.pitch!==+o.pitch&&(T=!0,d.pitch=+o.pitch),o.padding==null||d.isPaddingEqual(o.padding)||(d.padding=o.padding),this.fire(new s.Event("movestart",u)).fire(new s.Event("move",u)),_&&this.fire(new s.Event("zoomstart",u)).fire(new s.Event("zoom",u)).fire(new s.Event("zoomend",u)),x&&this.fire(new s.Event("rotatestart",u)).fire(new s.Event("rotate",u)).fire(new s.Event("rotateend",u)),T&&this.fire(new s.Event("pitchstart",u)).fire(new s.Event("pitch",u)).fire(new s.Event("pitchend",u)),this.fire(new s.Event("moveend",u))},a.prototype.easeTo=function(o,u){var d=this;this._stop(!1,o.easeId),((o=s.extend({offset:[0,0],duration:500,easing:s.ease},o)).animate===!1||!o.essential&&s.browser.prefersReducedMotion)&&(o.duration=0);var _=this.transform,x=this.getZoom(),T=this.getBearing(),z=this.getPitch(),L=this.getPadding(),j="zoom"in o?+o.zoom:x,q="bearing"in o?this._normalizeBearing(o.bearing,T):T,Z="pitch"in o?+o.pitch:z,J="padding"in o?o.padding:_.padding,Q=s.Point.convert(o.offset),oe=_.centerPoint.add(Q),Y=_.pointLocation(oe),ae=s.LngLat.convert(o.center||Y);this._normalizeCenter(ae);var he,ye,Te=_.project(Y),ve=_.project(ae).sub(Te),Ae=_.zoomScale(j-x);o.around&&(he=s.LngLat.convert(o.around),ye=_.locationPoint(he));var Re={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||j!==x,this._rotating=this._rotating||T!==q,this._pitching=this._pitching||Z!==z,this._padding=!_.isPaddingEqual(J),this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,Re),this._ease(function(Ue){if(d._zooming&&(_.zoom=s.number(x,j,Ue)),d._rotating&&(_.bearing=s.number(T,q,Ue)),d._pitching&&(_.pitch=s.number(z,Z,Ue)),d._padding&&(_.interpolatePadding(L,J,Ue),oe=_.centerPoint.add(Q)),he)_.setLocationAtPoint(he,ye);else{var Ve=_.zoomScale(_.zoom-x),at=j>x?Math.min(2,Ae):Math.max(.5,Ae),yt=Math.pow(at,1-Ue),mt=_.unproject(Te.add(ve.mult(Ue*yt)).mult(Ve));_.setLocationAtPoint(_.renderWorldCopies?mt.wrap():mt,oe)}d._fireMoveEvents(u)},function(Ue){d._afterEase(u,Ue)},o),this},a.prototype._prepareEase=function(o,u,d){d===void 0&&(d={}),this._moving=!0,u||d.moving||this.fire(new s.Event("movestart",o)),this._zooming&&!d.zooming&&this.fire(new s.Event("zoomstart",o)),this._rotating&&!d.rotating&&this.fire(new s.Event("rotatestart",o)),this._pitching&&!d.pitching&&this.fire(new s.Event("pitchstart",o))},a.prototype._fireMoveEvents=function(o){this.fire(new s.Event("move",o)),this._zooming&&this.fire(new s.Event("zoom",o)),this._rotating&&this.fire(new s.Event("rotate",o)),this._pitching&&this.fire(new s.Event("pitch",o))},a.prototype._afterEase=function(o,u){if(!this._easeId||!u||this._easeId!==u){delete this._easeId;var d=this._zooming,_=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new s.Event("zoomend",o)),_&&this.fire(new s.Event("rotateend",o)),x&&this.fire(new s.Event("pitchend",o)),this.fire(new s.Event("moveend",o))}},a.prototype.flyTo=function(o,u){var d=this;if(!o.essential&&s.browser.prefersReducedMotion){var _=s.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(_,u)}this.stop(),o=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},o);var x=this.transform,T=this.getZoom(),z=this.getBearing(),L=this.getPitch(),j=this.getPadding(),q="zoom"in o?s.clamp(+o.zoom,x.minZoom,x.maxZoom):T,Z="bearing"in o?this._normalizeBearing(o.bearing,z):z,J="pitch"in o?+o.pitch:L,Q="padding"in o?o.padding:x.padding,oe=x.zoomScale(q-T),Y=s.Point.convert(o.offset),ae=x.centerPoint.add(Y),he=x.pointLocation(ae),ye=s.LngLat.convert(o.center||he);this._normalizeCenter(ye);var Te=x.project(he),ve=x.project(ye).sub(Te),Ae=o.curve,Re=Math.max(x.width,x.height),Ue=Re/oe,Ve=ve.mag();if("minZoom"in o){var at=s.clamp(Math.min(o.minZoom,T,q),x.minZoom,x.maxZoom),yt=Re/x.zoomScale(at-T);Ae=Math.sqrt(yt/Ve*2)}var mt=Ae*Ae;function _t(bt){var wt=(Ue*Ue-Re*Re+(bt?-1:1)*mt*mt*Ve*Ve)/(2*(bt?Ue:Re)*mt*Ve);return Math.log(Math.sqrt(wt*wt+1)-wt)}function ir(bt){return(Math.exp(bt)-Math.exp(-bt))/2}function ut(bt){return(Math.exp(bt)+Math.exp(-bt))/2}var zt=_t(0),Ot=function(bt){return ut(zt)/ut(zt+Ae*bt)},Et=function(bt){return Re*((ut(zt)*(ir(wt=zt+Ae*bt)/ut(wt))-ir(zt))/mt)/Ve;var wt},St=(_t(1)-zt)/Ae;if(Math.abs(Ve)<1e-6||!isFinite(St)){if(Math.abs(Re-Ue)<1e-6)return this.easeTo(o,u);var Dt=Ue<Re?-1:1;St=Math.abs(Math.log(Ue/Re))/Ae,Et=function(){return 0},Ot=function(bt){return Math.exp(Dt*Ae*bt)}}return o.duration="duration"in o?+o.duration:1e3*St/("screenSpeed"in o?+o.screenSpeed/Ae:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=z!==Z,this._pitching=J!==L,this._padding=!x.isPaddingEqual(Q),this._prepareEase(u,!1),this._ease(function(bt){var wt=bt*St,zi=1/Ot(wt);x.zoom=bt===1?q:T+x.scaleZoom(zi),d._rotating&&(x.bearing=s.number(z,Z,bt)),d._pitching&&(x.pitch=s.number(L,J,bt)),d._padding&&(x.interpolatePadding(j,Q,bt),ae=x.centerPoint.add(Y));var ui=bt===1?ye:x.unproject(Te.add(ve.mult(Et(wt))).mult(zi));x.setLocationAtPoint(x.renderWorldCopies?ui.wrap():ui,ae),d._fireMoveEvents(u)},function(){return d._afterEase(u)},o),this},a.prototype.isEasing=function(){return!!this._easeFrameId},a.prototype.stop=function(){return this._stop()},a.prototype._stop=function(o,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,u)}if(!o){var _=this.handlers;_&&_.stop(!1)}return this},a.prototype._ease=function(o,u,d){d.animate===!1||d.duration===0?(o(1),u()):(this._easeStart=s.browser.now(),this._easeOptions=d,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},a.prototype._renderFrameCallback=function(){var o=Math.min((s.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},a.prototype._normalizeBearing=function(o,u){o=s.wrap(o,-180,180);var d=Math.abs(o-u);return Math.abs(o-360-u)<d&&(o-=360),Math.abs(o+360-u)<d&&(o+=360),o},a.prototype._normalizeCenter=function(o){var u=this.transform;if(u.renderWorldCopies&&!u.lngRange){var d=o.lng-u.center.lng;o.lng+=d>180?-360:d<-180?360:0}},a}(s.Evented),Bi=function(n){n===void 0&&(n={}),this.options=n,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Bi.prototype.getDefaultPosition=function(){return"bottom-right"},Bi.prototype.onAdd=function(n){var a=this.options&&this.options.compact;return this._map=n,this._container=A.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=A.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),a===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Bi.prototype.onRemove=function(){A.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Bi.prototype._setElementTitle=function(n,a){var o=this._map._getUIString("AttributionControl."+a);n.title=o,n.setAttribute("aria-label",o)},Bi.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Bi.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(n){var o=a.reduce(function(u,d,_){return d.value&&(u+=d.key+"="+d.value+(_<a.length-1?"&":"")),u},"?");n.href=s.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},Bi.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Bi.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(T){return typeof T!="string"?"":T})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}var o=this._map.style.sourceCaches;for(var u in o){var d=o[u];if(d.used){var _=d.getSource();_.attribution&&n.indexOf(_.attribution)<0&&n.push(_.attribution)}}n.sort(function(T,z){return T.length-z.length});var x=(n=n.filter(function(T,z){for(var L=z+1;L<n.length;L++)if(n[L].indexOf(T)>=0)return!1;return!0})).join(" | ");x!==this._attribHTML&&(this._attribHTML=x,n.length?(this._innerContainer.innerHTML=x,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Bi.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var mn=function(){s.bindAll(["_updateLogo"],this),s.bindAll(["_updateCompact"],this)};mn.prototype.onAdd=function(n){this._map=n,this._container=A.create("div","mapboxgl-ctrl");var a=A.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},mn.prototype.onRemove=function(){A.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},mn.prototype.getDefaultPosition=function(){return"bottom-left"},mn.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},mn.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var a in n)if(n[a].getSource().mapbox_logo)return!0;return!1}},mn.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var a=n[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}};var Ur=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Ur.prototype.add=function(n){var a=++this._id;return this._queue.push({callback:n,id:a,cancelled:!1}),a},Ur.prototype.remove=function(n){for(var a=this._currentlyRunning,o=0,u=a?this._queue.concat(a):this._queue;o<u.length;o+=1){var d=u[o];if(d.id===n)return void(d.cancelled=!0)}},Ur.prototype.run=function(n){n===void 0&&(n=0);var a=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,u=a;o<u.length;o+=1){var d=u[o];if(!d.cancelled&&(d.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Ur.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Pn={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},$a=s.window.HTMLImageElement,Ca=s.window.HTMLElement,Kt=s.window.ImageBitmap,ei={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ms=function(n){function a(u){var d=this;if((u=s.extend({},ei,u)).minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var _=new Qt(u.minZoom,u.maxZoom,u.minPitch,u.maxPitch,u.renderWorldCopies);if(n.call(this,_,u),this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._failIfMajorPerformanceCaveat=u.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=u.preserveDrawingBuffer,this._antialias=u.antialias,this._trackResize=u.trackResize,this._bearingSnap=u.bearingSnap,this._refreshExpiredTiles=u.refreshExpiredTiles,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=u.collectResourceTiming,this._renderTaskQueue=new Ur,this._controls=[],this._mapId=s.uniqueId(),this._locale=s.extend({},Pn,u.locale),this._clickTolerance=u.clickTolerance,this._requestManager=new s.RequestManager(u.transformRequest,u.accessToken),typeof u.container=="string"){if(this._container=s.window.document.getElementById(u.container),!this._container)throw new Error("Container '"+u.container+"' not found.")}else{if(!(u.container instanceof Ca))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return d._update(!1)}),this.on("moveend",function(){return d._update(!1)}),this.on("zoom",function(){return d._update(!0)}),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new ot(this,u),this._hash=u.hash&&new Ui(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,s.extend({},u.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=u.localIdeographFontFamily,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new Bi({customAttribution:u.customAttribution})),this.addControl(new mn,u.logoPosition),this.on("style.load",function(){d.transform.unmodified&&d.jumpTo(d.style.stylesheet)}),this.on("data",function(x){d._update(x.dataType==="style"),d.fire(new s.Event(x.dataType+"data",x))}),this.on("dataloading",function(x){d.fire(new s.Event(x.dataType+"dataloading",x))})}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(u,d){if(d===void 0&&(d=u.getDefaultPosition?u.getDefaultPosition():"top-right"),!u||!u.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var _=u.onAdd(this);this._controls.push(u);var x=this._controlPositions[d];return d.indexOf("bottom")!==-1?x.insertBefore(_,x.firstChild):x.appendChild(_),this},a.prototype.removeControl=function(u){if(!u||!u.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var d=this._controls.indexOf(u);return d>-1&&this._controls.splice(d,1),u.onRemove(this),this},a.prototype.hasControl=function(u){return this._controls.indexOf(u)>-1},a.prototype.resize=function(u){var d=this._containerDimensions(),_=d[0],x=d[1];if(_===this.transform.width&&x===this.transform.height)return this;this._resizeCanvas(_,x),this.transform.resize(_,x),this.painter.resize(_,x);var T=!this._moving;return T&&this.fire(new s.Event("movestart",u)).fire(new s.Event("move",u)),this.fire(new s.Event("resize",u)),T&&this.fire(new s.Event("moveend",u)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(u){return this.transform.setMaxBounds(s.LngLatBounds.convert(u)),this._update()},a.prototype.setMinZoom=function(u){if((u=u==null?-2:u)>=-2&&u<=this.transform.maxZoom)return this.transform.minZoom=u,this._update(),this.getZoom()<u&&this.setZoom(u),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(u){if((u=u==null?22:u)>=this.transform.minZoom)return this.transform.maxZoom=u,this._update(),this.getZoom()>u&&this.setZoom(u),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(u){if((u=u==null?0:u)<0)throw new Error("minPitch must be greater than or equal to 0");if(u>=0&&u<=this.transform.maxPitch)return this.transform.minPitch=u,this._update(),this.getPitch()<u&&this.setPitch(u),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(u){if((u=u==null?60:u)>60)throw new Error("maxPitch must be less than or equal to 60");if(u>=this.transform.minPitch)return this.transform.maxPitch=u,this._update(),this.getPitch()>u&&this.setPitch(u),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(u){return this.transform.renderWorldCopies=u,this._update()},a.prototype.project=function(u){return this.transform.locationPoint(s.LngLat.convert(u))},a.prototype.unproject=function(u){return this.transform.pointLocation(s.Point.convert(u))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(u,d,_){var x,T=this;if(u==="mouseenter"||u==="mouseover"){var z=!1;return{layer:d,listener:_,delegates:{mousemove:function(j){var q=T.getLayer(d)?T.queryRenderedFeatures(j.point,{layers:[d]}):[];q.length?z||(z=!0,_.call(T,new Gr(u,T,j.originalEvent,{features:q}))):z=!1},mouseout:function(){z=!1}}}}if(u==="mouseleave"||u==="mouseout"){var L=!1;return{layer:d,listener:_,delegates:{mousemove:function(j){(T.getLayer(d)?T.queryRenderedFeatures(j.point,{layers:[d]}):[]).length?L=!0:L&&(L=!1,_.call(T,new Gr(u,T,j.originalEvent)))},mouseout:function(j){L&&(L=!1,_.call(T,new Gr(u,T,j.originalEvent)))}}}}return{layer:d,listener:_,delegates:(x={},x[u]=function(j){var q=T.getLayer(d)?T.queryRenderedFeatures(j.point,{layers:[d]}):[];q.length&&(j.features=q,_.call(T,j),delete j.features)},x)}},a.prototype.on=function(u,d,_){if(_===void 0)return n.prototype.on.call(this,u,d);var x=this._createDelegatedListener(u,d,_);for(var T in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[u]=this._delegatedListeners[u]||[],this._delegatedListeners[u].push(x),x.delegates)this.on(T,x.delegates[T]);return this},a.prototype.once=function(u,d,_){if(_===void 0)return n.prototype.once.call(this,u,d);var x=this._createDelegatedListener(u,d,_);for(var T in x.delegates)this.once(T,x.delegates[T]);return this},a.prototype.off=function(u,d,_){var x=this;return _===void 0?n.prototype.off.call(this,u,d):(this._delegatedListeners&&this._delegatedListeners[u]&&function(T){for(var z=T[u],L=0;L<z.length;L++){var j=z[L];if(j.layer===d&&j.listener===_){for(var q in j.delegates)x.off(q,j.delegates[q]);return z.splice(L,1),x}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(u,d){if(!this.style)return[];var _;if(d!==void 0||u===void 0||u instanceof s.Point||Array.isArray(u)||(d=u,u=void 0),d=d||{},(u=u||[[0,0],[this.transform.width,this.transform.height]])instanceof s.Point||typeof u[0]=="number")_=[s.Point.convert(u)];else{var x=s.Point.convert(u[0]),T=s.Point.convert(u[1]);_=[x,new s.Point(T.x,x.y),T,new s.Point(x.x,T.y),x]}return this.style.queryRenderedFeatures(_,d,this.transform)},a.prototype.querySourceFeatures=function(u,d){return this.style.querySourceFeatures(u,d)},a.prototype.setStyle=function(u,d){return(d=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},d)).diff!==!1&&d.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&u?(this._diffStyle(u,d),this):(this._localIdeographFontFamily=d.localIdeographFontFamily,this._updateStyle(u,d))},a.prototype._getUIString=function(u){var d=this._locale[u];if(d==null)throw new Error("Missing UI string '"+u+"'");return d},a.prototype._updateStyle=function(u,d){return this.style&&(this.style.setEventedParent(null),this.style._remove()),u?(this.style=new Tn(this,d||{}),this.style.setEventedParent(this,{style:this.style}),typeof u=="string"?this.style.loadURL(u):this.style.loadJSON(u),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Tn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(u,d){var _=this;if(typeof u=="string"){var x=this._requestManager.normalizeStyleURL(u),T=this._requestManager.transformRequest(x,s.ResourceType.Style);s.getJSON(T,function(z,L){z?_.fire(new s.ErrorEvent(z)):L&&_._updateDiff(L,d)})}else typeof u=="object"&&this._updateDiff(u,d)},a.prototype._updateDiff=function(u,d){try{this.style.setState(u)&&this._update(!0)}catch(_){s.warnOnce("Unable to perform style diff: "+(_.message||_.error||_)+".  Rebuilding the style from scratch."),this._updateStyle(u,d)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():s.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(u,d){return this._lazyInitEmptyStyle(),this.style.addSource(u,d),this._update(!0)},a.prototype.isSourceLoaded=function(u){var d=this.style&&this.style.sourceCaches[u];if(d!==void 0)return d.loaded();this.fire(new s.ErrorEvent(new Error("There is no source with ID '"+u+"'")))},a.prototype.areTilesLoaded=function(){var u=this.style&&this.style.sourceCaches;for(var d in u){var _=u[d]._tiles;for(var x in _){var T=_[x];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0},a.prototype.addSourceType=function(u,d,_){return this._lazyInitEmptyStyle(),this.style.addSourceType(u,d,_)},a.prototype.removeSource=function(u){return this.style.removeSource(u),this._update(!0)},a.prototype.getSource=function(u){return this.style.getSource(u)},a.prototype.addImage=function(u,d,_){_===void 0&&(_={});var x=_.pixelRatio;x===void 0&&(x=1);var T=_.sdf;T===void 0&&(T=!1);var z=_.stretchX,L=_.stretchY,j=_.content;if(this._lazyInitEmptyStyle(),d instanceof $a||Kt&&d instanceof Kt){var q=s.browser.getImageData(d);this.style.addImage(u,{data:new s.RGBAImage({width:q.width,height:q.height},q.data),pixelRatio:x,stretchX:z,stretchY:L,content:j,sdf:T,version:0})}else{if(d.width===void 0||d.height===void 0)return this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Z=d;this.style.addImage(u,{data:new s.RGBAImage({width:d.width,height:d.height},new Uint8Array(d.data)),pixelRatio:x,stretchX:z,stretchY:L,content:j,sdf:T,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,u)}},a.prototype.updateImage=function(u,d){var _=this.style.getImage(u);if(!_)return this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var x=d instanceof $a||Kt&&d instanceof Kt?s.browser.getImageData(d):d,T=x.width,z=x.height,L=x.data;return T===void 0||z===void 0?this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):T!==_.data.width||z!==_.data.height?this.fire(new s.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(_.data.replace(L,!(d instanceof $a||Kt&&d instanceof Kt)),void this.style.updateImage(u,_))},a.prototype.hasImage=function(u){return u?!!this.style.getImage(u):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(u){this.style.removeImage(u)},a.prototype.loadImage=function(u,d){s.getImage(this._requestManager.transformRequest(u,s.ResourceType.Image),d)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(u,d){return this._lazyInitEmptyStyle(),this.style.addLayer(u,d),this._update(!0)},a.prototype.moveLayer=function(u,d){return this.style.moveLayer(u,d),this._update(!0)},a.prototype.removeLayer=function(u){return this.style.removeLayer(u),this._update(!0)},a.prototype.getLayer=function(u){return this.style.getLayer(u)},a.prototype.setLayerZoomRange=function(u,d,_){return this.style.setLayerZoomRange(u,d,_),this._update(!0)},a.prototype.setFilter=function(u,d,_){return _===void 0&&(_={}),this.style.setFilter(u,d,_),this._update(!0)},a.prototype.getFilter=function(u){return this.style.getFilter(u)},a.prototype.setPaintProperty=function(u,d,_,x){return x===void 0&&(x={}),this.style.setPaintProperty(u,d,_,x),this._update(!0)},a.prototype.getPaintProperty=function(u,d){return this.style.getPaintProperty(u,d)},a.prototype.setLayoutProperty=function(u,d,_,x){return x===void 0&&(x={}),this.style.setLayoutProperty(u,d,_,x),this._update(!0)},a.prototype.getLayoutProperty=function(u,d){return this.style.getLayoutProperty(u,d)},a.prototype.setLight=function(u,d){return d===void 0&&(d={}),this._lazyInitEmptyStyle(),this.style.setLight(u,d),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(u,d){return this.style.setFeatureState(u,d),this._update()},a.prototype.removeFeatureState=function(u,d){return this.style.removeFeatureState(u,d),this._update()},a.prototype.getFeatureState=function(u){return this.style.getFeatureState(u)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var u=0,d=0;return this._container&&(u=this._container.clientWidth||400,d=this._container.clientHeight||300),[u,d]},a.prototype._detectMissingCSS=function(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var u=this._container;u.classList.add("mapboxgl-map"),(this._missingCSSCanary=A.create("div","mapboxgl-canary",u)).style.visibility="hidden",this._detectMissingCSS();var d=this._canvasContainer=A.create("div","mapboxgl-canvas-container",u);this._interactive&&d.classList.add("mapboxgl-interactive"),this._canvas=A.create("canvas","mapboxgl-canvas",d),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var _=this._containerDimensions();this._resizeCanvas(_[0],_[1]);var x=this._controlContainer=A.create("div","mapboxgl-control-container",u),T=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(z){T[z]=A.create("div","mapboxgl-ctrl-"+z,x)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},a.prototype._resizeCanvas=function(u,d){var _=s.browser.devicePixelRatio||1;this._canvas.width=_*u,this._canvas.height=_*d,this._canvas.style.width=u+"px",this._canvas.style.height=d+"px"},a.prototype._setupPainter=function(){var u=s.extend({},M.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),d=this._canvas.getContext("webgl",u)||this._canvas.getContext("experimental-webgl",u);d?(this.painter=new Nr(d,this.transform),s.webpSupported.testSupport(d)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(u){u.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:u}))},a.prototype._contextRestored=function(u){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:u}))},a.prototype._onMapScroll=function(u){if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(u){return this.style?(this._styleDirty=this._styleDirty||u,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(u){return this._update(),this._renderTaskQueue.add(u)},a.prototype._cancelRenderFrame=function(u){this._renderTaskQueue.remove(u)},a.prototype._render=function(u){var d,_=this,x=0,T=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(d=T.createQueryEXT(),T.beginQueryEXT(T.TIME_ELAPSED_EXT,d),x=s.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(u),!this._removed){var z=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var L=this.transform.zoom,j=s.browser.now();this.style.zoomHistory.update(L,j);var q=new s.EvaluationParameters(L,{now:j,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Z=q.crossFadingFactor();Z===1&&Z===this._crossFadingFactor||(z=!0,this._crossFadingFactor=Z),this.style.update(q)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&(this.style.hasTransitions()||z)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var J=s.browser.now()-x;T.endQueryEXT(T.TIME_ELAPSED_EXT,d),setTimeout(function(){var Y=T.getQueryObjectEXT(d,T.QUERY_RESULT_EXT)/1e6;T.deleteQueryEXT(d),_.fire(new s.Event("gpu-timing-frame",{cpuTime:J,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){var Q=this.painter.collectGpuTimers();setTimeout(function(){var Y=_.painter.queryGpuTimers(Q);_.fire(new s.Event("gpu-timing-layer",{layerTimes:Y}))},50)}var oe=this._sourcesDirty||this._styleDirty||this._placementDirty;return oe||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.Event("idle")),!this._loaded||this._fullyLoaded||oe||(this._fullyLoaded=!0),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var u=0,d=this._controls;u<d.length;u+=1)d[u].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1));var _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),Uo(this._canvasContainer),Uo(this._controlContainer),Uo(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new s.Event("remove"))},a.prototype.triggerRepaint=function(){var u=this;this.style&&!this._frame&&(this._frame=s.browser.frame(function(d){u._frame=null,u._render(d)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(u){this._trackResize&&this.resize({originalEvent:u})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(u){this._showTileBoundaries!==u&&(this._showTileBoundaries=u,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(u){this._showPadding!==u&&(this._showPadding=u,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(u){this._showCollisionBoxes!==u&&(this._showCollisionBoxes=u,u?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(u){this._showOverdrawInspector!==u&&(this._showOverdrawInspector=u,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(u){this._repaint!==u&&(this._repaint=u,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(u){this._vertices=u,this._update()},a.prototype._setCacheLimits=function(u,d){s.setCacheLimits(u,d)},o.version.get=function(){return s.version},Object.defineProperties(a.prototype,o),a}(co);function Uo(n){n.parentNode&&n.parentNode.removeChild(n)}var Vl={showCompass:!0,showZoom:!0,visualizePitch:!1},Ma=function(n){var a=this;this.options=s.extend({},Vl,n),this._container=A.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return a._map.zoomIn({},{originalEvent:o})}),A.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return a._map.zoomOut({},{originalEvent:o})}),A.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){a.options.visualizePitch?a._map.resetNorthPitch({},{originalEvent:o}):a._map.resetNorth({},{originalEvent:o})}),this._compassIcon=A.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ma.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),a=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},Ma.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Ma.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Xn(this._map,this._compass,this.options.visualizePitch)),this._container},Ma.prototype.onRemove=function(){A.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ma.prototype._createButton=function(n,a){var o=A.create("button",n,this._container);return o.type="button",o.addEventListener("click",a),o},Ma.prototype._setButtonTitle=function(n,a){var o=this._map._getUIString("NavigationControl."+a);n.title=o,n.setAttribute("aria-label",o)};var Xn=function(n,a,o){o===void 0&&(o=!1),this._clickTolerance=10,this.element=a,this.mouseRotate=new Pa({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new ds({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),A.addEventListener(a,"mousedown",this.mousedown),A.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),A.addEventListener(a,"touchmove",this.touchmove),A.addEventListener(a,"touchend",this.touchend),A.addEventListener(a,"touchcancel",this.reset)};function ha(n,a,o){if(n=new s.LngLat(n.lng,n.lat),a){var u=new s.LngLat(n.lng-360,n.lat),d=new s.LngLat(n.lng+360,n.lat),_=o.locationPoint(n).distSqr(a);o.locationPoint(u).distSqr(a)<_?n=u:o.locationPoint(d).distSqr(a)<_&&(n=d)}for(;Math.abs(n.lng-o.center.lng)>180;){var x=o.locationPoint(n);if(x.x>=0&&x.y>=0&&x.x<=o.width&&x.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}Xn.prototype.down=function(n,a){this.mouseRotate.mousedown(n,a),this.mousePitch&&this.mousePitch.mousedown(n,a),A.disableDrag()},Xn.prototype.move=function(n,a){var o=this.map,u=this.mouseRotate.mousemoveWindow(n,a);if(u&&u.bearingDelta&&o.setBearing(o.getBearing()+u.bearingDelta),this.mousePitch){var d=this.mousePitch.mousemoveWindow(n,a);d&&d.pitchDelta&&o.setPitch(o.getPitch()+d.pitchDelta)}},Xn.prototype.off=function(){var n=this.element;A.removeEventListener(n,"mousedown",this.mousedown),A.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),A.removeEventListener(n,"touchmove",this.touchmove),A.removeEventListener(n,"touchend",this.touchend),A.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},Xn.prototype.offTemp=function(){A.enableDrag(),A.removeEventListener(s.window,"mousemove",this.mousemove),A.removeEventListener(s.window,"mouseup",this.mouseup)},Xn.prototype.mousedown=function(n){this.down(s.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),A.mousePos(this.element,n)),A.addEventListener(s.window,"mousemove",this.mousemove),A.addEventListener(s.window,"mouseup",this.mouseup)},Xn.prototype.mousemove=function(n){this.move(n,A.mousePos(this.element,n))},Xn.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},Xn.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=A.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},Xn.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=A.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},Xn.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Xn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var nn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function dl(n,a,o){var u=n.classList;for(var d in nn)u.remove("mapboxgl-"+o+"-anchor-"+d);u.add("mapboxgl-"+o+"-anchor-"+a)}var jo,Zs=function(n){function a(o,u){if(n.call(this),(o instanceof s.window.HTMLElement||u)&&(o=s.extend({element:o},u)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=s.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=A.create("div"),this._element.setAttribute("aria-label","Map marker");var d=A.createNS("http://www.w3.org/2000/svg","svg");d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height","41px"),d.setAttributeNS(null,"width","27px"),d.setAttributeNS(null,"viewBox","0 0 27 41");var _=A.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");var x=A.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");var T=A.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");for(var z=0,L=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];z<L.length;z+=1){var j=L[z],q=A.createNS("http://www.w3.org/2000/svg","ellipse");q.setAttributeNS(null,"opacity","0.04"),q.setAttributeNS(null,"cx","10.5"),q.setAttributeNS(null,"cy","5.80029008"),q.setAttributeNS(null,"rx",j.rx),q.setAttributeNS(null,"ry",j.ry),T.appendChild(q)}var Z=A.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"fill",this._color);var J=A.createNS("http://www.w3.org/2000/svg","path");J.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Z.appendChild(J);var Q=A.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"opacity","0.25"),Q.setAttributeNS(null,"fill","#000000");var oe=A.createNS("http://www.w3.org/2000/svg","path");oe.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Q.appendChild(oe);var Y=A.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");var ae=A.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(8.0, 8.0)");var he=A.createNS("http://www.w3.org/2000/svg","circle");he.setAttributeNS(null,"fill","#000000"),he.setAttributeNS(null,"opacity","0.25"),he.setAttributeNS(null,"cx","5.5"),he.setAttributeNS(null,"cy","5.5"),he.setAttributeNS(null,"r","5.4999962");var ye=A.createNS("http://www.w3.org/2000/svg","circle");ye.setAttributeNS(null,"fill","#FFFFFF"),ye.setAttributeNS(null,"cx","5.5"),ye.setAttributeNS(null,"cy","5.5"),ye.setAttributeNS(null,"r","5.4999962"),ae.appendChild(he),ae.appendChild(ye),x.appendChild(T),x.appendChild(Z),x.appendChild(Q),x.appendChild(Y),x.appendChild(ae),d.appendChild(x),d.setAttributeNS(null,"height",41*this._scale+"px"),d.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(d),this._offset=s.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Te){Te.preventDefault()}),this._element.addEventListener("mousedown",function(Te){Te.preventDefault()}),dl(this._element,this._anchor,"marker"),this._popup=null}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),A.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(o){return this._lngLat=s.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var u=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(24.6+u)],"bottom-right":[-u,-1*(24.6+u)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(o){var u=o.code,d=o.charCode||o.keyCode;u!=="Space"&&u!=="Enter"&&d!==32&&d!==13||this.togglePopup()},a.prototype._onMapClick=function(o){var u=o.originalEvent.target,d=this._element;this._popup&&(u===d||d.contains(u))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},a.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ha(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var u="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?u="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(u="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var d="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?d="rotateX(0deg)":this._pitchAlignment==="map"&&(d="rotateX("+this._map.getPitch()+"deg)"),o&&o.type!=="moveend"||(this._pos=this._pos.round()),A.setTransform(this._element,nn[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+d+" "+u)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(o){return this._offset=s.Point.convert(o),this._update(),this},a.prototype._onMove=function(o){if(!this._isDragging){var u=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag")))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(s.Evented),ml={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Gs=0,ys=!1,Nl=function(n){function a(o){n.call(this),this.options=s.extend({},ml,o),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.onAdd=function(o){var u;return this._map=o,this._container=A.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),u=this._setupUI,jo!==void 0?u(jo):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(function(d){u(jo=d.state!=="denied")}):u(jo=!!s.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),A.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Gs=0,ys=!1},a.prototype._isOutOfMapMaxBounds=function(o){var u=this._map.getMaxBounds(),d=o.coords;return u&&(d.longitude<u.getWest()||d.longitude>u.getEast()||d.latitude<u.getSouth()||d.latitude>u.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",o)),this._finish()}},a.prototype._updateCamera=function(o){var u=new s.LngLat(o.coords.longitude,o.coords.latitude),d=o.coords.accuracy,_=this._map.getBearing(),x=s.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(d),x,{geolocateSource:!0})},a.prototype._updateMarker=function(o){if(o){var u=new s.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,u=this._map.unproject([0,o]),d=this._map.unproject([1,o]),_=u.distanceTo(d),x=Math.ceil(2*this._accuracy/_);this._circleElement.style.width=x+"px",this._circleElement.style.height=x+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&ys)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",o)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(o){var u=this;if(this._container.addEventListener("contextmenu",function(x){return x.preventDefault()}),this._geolocateButton=A.create("button","mapboxgl-ctrl-geolocate",this._container),A.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",o===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{var _=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=_,this._geolocateButton.setAttribute("aria-label",_)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Zs(this._dotElement),this._circleElement=A.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Zs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(x){x.geolocateSource||u._watchState!=="ACTIVE_LOCK"||x.originalEvent&&x.originalEvent.type==="resize"||(u._watchState="BACKGROUND",u._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),u._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),u.fire(new s.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Gs--,ys=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Gs>1?(o={maximumAge:6e5,timeout:0},ys=!0):(o=this.options.positionOptions,ys=!1),this._geolocationWatchID=s.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else s.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(s.Evented),es={maxWidth:100,unit:"metric"},ho=function(n){this.options=s.extend({},es,n),s.bindAll(["_onMove","setUnit"],this)};function yl(n,a,o){var u=o&&o.maxWidth||100,d=n._container.clientHeight/2,_=n.unproject([0,d]),x=n.unproject([u,d]),T=_.distanceTo(x);if(o&&o.unit==="imperial"){var z=3.2808*T;z>5280?Da(a,u,z/5280,n._getUIString("ScaleControl.Miles")):Da(a,u,z,n._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Da(a,u,T/1852,n._getUIString("ScaleControl.NauticalMiles")):T>=1e3?Da(a,u,T/1e3,n._getUIString("ScaleControl.Kilometers")):Da(a,u,T,n._getUIString("ScaleControl.Meters"))}function Da(n,a,o,u){var d,_,x,T=(d=o,(_=Math.pow(10,(""+Math.floor(d)).length-1))*(x=(x=d/_)>=10?10:x>=5?5:x>=3?3:x>=2?2:x>=1?1:function(z){var L=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*L)/L}(x)));n.style.width=a*(T/o)+"px",n.innerHTML=T+"&nbsp;"+u}ho.prototype.getDefaultPosition=function(){return"bottom-left"},ho.prototype._onMove=function(){yl(this._map,this._container,this.options)},ho.prototype.onAdd=function(n){return this._map=n,this._container=A.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ho.prototype.onRemove=function(){A.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ho.prototype.setUnit=function(n){this.options.unit=n,yl(this._map,this._container,this.options)};var qo=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof s.window.HTMLElement?this._container=n.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in s.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in s.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in s.window.document&&(this._fullscreenchange="MSFullscreenChange")};qo.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=A.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},qo.prototype.onRemove=function(){A.remove(this._controlContainer),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},qo.prototype._checkFullscreenSupport=function(){return!!(s.window.document.fullscreenEnabled||s.window.document.mozFullScreenEnabled||s.window.document.msFullscreenEnabled||s.window.document.webkitFullscreenEnabled)},qo.prototype._setupUI=function(){var n=this._fullscreenButton=A.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);A.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},qo.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},qo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},qo.prototype._isFullscreen=function(){return this._fullscreen},qo.prototype._changeIcon=function(){(s.window.document.fullscreenElement||s.window.document.mozFullScreenElement||s.window.document.webkitFullscreenElement||s.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},qo.prototype._onClickFullscreen=function(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.mozCancelFullScreen?s.window.document.mozCancelFullScreen():s.window.document.msExitFullscreen?s.window.document.msExitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Ul={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ks=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),jl=function(n){function a(o){n.call(this),this.options=s.extend(Object.create(Ul),o),s.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new s.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&A.remove(this._content),this._container&&(A.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new s.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(o){return this._lngLat=s.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(o){return this.setDOMContent(s.window.document.createTextNode(o))},a.prototype.setHTML=function(o){var u,d=s.window.document.createDocumentFragment(),_=s.window.document.createElement("body");for(_.innerHTML=o;u=_.firstChild;)d.appendChild(u);return this.setDOMContent(d)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},a.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=A.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},a.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},a.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},a.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},a.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},a.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=A.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(o){this._update(o.point)},a.prototype._onMouseMove=function(o){this._update(o.point)},a.prototype._onDrag=function(o){this._update(o.point)},a.prototype._update=function(o){var u=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=A.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=A.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(q){return u._container.classList.add(q)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ha(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var d=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),_=this.options.anchor,x=function q(Z){if(Z){if(typeof Z=="number"){var J=Math.round(Math.sqrt(.5*Math.pow(Z,2)));return{center:new s.Point(0,0),top:new s.Point(0,Z),"top-left":new s.Point(J,J),"top-right":new s.Point(-J,J),bottom:new s.Point(0,-Z),"bottom-left":new s.Point(J,-J),"bottom-right":new s.Point(-J,-J),left:new s.Point(Z,0),right:new s.Point(-Z,0)}}if(Z instanceof s.Point||Array.isArray(Z)){var Q=s.Point.convert(Z);return{center:Q,top:Q,"top-left":Q,"top-right":Q,bottom:Q,"bottom-left":Q,"bottom-right":Q,left:Q,right:Q}}return{center:s.Point.convert(Z.center||[0,0]),top:s.Point.convert(Z.top||[0,0]),"top-left":s.Point.convert(Z["top-left"]||[0,0]),"top-right":s.Point.convert(Z["top-right"]||[0,0]),bottom:s.Point.convert(Z.bottom||[0,0]),"bottom-left":s.Point.convert(Z["bottom-left"]||[0,0]),"bottom-right":s.Point.convert(Z["bottom-right"]||[0,0]),left:s.Point.convert(Z.left||[0,0]),right:s.Point.convert(Z.right||[0,0])}}return q(new s.Point(0,0))}(this.options.offset);if(!_){var T,z=this._container.offsetWidth,L=this._container.offsetHeight;T=d.y+x.bottom.y<L?["top"]:d.y>this._map.transform.height-L?["bottom"]:[],d.x<z/2?T.push("left"):d.x>this._map.transform.width-z/2&&T.push("right"),_=T.length===0?"bottom":T.join("-")}var j=d.add(x[_]).round();A.setTransform(this._container,nn[_]+" translate("+j.x+"px,"+j.y+"px)"),dl(this._container,_,"popup")}},a.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(Ks);o&&o.focus()}},a.prototype._onClose=function(){this.remove()},a}(s.Evented),pa={version:s.version,supported:M,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:ms,NavigationControl:Ma,GeolocateControl:Nl,AttributionControl:Bi,ScaleControl:ho,FullscreenControl:qo,Popup:jl,Marker:Zs,Style:Tn,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,Evented:s.Evented,config:s.config,prewarm:function(){Se().acquire(be)},clearPrewarmedResources:function(){var n=et;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(be),et=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(n){s.config.ACCESS_TOKEN=n},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(n){s.config.API_URL=n},get workerCount(){return Be.workerCount},set workerCount(n){Be.workerCount=n},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){s.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){s.clearTileCache(n)},workerUrl:""};return pa}),S})})(kc);const b0=kc.exports;function fm(c){let p;const m=c[15].default,v=zc(m,c,c[14],null);return{c(){v&&v.c()},l(S){v&&v.l(S)},m(S,E){v&&v.m(S,E),p=!0},p(S,E){v&&v.p&&(!p||E&16384)&&Ac(v,m,S,S[14],p?Cc(m,S[14],E,null):Pc(S[14]),null)},i(S){p||(jt(v,S),p=!0)},o(S){tr(v,S),p=!1},d(S){v&&v.d(S)}}}function w0(c){let p,m,v,S=c[0]&&fm(c);return{c(){p=Ie("div"),S&&S.c(),this.h()},l(E){p=ke(E,"DIV",{class:!0,id:!0});var s=we(p);S&&S.l(s),s.forEach(se),this.h()},h(){X(p,"class","absolute top-0 bg-grey4 w-full h-full svelte-a65d1y"),X(p,"id",c[1]),Rh(()=>c[16].call(p))},m(E,s){dt(E,p,s),S&&S.m(p,null),m=Bh(p,c[16].bind(p)),c[17](p),v=!0},p(E,[s]){E[0]?S?(S.p(E,s),s&1&&jt(S,1)):(S=fm(E),S.c(),jt(S,1),S.m(p,null)):S&&(fu(),tr(S,1,1,()=>{S=null}),du()),(!v||s&2)&&X(p,"id",E[1])},i(E){v||(jt(S),v=!0)},o(E){tr(S),v=!1},d(E){E&&se(p),S&&S.d(),m(),c[17](null)}}}function S0(c,p,m){let{$$slots:v={},$$scope:S}=p,{map:E}=p,{id:s="map"}=p,{location:M={bounds:[[-8.1775,54.02275],[-5.43279,55.31298]]}}=p,{style:A="https://raw.githubusercontent.com/nisra-explore/map_tiles/main/basemap_styles/style-omt.json"}=p,{interactive:V=!0}=p,{minzoom:N=0}=p,{maxzoom:W=14}=p,{zoom:K=null}=p,{scrollzoom:H=!0}=p,{geolocate:fe=!0}=p,{zoomcontrol:Oe=!0}=p,{options:ze={}}=p,Ke,Xe;Am("map",{getMap:()=>E}),M.bounds?ze={...ze,bounds:M.bounds}:M.lon&&M.lat&&(ze={...ze,center:[M.lon,M.lat]},M.zoom&&(ze.zoom=M.zoom)),zm(()=>{const He=document.createElement("link");return He.rel="stylesheet",He.href="https://unpkg.com/mapbox-gl@1.13.0/dist/mapbox-gl.css",He.onload=()=>{m(0,E=new kc.exports.Map({container:Ke,style:A,minZoom:N,maxZoom:W,interactive:V,...ze})),Oe&&E.addControl(new kc.exports.NavigationControl({showCompass:!1})),H||E.scrollZoom.disable(),fe&&E.addControl(new kc.exports.GeolocateControl),E.on("load",()=>{m(4,K=E.getZoom())}),E.on("zoom",()=>{m(4,K=E.getZoom())})},document.head.appendChild(He),()=>{E.remove(),He.parentNode.removeChild(He)}});function Ft(){let He=document.getElementsByClassName("mapboxgl-canvas");He[0]&&(He[0].style.width="100%",E.resize())}function Lt(){Xe=this.clientWidth,m(2,Xe)}function ft(He){Tl[He?"unshift":"push"](()=>{Ke=He,m(3,Ke)})}return c.$$set=He=>{"map"in He&&m(0,E=He.map),"id"in He&&m(1,s=He.id),"location"in He&&m(6,M=He.location),"style"in He&&m(7,A=He.style),"interactive"in He&&m(8,V=He.interactive),"minzoom"in He&&m(9,N=He.minzoom),"maxzoom"in He&&m(10,W=He.maxzoom),"zoom"in He&&m(4,K=He.zoom),"scrollzoom"in He&&m(11,H=He.scrollzoom),"geolocate"in He&&m(12,fe=He.geolocate),"zoomcontrol"in He&&m(13,Oe=He.zoomcontrol),"options"in He&&m(5,ze=He.options),"$$scope"in He&&m(14,S=He.$$scope)},c.$$.update=()=>{c.$$.dirty&4&&Xe&&Ft()},[E,s,Xe,Ke,K,ze,M,A,V,N,W,H,fe,Oe,S,v,Lt,ft]}class E0 extends rs{constructor(p){super(),is(this,p,S0,w0,ns,{map:0,id:1,location:6,style:7,interactive:8,minzoom:9,maxzoom:10,zoom:4,scrollzoom:11,geolocate:12,zoomcontrol:13,options:5})}}function dm(c){let p;const m=c[11].default,v=zc(m,c,c[10],null);return{c(){v&&v.c()},l(S){v&&v.l(S)},m(S,E){v&&v.m(S,E),p=!0},p(S,E){v&&v.p&&(!p||E&1024)&&Ac(v,m,S,S[10],p?Cc(m,S[10],E,null):Pc(S[10]),null)},i(S){p||(jt(v,S),p=!0)},o(S){tr(v,S),p=!1},d(S){v&&v.d(S)}}}function T0(c){let p,m,v=c[0]&&dm(c);return{c(){v&&v.c(),p=un()},l(S){v&&v.l(S),p=un()},m(S,E){v&&v.m(S,E),dt(S,p,E),m=!0},p(S,[E]){S[0]?v?(v.p(S,E),E&1&&jt(v,1)):(v=dm(S),v.c(),jt(v,1),v.m(p.parentNode,p)):v&&(fu(),tr(v,1,1,()=>{v=null}),du())},i(S){m||(jt(v),m=!0)},o(S){tr(v),m=!1},d(S){v&&v.d(S),S&&se(p)}}}function I0(c,p,m){let{$$slots:v={},$$scope:S}=p,{id:E}=p,{type:s}=p,{url:M=null}=p,{props:A={}}=p,{data:V=null}=p,{layer:N=null}=p,{promoteId:W=null}=p,{minzoom:K=null}=p,{maxzoom:H=null}=p,fe=!1;const{getMap:Oe}=Rc("map"),ze=Oe();ze.getSource(E)&&ze.removeSource(E);function Ke(){ze.isSourceLoaded(E)?(m(0,fe=!0),console.log(E+" loaded!")):setTimeout(()=>{console.log("..."),Ke()},500)}function Xe(){ze.isStyleLoaded(E)?(Ft(),document.querySelector("#map canvas")&&document.querySelector("#map canvas").tabIndex=="0"&&(document.querySelector("#map canvas").tabIndex="-1")):setTimeout(()=>{console.log("..."),Xe()},500)}K&&(A.minzoom=K),H&&(A.maxzoom=H),N&&W?(A.promoteId={},A.promoteId[N]=W):W&&(A.promoteId=W);function Ft(){console.log(E+" map source loading..."),s=="geojson"?V?(ze.addSource(E,{type:s,data:V,...A}),Ke()):M&&(ze.addSource(E,{type:s,data:M,...A}),Ke()):s=="vector"&&(ze.addSource(E,{type:s,tiles:[M],...A}),Ke())}Xe();function Lt(){ze.getSource(E).setData(V)}return c.$$set=ft=>{"id"in ft&&m(2,E=ft.id),"type"in ft&&m(3,s=ft.type),"url"in ft&&m(4,M=ft.url),"props"in ft&&m(1,A=ft.props),"data"in ft&&m(5,V=ft.data),"layer"in ft&&m(6,N=ft.layer),"promoteId"in ft&&m(7,W=ft.promoteId),"minzoom"in ft&&m(8,K=ft.minzoom),"maxzoom"in ft&&m(9,H=ft.maxzoom),"$$scope"in ft&&m(10,S=ft.$$scope)},c.$$.update=()=>{c.$$.dirty&33&&fe&&V&&Lt()},[fe,A,E,s,M,V,N,W,K,H,S,v]}class Qm extends rs{constructor(p){super(),is(this,p,I0,T0,ns,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9})}}function k0(c,p,m){const{Popup:v}=b0,S=Pm(),E=new v({closeButton:!1,closeOnClick:!1});let{id:s}=p,{source:M}=p,{sourceLayer:A=null}=p,{type:V}=p,{filter:N=null}=p,{layout:W={}}=p,{paint:K={}}=p,{data:H=null}=p,{code:fe=null}=p,{name:Oe="name"}=p,{colorCode:ze=null}=p,{click:Ke=!1}=p,{ignoreClick:Xe=!1}=p,{clickCenter:Ft=!1}=p,{selected:Lt=null}=p,{hover:ft=!1}=p,{hovered:He=null}=p,{highlight:xr=!1}=p,{highlightKey:cr="highlighted"}=p,{highlighted:Wt=[]}=p,{order:Ht=null}=p,{maxzoom:qe=null}=p,{minzoom:mr=null}=p,{isChild:It=!1}=p;const{getMap:rr}=Rc("map"),it=rr();let hr=null,Or=null,kt=[];it.getLayer(s)&&it.removeLayer(s);let er={id:s,type:V,source:M,paint:K,layout:W};N&&(er.filter=N),A&&(er["source-layer"]=A),qe&&(er.maxzoom=qe),mr&&(er.minzoom=mr),it.addLayer(er,Ht);function nt(){console.log("updating colors..."),H.forEach(Ze=>{it.setFeatureState({source:M,sourceLayer:A,id:Ze[fe]},{color:Ze[ze]})})}return Ke&&it.on("click",s,Ze=>{if(Ze.features.length>0&&!Xe){let lr=Ze.features[0].id;if(It&&Wt.includes(lr)||!It&&Lt!=lr){if(m(0,Lt=lr),S("select",{code:Lt}),hr&&it.setFeatureState({source:M,sourceLayer:A,id:hr},{selected:!1}),it.setFeatureState({source:M,sourceLayer:A,id:Lt},{selected:!0}),Ft){let br=centroid(Ze.features[0].toJSON().geometry);it.flyTo({center:br.geometry.coordinates})}m(24,hr=Lt)}}}),ft&&(it.on("mousemove",s,Ze=>{if(Ze.features.length>0){let lr=Ze.features[0].id;He&&it.setFeatureState({source:M,sourceLayer:A,id:He},{hovered:!1}),It&&Wt.includes(lr)||!It&&Lt!=lr?(m(1,He=m(25,Or=lr)),it.setFeatureState({source:M,sourceLayer:A,id:He},{hovered:!0}),it.getCanvas().style.cursor="pointer",E.setLngLat(Ze.lngLat).setHTML(`<strong>${Ze.features[0].properties[Oe]?Ze.features[0].properties[Oe]:Ze.features[0].properties[fe]}</strong>`).addTo(it)):E.remove()}}),it.on("mouseleave",s,Ze=>{He&&it.setFeatureState({source:M,sourceLayer:A,id:He},{hovered:!1}),m(1,He=m(25,Or=null)),it.getCanvas().style.cursor="",E.remove()})),c.$$set=Ze=>{"id"in Ze&&m(2,s=Ze.id),"source"in Ze&&m(3,M=Ze.source),"sourceLayer"in Ze&&m(4,A=Ze.sourceLayer),"type"in Ze&&m(5,V=Ze.type),"filter"in Ze&&m(6,N=Ze.filter),"layout"in Ze&&m(7,W=Ze.layout),"paint"in Ze&&m(8,K=Ze.paint),"data"in Ze&&m(9,H=Ze.data),"code"in Ze&&m(10,fe=Ze.code),"name"in Ze&&m(11,Oe=Ze.name),"colorCode"in Ze&&m(12,ze=Ze.colorCode),"click"in Ze&&m(13,Ke=Ze.click),"ignoreClick"in Ze&&m(14,Xe=Ze.ignoreClick),"clickCenter"in Ze&&m(15,Ft=Ze.clickCenter),"selected"in Ze&&m(0,Lt=Ze.selected),"hover"in Ze&&m(16,ft=Ze.hover),"hovered"in Ze&&m(1,He=Ze.hovered),"highlight"in Ze&&m(17,xr=Ze.highlight),"highlightKey"in Ze&&m(18,cr=Ze.highlightKey),"highlighted"in Ze&&m(19,Wt=Ze.highlighted),"order"in Ze&&m(20,Ht=Ze.order),"maxzoom"in Ze&&m(21,qe=Ze.maxzoom),"minzoom"in Ze&&m(22,mr=Ze.minzoom),"isChild"in Ze&&m(23,It=Ze.isChild)},c.$$.update=()=>{c.$$.dirty[0]&4096&&ze&&nt(),c.$$.dirty[0]&68026392&&xr&&Wt!=kt&&(kt[0]&&kt.forEach(Ze=>{let lr={};lr[cr]=!1,it.setFeatureState({source:M,sourceLayer:A,id:Ze},lr)}),m(26,kt=Wt),Wt[0]&&Wt.forEach(Ze=>{let lr={};lr[cr]=!0,it.setFeatureState({source:M,sourceLayer:A,id:Ze},lr)})),c.$$.dirty[0]&16777241&&Lt!=hr&&(hr&&it.setFeatureState({source:M,sourceLayer:A,id:hr},{selected:!1}),Lt&&it.setFeatureState({source:M,sourceLayer:A,id:Lt},{selected:!0}),m(24,hr=Lt)),c.$$.dirty[0]&33619994&&ft&&He!=Or&&(Or&&it.setFeatureState({source:M,sourceLayer:A,id:Or},{hovered:!1}),He&&it.setFeatureState({source:M,sourceLayer:A,id:He},{hovered:!0}),m(25,Or=He))},[Lt,He,s,M,A,V,N,W,K,H,fe,Oe,ze,Ke,Xe,Ft,ft,xr,cr,Wt,Ht,qe,mr,It,hr,Or,kt]}class Wu extends rs{constructor(p){super(),is(this,p,k0,null,ns,{id:2,source:3,sourceLayer:4,type:5,filter:6,layout:7,paint:8,data:9,code:10,name:11,colorCode:12,click:13,ignoreClick:14,clickCenter:15,selected:0,hover:16,hovered:1,highlight:17,highlightKey:18,highlighted:19,order:20,maxzoom:21,minzoom:22,isChild:23},null,[-1,-1])}}function mm(c,p,m){const v=c.slice();return v[31]=p[m],v[33]=m,v}function ym(c,p,m){const v=c.slice();return v[34]=p[m],v[33]=m,v}function gm(c,p,m){const v=c.slice();return v[36]=p[m],v}function _m(c,p,m){const v=c.slice();return v[36]=p[m],v}function vm(c,p,m){const v=c.slice();return v[34]=p[m],v[33]=m,v}function xm(c){let p,m,v,S,E,s,M=" &gt; ",A,V,N,W,K,H=c[1].name+"",fe,Oe,ze,Ke,Xe,Ft,Lt,ft,He,xr,cr,Wt,Ht,qe,mr,It,rr,it,hr,Or,kt,er,nt,Ze,lr,br,Yi,Qi,Ni,Gt,_r,Rt,kr,xn,bn,qt,wn=c[1].name+"",Ei,Ci,Yn=c[1].name+"",Zi,Qn,hi=cu[c[1].type].name.toLowerCase()+"",cn,Bn,Mi,Fr,Yr,Xr,go,On,ya=" &#x24D8; ",Co,hn,$n,_o,Mo,$i,eo=c[1].data.births.value[2020].toLocaleString()+"",vo,Ho,Jo,Ti,Qr,Ii,xo,en,Dr=" &#x24D8; ",C,R,O,G,ee,le,ce=c[1].data.deaths.value[2020].toLocaleString()+"",F,re,me,Ce,Le,be,Be,et,Qe=c[1].name+"",Se,Je,Ne,Ge,At,je,Pt,ar,Ct,Vt,Mt,oi,Jt=c[1].name+"",zr,or,Bt,Zt,pi,tn,Cr,ai=(c[1].children[0]?cu[c[1].children[0].type].pl:"Areas")+"",Yo,Do,Ar=c[1].name+"",bo,fi,Wr,di,wr,pn,mi,Qo,yi,Sn,gi=c[1].name+"",si,Fn,ki,sr,to,ro,Vn,al,Lo,Yl=" &#x24D8; ",os,ga,wo,bs,ja,$o,Nn,En,Gi,pe,$r,Di,vr,_a=" &#x24D8; ",Tn,qr,ea,Il,Ql,as,va,sl,Ro,io,xa,kl,ws,ll=" &#x24D8; ",Ss,ss,_i,ul,ba,Un,qa,So,no,Za,Eo,Bo=c[1].name+"",cl,zl,Sr,wa,jn,Sa,Al,ls,_u=" &#x24D8; ",Ga,oo,Oo,Pl,Cl,Ea,Ka,ta,rn,qn,Ml,ra,Vr=" &#x24D8; ",Fs,Es,ia,Dl,$l,Xa,na,us,ao,Zn,To,cs,hs,Vs=" &#x24D8; ",Io,ps,Ts,Ll,Wa,Fo,Ns,Ha,Ta,eu,Ia,Is=c[1].name+"",hl,Rl,Us,Vo,so,oa,ks,fs,zs=" &#x24D8; ",Nr,ka,No,za,Qt,dr,Ui,As,Gn,In,Ja,tu,aa,pl=" &#x24D8; ",sa,Gr,Aa,Bl,li,$e,kn,ko,fn,Ki,zn,Ya,Ye=" &#x24D8; ",fl,Pa,ds,lo,An,la,ua,Kn,Lr,Ol,js;function Fl(_e,Pe){return _e[1].parents[0]?A0:z0}let qs=Fl(c),Li=qs(c),Zr=c[1].type!="ew"&&wm(c);rr=new x0({props:{options:c[0],group:"typestr",search:!0}}),rr.$on("select",c[14]);function Yt(_e){c[24](_e)}let ca={location:{bounds:c[1].bounds},options:{fitBoundsOptions:{padding:20}},style:Lg,$$slots:{default:[M0]},$$scope:{ctx:c}};c[6]!==void 0&&(ca.map=c[6]),Pt=new E0({props:ca}),Tl.push(()=>Cg(Pt,"map",Yt));function zo(_e,Pe){return _e[1].parents[0]?L0:D0}let Ri=zo(c),dn=Ri(c);function Qa(_e,Pe){return _e[1].children[0]?B0:R0}let uo=Qa(c),Hr=uo(c);return Nn=new Ec({props:{data:c[1]&&c[12](["births","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null}}),va=new Ec({props:{data:c[1]&&c[12](["birth_month","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),Un=new Mh({props:{data:c[1]&&c[12](["place_of_death","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),Ea=new Mh({props:{data:c[1]&&c[12](["cause_of_death","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),na=new Ec({props:{data:c[1]&&c[12](["age_at_death","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),Fo=new Mh({props:{data:c[1]&&c[12](["place_of_death","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),Ui=new Ec({props:{data:c[1]&&c[12](["marriage_month","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),$e=new Mh({props:{data:c[1]&&c[12](["place_of_marriage","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),ua=new Ec({props:{data:c[1]&&c[12](["ave_age_at_marriage","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),{c(){p=Ie("div"),m=Ie("div"),v=Ie("span"),S=Ie("a"),E=tt("Home"),s=new Vp(!1),A=ht(),Li.c(),V=ht(),N=Ie("br"),W=ht(),K=Ie("span"),fe=tt(H),Oe=ht(),ze=Ie("div"),Ke=tt(`Click for:\r
		\r
					`),Xe=Ie("button"),Ft=tt("No comparison"),Lt=ht(),Zr&&Zr.c(),ft=ht(),He=Ie("button"),xr=tt("Same area 2010"),cr=ht(),Wt=Ie("div"),Ht=Ie("div"),qe=Ie("b"),mr=tt("Search for your Local Government District:"),It=ht(),xi(rr.$$.fragment),it=ht(),hr=Ie("script"),Or=tt(`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input")\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]'\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),kt=ht(),er=Ie("div"),nt=Ie("button"),Ze=tt("Print / PDF"),lr=ht(),br=Ie("button"),Yi=tt("Menu"),Qi=ht(),Ni=Ie("button"),Gt=tt("Share"),_r=ht(),Rt=Ie("div"),kr=Ie("div"),xn=Ie("h3"),bn=tt("Overview"),qt=tt(`\r
					The population of `),Ei=tt(wn),Ci=tt(" was 25,000 in 2020.  "),Zi=tt(Yn),Qn=tt(" is a "),cn=tt(hi),Bn=tt("."),Mi=ht(),Fr=Ie("div"),Yr=Ie("div"),Xr=Ie("div"),go=tt("Births "),On=Ie("span"),Co=ht(),hn=Ie("div"),$n=Ie("div"),_o=tt("words....."),Mo=ht(),$i=Ie("span"),vo=tt(eo),Ho=Ie("br"),Jo=ht(),Ti=Ie("div"),Qr=Ie("div"),Ii=Ie("div"),xo=tt("Deaths "),en=Ie("span"),C=ht(),R=Ie("div"),O=Ie("div"),G=tt("words...."),ee=ht(),le=Ie("span"),F=tt(ce),re=Ie("br"),me=ht(),Ce=Ie("div"),Le=Ie("div"),be=Ie("h3"),Be=tt("You are currently viewing: "),et=Ie("span"),Se=tt(Qe),Je=ht(),Ne=Ie("br"),Ge=tt("View other area statistics by clicking on the map below or using the menu on the right."),At=ht(),je=Ie("div"),xi(Pt.$$.fragment),Ct=ht(),Vt=Ie("div"),Mt=Ie("span"),oi=tt("Parents of "),zr=tt(Jt),or=Ie("br"),Bt=ht(),Zt=Ie("span"),dn.c(),pi=ht(),tn=Ie("div"),Cr=Ie("span"),Yo=tt(ai),Do=tt(" within "),bo=tt(Ar),fi=Ie("br"),Wr=ht(),di=Ie("span"),Hr.c(),pn=ht(),mi=Ie("div"),Qo=Ie("h2"),yi=tt("Births "),Sn=Ie("span"),si=tt(gi),Fn=tt(" 2020"),ki=ht(),sr=Ie("div"),to=Ie("div"),ro=Ie("div"),Vn=Ie("div"),al=tt("Births by sex "),Lo=Ie("span"),os=ht(),ga=Ie("div"),wo=Ie("div"),bs=tt("words about births"),ja=ht(),$o=Ie("div"),xi(Nn.$$.fragment),En=ht(),Gi=Ie("div"),pe=Ie("div"),$r=Ie("div"),Di=tt("Births by month "),vr=Ie("span"),Tn=ht(),qr=Ie("div"),ea=Ie("div"),Il=tt("words about birth months"),Ql=ht(),as=Ie("div"),xi(va.$$.fragment),sl=ht(),Ro=Ie("div"),io=Ie("div"),xa=Ie("div"),kl=tt("Places of birth "),ws=Ie("span"),Ss=ht(),ss=Ie("div"),_i=Ie("div"),ul=tt("words about place of birth"),ba=ht(),xi(Un.$$.fragment),qa=ht(),So=Ie("div"),no=Ie("h2"),Za=tt("Deaths "),Eo=Ie("span"),cl=tt(Bo),zl=tt(" 2020"),Sr=ht(),wa=Ie("div"),jn=Ie("div"),Sa=Ie("div"),Al=tt("Cause of death "),ls=Ie("span"),Ga=ht(),oo=Ie("div"),Oo=Ie("div"),Pl=tt("words about cause of death"),Cl=ht(),xi(Ea.$$.fragment),Ka=ht(),ta=Ie("div"),rn=Ie("div"),qn=Ie("div"),Ml=tt("Age at death (years) "),ra=Ie("span"),Fs=ht(),Es=Ie("div"),ia=Ie("div"),Dl=tt("words for age at death"),$l=ht(),Xa=Ie("div"),xi(na.$$.fragment),us=ht(),ao=Ie("div"),Zn=Ie("div"),To=Ie("div"),cs=tt("Place of death "),hs=Ie("span"),Io=ht(),ps=Ie("div"),Ts=Ie("div"),Ll=tt("words for place of death"),Wa=ht(),xi(Fo.$$.fragment),Ns=ht(),Ha=Ie("div"),Ta=Ie("h2"),eu=tt("Marriages "),Ia=Ie("span"),hl=tt(Is),Rl=tt(" 2020"),Us=ht(),Vo=Ie("div"),so=Ie("div"),oa=Ie("div"),ks=tt("Marriages by month "),fs=Ie("span"),Nr=ht(),ka=Ie("div"),No=Ie("div"),za=tt("words about marriage months"),Qt=ht(),dr=Ie("div"),xi(Ui.$$.fragment),As=ht(),Gn=Ie("div"),In=Ie("div"),Ja=Ie("div"),tu=tt("Place of marriage "),aa=Ie("span"),sa=ht(),Gr=Ie("div"),Aa=Ie("div"),Bl=tt("words for place of marriage"),li=ht(),xi($e.$$.fragment),kn=ht(),ko=Ie("div"),fn=Ie("div"),Ki=Ie("div"),zn=tt("Average age at marriage (years) "),Ya=Ie("span"),fl=ht(),Pa=Ie("div"),ds=Ie("div"),lo=tt("words for age at marriage"),An=ht(),la=Ie("div"),xi(ua.$$.fragment),this.h()},l(_e){p=ke(_e,"DIV",{class:!0});var Pe=we(p);m=ke(Pe,"DIV",{});var ot=we(m);v=ke(ot,"SPAN",{class:!0});var co=we(v);S=ke(co,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var Bi=we(S);E=rt(Bi,"Home"),Bi.forEach(se),s=Np(co,!1),A=pt(co),Li.l(co),V=pt(co),co.forEach(se),N=ke(ot,"BR",{}),W=pt(ot),K=ke(ot,"SPAN",{class:!0});var mn=we(K);fe=rt(mn,H),mn.forEach(se),Oe=pt(ot),ze=ke(ot,"DIV",{class:!0,style:!0});var Ur=we(ze);Ke=rt(Ur,`Click for:\r
		\r
					`),Xe=ke(Ur,"BUTTON",{class:!0});var Pn=we(Xe);Ft=rt(Pn,"No comparison"),Pn.forEach(se),Lt=pt(Ur),Zr&&Zr.l(Ur),ft=pt(Ur),He=ke(Ur,"BUTTON",{class:!0});var $a=we(He);xr=rt($a,"Same area 2010"),$a.forEach(se),Ur.forEach(se),ot.forEach(se),cr=pt(Pe),Wt=ke(Pe,"DIV",{});var Ca=we(Wt);Ht=ke(Ca,"DIV",{style:!0,class:!0});var Kt=we(Ht);qe=ke(Kt,"B",{});var ei=we(qe);mr=rt(ei,"Search for your Local Government District:"),ei.forEach(se),It=pt(Kt),bi(rr.$$.fragment,Kt),it=pt(Kt),hr=ke(Kt,"SCRIPT",{});var ms=we(hr);Or=rt(ms,`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input")\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]'\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),ms.forEach(se),kt=pt(Kt),er=ke(Kt,"DIV",{width:!0});var Uo=we(er);nt=ke(Uo,"BUTTON",{class:!0,style:!0,title:!0,onclick:!0});var Vl=we(nt);Ze=rt(Vl,"Print / PDF"),Vl.forEach(se),lr=pt(Uo),br=ke(Uo,"BUTTON",{class:!0,style:!0,alt:!0,onclick:!0});var Ma=we(br);Yi=rt(Ma,"Menu"),Ma.forEach(se),Qi=pt(Uo),Ni=ke(Uo,"BUTTON",{class:!0,style:!0,type:!0,alt:!0});var Xn=we(Ni);Gt=rt(Xn,"Share"),Xn.forEach(se),Uo.forEach(se),Kt.forEach(se),Ca.forEach(se),Pe.forEach(se),_r=pt(_e),Rt=ke(_e,"DIV",{id:!0,class:!0});var ha=we(Rt);kr=ke(ha,"DIV",{class:!0,style:!0});var nn=we(kr);xn=ke(nn,"H3",{style:!0,class:!0});var dl=we(xn);bn=rt(dl,"Overview"),dl.forEach(se),qt=rt(nn,`\r
					The population of `),Ei=rt(nn,wn),Ci=rt(nn," was 25,000 in 2020.  "),Zi=rt(nn,Yn),Qn=rt(nn," is a "),cn=rt(nn,hi),Bn=rt(nn,"."),nn.forEach(se),Mi=pt(ha),Fr=ke(ha,"DIV",{class:!0});var jo=we(Fr);Yr=ke(jo,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Zs=we(Yr);Xr=ke(Zs,"DIV",{class:!0,style:!0});var ml=we(Xr);go=rt(ml,"Births "),On=ke(ml,"SPAN",{style:!0});var Gs=we(On);Gs.forEach(se),ml.forEach(se),Zs.forEach(se),Co=pt(jo),hn=ke(jo,"DIV",{class:!0,id:!0});var ys=we(hn);$n=ke(ys,"DIV",{class:!0});var Nl=we($n);_o=rt(Nl,"words....."),Nl.forEach(se),ys.forEach(se),Mo=pt(jo),$i=ke(jo,"SPAN",{class:!0,style:!0});var es=we($i);vo=rt(es,eo),es.forEach(se),Ho=ke(jo,"BR",{}),jo.forEach(se),Jo=pt(ha),Ti=ke(ha,"DIV",{class:!0});var ho=we(Ti);Qr=ke(ho,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var yl=we(Qr);Ii=ke(yl,"DIV",{class:!0,style:!0});var Da=we(Ii);xo=rt(Da,"Deaths "),en=ke(Da,"SPAN",{style:!0});var qo=we(en);qo.forEach(se),Da.forEach(se),yl.forEach(se),C=pt(ho),R=ke(ho,"DIV",{class:!0,id:!0});var Ul=we(R);O=ke(Ul,"DIV",{class:!0});var Ks=we(O);G=rt(Ks,"words...."),Ks.forEach(se),Ul.forEach(se),ee=pt(ho),le=ke(ho,"SPAN",{class:!0,style:!0});var jl=we(le);F=rt(jl,ce),jl.forEach(se),re=ke(ho,"BR",{}),ho.forEach(se),ha.forEach(se),me=pt(_e),Ce=ke(_e,"DIV",{class:!0});var pa=we(Ce);Le=ke(pa,"DIV",{style:!0});var n=we(Le);be=ke(n,"H3",{class:!0});var a=we(be);Be=rt(a,"You are currently viewing: "),et=ke(a,"SPAN",{style:!0});var o=we(et);Se=rt(o,Qe),o.forEach(se),a.forEach(se),Je=pt(n),Ne=ke(n,"BR",{}),Ge=rt(n,"View other area statistics by clicking on the map below or using the menu on the right."),n.forEach(se),At=pt(pa),je=ke(pa,"DIV",{id:!0,style:!0,class:!0});var u=we(je);bi(Pt.$$.fragment,u),u.forEach(se),Ct=pt(pa),Vt=ke(pa,"DIV",{});var d=we(Vt);Mt=ke(d,"SPAN",{class:!0});var _=we(Mt);oi=rt(_,"Parents of "),zr=rt(_,Jt),_.forEach(se),or=ke(d,"BR",{}),Bt=pt(d),Zt=ke(d,"SPAN",{class:!0});var x=we(Zt);dn.l(x),x.forEach(se),d.forEach(se),pi=pt(pa),tn=ke(pa,"DIV",{});var T=we(tn);Cr=ke(T,"SPAN",{class:!0});var z=we(Cr);Yo=rt(z,ai),Do=rt(z," within "),bo=rt(z,Ar),z.forEach(se),fi=ke(T,"BR",{}),Wr=pt(T),di=ke(T,"SPAN",{class:!0});var L=we(di);Hr.l(L),L.forEach(se),T.forEach(se),pa.forEach(se),pn=pt(_e),mi=ke(_e,"DIV",{style:!0});var j=we(mi);Qo=ke(j,"H2",{class:!0});var q=we(Qo);yi=rt(q,"Births "),Sn=ke(q,"SPAN",{class:!0});var Z=we(Sn);si=rt(Z,gi),Fn=rt(Z," 2020"),Z.forEach(se),q.forEach(se),j.forEach(se),ki=pt(_e),sr=ke(_e,"DIV",{class:!0});var J=we(sr);to=ke(J,"DIV",{class:!0});var Q=we(to);ro=ke(Q,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var oe=we(ro);Vn=ke(oe,"DIV",{class:!0,style:!0});var Y=we(Vn);al=rt(Y,"Births by sex "),Lo=ke(Y,"SPAN",{style:!0});var ae=we(Lo);ae.forEach(se),Y.forEach(se),oe.forEach(se),os=pt(Q),ga=ke(Q,"DIV",{class:!0,id:!0});var he=we(ga);wo=ke(he,"DIV",{class:!0});var ye=we(wo);bs=rt(ye,"words about births"),ye.forEach(se),he.forEach(se),ja=pt(Q),$o=ke(Q,"DIV",{class:!0,style:!0});var Te=we($o);bi(Nn.$$.fragment,Te),Te.forEach(se),Q.forEach(se),En=pt(J),Gi=ke(J,"DIV",{class:!0});var ve=we(Gi);pe=ke(ve,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Ae=we(pe);$r=ke(Ae,"DIV",{class:!0,style:!0});var Re=we($r);Di=rt(Re,"Births by month "),vr=ke(Re,"SPAN",{style:!0});var Ue=we(vr);Ue.forEach(se),Re.forEach(se),Ae.forEach(se),Tn=pt(ve),qr=ke(ve,"DIV",{class:!0,id:!0});var Ve=we(qr);ea=ke(Ve,"DIV",{class:!0});var at=we(ea);Il=rt(at,"words about birth months"),at.forEach(se),Ve.forEach(se),Ql=pt(ve),as=ke(ve,"DIV",{class:!0,style:!0});var yt=we(as);bi(va.$$.fragment,yt),yt.forEach(se),ve.forEach(se),sl=pt(J),Ro=ke(J,"DIV",{class:!0});var mt=we(Ro);io=ke(mt,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var _t=we(io);xa=ke(_t,"DIV",{class:!0,style:!0});var ir=we(xa);kl=rt(ir,"Places of birth "),ws=ke(ir,"SPAN",{style:!0});var ut=we(ws);ut.forEach(se),ir.forEach(se),_t.forEach(se),Ss=pt(mt),ss=ke(mt,"DIV",{class:!0,id:!0});var zt=we(ss);_i=ke(zt,"DIV",{class:!0});var Ot=we(_i);ul=rt(Ot,"words about place of birth"),Ot.forEach(se),zt.forEach(se),ba=pt(mt),bi(Un.$$.fragment,mt),mt.forEach(se),qa=pt(J),So=ke(J,"DIV",{style:!0});var Et=we(So);no=ke(Et,"H2",{class:!0});var St=we(no);Za=rt(St,"Deaths "),Eo=ke(St,"SPAN",{class:!0});var Dt=we(Eo);cl=rt(Dt,Bo),zl=rt(Dt," 2020"),Dt.forEach(se),St.forEach(se),Et.forEach(se),Sr=pt(J),wa=ke(J,"DIV",{class:!0});var bt=we(wa);jn=ke(bt,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var wt=we(jn);Sa=ke(wt,"DIV",{class:!0,style:!0});var zi=we(Sa);Al=rt(zi,"Cause of death "),ls=ke(zi,"SPAN",{style:!0});var ui=we(ls);ui.forEach(se),zi.forEach(se),wt.forEach(se),Ga=pt(bt),oo=ke(bt,"DIV",{class:!0,id:!0});var on=we(oo);Oo=ke(on,"DIV",{class:!0});var ji=we(Oo);Pl=rt(ji,"words about cause of death"),ji.forEach(se),on.forEach(se),Cl=pt(bt),bi(Ea.$$.fragment,bt),bt.forEach(se),Ka=pt(J),ta=ke(J,"DIV",{class:!0});var Rr=we(ta);rn=ke(Rr,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ci=we(rn);qn=ke(ci,"DIV",{class:!0,style:!0});var Cn=we(qn);Ml=rt(Cn,"Age at death (years) "),ra=ke(Cn,"SPAN",{style:!0});var Mn=we(ra);Mn.forEach(se),Cn.forEach(se),ci.forEach(se),Fs=pt(Rr),Es=ke(Rr,"DIV",{class:!0,id:!0});var ts=we(Es);ia=ke(ts,"DIV",{class:!0});var Dn=we(ia);Dl=rt(Dn,"words for age at death"),Dn.forEach(se),ts.forEach(se),$l=pt(Rr),Xa=ke(Rr,"DIV",{class:!0,style:!0});var Zo=we(Xa);bi(na.$$.fragment,Zo),Zo.forEach(se),Rr.forEach(se),us=pt(J),ao=ke(J,"DIV",{class:!0});var yn=we(ao);Zn=ke(yn,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Xs=we(Zn);To=ke(Xs,"DIV",{class:!0,style:!0});var gs=we(To);cs=rt(gs,"Place of death "),hs=ke(gs,"SPAN",{style:!0});var _s=we(hs);_s.forEach(se),gs.forEach(se),Xs.forEach(se),Io=pt(yn),ps=ke(yn,"DIV",{class:!0,id:!0});var Ps=we(ps);Ts=ke(Ps,"DIV",{class:!0});var Ws=we(Ts);Ll=rt(Ws,"words for place of death"),Ws.forEach(se),Ps.forEach(se),Wa=pt(yn),bi(Fo.$$.fragment,yn),yn.forEach(se),Ns=pt(J),Ha=ke(J,"DIV",{style:!0});var fa=we(Ha);Ta=ke(fa,"H2",{class:!0});var Cs=we(Ta);eu=rt(Cs,"Marriages "),Ia=ke(Cs,"SPAN",{class:!0});var Go=we(Ia);hl=rt(Go,Is),Rl=rt(Go," 2020"),Go.forEach(se),Cs.forEach(se),fa.forEach(se),Us=pt(J),Vo=ke(J,"DIV",{class:!0});var ti=we(Vo);so=ke(ti,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var La=we(so);oa=ke(La,"DIV",{class:!0,style:!0});var Ra=we(oa);ks=rt(Ra,"Marriages by month "),fs=ke(Ra,"SPAN",{style:!0});var Ms=we(fs);Ms.forEach(se),Ra.forEach(se),La.forEach(se),Nr=pt(ti),ka=ke(ti,"DIV",{class:!0,id:!0});var pr=we(ka);No=ke(pr,"DIV",{class:!0});var po=we(No);za=rt(po,"words about marriage months"),po.forEach(se),pr.forEach(se),Qt=pt(ti),dr=ke(ti,"DIV",{class:!0,style:!0});var Ln=we(dr);bi(Ui.$$.fragment,Ln),Ln.forEach(se),ti.forEach(se),As=pt(J),Gn=ke(J,"DIV",{class:!0});var Ko=we(Gn);In=ke(Ko,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var vu=we(In);Ja=ke(vu,"DIV",{class:!0,style:!0});var Hs=we(Ja);tu=rt(Hs,"Place of marriage "),aa=ke(Hs,"SPAN",{style:!0});var Ju=we(aa);Ju.forEach(se),Hs.forEach(se),vu.forEach(se),sa=pt(Ko),Gr=ke(Ko,"DIV",{class:!0,id:!0});var Js=we(Gr);Aa=ke(Js,"DIV",{class:!0});var ru=we(Aa);Bl=rt(ru,"words for place of marriage"),ru.forEach(se),Js.forEach(se),li=pt(Ko),bi($e.$$.fragment,Ko),Ko.forEach(se),kn=pt(J),ko=ke(J,"DIV",{class:!0});var da=we(ko);fn=ke(da,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var gl=we(fn);Ki=ke(gl,"DIV",{class:!0,style:!0});var iu=we(Ki);zn=rt(iu,"Average age at marriage (years) "),Ya=ke(iu,"SPAN",{style:!0});var _l=we(Ya);_l.forEach(se),iu.forEach(se),gl.forEach(se),fl=pt(da),Pa=ke(da,"DIV",{class:!0,id:!0});var Wn=we(Pa);ds=ke(Wn,"DIV",{class:!0});var Zc=we(ds);lo=rt(Zc,"words for age at marriage"),Zc.forEach(se),Wn.forEach(se),An=pt(da),la=ke(da,"DIV",{class:!0,style:!0});var Yu=we(la);bi(ua.$$.fragment,Yu),Yu.forEach(se),da.forEach(se),J.forEach(se),this.h()},h(){X(S,"href",ol+"/"),X(S,"sveltekit:noscroll",""),X(S,"class","svelte-1dy7mjs"),s.a=A,X(v,"class","text-small"),X(K,"class","text-big title svelte-1dy7mjs"),X(Xe,"class","btn svelte-1dy7mjs"),ln(Xe,"btn-active",c[9]),X(He,"class","btn svelte-1dy7mjs"),ln(He,"btn-active",c[4]&!c[9]&!c[10]),X(ze,"class","text-bold"),De(ze,"font-size","0.85em"),X(nt,"class","btn svelte-1dy7mjs"),De(nt,"width","33%"),X(nt,"title","Click to print this page to pdf or printer"),X(nt,"onclick","window.print();return false;"),X(br,"class","btn svelte-1dy7mjs"),De(br,"width","33%"),X(br,"alt","Return to the landing page"),X(br,"onclick","window.location.href='"+ol+"';"),X(Ni,"class","btn svelte-1dy7mjs"),De(Ni,"width","30%"),X(Ni,"type","share"),X(Ni,"alt","Share this page"),X(er,"width","100%"),De(Ht,"width","350px"),De(Ht,"padding-top","5px"),X(Ht,"class","svelte-1dy7mjs"),ln(Ht,"float-right",c[5]>1),X(p,"class","grid mtl svelte-1dy7mjs"),De(xn,"margin","0 0 10px 0"),De(xn,"line-height","1.78"),X(xn,"class","svelte-1dy7mjs"),X(kr,"class","div-grey-box svelte-1dy7mjs"),De(kr,"line-height","1.3"),De(On,"color","gray"),De(On,"font-size","14pt"),X(Xr,"class","blocktitle"),De(Xr,"margin","0"),De(Xr,"width","100%"),X(Yr,"class","row"),De(Yr,"display","flex"),De(Yr,"cursor","pointer"),X(Yr,"data-bs-toggle","collapse"),X(Yr,"data-bs-target","#pop-info"),X(Yr,"aria-expanded","false"),X(Yr,"aria-controls","pop-info"),X($n,"class","card card-body svelte-1dy7mjs"),X(hn,"class","collapse svelte-1dy7mjs"),X(hn,"id","pop-info"),X($i,"class","text-big"),De($i,"font-size","2.8em"),X(Fr,"class","div-grey-box svelte-1dy7mjs"),De(en,"color","gray"),De(en,"font-size","14pt"),X(Ii,"class","blocktitle"),De(Ii,"margin","0"),De(Ii,"width","100%"),X(Qr,"class","row"),De(Qr,"display","flex"),De(Qr,"cursor","pointer"),X(Qr,"data-bs-toggle","collapse"),X(Qr,"data-bs-target","#pop-info2"),X(Qr,"aria-expanded","false"),X(Qr,"aria-controls","pop-info2"),X(O,"class","card card-body svelte-1dy7mjs"),X(R,"class","collapse svelte-1dy7mjs"),X(R,"id","pop-info2"),X(le,"class","text-big"),De(le,"font-size","2.8em"),X(Ti,"class","div-grey-box svelte-1dy7mjs"),X(Rt,"id","grid"),X(Rt,"class","grid mt svelte-1dy7mjs"),De(et,"color","#93328E"),X(be,"class","svelte-1dy7mjs"),De(Le,"grid-column","span "+c[5]),X(je,"id","map"),De(je,"padding-right","45px"),De(je,"grid-column","span "+(c[5]==2?2:c[5]&&c[5]>2?c[5]-1:1)),X(je,"class","svelte-1dy7mjs"),X(Mt,"class","text-bold"),X(Zt,"class","text-small"),X(Cr,"class","text-bold"),X(di,"class","text-small"),X(Ce,"class","grid mt svelte-1dy7mjs"),Rh(()=>c[25].call(Ce)),X(Sn,"class","title-inset muted svelte-1dy7mjs"),X(Qo,"class","svelte-1dy7mjs"),De(mi,"grid-column","span "+c[5]),De(Lo,"color","gray"),De(Lo,"font-size","14pt"),X(Vn,"class","blocktitle"),De(Vn,"margin","0"),De(Vn,"width","100%"),X(ro,"class","row"),De(ro,"display","flex"),De(ro,"cursor","pointer"),X(ro,"data-bs-toggle","collapse"),X(ro,"data-bs-target","#births-info"),X(ro,"aria-expanded","false"),X(ro,"aria-controls","births-info"),X(wo,"class","card card-body svelte-1dy7mjs"),X(ga,"class","collapse svelte-1dy7mjs"),X(ga,"id","births-info"),X($o,"class","chart svelte-1dy7mjs"),De($o,"height","100px"),De($o,"padding-bottom","5px"),X(to,"class","div-grey-box svelte-1dy7mjs"),De(vr,"color","gray"),De(vr,"font-size","14pt"),X($r,"class","blocktitle"),De($r,"margin","0"),De($r,"width","100%"),X(pe,"class","row"),De(pe,"display","flex"),De(pe,"cursor","pointer"),X(pe,"data-bs-toggle","collapse"),X(pe,"data-bs-target","#birthmonth-info"),X(pe,"aria-expanded","false"),X(pe,"aria-controls","birthmonth-info"),X(ea,"class","card card-body svelte-1dy7mjs"),X(qr,"class","collapse svelte-1dy7mjs"),X(qr,"id","birthmonth-info"),X(as,"class","chart svelte-1dy7mjs"),De(as,"height","100px"),De(as,"padding-bottom","5px"),X(Gi,"class","div-grey-box svelte-1dy7mjs"),De(ws,"color","gray"),De(ws,"font-size","14pt"),X(xa,"class","blocktitle"),De(xa,"margin","0"),De(xa,"width","100%"),X(io,"class","row"),De(io,"display","flex"),De(io,"cursor","pointer"),X(io,"data-bs-toggle","collapse"),X(io,"data-bs-target","#birthplace-info"),X(io,"aria-expanded","false"),X(io,"aria-controls","birthplace-info"),X(_i,"class","card card-body svelte-1dy7mjs"),X(ss,"class","collapse svelte-1dy7mjs"),X(ss,"id","birthplace-info"),X(Ro,"class","div-grey-box svelte-1dy7mjs"),X(Eo,"class","title-inset muted svelte-1dy7mjs"),X(no,"class","svelte-1dy7mjs"),De(So,"grid-column","span "+c[5]),De(ls,"color","gray"),De(ls,"font-size","14pt"),X(Sa,"class","blocktitle"),De(Sa,"margin","0"),De(Sa,"width","100%"),X(jn,"class","row"),De(jn,"display","flex"),De(jn,"cursor","pointer"),X(jn,"data-bs-toggle","collapse"),X(jn,"data-bs-target","#causeofdeath-info"),X(jn,"aria-expanded","false"),X(jn,"aria-controls","causeofdeath-info"),X(Oo,"class","card card-body svelte-1dy7mjs"),X(oo,"class","collapse svelte-1dy7mjs"),X(oo,"id","causeofdeath-info"),X(wa,"class","div-grey-box svelte-1dy7mjs"),De(ra,"color","gray"),De(ra,"font-size","14pt"),X(qn,"class","blocktitle"),De(qn,"margin","0"),De(qn,"width","100%"),X(rn,"class","row"),De(rn,"display","flex"),De(rn,"cursor","pointer"),X(rn,"data-bs-toggle","collapse"),X(rn,"data-bs-target","#ageatdeath-info"),X(rn,"aria-expanded","false"),X(rn,"aria-controls","ageatdeath-info"),X(ia,"class","card card-body svelte-1dy7mjs"),X(Es,"class","collapse svelte-1dy7mjs"),X(Es,"id","ageatdeath-info"),X(Xa,"class","chart svelte-1dy7mjs"),De(Xa,"height","100px"),De(Xa,"padding-bottom","5px"),X(ta,"class","div-grey-box svelte-1dy7mjs"),De(hs,"color","gray"),De(hs,"font-size","14pt"),X(To,"class","blocktitle"),De(To,"margin","0"),De(To,"width","100%"),X(Zn,"class","row"),De(Zn,"display","flex"),De(Zn,"cursor","pointer"),X(Zn,"data-bs-toggle","collapse"),X(Zn,"data-bs-target","#placeofdeath-info"),X(Zn,"aria-expanded","false"),X(Zn,"aria-controls","placeofdeath-info"),X(Ts,"class","card card-body svelte-1dy7mjs"),X(ps,"class","collapse svelte-1dy7mjs"),X(ps,"id","placeofdeath-info"),X(ao,"class","div-grey-box svelte-1dy7mjs"),X(Ia,"class","title-inset muted svelte-1dy7mjs"),X(Ta,"class","svelte-1dy7mjs"),De(Ha,"grid-column","span "+c[5]),De(fs,"color","gray"),De(fs,"font-size","14pt"),X(oa,"class","blocktitle"),De(oa,"margin","0"),De(oa,"width","100%"),X(so,"class","row"),De(so,"display","flex"),De(so,"cursor","pointer"),X(so,"data-bs-toggle","collapse"),X(so,"data-bs-target","#marriagemonth-info"),X(so,"aria-expanded","false"),X(so,"aria-controls","marriagemonth-info"),X(No,"class","card card-body svelte-1dy7mjs"),X(ka,"class","collapse svelte-1dy7mjs"),X(ka,"id","marriagemonth-info"),X(dr,"class","chart svelte-1dy7mjs"),De(dr,"height","100px"),De(dr,"padding-bottom","5px"),X(Vo,"class","div-grey-box svelte-1dy7mjs"),De(aa,"color","gray"),De(aa,"font-size","14pt"),X(Ja,"class","blocktitle"),De(Ja,"margin","0"),De(Ja,"width","100%"),X(In,"class","row"),De(In,"display","flex"),De(In,"cursor","pointer"),X(In,"data-bs-toggle","collapse"),X(In,"data-bs-target","#placeofmarriage-info"),X(In,"aria-expanded","false"),X(In,"aria-controls","placeofmarriage-info"),X(Aa,"class","card card-body svelte-1dy7mjs"),X(Gr,"class","collapse svelte-1dy7mjs"),X(Gr,"id","placeofmarriage-info"),X(Gn,"class","div-grey-box svelte-1dy7mjs"),De(Ya,"color","gray"),De(Ya,"font-size","14pt"),X(Ki,"class","blocktitle"),De(Ki,"margin","0"),De(Ki,"width","100%"),X(fn,"class","row"),De(fn,"display","flex"),De(fn,"cursor","pointer"),X(fn,"data-bs-toggle","collapse"),X(fn,"data-bs-target","#ageatmarriage-info"),X(fn,"aria-expanded","false"),X(fn,"aria-controls","ageatmarriage-info"),X(ds,"class","card card-body svelte-1dy7mjs"),X(Pa,"class","collapse svelte-1dy7mjs"),X(Pa,"id","ageatmarriage-info"),X(la,"class","chart svelte-1dy7mjs"),De(la,"height","100px"),De(la,"padding-bottom","5px"),X(ko,"class","div-grey-box svelte-1dy7mjs"),X(sr,"class","grid mt svelte-1dy7mjs"),Rh(()=>c[26].call(sr))},m(_e,Pe){dt(_e,p,Pe),ie(p,m),ie(m,v),ie(v,S),ie(S,E),s.m(M,v),ie(v,A),Li.m(v,null),ie(v,V),ie(m,N),ie(m,W),ie(m,K),ie(K,fe),ie(m,Oe),ie(m,ze),ie(ze,Ke),ie(ze,Xe),ie(Xe,Ft),ie(ze,Lt),Zr&&Zr.m(ze,null),ie(ze,ft),ie(ze,He),ie(He,xr),ie(p,cr),ie(p,Wt),ie(Wt,Ht),ie(Ht,qe),ie(qe,mr),ie(Ht,It),wi(rr,Ht,null),ie(Ht,it),ie(Ht,hr),ie(hr,Or),ie(Ht,kt),ie(Ht,er),ie(er,nt),ie(nt,Ze),ie(er,lr),ie(er,br),ie(br,Yi),ie(er,Qi),ie(er,Ni),ie(Ni,Gt),dt(_e,_r,Pe),dt(_e,Rt,Pe),ie(Rt,kr),ie(kr,xn),ie(xn,bn),ie(kr,qt),ie(kr,Ei),ie(kr,Ci),ie(kr,Zi),ie(kr,Qn),ie(kr,cn),ie(kr,Bn),ie(Rt,Mi),ie(Rt,Fr),ie(Fr,Yr),ie(Yr,Xr),ie(Xr,go),ie(Xr,On),On.innerHTML=ya,ie(Fr,Co),ie(Fr,hn),ie(hn,$n),ie($n,_o),ie(Fr,Mo),ie(Fr,$i),ie($i,vo),ie(Fr,Ho),ie(Rt,Jo),ie(Rt,Ti),ie(Ti,Qr),ie(Qr,Ii),ie(Ii,xo),ie(Ii,en),en.innerHTML=Dr,ie(Ti,C),ie(Ti,R),ie(R,O),ie(O,G),ie(Ti,ee),ie(Ti,le),ie(le,F),ie(Ti,re),dt(_e,me,Pe),dt(_e,Ce,Pe),ie(Ce,Le),ie(Le,be),ie(be,Be),ie(be,et),ie(et,Se),ie(Le,Je),ie(Le,Ne),ie(Le,Ge),ie(Ce,At),ie(Ce,je),wi(Pt,je,null),ie(Ce,Ct),ie(Ce,Vt),ie(Vt,Mt),ie(Mt,oi),ie(Mt,zr),ie(Vt,or),ie(Vt,Bt),ie(Vt,Zt),dn.m(Zt,null),ie(Ce,pi),ie(Ce,tn),ie(tn,Cr),ie(Cr,Yo),ie(Cr,Do),ie(Cr,bo),ie(tn,fi),ie(tn,Wr),ie(tn,di),Hr.m(di,null),wr=Bh(Ce,c[25].bind(Ce)),dt(_e,pn,Pe),dt(_e,mi,Pe),ie(mi,Qo),ie(Qo,yi),ie(Qo,Sn),ie(Sn,si),ie(Sn,Fn),dt(_e,ki,Pe),dt(_e,sr,Pe),ie(sr,to),ie(to,ro),ie(ro,Vn),ie(Vn,al),ie(Vn,Lo),Lo.innerHTML=Yl,ie(to,os),ie(to,ga),ie(ga,wo),ie(wo,bs),ie(to,ja),ie(to,$o),wi(Nn,$o,null),ie(sr,En),ie(sr,Gi),ie(Gi,pe),ie(pe,$r),ie($r,Di),ie($r,vr),vr.innerHTML=_a,ie(Gi,Tn),ie(Gi,qr),ie(qr,ea),ie(ea,Il),ie(Gi,Ql),ie(Gi,as),wi(va,as,null),ie(sr,sl),ie(sr,Ro),ie(Ro,io),ie(io,xa),ie(xa,kl),ie(xa,ws),ws.innerHTML=ll,ie(Ro,Ss),ie(Ro,ss),ie(ss,_i),ie(_i,ul),ie(Ro,ba),wi(Un,Ro,null),ie(sr,qa),ie(sr,So),ie(So,no),ie(no,Za),ie(no,Eo),ie(Eo,cl),ie(Eo,zl),ie(sr,Sr),ie(sr,wa),ie(wa,jn),ie(jn,Sa),ie(Sa,Al),ie(Sa,ls),ls.innerHTML=_u,ie(wa,Ga),ie(wa,oo),ie(oo,Oo),ie(Oo,Pl),ie(wa,Cl),wi(Ea,wa,null),ie(sr,Ka),ie(sr,ta),ie(ta,rn),ie(rn,qn),ie(qn,Ml),ie(qn,ra),ra.innerHTML=Vr,ie(ta,Fs),ie(ta,Es),ie(Es,ia),ie(ia,Dl),ie(ta,$l),ie(ta,Xa),wi(na,Xa,null),ie(sr,us),ie(sr,ao),ie(ao,Zn),ie(Zn,To),ie(To,cs),ie(To,hs),hs.innerHTML=Vs,ie(ao,Io),ie(ao,ps),ie(ps,Ts),ie(Ts,Ll),ie(ao,Wa),wi(Fo,ao,null),ie(sr,Ns),ie(sr,Ha),ie(Ha,Ta),ie(Ta,eu),ie(Ta,Ia),ie(Ia,hl),ie(Ia,Rl),ie(sr,Us),ie(sr,Vo),ie(Vo,so),ie(so,oa),ie(oa,ks),ie(oa,fs),fs.innerHTML=zs,ie(Vo,Nr),ie(Vo,ka),ie(ka,No),ie(No,za),ie(Vo,Qt),ie(Vo,dr),wi(Ui,dr,null),ie(sr,As),ie(sr,Gn),ie(Gn,In),ie(In,Ja),ie(Ja,tu),ie(Ja,aa),aa.innerHTML=pl,ie(Gn,sa),ie(Gn,Gr),ie(Gr,Aa),ie(Aa,Bl),ie(Gn,li),wi($e,Gn,null),ie(sr,kn),ie(sr,ko),ie(ko,fn),ie(fn,Ki),ie(Ki,zn),ie(Ki,Ya),Ya.innerHTML=Ye,ie(ko,fl),ie(ko,Pa),ie(Pa,ds),ie(ds,lo),ie(ko,An),ie(ko,la),wi(ua,la,null),Kn=Bh(sr,c[26].bind(sr)),Lr=!0,Ol||(js=[Rn(Xe,"click",c[15]),Rn(Xe,"click",c[16]),Rn(Xe,"click",c[17]),Rn(He,"click",c[21]),Rn(He,"click",c[22]),Rn(He,"click",c[23])],Ol=!0)},p(_e,Pe){qs===(qs=Fl(_e))&&Li?Li.p(_e,Pe):(Li.d(1),Li=qs(_e),Li&&(Li.c(),Li.m(v,V))),(!Lr||Pe[0]&2)&&H!==(H=_e[1].name+"")&&Pr(fe,H),Pe[0]&512&&ln(Xe,"btn-active",_e[9]),_e[1].type!="ew"?Zr?Zr.p(_e,Pe):(Zr=wm(_e),Zr.c(),Zr.m(ze,ft)):Zr&&(Zr.d(1),Zr=null),Pe[0]&1552&&ln(He,"btn-active",_e[4]&!_e[9]&!_e[10]);const ot={};Pe[0]&1&&(ot.options=_e[0]),rr.$set(ot),Pe[0]&32&&ln(Ht,"float-right",_e[5]>1),(!Lr||Pe[0]&2)&&wn!==(wn=_e[1].name+"")&&Pr(Ei,wn),(!Lr||Pe[0]&2)&&Yn!==(Yn=_e[1].name+"")&&Pr(Zi,Yn),(!Lr||Pe[0]&2)&&hi!==(hi=cu[_e[1].type].name.toLowerCase()+"")&&Pr(cn,hi),(!Lr||Pe[0]&2)&&eo!==(eo=_e[1].data.births.value[2020].toLocaleString()+"")&&Pr(vo,eo),(!Lr||Pe[0]&2)&&ce!==(ce=_e[1].data.deaths.value[2020].toLocaleString()+"")&&Pr(F,ce),(!Lr||Pe[0]&2)&&Qe!==(Qe=_e[1].name+"")&&Pr(Se,Qe),(!Lr||Pe[0]&32)&&De(Le,"grid-column","span "+_e[5]);const co={};Pe[0]&2&&(co.location={bounds:_e[1].bounds}),Pe[0]&384|Pe[1]&2048&&(co.$$scope={dirty:Pe,ctx:_e}),!ar&&Pe[0]&64&&(ar=!0,co.map=_e[6],Mg(()=>ar=!1)),Pt.$set(co),(!Lr||Pe[0]&32)&&De(je,"grid-column","span "+(_e[5]==2?2:_e[5]&&_e[5]>2?_e[5]-1:1)),(!Lr||Pe[0]&2)&&Jt!==(Jt=_e[1].name+"")&&Pr(zr,Jt),Ri===(Ri=zo(_e))&&dn?dn.p(_e,Pe):(dn.d(1),dn=Ri(_e),dn&&(dn.c(),dn.m(Zt,null))),(!Lr||Pe[0]&2)&&ai!==(ai=(_e[1].children[0]?cu[_e[1].children[0].type].pl:"Areas")+"")&&Pr(Yo,ai),(!Lr||Pe[0]&2)&&Ar!==(Ar=_e[1].name+"")&&Pr(bo,Ar),uo===(uo=Qa(_e))&&Hr?Hr.p(_e,Pe):(Hr.d(1),Hr=uo(_e),Hr&&(Hr.c(),Hr.m(di,null))),(!Lr||Pe[0]&2)&&gi!==(gi=_e[1].name+"")&&Pr(si,gi),(!Lr||Pe[0]&32)&&De(mi,"grid-column","span "+_e[5]);const Bi={};Pe[0]&2&&(Bi.data=_e[1]&&_e[12](["births","perc","2020"])),Pe[0]&530&&(Bi.zKey=_e[9]?null:_e[4]?"prev":!_e[4]&&_e[1].type!="ew"?"ew":null),Nn.$set(Bi);const mn={};Pe[0]&2&&(mn.data=_e[1]&&_e[12](["birth_month","perc","2020"])),Pe[0]&530&&(mn.zKey=_e[9]?null:_e[4]?"prev":!_e[4]&&_e[1].type!="ew"?"ew":null),Pe[0]&2048&&(mn.label=_e[11]),va.$set(mn);const Ur={};Pe[0]&2&&(Ur.data=_e[1]&&_e[12](["place_of_death","perc","2020"])),Pe[0]&530&&(Ur.zKey=_e[9]?null:_e[4]?"prev":!_e[4]&&_e[1].type!="ew"?"ew":null),Pe[0]&2048&&(Ur.label=_e[11]),Un.$set(Ur),(!Lr||Pe[0]&2)&&Bo!==(Bo=_e[1].name+"")&&Pr(cl,Bo),(!Lr||Pe[0]&32)&&De(So,"grid-column","span "+_e[5]);const Pn={};Pe[0]&2&&(Pn.data=_e[1]&&_e[12](["cause_of_death","perc","2020"])),Pe[0]&530&&(Pn.zKey=_e[9]?null:_e[4]?"prev":!_e[4]&&_e[1].type!="ew"?"ew":null),Pe[0]&2048&&(Pn.label=_e[11]),Ea.$set(Pn);const $a={};Pe[0]&2&&($a.data=_e[1]&&_e[12](["age_at_death","perc","2020"])),Pe[0]&530&&($a.zKey=_e[9]?null:_e[4]?"prev":!_e[4]&&_e[1].type!="ew"?"ew":null),Pe[0]&2048&&($a.label=_e[11]),na.$set($a);const Ca={};Pe[0]&2&&(Ca.data=_e[1]&&_e[12](["place_of_death","perc","2020"])),Pe[0]&530&&(Ca.zKey=_e[9]?null:_e[4]?"prev":!_e[4]&&_e[1].type!="ew"?"ew":null),Pe[0]&2048&&(Ca.label=_e[11]),Fo.$set(Ca),(!Lr||Pe[0]&2)&&Is!==(Is=_e[1].name+"")&&Pr(hl,Is),(!Lr||Pe[0]&32)&&De(Ha,"grid-column","span "+_e[5]);const Kt={};Pe[0]&2&&(Kt.data=_e[1]&&_e[12](["marriage_month","perc","2020"])),Pe[0]&530&&(Kt.zKey=_e[9]?null:_e[4]?"prev":!_e[4]&&_e[1].type!="ew"?"ew":null),Pe[0]&2048&&(Kt.label=_e[11]),Ui.$set(Kt);const ei={};Pe[0]&2&&(ei.data=_e[1]&&_e[12](["place_of_marriage","perc","2020"])),Pe[0]&530&&(ei.zKey=_e[9]?null:_e[4]?"prev":!_e[4]&&_e[1].type!="ew"?"ew":null),Pe[0]&2048&&(ei.label=_e[11]),$e.$set(ei);const ms={};Pe[0]&2&&(ms.data=_e[1]&&_e[12](["ave_age_at_marriage","perc","2020"])),Pe[0]&530&&(ms.zKey=_e[9]?null:_e[4]?"prev":!_e[4]&&_e[1].type!="ew"?"ew":null),Pe[0]&2048&&(ms.label=_e[11]),ua.$set(ms)},i(_e){Lr||(jt(rr.$$.fragment,_e),jt(Pt.$$.fragment,_e),jt(Nn.$$.fragment,_e),jt(va.$$.fragment,_e),jt(Un.$$.fragment,_e),jt(Ea.$$.fragment,_e),jt(na.$$.fragment,_e),jt(Fo.$$.fragment,_e),jt(Ui.$$.fragment,_e),jt($e.$$.fragment,_e),jt(ua.$$.fragment,_e),Lr=!0)},o(_e){tr(rr.$$.fragment,_e),tr(Pt.$$.fragment,_e),tr(Nn.$$.fragment,_e),tr(va.$$.fragment,_e),tr(Un.$$.fragment,_e),tr(Ea.$$.fragment,_e),tr(na.$$.fragment,_e),tr(Fo.$$.fragment,_e),tr(Ui.$$.fragment,_e),tr($e.$$.fragment,_e),tr(ua.$$.fragment,_e),Lr=!1},d(_e){_e&&se(p),Li.d(),Zr&&Zr.d(),Si(rr),_e&&se(_r),_e&&se(Rt),_e&&se(me),_e&&se(Ce),Si(Pt),dn.d(),Hr.d(),wr(),_e&&se(pn),_e&&se(mi),_e&&se(ki),_e&&se(sr),Si(Nn),Si(va),Si(Un),Si(Ea),Si(na),Si(Fo),Si(Ui),Si($e),Si(ua),Kn(),Ol=!1,mu(js)}}}function z0(c){let p=c[1].name+"",m;return{c(){m=tt(p)},l(v){m=rt(v,p)},m(v,S){dt(v,m,S)},p(v,S){S[0]&2&&p!==(p=v[1].name+"")&&Pr(m,p)},d(v){v&&se(m)}}}function A0(c){let p,m=c[1].name+"",v,S=[...c[1].parents].reverse(),E=[];for(let s=0;s<S.length;s+=1)E[s]=bm(vm(c,S,s));return{c(){for(let s=0;s<E.length;s+=1)E[s].c();p=ht(),v=tt(m)},l(s){for(let M=0;M<E.length;M+=1)E[M].l(s);p=pt(s),v=rt(s,m)},m(s,M){for(let A=0;A<E.length;A+=1)E[A].m(s,M);dt(s,p,M),dt(s,v,M)},p(s,M){if(M[0]&2){S=[...s[1].parents].reverse();let A;for(A=0;A<S.length;A+=1){const V=vm(s,S,A);E[A]?E[A].p(V,M):(E[A]=bm(V),E[A].c(),E[A].m(p.parentNode,p))}for(;A<E.length;A+=1)E[A].d(1);E.length=S.length}M[0]&2&&m!==(m=s[1].name+"")&&Pr(v,m)},d(s){Os(E,s),s&&se(p),s&&se(v)}}}function bm(c){let p,m=c[34].name+"",v,S,E,s=" &gt; ",M;return{c(){p=Ie("a"),v=tt(m),E=new Vp(!1),M=un(),this.h()},l(A){p=ke(A,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var V=we(p);v=rt(V,m),V.forEach(se),E=Np(A,!1),M=un(),this.h()},h(){X(p,"href",S=ol+"/"+c[34].code+"/"),X(p,"sveltekit:noscroll",""),X(p,"class","svelte-1dy7mjs"),E.a=M},m(A,V){dt(A,p,V),ie(p,v),E.m(s,A,V),dt(A,M,V)},p(A,V){V[0]&2&&m!==(m=A[34].name+"")&&Pr(v,m),V[0]&2&&S!==(S=ol+"/"+A[34].code+"/")&&X(p,"href",S)},d(A){A&&se(p),A&&se(M),A&&E.d()}}}function wm(c){let p,m,v,S;return{c(){p=Ie("button"),m=tt("NI 2020"),this.h()},l(E){p=ke(E,"BUTTON",{class:!0});var s=we(p);m=rt(s,"NI 2020"),s.forEach(se),this.h()},h(){X(p,"class","btn svelte-1dy7mjs"),ln(p,"btn-active",c[10]&!c[9]&!c[4])},m(E,s){dt(E,p,s),ie(p,m),v||(S=[Rn(p,"click",c[18]),Rn(p,"click",c[19]),Rn(p,"click",c[20])],v=!0)},p(E,s){s[0]&1552&&ln(p,"btn-active",E[10]&!E[9]&!E[4])},d(E){E&&se(p),v=!1,mu(S)}}}function P0(c){let p,m,v,S,E,s;const M=[Na[c[36]],{id:c[36]+"-fill"},{type:"fill"},{isChild:c[8][c[36]]},{click:!0},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{hover:!0},{hovered:c[7].hovered},{layout:{visibility:c[7].type==c[36]||c[7].childType==c[36]?"visible":"none"}},{paint:c[7].type==c[36]?Ir["fill-self"]:c[7].childType==c[36]?Ir["fill-child"]:Ir.fill}];let A={};for(let H=0;H<M.length;H+=1)A=Wl(A,M[H]);p=new Wu({props:A}),p.$on("select",c[13]);const V=[Na[c[36]],{id:c[36]+"-bounds"},{type:"line"},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{layout:{visibility:c[7].type==c[36]||c[7].childType==c[36]?"visible":"none"}},{paint:c[7].type==c[36]?Ir["line-active"]:c[7].childType==c[36]?Ir["line-child"]:Ir.line}];let N={};for(let H=0;H<V.length;H+=1)N=Wl(N,V[H]);v=new Wu({props:N});const W=[Na[c[36]],{id:c[36]+"-self"},{type:"line"},{selected:c[7].selected},{layout:{visibility:c[7].type==c[36]?"visible":"none"}},{paint:c[7].type==c[36]?Ir["line-self"]:Ir.line}];let K={};for(let H=0;H<W.length;H+=1)K=Wl(K,W[H]);return E=new Wu({props:K}),{c(){xi(p.$$.fragment),m=ht(),xi(v.$$.fragment),S=ht(),xi(E.$$.fragment)},l(H){bi(p.$$.fragment,H),m=pt(H),bi(v.$$.fragment,H),S=pt(H),bi(E.$$.fragment,H)},m(H,fe){wi(p,H,fe),dt(H,m,fe),wi(v,H,fe),dt(H,S,fe),wi(E,H,fe),s=!0},p(H,fe){const Oe=fe[0]&384?Hl(M,[fe&0&&Jl(Na[H[36]]),M[1],M[2],fe[0]&256&&{isChild:H[8][H[36]]},M[4],fe[0]&128&&{selected:H[7].selected},M[6],fe[0]&128&&{highlighted:H[7].highlighted},M[8],fe[0]&128&&{hovered:H[7].hovered},fe[0]&128&&{layout:{visibility:H[7].type==H[36]||H[7].childType==H[36]?"visible":"none"}},fe[0]&128&&{paint:H[7].type==H[36]?Ir["fill-self"]:H[7].childType==H[36]?Ir["fill-child"]:Ir.fill}]):{};p.$set(Oe);const ze=fe[0]&128?Hl(V,[fe&0&&Jl(Na[H[36]]),V[1],V[2],fe[0]&128&&{selected:H[7].selected},V[4],fe[0]&128&&{highlighted:H[7].highlighted},fe[0]&128&&{layout:{visibility:H[7].type==H[36]||H[7].childType==H[36]?"visible":"none"}},fe[0]&128&&{paint:H[7].type==H[36]?Ir["line-active"]:H[7].childType==H[36]?Ir["line-child"]:Ir.line}]):{};v.$set(ze);const Ke=fe[0]&128?Hl(W,[fe&0&&Jl(Na[H[36]]),W[1],W[2],fe[0]&128&&{selected:H[7].selected},fe[0]&128&&{layout:{visibility:H[7].type==H[36]?"visible":"none"}},fe[0]&128&&{paint:H[7].type==H[36]?Ir["line-self"]:Ir.line}]):{};E.$set(Ke)},i(H){s||(jt(p.$$.fragment,H),jt(v.$$.fragment,H),jt(E.$$.fragment,H),s=!0)},o(H){tr(p.$$.fragment,H),tr(v.$$.fragment,H),tr(E.$$.fragment,H),s=!1},d(H){Si(p,H),H&&se(m),Si(v,H),H&&se(S),Si(E,H)}}}function Sm(c){let p,m;const v=[Fh[c[36]]];let S={$$slots:{default:[P0]},$$scope:{ctx:c}};for(let E=0;E<v.length;E+=1)S=Wl(S,v[E]);return p=new Qm({props:S}),{c(){xi(p.$$.fragment)},l(E){bi(p.$$.fragment,E)},m(E,s){wi(p,E,s),m=!0},p(E,s){const M=s&0?Hl(v,[Jl(Fh[E[36]])]):{};s[0]&384|s[1]&2048&&(M.$$scope={dirty:s,ctx:E}),p.$set(M)},i(E){m||(jt(p.$$.fragment,E),m=!0)},o(E){tr(p.$$.fragment,E),m=!1},d(E){Si(p,E)}}}function Em(c){let p,m,v,S,E,s;const M=[Na[c[36]],{id:c[36]+"-fill"},{type:"fill"},{isChild:c[8][c[36]]},{click:!0},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{hover:!0},{hovered:c[7].hovered},{layout:{visibility:c[7].type==c[36]||c[7].childType==c[36]?"visible":"none"}},{paint:c[7].type==c[36]?Ir["fill-self"]:c[7].childType==c[36]?Ir["fill-child"]:Ir.fill}];let A={};for(let H=0;H<M.length;H+=1)A=Wl(A,M[H]);p=new Wu({props:A}),p.$on("select",c[13]);const V=[Na[c[36]],{id:c[36]+"-bounds"},{type:"line"},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{layout:{visibility:c[7].type==c[36]||c[7].childType==c[36]?"visible":"none"}},{paint:c[7].type==c[36]?Ir["line-active"]:c[7].childType==c[36]?Ir["line-child"]:Ir.line}];let N={};for(let H=0;H<V.length;H+=1)N=Wl(N,V[H]);v=new Wu({props:N});const W=[Na[c[36]],{id:c[36]+"-self"},{type:"line"},{selected:c[7].selected},{layout:{visibility:c[7].type==c[36]?"visible":"none"}},{paint:c[7].type==c[36]?Ir["line-self"]:Ir.line}];let K={};for(let H=0;H<W.length;H+=1)K=Wl(K,W[H]);return E=new Wu({props:K}),{c(){xi(p.$$.fragment),m=ht(),xi(v.$$.fragment),S=ht(),xi(E.$$.fragment)},l(H){bi(p.$$.fragment,H),m=pt(H),bi(v.$$.fragment,H),S=pt(H),bi(E.$$.fragment,H)},m(H,fe){wi(p,H,fe),dt(H,m,fe),wi(v,H,fe),dt(H,S,fe),wi(E,H,fe),s=!0},p(H,fe){const Oe=fe[0]&384?Hl(M,[fe&0&&Jl(Na[H[36]]),M[1],M[2],fe[0]&256&&{isChild:H[8][H[36]]},M[4],fe[0]&128&&{selected:H[7].selected},M[6],fe[0]&128&&{highlighted:H[7].highlighted},M[8],fe[0]&128&&{hovered:H[7].hovered},fe[0]&128&&{layout:{visibility:H[7].type==H[36]||H[7].childType==H[36]?"visible":"none"}},fe[0]&128&&{paint:H[7].type==H[36]?Ir["fill-self"]:H[7].childType==H[36]?Ir["fill-child"]:Ir.fill}]):{};p.$set(Oe);const ze=fe[0]&128?Hl(V,[fe&0&&Jl(Na[H[36]]),V[1],V[2],fe[0]&128&&{selected:H[7].selected},V[4],fe[0]&128&&{highlighted:H[7].highlighted},fe[0]&128&&{layout:{visibility:H[7].type==H[36]||H[7].childType==H[36]?"visible":"none"}},fe[0]&128&&{paint:H[7].type==H[36]?Ir["line-active"]:H[7].childType==H[36]?Ir["line-child"]:Ir.line}]):{};v.$set(ze);const Ke=fe[0]&128?Hl(W,[fe&0&&Jl(Na[H[36]]),W[1],W[2],fe[0]&128&&{selected:H[7].selected},fe[0]&128&&{layout:{visibility:H[7].type==H[36]?"visible":"none"}},fe[0]&128&&{paint:H[7].type==H[36]?Ir["line-self"]:Ir.line}]):{};E.$set(Ke)},i(H){s||(jt(p.$$.fragment,H),jt(v.$$.fragment,H),jt(E.$$.fragment,H),s=!0)},o(H){tr(p.$$.fragment,H),tr(v.$$.fragment,H),tr(E.$$.fragment,H),s=!1},d(H){Si(p,H),H&&se(m),Si(v,H),H&&se(S),Si(E,H)}}}function C0(c){let p,m,v=["lgd"],S=[];for(let s=0;s<1;s+=1)S[s]=Em(gm(c,v,s));const E=s=>tr(S[s],1,1,()=>{S[s]=null});return{c(){for(let s=0;s<1;s+=1)S[s].c();p=un()},l(s){for(let M=0;M<1;M+=1)S[M].l(s);p=un()},m(s,M){for(let A=0;A<1;A+=1)S[A].m(s,M);dt(s,p,M),m=!0},p(s,M){if(M[0]&8576){v=["lgd"];let A;for(A=0;A<1;A+=1){const V=gm(s,v,A);S[A]?(S[A].p(V,M),jt(S[A],1)):(S[A]=Em(V),S[A].c(),jt(S[A],1),S[A].m(p.parentNode,p))}for(fu(),A=1;A<1;A+=1)E(A);du()}},i(s){if(!m){for(let M=0;M<1;M+=1)jt(S[M]);m=!0}},o(s){S=S.filter(Boolean);for(let M=0;M<1;M+=1)tr(S[M]);m=!1},d(s){Os(S,s),s&&se(p)}}}function M0(c){let p,m,v,S=["ward","dea"],E=[];for(let V=0;V<2;V+=1)E[V]=Sm(_m(c,S,V));const s=V=>tr(E[V],1,1,()=>{E[V]=null}),M=[Fh.lgd];let A={$$slots:{default:[C0]},$$scope:{ctx:c}};for(let V=0;V<M.length;V+=1)A=Wl(A,M[V]);return m=new Qm({props:A}),{c(){for(let V=0;V<2;V+=1)E[V].c();p=ht(),xi(m.$$.fragment)},l(V){for(let N=0;N<2;N+=1)E[N].l(V);p=pt(V),bi(m.$$.fragment,V)},m(V,N){for(let W=0;W<2;W+=1)E[W].m(V,N);dt(V,p,N),wi(m,V,N),v=!0},p(V,N){if(N[0]&8576){S=["ward","dea"];let K;for(K=0;K<2;K+=1){const H=_m(V,S,K);E[K]?(E[K].p(H,N),jt(E[K],1)):(E[K]=Sm(H),E[K].c(),jt(E[K],1),E[K].m(p.parentNode,p))}for(fu(),K=2;K<2;K+=1)s(K);du()}const W=N&0?Hl(M,[Jl(Fh.lgd)]):{};N[0]&384|N[1]&2048&&(W.$$scope={dirty:N,ctx:V}),m.$set(W)},i(V){if(!v){for(let N=0;N<2;N+=1)jt(E[N]);jt(m.$$.fragment,V),v=!0}},o(V){E=E.filter(Boolean);for(let N=0;N<2;N+=1)tr(E[N]);tr(m.$$.fragment,V),v=!1},d(V){Os(E,V),V&&se(p),Si(m,V)}}}function D0(c){let p,m,v=c[1].name+"",S;return{c(){p=Ie("span"),m=tt("No parents for "),S=tt(v),this.h()},l(E){p=ke(E,"SPAN",{class:!0});var s=we(p);m=rt(s,"No parents for "),S=rt(s,v),s.forEach(se),this.h()},h(){X(p,"class","muted")},m(E,s){dt(E,p,s),ie(p,m),ie(p,S)},p(E,s){s[0]&2&&v!==(v=E[1].name+"")&&Pr(S,v)},d(E){E&&se(p)}}}function L0(c){let p,m=[...c[1].parents].reverse(),v=[];for(let S=0;S<m.length;S+=1)v[S]=Tm(ym(c,m,S));return{c(){for(let S=0;S<v.length;S+=1)v[S].c();p=un()},l(S){for(let E=0;E<v.length;E+=1)v[E].l(S);p=un()},m(S,E){for(let s=0;s<v.length;s+=1)v[s].m(S,E);dt(S,p,E)},p(S,E){if(E[0]&2){m=[...S[1].parents].reverse();let s;for(s=0;s<m.length;s+=1){const M=ym(S,m,s);v[s]?v[s].p(M,E):(v[s]=Tm(M),v[s].c(),v[s].m(p.parentNode,p))}for(;s<v.length;s+=1)v[s].d(1);v.length=m.length}},d(S){Os(v,S),S&&se(p)}}}function Tm(c){let p,m,v=c[33]>0?"\u21B3 ":"",S,E=c[34].name+"",s,M;return{c(){p=Ie("span"),m=new Vp(!1),S=Ie("a"),s=tt(E),this.h()},l(A){p=ke(A,"SPAN",{style:!0});var V=we(p);m=Np(V,!1),S=ke(V,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var N=we(S);s=rt(N,E),N.forEach(se),V.forEach(se),this.h()},h(){m.a=S,X(S,"href",M=ol+"/"+c[34].code),X(S,"sveltekit:noscroll",""),X(S,"class","svelte-1dy7mjs"),De(p,"display","block"),De(p,"margin-left",(c[33]>0?(c[33]-1)*15:0)+"px")},m(A,V){dt(A,p,V),m.m(v,p),ie(p,S),ie(S,s)},p(A,V){V[0]&2&&E!==(E=A[34].name+"")&&Pr(s,E),V[0]&2&&M!==(M=ol+"/"+A[34].code)&&X(S,"href",M)},d(A){A&&se(p)}}}function R0(c){let p,m,v=c[1].name+"",S;return{c(){p=Ie("span"),m=tt("No areas below "),S=tt(v),this.h()},l(E){p=ke(E,"SPAN",{class:!0});var s=we(p);m=rt(s,"No areas below "),S=rt(s,v),s.forEach(se),this.h()},h(){X(p,"class","muted")},m(E,s){dt(E,p,s),ie(p,m),ie(p,S)},p(E,s){s[0]&2&&v!==(v=E[1].name+"")&&Pr(S,v)},d(E){E&&se(p)}}}function B0(c){let p,m=c[1].children,v=[];for(let S=0;S<m.length;S+=1)v[S]=Im(mm(c,m,S));return{c(){for(let S=0;S<v.length;S+=1)v[S].c();p=un()},l(S){for(let E=0;E<v.length;E+=1)v[E].l(S);p=un()},m(S,E){for(let s=0;s<v.length;s+=1)v[s].m(S,E);dt(S,p,E)},p(S,E){if(E[0]&2){m=S[1].children;let s;for(s=0;s<m.length;s+=1){const M=mm(S,m,s);v[s]?v[s].p(M,E):(v[s]=Im(M),v[s].c(),v[s].m(p.parentNode,p))}for(;s<v.length;s+=1)v[s].d(1);v.length=m.length}},d(S){Os(v,S),S&&se(p)}}}function Im(c){let p,m=c[31].name+"",v,S,E=c[33]<c[1].children.length-1?", ":"",s;return{c(){p=Ie("a"),v=tt(m),s=tt(E),this.h()},l(M){p=ke(M,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var A=we(p);v=rt(A,m),A.forEach(se),s=rt(M,E),this.h()},h(){X(p,"href",S=ol+"/"+c[31].code),X(p,"sveltekit:noscroll",""),X(p,"class","svelte-1dy7mjs")},m(M,A){dt(M,p,A),ie(p,v),dt(M,s,A)},p(M,A){A[0]&2&&m!==(m=M[31].name+"")&&Pr(v,m),A[0]&2&&S!==(S=ol+"/"+M[31].code)&&X(p,"href",S),A[0]&2&&E!==(E=M[33]<M[1].children.length-1?", ":"")&&Pr(s,E)},d(M){M&&se(p),M&&se(s)}}}function O0(c){let p,m,v=c[1]&&c[2]&&xm(c);return{c(){v&&v.c(),p=un()},l(S){v&&v.l(S),p=un()},m(S,E){v&&v.m(S,E),dt(S,p,E),m=!0},p(S,E){S[1]&&S[2]?v?(v.p(S,E),E[0]&6&&jt(v,1)):(v=xm(S),v.c(),jt(v,1),v.m(p.parentNode,p)):v&&(fu(),tr(v,1,1,()=>{v=null}),du())},i(S){m||(jt(v),m=!0)},o(S){tr(v),m=!1},d(S){v&&v.d(S),S&&se(p)}}}function F0(c){let p,m,v,S,E,s,M,A,V,N,W,K,H,fe;return document.title=p=c[1].name+" Census Data",H=new Dg({props:{column:"wide",$$slots:{default:[O0]},$$scope:{ctx:c}}}),{c(){m=Ie("meta"),v=Ie("meta"),E=Ie("meta"),s=Ie("meta"),A=Ie("meta"),N=Ie("meta"),K=ht(),xi(H.$$.fragment),this.h()},l(Oe){const ze=Pg('[data-svelte="svelte-hyixok"]',document.head);m=ke(ze,"META",{name:!0,content:!0}),v=ke(ze,"META",{property:!0,content:!0}),E=ke(ze,"META",{property:!0,content:!0}),s=ke(ze,"META",{property:!0,content:!0}),A=ke(ze,"META",{property:!0,content:!0}),N=ke(ze,"META",{name:!0,content:!0}),ze.forEach(se),K=pt(Oe),bi(H.$$.fragment,Oe),this.h()},h(){X(m,"name","description"),X(m,"content",""),X(v,"property","og:title"),X(v,"content",S=c[1].name+" Census Data"),X(E,"property","og:type"),X(E,"content","website"),X(s,"property","og:url"),X(s,"content",M=Oh.base+"/"+c[1].code+"/"),X(A,"property","og:description"),X(A,"content",V="Explore census data for "+c[1].name+"."),X(N,"name","description"),X(N,"content",W="Explore census data for "+c[1].name+".")},m(Oe,ze){ie(document.head,m),ie(document.head,v),ie(document.head,E),ie(document.head,s),ie(document.head,A),ie(document.head,N),dt(Oe,K,ze),wi(H,Oe,ze),fe=!0},p(Oe,ze){(!fe||ze[0]&2)&&p!==(p=Oe[1].name+" Census Data")&&(document.title=p),(!fe||ze[0]&2&&S!==(S=Oe[1].name+" Census Data"))&&X(v,"content",S),(!fe||ze[0]&2&&M!==(M=Oh.base+"/"+Oe[1].code+"/"))&&X(s,"content",M),(!fe||ze[0]&2&&V!==(V="Explore census data for "+Oe[1].name+"."))&&X(A,"content",V),(!fe||ze[0]&2&&W!==(W="Explore census data for "+Oe[1].name+"."))&&X(N,"content",W);const Ke={};ze[0]&4095|ze[1]&2048&&(Ke.$$scope={dirty:ze,ctx:Oe}),H.$set(Ke)},i(Oe){fe||(jt(H.$$.fragment,Oe),fe=!0)},o(Oe){tr(H.$$.fragment,Oe),fe=!1},d(Oe){se(m),se(v),se(E),se(s),se(A),se(N),Oe&&se(K),Si(H,Oe)}}}const G0=!0;async function km(c,p){return await(await p(Oh.places+c+".json")).json()}async function K0({params:c,fetch:p}){let m=c.code,v=await qg(Oh.options,p),S={};v.forEach(A=>S[A.code]=A.name),v.forEach(A=>{A.typepl=cu[A.type].pl,A.typenm=cu[A.type].name,A.typestr=S[A.parent]?`${cu[A.type].name} within ${S[A.parent]}`:""});let E=v.sort((A,V)=>A.name.localeCompare(V.name)),s=await km("N92000002",p),M=await km(m,p);return{props:{options:E,place:M,ew:s}}}function V0(c,p,m){let v,S,E,{options:s,place:M,ew:A}=p,V,N,W=null,K=!1,H={selected:null,type:null,childType:null,highlighted:[],hovered:null},fe={};Object.keys(Na).forEach(kt=>m(8,fe[kt]=!1,fe));function Oe(kt){const er=(_r,Rt)=>_r+Rt;let nt=kt[0],Ze=kt[1],lr=M.data[nt][Ze][2020],br=M.data[nt][Ze][2010],Yi=A.data[nt][Ze][2020],Qi=gd[nt].map(_r=>_r.code),Ni=gd[nt].map(_r=>_r.label?_r.label:_r.code);return Qi.map((_r,Rt)=>Array.isArray(_r)?{x:Ni[Rt],y:_r.map(kr=>lr[kr]).reduce(er,0),ew:_r.map(kr=>Yi[kr]).reduce(er,0),prev:_r.map(kr=>br[kr]).reduce(er,0)}:{x:Ni[Rt],y:lr[_r],ew:Yi[_r],prev:br[_r]})}function ze(kt){W&&W.fitBounds(kt,{padding:20})}function Ke(kt){let er=JSON.parse(JSON.stringify(H)),nt=kt.code,Ze=kt.type,lr=kt.children[0]?kt.children.map(Gt=>Gt.code):[],br=kt.type=="rgn"?"cty":lr[0]?kt.children[0].type:null;m(7,H.selected=nt,H),m(7,H.type=Ze,H),m(7,H.childType=br,H),m(7,H.highlighted=lr,H);let Yi=Object.keys(Na),Qi=["fill-color","fill-opacity"],Ni=["line-color","line-width","line-opacity"];W&&(H.type!=er.type||H.childType!=er.childType)&&(Yi.forEach(Gt=>{let _r=Gt==Ze||br&&Gt==br?"visible":"none";W.setLayoutProperty(Gt+"-fill","visibility",_r),W.setLayoutProperty(Gt+"-bounds","visibility",_r),kt.parents[0]&&W.setLayoutProperty(Gt+"-self","visibility",_r),m(8,fe[Gt]=Gt==br,fe)}),kt.parents[0]&&(Qi.forEach(Gt=>W.setPaintProperty(Ze+"-fill",Gt,Ir[lr[0]?"fill-active":"fill-self"][Gt])),Ni.forEach(Gt=>{W.setPaintProperty(Ze+"-bounds",Gt,Ir["line-active"][Gt]),W.setPaintProperty(Ze+"-self",Gt,Ir["line-self"][Gt])})),br&&(Qi.forEach(Gt=>W.setPaintProperty(br+"-fill",Gt,Ir["fill-child"][Gt])),Ni.forEach(Gt=>W.setPaintProperty(br+"-bounds",Gt,Ir["line-child"][Gt]))))}function Xe(kt){Ke(kt),ze(kt.bounds)}function Ft(kt){xd(`${ol}/${kt.detail.code}/`,{noscroll:!0})}function Lt(kt){xd(`${ol}/${kt.detail.value}/`,{noscroll:!0})}function ft(){m(5,N=V<575?1:window.getComputedStyle(grid).getPropertyValue("grid-template-columns").split(" ").length)}const He=()=>m(9,E=!0),xr=()=>m(4,K=!1),cr=()=>m(10,S=!1),Wt=()=>m(10,S=!0),Ht=()=>m(9,E=!1),qe=()=>m(4,K=!1),mr=()=>m(4,K=!0),It=()=>m(9,E=!1),rr=()=>m(10,S=!1);function it(kt){W=kt,m(6,W)}function hr(){V=this.clientWidth,m(3,V)}function Or(){V=this.clientWidth,m(3,V)}return c.$$set=kt=>{"options"in kt&&m(0,s=kt.options),"place"in kt&&m(1,M=kt.place),"ew"in kt&&m(2,A=kt.ew)},c.$$.update=()=>{c.$$.dirty[0]&8&&V&&ft(),c.$$.dirty[0]&18&&m(11,v=K?"Same area 2010":M&&M.parents[0]?"NI 2020":null),c.$$.dirty[0]&2&&M&&Xe(M)},m(10,S=!1),m(9,E=!0),[s,M,A,V,K,N,W,H,fe,E,S,v,Oe,Ft,Lt,He,xr,cr,Wt,Ht,qe,mr,It,rr,it,hr,Or]}class X0 extends rs{constructor(p){super(),is(this,p,V0,F0,ns,{options:0,place:1,ew:2},null,[-1,-1])}}export{X0 as default,K0 as load,G0 as prerender};
