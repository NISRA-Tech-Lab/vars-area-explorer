import{S as Ka,i as Xa,s as Wa,e as dn,b as dt,f as Zt,g as mu,t as ir,d as yu,h as ae,o as zm,U as qt,V as Ir,j as Am,O as Ic,l as Ie,m as ke,n as we,p as X,W as Mh,q as Me,X as Dh,Q as kc,R as zc,T as Ac,Y as El,Z as Wo,_ as Ho,I as ie,K as Dc,E as ps,$ as Ms,J as fn,r as $e,u as et,v as Ar,w as gi,x as _i,y as vi,B as xi,a as pt,c as ft,M as jn,G as gu,a0 as Pm,a1 as md,P as Cg,a2 as Mg,a3 as Op,a4 as Fp,a5 as Dg,C as Xl,z as Wl,A as Hl}from"../../chunks/index-cfd5f23c.js";import{a as fu,u as Lh,S as Lg,m as za,c as yd,b as Rg,d as zr,e as Rh}from"../../chunks/Section-85678994.js";import{b as $s}from"../../chunks/paths-1c47712a.js";import{c as _u,w as kr,d as nn}from"../../chunks/singletons-b37796d7.js";/* empty css                                                                 */var gd={},wp={},Sp=34,bc=10,Ep=13;function Cm(c){return new Function("d","return {"+c.map(function(p,m){return JSON.stringify(p)+": d["+m+'] || ""'}).join(",")+"}")}function Bg(c,p){var m=Cm(c);return function(v,S){return p(m(v),S,c)}}function _d(c){var p=Object.create(null),m=[];return c.forEach(function(v){for(var S in v)S in p||m.push(p[S]=S)}),m}function ka(c,p){var m=c+"",v=m.length;return v<p?new Array(p-v+1).join(0)+m:m}function Og(c){return c<0?"-"+ka(-c,6):c>9999?"+"+ka(c,6):ka(c,4)}function Fg(c){var p=c.getUTCHours(),m=c.getUTCMinutes(),v=c.getUTCSeconds(),S=c.getUTCMilliseconds();return isNaN(c)?"Invalid Date":Og(c.getUTCFullYear())+"-"+ka(c.getUTCMonth()+1,2)+"-"+ka(c.getUTCDate(),2)+(S?"T"+ka(p,2)+":"+ka(m,2)+":"+ka(v,2)+"."+ka(S,3)+"Z":v?"T"+ka(p,2)+":"+ka(m,2)+":"+ka(v,2)+"Z":m||p?"T"+ka(p,2)+":"+ka(m,2)+"Z":"")}function Vg(c){var p=new RegExp('["'+c+`
\r]`),m=c.charCodeAt(0);function v(W,K){var H,pe,Re=S(W,function(ze,Ge){if(H)return H(ze,Ge-1);pe=ze,H=K?Bg(ze,K):Cm(ze)});return Re.columns=pe||[],Re}function S(W,K){var H=[],pe=W.length,Re=0,ze=0,Ge,Ke=pe<=0,Nt=!1;W.charCodeAt(pe-1)===bc&&--pe,W.charCodeAt(pe-1)===Ep&&--pe;function Dt(){if(Ke)return wp;if(Nt)return Nt=!1,gd;var He,Er=Re,hr;if(W.charCodeAt(Er)===Sp){for(;Re++<pe&&W.charCodeAt(Re)!==Sp||W.charCodeAt(++Re)===Sp;);return(He=Re)>=pe?Ke=!0:(hr=W.charCodeAt(Re++))===bc?Nt=!0:hr===Ep&&(Nt=!0,W.charCodeAt(Re)===bc&&++Re),W.slice(Er+1,He-1).replace(/""/g,'"')}for(;Re<pe;){if((hr=W.charCodeAt(He=Re++))===bc)Nt=!0;else if(hr===Ep)Nt=!0,W.charCodeAt(Re)===bc&&++Re;else if(hr!==m)continue;return W.slice(Er,He)}return Ke=!0,W.slice(Er,pe)}for(;(Ge=Dt())!==wp;){for(var mt=[];Ge!==gd&&Ge!==wp;)mt.push(Ge),Ge=Dt();K&&(mt=K(mt,ze++))==null||H.push(mt)}return H}function E(W,K){return W.map(function(H){return K.map(function(pe){return N(H[pe])}).join(c)})}function s(W,K){return K==null&&(K=_d(W)),[K.map(N).join(c)].concat(E(W,K)).join(`
`)}function C(W,K){return K==null&&(K=_d(W)),E(W,K).join(`
`)}function A(W){return W.map(V).join(`
`)}function V(W){return W.map(N).join(c)}function N(W){return W==null?"":W instanceof Date?Fg(W):p.test(W+="")?'"'+W.replace(/"/g,'""')+'"':W}return{parse:v,parseRows:S,format:s,formatBody:C,formatRows:A,formatRow:V,formatValue:N}}var Ng=Vg(","),Ug=Ng.parse;function jg(c){for(var p in c){var m=c[p].trim(),v,S;if(!m)m=null;else if(m==="true")m=!0;else if(m==="false")m=!1;else if(m==="NaN")m=NaN;else if(!isNaN(v=+m))m=v;else if(S=m.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))qg&&!!S[4]&&!S[7]&&(m=m.replace(/-/g,"/").replace(/T/," ")),m=new Date(m);else continue;c[p]=m}return c}const qg=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();async function Zg(c,p=window.fetch){let v=await(await p(c)).text();return await Ug(v,jg)}function Bh(c,p="",m=0){return c!=0?Math.abs(c).toFixed(m)+p:p=="pp"?"n/c":"<1%)"}_u.disable_scroll_handling;const vd=_u.goto;_u.invalidate;_u.prefetch;_u.prefetch_routes;_u.before_navigate;_u.after_navigate;function Gg(c){return c===0?!0:c}function Kl(c){return Gg(c)?Array.isArray(c)?p=>c.map(m=>typeof m!="function"?p[m]:m(p)):typeof c!="function"?p=>p[c]:c:null}function Kg(c){const p={};for(const m of c){if(Object(m)!==m)throw new TypeError("iterable for fromEntries should yield objects");const{"0":v,"1":S}=m;Object.defineProperty(p,v,{configurable:!0,enumerable:!0,writable:!0,value:S})}return p}function Tp(c,p={}){return Kg(Object.entries(c).filter(([m,v])=>v!==void 0&&p[m]===void 0))}function Xg(c,p){if(!Array.isArray(c))throw new TypeError(`The first argument of calcExtents() must be an array. You passed in a ${typeof c}. Consider passing a flat array to the \`flatData\` prop. More info: https://layercake.graphics/guide/#flatdata`);if(Array.isArray(p)||p===void 0||p===null)throw new TypeError("The second argument of calcExtents() must be an object with field names as keys as accessor functions as values.");const m={},v=Object.keys(p),S=v.length;let E,s,C,A,V,N,W,K;const H=c.length;for(E=0;E<S;E+=1){for(A=v[E],W=p[A],V=null,N=null,s=0;s<H;s+=1)if(K=W(c[s]),Array.isArray(K)){const pe=K.length;for(C=0;C<pe;C+=1)K[C]!==void 0&&K[C]!==null&&Number.isNaN(K[C])===!1&&((V===null||K[C]<V)&&(V=K[C]),(N===null||K[C]>N)&&(N=K[C]))}else K!=null&&Number.isNaN(K)===!1&&((V===null||K<V)&&(V=K),(N===null||K>N)&&(N=K));m[A]=[V,N]}return m}function Mm(c=[],p){return Array.isArray(p)===!0?p.map((m,v)=>m===null?c[v]:m):c}function xh(c){return function([m,v]){return m?Mm(m[c],v):v}}function Ph(c,p){return c==null||p==null?NaN:c<p?-1:c>p?1:c>=p?0:NaN}function Wg(c,p){return c==null||p==null?NaN:p<c?-1:p>c?1:p>=c?0:NaN}function Dm(c){let p,m,v;c.length!==2?(p=Ph,m=(C,A)=>Ph(c(C),A),v=(C,A)=>c(C)-A):(p=c===Ph||c===Wg?c:Hg,m=c,v=c);function S(C,A,V=0,N=C.length){if(V<N){if(p(A,A)!==0)return N;do{const W=V+N>>>1;m(C[W],A)<0?V=W+1:N=W}while(V<N)}return V}function E(C,A,V=0,N=C.length){if(V<N){if(p(A,A)!==0)return N;do{const W=V+N>>>1;m(C[W],A)<=0?V=W+1:N=W}while(V<N)}return V}function s(C,A,V=0,N=C.length){const W=S(C,A,V,N-1);return W>V&&v(C[W-1],A)>-v(C[W],A)?W-1:W}return{left:S,center:s,right:E}}function Hg(){return 0}function Jg(c){return c===null?NaN:+c}const Yg=Dm(Ph),Qg=Yg.right;Dm(Jg).center;const $g=Qg;class xd extends Map{constructor(p,m=r_){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:m}}),p!=null)for(const[v,S]of p)this.set(v,S)}get(p){return super.get(bd(this,p))}has(p){return super.has(bd(this,p))}set(p,m){return super.set(e_(this,p),m)}delete(p){return super.delete(t_(this,p))}}function bd({_intern:c,_key:p},m){const v=p(m);return c.has(v)?c.get(v):m}function e_({_intern:c,_key:p},m){const v=p(m);return c.has(v)?c.get(v):(c.set(v,m),m)}function t_({_intern:c,_key:p},m){const v=p(m);return c.has(v)&&(m=c.get(v),c.delete(v)),m}function r_(c){return c!==null&&typeof c=="object"?c.valueOf():c}var Pp=Math.sqrt(50),Cp=Math.sqrt(10),Mp=Math.sqrt(2);function i_(c,p,m){var v,S=-1,E,s,C;if(p=+p,c=+c,m=+m,c===p&&m>0)return[c];if((v=p<c)&&(E=c,c=p,p=E),(C=Lm(c,p,m))===0||!isFinite(C))return[];if(C>0){let A=Math.round(c/C),V=Math.round(p/C);for(A*C<c&&++A,V*C>p&&--V,s=new Array(E=V-A+1);++S<E;)s[S]=(A+S)*C}else{C=-C;let A=Math.round(c*C),V=Math.round(p*C);for(A/C<c&&++A,V/C>p&&--V,s=new Array(E=V-A+1);++S<E;)s[S]=(A+S)/C}return v&&s.reverse(),s}function Lm(c,p,m){var v=(p-c)/Math.max(0,m),S=Math.floor(Math.log(v)/Math.LN10),E=v/Math.pow(10,S);return S>=0?(E>=Pp?10:E>=Cp?5:E>=Mp?2:1)*Math.pow(10,S):-Math.pow(10,-S)/(E>=Pp?10:E>=Cp?5:E>=Mp?2:1)}function n_(c,p,m){var v=Math.abs(p-c)/Math.max(0,m),S=Math.pow(10,Math.floor(Math.log(v)/Math.LN10)),E=v/S;return E>=Pp?S*=10:E>=Cp?S*=5:E>=Mp&&(S*=2),p<c?-S:S}function o_(c,p,m){c=+c,p=+p,m=(S=arguments.length)<2?(p=c,c=0,1):S<3?1:+m;for(var v=-1,S=Math.max(0,Math.ceil((p-c)/m))|0,E=new Array(S);++v<S;)E[v]=c+v*m;return E}function jh(c,p){switch(arguments.length){case 0:break;case 1:this.range(c);break;default:this.range(p).domain(c);break}return this}const wd=Symbol("implicit");function Rm(){var c=new xd,p=[],m=[],v=wd;function S(E){let s=c.get(E);if(s===void 0){if(v!==wd)return v;c.set(E,s=p.push(E)-1)}return m[s%m.length]}return S.domain=function(E){if(!arguments.length)return p.slice();p=[],c=new xd;for(const s of E)c.has(s)||c.set(s,p.push(s)-1);return S},S.range=function(E){return arguments.length?(m=Array.from(E),S):m.slice()},S.unknown=function(E){return arguments.length?(v=E,S):v},S.copy=function(){return Rm(p,m).unknown(v)},jh.apply(S,arguments),S}function Bm(){var c=Rm().unknown(void 0),p=c.domain,m=c.range,v=0,S=1,E,s,C=!1,A=0,V=0,N=.5;delete c.unknown;function W(){var K=p().length,H=S<v,pe=H?S:v,Re=H?v:S;E=(Re-pe)/Math.max(1,K-A+V*2),C&&(E=Math.floor(E)),pe+=(Re-pe-E*(K-A))*N,s=E*(1-A),C&&(pe=Math.round(pe),s=Math.round(s));var ze=o_(K).map(function(Ge){return pe+E*Ge});return m(H?ze.reverse():ze)}return c.domain=function(K){return arguments.length?(p(K),W()):p()},c.range=function(K){return arguments.length?([v,S]=K,v=+v,S=+S,W()):[v,S]},c.rangeRound=function(K){return[v,S]=K,v=+v,S=+S,C=!0,W()},c.bandwidth=function(){return s},c.step=function(){return E},c.round=function(K){return arguments.length?(C=!!K,W()):C},c.padding=function(K){return arguments.length?(A=Math.min(1,V=+K),W()):A},c.paddingInner=function(K){return arguments.length?(A=Math.min(1,K),W()):A},c.paddingOuter=function(K){return arguments.length?(V=+K,W()):V},c.align=function(K){return arguments.length?(N=Math.max(0,Math.min(1,K)),W()):N},c.copy=function(){return Bm(p(),[v,S]).round(C).paddingInner(A).paddingOuter(V).align(N)},jh.apply(W(),arguments)}function Vp(c,p,m){c.prototype=p.prototype=m,m.constructor=c}function Om(c,p){var m=Object.create(c.prototype);for(var v in p)m[v]=p[v];return m}function Lc(){}var Pc=.7,Oh=1/Pc,Xu="\\s*([+-]?\\d+)\\s*",Cc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Qs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",a_=/^#([0-9a-f]{3,8})$/,s_=new RegExp(`^rgb\\(${Xu},${Xu},${Xu}\\)$`),l_=new RegExp(`^rgb\\(${Qs},${Qs},${Qs}\\)$`),u_=new RegExp(`^rgba\\(${Xu},${Xu},${Xu},${Cc}\\)$`),c_=new RegExp(`^rgba\\(${Qs},${Qs},${Qs},${Cc}\\)$`),h_=new RegExp(`^hsl\\(${Cc},${Qs},${Qs}\\)$`),p_=new RegExp(`^hsla\\(${Cc},${Qs},${Qs},${Cc}\\)$`),Sd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Vp(Lc,Mc,{copy(c){return Object.assign(new this.constructor,this,c)},displayable(){return this.rgb().displayable()},hex:Ed,formatHex:Ed,formatHex8:f_,formatHsl:d_,formatRgb:Td,toString:Td});function Ed(){return this.rgb().formatHex()}function f_(){return this.rgb().formatHex8()}function d_(){return Fm(this).formatHsl()}function Td(){return this.rgb().formatRgb()}function Mc(c){var p,m;return c=(c+"").trim().toLowerCase(),(p=a_.exec(c))?(m=p[1].length,p=parseInt(p[1],16),m===6?Id(p):m===3?new Aa(p>>8&15|p>>4&240,p>>4&15|p&240,(p&15)<<4|p&15,1):m===8?bh(p>>24&255,p>>16&255,p>>8&255,(p&255)/255):m===4?bh(p>>12&15|p>>8&240,p>>8&15|p>>4&240,p>>4&15|p&240,((p&15)<<4|p&15)/255):null):(p=s_.exec(c))?new Aa(p[1],p[2],p[3],1):(p=l_.exec(c))?new Aa(p[1]*255/100,p[2]*255/100,p[3]*255/100,1):(p=u_.exec(c))?bh(p[1],p[2],p[3],p[4]):(p=c_.exec(c))?bh(p[1]*255/100,p[2]*255/100,p[3]*255/100,p[4]):(p=h_.exec(c))?Ad(p[1],p[2]/100,p[3]/100,1):(p=p_.exec(c))?Ad(p[1],p[2]/100,p[3]/100,p[4]):Sd.hasOwnProperty(c)?Id(Sd[c]):c==="transparent"?new Aa(NaN,NaN,NaN,0):null}function Id(c){return new Aa(c>>16&255,c>>8&255,c&255,1)}function bh(c,p,m,v){return v<=0&&(c=p=m=NaN),new Aa(c,p,m,v)}function m_(c){return c instanceof Lc||(c=Mc(c)),c?(c=c.rgb(),new Aa(c.r,c.g,c.b,c.opacity)):new Aa}function Dp(c,p,m,v){return arguments.length===1?m_(c):new Aa(c,p,m,v==null?1:v)}function Aa(c,p,m,v){this.r=+c,this.g=+p,this.b=+m,this.opacity=+v}Vp(Aa,Dp,Om(Lc,{brighter(c){return c=c==null?Oh:Math.pow(Oh,c),new Aa(this.r*c,this.g*c,this.b*c,this.opacity)},darker(c){return c=c==null?Pc:Math.pow(Pc,c),new Aa(this.r*c,this.g*c,this.b*c,this.opacity)},rgb(){return this},clamp(){return new Aa(du(this.r),du(this.g),du(this.b),Fh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:kd,formatHex:kd,formatHex8:y_,formatRgb:zd,toString:zd}));function kd(){return`#${pu(this.r)}${pu(this.g)}${pu(this.b)}`}function y_(){return`#${pu(this.r)}${pu(this.g)}${pu(this.b)}${pu((isNaN(this.opacity)?1:this.opacity)*255)}`}function zd(){const c=Fh(this.opacity);return`${c===1?"rgb(":"rgba("}${du(this.r)}, ${du(this.g)}, ${du(this.b)}${c===1?")":`, ${c})`}`}function Fh(c){return isNaN(c)?1:Math.max(0,Math.min(1,c))}function du(c){return Math.max(0,Math.min(255,Math.round(c)||0))}function pu(c){return c=du(c),(c<16?"0":"")+c.toString(16)}function Ad(c,p,m,v){return v<=0?c=p=m=NaN:m<=0||m>=1?c=p=NaN:p<=0&&(c=NaN),new Cs(c,p,m,v)}function Fm(c){if(c instanceof Cs)return new Cs(c.h,c.s,c.l,c.opacity);if(c instanceof Lc||(c=Mc(c)),!c)return new Cs;if(c instanceof Cs)return c;c=c.rgb();var p=c.r/255,m=c.g/255,v=c.b/255,S=Math.min(p,m,v),E=Math.max(p,m,v),s=NaN,C=E-S,A=(E+S)/2;return C?(p===E?s=(m-v)/C+(m<v)*6:m===E?s=(v-p)/C+2:s=(p-m)/C+4,C/=A<.5?E+S:2-E-S,s*=60):C=A>0&&A<1?0:s,new Cs(s,C,A,c.opacity)}function g_(c,p,m,v){return arguments.length===1?Fm(c):new Cs(c,p,m,v==null?1:v)}function Cs(c,p,m,v){this.h=+c,this.s=+p,this.l=+m,this.opacity=+v}Vp(Cs,g_,Om(Lc,{brighter(c){return c=c==null?Oh:Math.pow(Oh,c),new Cs(this.h,this.s,this.l*c,this.opacity)},darker(c){return c=c==null?Pc:Math.pow(Pc,c),new Cs(this.h,this.s,this.l*c,this.opacity)},rgb(){var c=this.h%360+(this.h<0)*360,p=isNaN(c)||isNaN(this.s)?0:this.s,m=this.l,v=m+(m<.5?m:1-m)*p,S=2*m-v;return new Aa(Ip(c>=240?c-240:c+120,S,v),Ip(c,S,v),Ip(c<120?c+240:c-120,S,v),this.opacity)},clamp(){return new Cs(Pd(this.h),wh(this.s),wh(this.l),Fh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const c=Fh(this.opacity);return`${c===1?"hsl(":"hsla("}${Pd(this.h)}, ${wh(this.s)*100}%, ${wh(this.l)*100}%${c===1?")":`, ${c})`}`}}));function Pd(c){return c=(c||0)%360,c<0?c+360:c}function wh(c){return Math.max(0,Math.min(1,c||0))}function Ip(c,p,m){return(c<60?p+(m-p)*c/60:c<180?m:c<240?p+(m-p)*(240-c)/60:p)*255}const Np=c=>()=>c;function __(c,p){return function(m){return c+m*p}}function v_(c,p,m){return c=Math.pow(c,m),p=Math.pow(p,m)-c,m=1/m,function(v){return Math.pow(c+v*p,m)}}function x_(c){return(c=+c)==1?Vm:function(p,m){return m-p?v_(p,m,c):Np(isNaN(p)?m:p)}}function Vm(c,p){var m=p-c;return m?__(c,m):Np(isNaN(c)?p:c)}const Cd=function c(p){var m=x_(p);function v(S,E){var s=m((S=Dp(S)).r,(E=Dp(E)).r),C=m(S.g,E.g),A=m(S.b,E.b),V=Vm(S.opacity,E.opacity);return function(N){return S.r=s(N),S.g=C(N),S.b=A(N),S.opacity=V(N),S+""}}return v.gamma=c,v}(1);function b_(c,p){p||(p=[]);var m=c?Math.min(p.length,c.length):0,v=p.slice(),S;return function(E){for(S=0;S<m;++S)v[S]=c[S]*(1-E)+p[S]*E;return v}}function w_(c){return ArrayBuffer.isView(c)&&!(c instanceof DataView)}function S_(c,p){var m=p?p.length:0,v=c?Math.min(m,c.length):0,S=new Array(v),E=new Array(m),s;for(s=0;s<v;++s)S[s]=Up(c[s],p[s]);for(;s<m;++s)E[s]=p[s];return function(C){for(s=0;s<v;++s)E[s]=S[s](C);return E}}function E_(c,p){var m=new Date;return c=+c,p=+p,function(v){return m.setTime(c*(1-v)+p*v),m}}function Vh(c,p){return c=+c,p=+p,function(m){return c*(1-m)+p*m}}function T_(c,p){var m={},v={},S;(c===null||typeof c!="object")&&(c={}),(p===null||typeof p!="object")&&(p={});for(S in p)S in c?m[S]=Up(c[S],p[S]):v[S]=p[S];return function(E){for(S in m)v[S]=m[S](E);return v}}var Lp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,kp=new RegExp(Lp.source,"g");function I_(c){return function(){return c}}function k_(c){return function(p){return c(p)+""}}function z_(c,p){var m=Lp.lastIndex=kp.lastIndex=0,v,S,E,s=-1,C=[],A=[];for(c=c+"",p=p+"";(v=Lp.exec(c))&&(S=kp.exec(p));)(E=S.index)>m&&(E=p.slice(m,E),C[s]?C[s]+=E:C[++s]=E),(v=v[0])===(S=S[0])?C[s]?C[s]+=S:C[++s]=S:(C[++s]=null,A.push({i:s,x:Vh(v,S)})),m=kp.lastIndex;return m<p.length&&(E=p.slice(m),C[s]?C[s]+=E:C[++s]=E),C.length<2?A[0]?k_(A[0].x):I_(p):(p=A.length,function(V){for(var N=0,W;N<p;++N)C[(W=A[N]).i]=W.x(V);return C.join("")})}function Up(c,p){var m=typeof p,v;return p==null||m==="boolean"?Np(p):(m==="number"?Vh:m==="string"?(v=Mc(p))?(p=v,Cd):z_:p instanceof Mc?Cd:p instanceof Date?E_:w_(p)?b_:Array.isArray(p)?S_:typeof p.valueOf!="function"&&typeof p.toString!="function"||isNaN(p)?T_:Vh)(c,p)}function A_(c,p){return c=+c,p=+p,function(m){return Math.round(c*(1-m)+p*m)}}function P_(c){return function(){return c}}function C_(c){return+c}var Md=[0,1];function Ys(c){return c}function Rp(c,p){return(p-=c=+c)?function(m){return(m-c)/p}:P_(isNaN(p)?NaN:.5)}function M_(c,p){var m;return c>p&&(m=c,c=p,p=m),function(v){return Math.max(c,Math.min(p,v))}}function D_(c,p,m){var v=c[0],S=c[1],E=p[0],s=p[1];return S<v?(v=Rp(S,v),E=m(s,E)):(v=Rp(v,S),E=m(E,s)),function(C){return E(v(C))}}function L_(c,p,m){var v=Math.min(c.length,p.length)-1,S=new Array(v),E=new Array(v),s=-1;for(c[v]<c[0]&&(c=c.slice().reverse(),p=p.slice().reverse());++s<v;)S[s]=Rp(c[s],c[s+1]),E[s]=m(p[s],p[s+1]);return function(C){var A=$g(c,C,1,v)-1;return E[A](S[A](C))}}function Nm(c,p){return p.domain(c.domain()).range(c.range()).interpolate(c.interpolate()).clamp(c.clamp()).unknown(c.unknown())}function Um(){var c=Md,p=Md,m=Up,v,S,E,s=Ys,C,A,V;function N(){var K=Math.min(c.length,p.length);return s!==Ys&&(s=M_(c[0],c[K-1])),C=K>2?L_:D_,A=V=null,W}function W(K){return K==null||isNaN(K=+K)?E:(A||(A=C(c.map(v),p,m)))(v(s(K)))}return W.invert=function(K){return s(S((V||(V=C(p,c.map(v),Vh)))(K)))},W.domain=function(K){return arguments.length?(c=Array.from(K,C_),N()):c.slice()},W.range=function(K){return arguments.length?(p=Array.from(K),N()):p.slice()},W.rangeRound=function(K){return p=Array.from(K),m=A_,N()},W.clamp=function(K){return arguments.length?(s=K?!0:Ys,N()):s!==Ys},W.interpolate=function(K){return arguments.length?(m=K,N()):m},W.unknown=function(K){return arguments.length?(E=K,W):E},function(K,H){return v=K,S=H,N()}}function R_(){return Um()(Ys,Ys)}function B_(c){return Math.abs(c=Math.round(c))>=1e21?c.toLocaleString("en").replace(/,/g,""):c.toString(10)}function Nh(c,p){if((m=(c=p?c.toExponential(p-1):c.toExponential()).indexOf("e"))<0)return null;var m,v=c.slice(0,m);return[v.length>1?v[0]+v.slice(2):v,+c.slice(m+1)]}function Hu(c){return c=Nh(Math.abs(c)),c?c[1]:NaN}function O_(c,p){return function(m,v){for(var S=m.length,E=[],s=0,C=c[0],A=0;S>0&&C>0&&(A+C+1>v&&(C=Math.max(1,v-A)),E.push(m.substring(S-=C,S+C)),!((A+=C+1)>v));)C=c[s=(s+1)%c.length];return E.reverse().join(p)}}function F_(c){return function(p){return p.replace(/[0-9]/g,function(m){return c[+m]})}}var V_=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Uh(c){if(!(p=V_.exec(c)))throw new Error("invalid format: "+c);var p;return new jp({fill:p[1],align:p[2],sign:p[3],symbol:p[4],zero:p[5],width:p[6],comma:p[7],precision:p[8]&&p[8].slice(1),trim:p[9],type:p[10]})}Uh.prototype=jp.prototype;function jp(c){this.fill=c.fill===void 0?" ":c.fill+"",this.align=c.align===void 0?">":c.align+"",this.sign=c.sign===void 0?"-":c.sign+"",this.symbol=c.symbol===void 0?"":c.symbol+"",this.zero=!!c.zero,this.width=c.width===void 0?void 0:+c.width,this.comma=!!c.comma,this.precision=c.precision===void 0?void 0:+c.precision,this.trim=!!c.trim,this.type=c.type===void 0?"":c.type+""}jp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function N_(c){e:for(var p=c.length,m=1,v=-1,S;m<p;++m)switch(c[m]){case".":v=S=m;break;case"0":v===0&&(v=m),S=m;break;default:if(!+c[m])break e;v>0&&(v=0);break}return v>0?c.slice(0,v)+c.slice(S+1):c}var jm;function U_(c,p){var m=Nh(c,p);if(!m)return c+"";var v=m[0],S=m[1],E=S-(jm=Math.max(-8,Math.min(8,Math.floor(S/3)))*3)+1,s=v.length;return E===s?v:E>s?v+new Array(E-s+1).join("0"):E>0?v.slice(0,E)+"."+v.slice(E):"0."+new Array(1-E).join("0")+Nh(c,Math.max(0,p+E-1))[0]}function Dd(c,p){var m=Nh(c,p);if(!m)return c+"";var v=m[0],S=m[1];return S<0?"0."+new Array(-S).join("0")+v:v.length>S+1?v.slice(0,S+1)+"."+v.slice(S+1):v+new Array(S-v.length+2).join("0")}const Ld={"%":(c,p)=>(c*100).toFixed(p),b:c=>Math.round(c).toString(2),c:c=>c+"",d:B_,e:(c,p)=>c.toExponential(p),f:(c,p)=>c.toFixed(p),g:(c,p)=>c.toPrecision(p),o:c=>Math.round(c).toString(8),p:(c,p)=>Dd(c*100,p),r:Dd,s:U_,X:c=>Math.round(c).toString(16).toUpperCase(),x:c=>Math.round(c).toString(16)};function Rd(c){return c}var Bd=Array.prototype.map,Od=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function j_(c){var p=c.grouping===void 0||c.thousands===void 0?Rd:O_(Bd.call(c.grouping,Number),c.thousands+""),m=c.currency===void 0?"":c.currency[0]+"",v=c.currency===void 0?"":c.currency[1]+"",S=c.decimal===void 0?".":c.decimal+"",E=c.numerals===void 0?Rd:F_(Bd.call(c.numerals,String)),s=c.percent===void 0?"%":c.percent+"",C=c.minus===void 0?"\u2212":c.minus+"",A=c.nan===void 0?"NaN":c.nan+"";function V(W){W=Uh(W);var K=W.fill,H=W.align,pe=W.sign,Re=W.symbol,ze=W.zero,Ge=W.width,Ke=W.comma,Nt=W.precision,Dt=W.trim,mt=W.type;mt==="n"?(Ke=!0,mt="g"):Ld[mt]||(Nt===void 0&&(Nt=12),Dt=!0,mt="g"),(ze||K==="0"&&H==="=")&&(ze=!0,K="0",H="=");var He=Re==="$"?m:Re==="#"&&/[boxX]/.test(mt)?"0"+mt.toLowerCase():"",Er=Re==="$"?v:/[%p]/.test(mt)?s:"",hr=Ld[mt],Ht=/[defgprs%]/.test(mt);Nt=Nt===void 0?6:/[gprs]/.test(mt)?Math.max(1,Math.min(21,Nt)):Math.max(0,Math.min(20,Nt));function Jt(qe){var _r=He,At=Er,nr,tt,pr;if(mt==="c")At=hr(qe)+At,qe="";else{qe=+qe;var Vr=qe<0||1/qe<0;if(qe=isNaN(qe)?A:hr(Math.abs(qe),Nt),Dt&&(qe=N_(qe)),Vr&&+qe==0&&pe!=="+"&&(Vr=!1),_r=(Vr?pe==="("?pe:C:pe==="-"||pe==="("?"":pe)+_r,At=(mt==="s"?Od[8+jm/3]:"")+At+(Vr&&pe==="("?")":""),Ht){for(nr=-1,tt=qe.length;++nr<tt;)if(pr=qe.charCodeAt(nr),48>pr||pr>57){At=(pr===46?S+qe.slice(nr+1):qe.slice(nr))+At,qe=qe.slice(0,nr);break}}}Ke&&!ze&&(qe=p(qe,1/0));var Pt=_r.length+qe.length+At.length,tr=Pt<Ge?new Array(Ge-Pt+1).join(K):"";switch(Ke&&ze&&(qe=p(tr+qe,tr.length?Ge-At.length:1/0),tr=""),H){case"<":qe=_r+qe+At+tr;break;case"=":qe=_r+tr+qe+At;break;case"^":qe=tr.slice(0,Pt=tr.length>>1)+_r+qe+At+tr.slice(Pt);break;default:qe=tr+_r+qe+At;break}return E(qe)}return Jt.toString=function(){return W+""},Jt}function N(W,K){var H=V((W=Uh(W),W.type="f",W)),pe=Math.max(-8,Math.min(8,Math.floor(Hu(K)/3)))*3,Re=Math.pow(10,-pe),ze=Od[8+pe/3];return function(Ge){return H(Re*Ge)+ze}}return{format:V,formatPrefix:N}}var Sh,qm,Zm;q_({thousands:",",grouping:[3],currency:["$",""]});function q_(c){return Sh=j_(c),qm=Sh.format,Zm=Sh.formatPrefix,Sh}function Z_(c){return Math.max(0,-Hu(Math.abs(c)))}function G_(c,p){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Hu(p)/3)))*3-Hu(Math.abs(c)))}function K_(c,p){return c=Math.abs(c),p=Math.abs(p)-c,Math.max(0,Hu(p)-Hu(c))+1}function X_(c,p,m,v){var S=n_(c,p,m),E;switch(v=Uh(v==null?",f":v),v.type){case"s":{var s=Math.max(Math.abs(c),Math.abs(p));return v.precision==null&&!isNaN(E=G_(S,s))&&(v.precision=E),Zm(v,s)}case"":case"e":case"g":case"p":case"r":{v.precision==null&&!isNaN(E=K_(S,Math.max(Math.abs(c),Math.abs(p))))&&(v.precision=E-(v.type==="e"));break}case"f":case"%":{v.precision==null&&!isNaN(E=Z_(S))&&(v.precision=E-(v.type==="%")*2);break}}return qm(v)}function Gm(c){var p=c.domain;return c.ticks=function(m){var v=p();return i_(v[0],v[v.length-1],m==null?10:m)},c.tickFormat=function(m,v){var S=p();return X_(S[0],S[S.length-1],m==null?10:m,v)},c.nice=function(m){m==null&&(m=10);var v=p(),S=0,E=v.length-1,s=v[S],C=v[E],A,V,N=10;for(C<s&&(V=s,s=C,C=V,V=S,S=E,E=V);N-- >0;){if(V=Lm(s,C,m),V===A)return v[S]=s,v[E]=C,p(v);if(V>0)s=Math.floor(s/V)*V,C=Math.ceil(C/V)*V;else if(V<0)s=Math.ceil(s*V)/V,C=Math.floor(C*V)/V;else break;A=V}return c},c}function Ch(){var c=R_();return c.copy=function(){return Nm(c,Ch())},jh.apply(c,arguments),Gm(c)}function Fd(c){return function(p){return p<0?-Math.pow(-p,c):Math.pow(p,c)}}function W_(c){return c<0?-Math.sqrt(-c):Math.sqrt(c)}function H_(c){return c<0?-c*c:c*c}function J_(c){var p=c(Ys,Ys),m=1;function v(){return m===1?c(Ys,Ys):m===.5?c(W_,H_):c(Fd(m),Fd(1/m))}return p.exponent=function(S){return arguments.length?(m=+S,v()):m},Gm(p)}function Km(){var c=J_(Um());return c.copy=function(){return Nm(c,Km()).exponent(c.exponent())},jh.apply(c,arguments),c}function Y_(){return Km.apply(null,arguments).exponent(.5)}const Ec={x:Ch,y:Ch,z:Ch,r:Y_};function Q_(c){return c.constant?"symlog":c.base?"log":c.exponent?c.exponent()===.5?"sqrt":"pow":"other"}function Vd(c){return c}function $_(c){return p=>Math.log(c*p)}function ev(c){return p=>c*Math.exp(p)}function tv(c){return p=>Math.sign(p)*Math.log1p(Math.abs(p/c))}function rv(c){return p=>Math.sign(p)*Math.expm1(Math.abs(p))*c}function Eh(c){return function(m){return m<0?-Math.pow(-m,c):Math.pow(m,c)}}function iv(c){const p=Q_(c);if(p==="log"){const m=Math.sign(c.domain()[0]);return{lift:$_(m),ground:ev(m),scaleType:p}}return p==="pow"?{lift:Eh(1),ground:Eh(1/1),scaleType:p}:p==="sqrt"?{lift:Eh(.5),ground:Eh(1/.5),scaleType:p}:p==="symlog"?{lift:tv(1),ground:rv(1),scaleType:p}:{lift:Vd,ground:Vd,scaleType:p}}function nv(c,p){if(typeof c.range!="function")throw new Error("Scale method `range` must be a function");if(typeof c.domain!="function")throw new Error("Scale method `domain` must be a function");if(!Array.isArray(p))return c.domain();c.domain().length!==2&&console.warn("[LayerCake] The scale is expected to have a domain of length 2 to use padding. Are you sure you want to use padding? Your scale's domain is:",c.domain()),c.range().length!==2&&console.warn("[LayerCake] The scale is expected to have a range of length 2 to use padding. Are you sure you want to use padding? Your scale's range is:",c.range());const{lift:m,ground:v}=iv(c),S=c.domain()[0],E=Object.prototype.toString.call(S)==="[object Date]",[s,C]=c.domain().map(H=>m(E?H.getTime():H)),[A,V]=c.range(),N=p[0]||0,W=p[1]||0,K=(C-s)/(Math.abs(V-A)-N-W);return[s-N*K,W*K+C].map(H=>v(E?new Date(H):H))}function ov(c,p,m,v,S){let E,s;return S===!0?(E=0,s=100):(E=c==="r"?1:0,s=c==="y"?m:c==="r"?25:p),v===!0?[s,E]:[E,s]}function av(c,p,m,v,S,E){return S?typeof S=="function"?S({width:p,height:m}):S:ov(c,p,m,v,E)}function Th(c){return function([m,v,S,E,s,C,A,V,N,W]){if(v===null)return null;const K=av(c,A,V,C,N,W),H=m===Ec[c]?m():m.copy();return H.domain(Mm(v[c],S)).range(K),E&&H.domain(nv(H,E)),s===!0&&(typeof H.nice=="function"?H.nice():console.error(`[Layer Cake] You set \`${c}Nice: true\` but the ${c}Scale does not have a \`.nice\` method. Ignoring...`)),H}}function Ih([c,p]){return m=>{const v=c(m);return Array.isArray(v)?v.map(S=>p(S)):p(v)}}function kh([c]){if(typeof c=="function"){if(typeof c.range=="function")return c.range();console.error("[LayerCake] Your scale doesn't have a `.range` method?")}return null}const zh={x:!1,y:!0,z:!1,r:!1};const sv=c=>({element:c[0]&4,width:c[0]&256,height:c[0]&512,aspectRatio:c[0]&1024,containerWidth:c[0]&128,containerHeight:c[0]&64}),Nd=c=>({element:c[2],width:c[8],height:c[9],aspectRatio:c[10],containerWidth:c[7],containerHeight:c[6]});function Ud(c){let p,m,v;const S=c[90].default,E=Ic(S,c,c[89],Nd);return{c(){p=Ie("div"),E&&E.c(),this.h()},l(s){p=ke(s,"DIV",{class:!0});var C=we(p);E&&E.l(C),C.forEach(ae),this.h()},h(){X(p,"class","layercake-container svelte-vhzpsp"),Mh(()=>c[92].call(p)),Me(p,"position",c[5],!1),Me(p,"top",c[5]==="absolute"?"0":null,!1),Me(p,"right",c[5]==="absolute"?"0":null,!1),Me(p,"bottom",c[5]==="absolute"?"0":null,!1),Me(p,"left",c[5]==="absolute"?"0":null,!1),Me(p,"pointer-events",c[4]===!1?"none":null,!1)},m(s,C){dt(s,p,C),E&&E.m(p,null),c[91](p),m=Dh(p,c[92].bind(p)),v=!0},p(s,C){E&&E.p&&(!v||C[0]&1988|C[2]&134217728)&&kc(E,S,s,s[89],v?Ac(S,s[89],C,sv):zc(s[89]),Nd),C[0]&32&&Me(p,"position",s[5],!1),C[0]&32&&Me(p,"top",s[5]==="absolute"?"0":null,!1),C[0]&32&&Me(p,"right",s[5]==="absolute"?"0":null,!1),C[0]&32&&Me(p,"bottom",s[5]==="absolute"?"0":null,!1),C[0]&32&&Me(p,"left",s[5]==="absolute"?"0":null,!1),C[0]&16&&Me(p,"pointer-events",s[4]===!1?"none":null,!1)},i(s){v||(Zt(E,s),v=!0)},o(s){ir(E,s),v=!1},d(s){s&&ae(p),E&&E.d(s),c[91](null),m()}}}function lv(c){let p,m,v=(c[3]===!0||typeof window<"u")&&Ud(c);return{c(){v&&v.c(),p=dn()},l(S){v&&v.l(S),p=dn()},m(S,E){v&&v.m(S,E),dt(S,p,E),m=!0},p(S,E){S[3]===!0||typeof window<"u"?v?(v.p(S,E),E[0]&8&&Zt(v,1)):(v=Ud(S),v.c(),Zt(v,1),v.m(p.parentNode,p)):v&&(mu(),ir(v,1,1,()=>{v=null}),yu())},i(S){m||(Zt(v),m=!0)},o(S){ir(v),m=!1},d(S){v&&v.d(S),S&&ae(p)}}}function uv(c,p,m){let v,S,E,s,C,A,V,N,W,K,H,pe,Re,ze,Ge,Ke,Nt,Dt,mt,He,Er,hr,Ht,Jt,qe,_r,At,nr,tt,pr,Vr,Pt,tr,rt,Ze,lr,Tr,on,an,Ni,Xt,{$$slots:wr={},$$scope:Bt}=p,{ssr:Lr=!1}=p,{pointerEvents:kn=!0}=p,{position:zn="relative"}=p,{percentRange:Gt=!1}=p,{width:An=void 0}=p,{height:bi=void 0}=p,{containerWidth:Ai=An||100}=p,{containerHeight:Ro=bi||100}=p,{element:Gr=void 0}=p,{x:ci=void 0}=p,{y:jr=void 0}=p,{z:Pn=void 0}=p,{r:Xi=void 0}=p,{data:Wi=[]}=p,{xDomain:Pi=void 0}=p,{yDomain:Ui=void 0}=p,{zDomain:hi=void 0}=p,{rDomain:vo=void 0}=p,{xNice:Jo=!1}=p,{yNice:Cn=!1}=p,{zNice:ro=!1}=p,{rNice:io=!1}=p,{xReverse:Yo=zh.x}=p,{yReverse:xo=zh.y}=p,{zReverse:ji=zh.z}=p,{rReverse:pi=zh.r}=p,{xPadding:sn=void 0}=p,{yPadding:Bo=void 0}=p,{zPadding:qn=void 0}=p,{rPadding:Pa=void 0}=p,{xScale:no=Ec.x}=p,{yScale:qi=Ec.y}=p,{zScale:Hi=Ec.z}=p,{rScale:bo=Ec.r}=p,{xRange:oo=void 0}=p,{yRange:dr=void 0}=p,{zRange:M=void 0}=p,{rRange:R=void 0}=p,{padding:F={}}=p,{extents:G={}}=p,{flatData:J=void 0}=p,{custom:le={}}=p,ce=!1;zm(()=>{ce=!0});const O={},te=kr(Gt);qt(c,te,de=>m(128,on=de));const me=kr(Ai);qt(c,me,de=>m(7,Tr=de));const Ce=kr(Ro);qt(c,Ce,de=>m(6,lr=de));const Be=kr(Tp(G));qt(c,Be,de=>m(127,Ze=de));const Se=kr(Wi);qt(c,Se,de=>m(126,rt=de));const Le=kr(J||Wi);qt(c,Le,de=>m(125,tr=de));const st=kr(F);qt(c,st,de=>m(124,Pt=de));const Xe=kr(Kl(ci));qt(c,Xe,de=>m(123,Vr=de));const xe=kr(Kl(jr));qt(c,xe,de=>m(122,pr=de));const Je=kr(Kl(Pn));qt(c,Je,de=>m(121,tt=de));const Ue=kr(Kl(Xi));qt(c,Ue,de=>m(120,nr=de));const Ve=kr(Pi);qt(c,Ve,de=>m(119,At=de));const It=kr(Ui);qt(c,It,de=>m(118,_r=de));const Ye=kr(hi);qt(c,Ye,de=>m(117,qe=de));const Ot=kr(vo);qt(c,Ot,de=>m(116,Jt=de));const sr=kr(Jo);qt(c,sr,de=>m(115,Ht=de));const Ct=kr(Cn);qt(c,Ct,de=>m(114,hr=de));const Qt=kr(ro);qt(c,Qt,de=>m(113,Er=de));const Mt=kr(io);qt(c,Mt,de=>m(112,He=de));const ri=kr(Yo);qt(c,ri,de=>m(111,mt=de));const Kt=kr(xo);qt(c,Kt,de=>m(110,Dt=de));const mr=kr(ji);qt(c,mr,de=>m(109,Nt=de));const rr=kr(pi);qt(c,rr,de=>m(108,Ke=de));const Lt=kr(sn);qt(c,Lt,de=>m(107,Ge=de));const $t=kr(Bo);qt(c,$t,de=>m(106,ze=de));const Yr=kr(qn);qt(c,Yr,de=>m(105,Re=de));const ao=kr(Pa);qt(c,ao,de=>m(104,pe=de));const Kr=kr(oo);qt(c,Kr,de=>m(103,H=de));const wi=kr(dr);qt(c,wi,de=>m(102,K=de));const so=kr(M);qt(c,so,de=>m(101,W=de));const Qo=kr(R);qt(c,Qo,de=>m(100,N=de));const Pr=kr(no);qt(c,Pr,de=>m(99,V=de));const mn=kr(qi);qt(c,mn,de=>m(98,A=de));const qr=kr(Hi);qt(c,qr,de=>m(97,C=de));const Xr=kr(bo);qt(c,Xr,de=>m(96,s=de));const fi=kr(O);qt(c,fi,de=>m(94,S=de));const yr=kr(le);qt(c,yr,de=>m(95,E=de));const yn=nn([Xe,xe,Je,Ue],([de,Si,Ci,Br])=>{const _n={};return de&&(_n.x=de),Si&&(_n.y=Si),Ci&&(_n.z=Ci),Br&&(_n.r=Br),_n}),ln=nn([st,me,Ce],([de])=>Object.assign({top:0,right:0,bottom:0,left:0},de)),Ha=nn([me,Ce,ln],([de,Si,Ci])=>{const Br={};return Br.top=Ci.top,Br.right=de-Ci.right,Br.bottom=Si-Ci.bottom,Br.left=Ci.left,Br.width=Br.right-Br.left,Br.height=Br.bottom-Br.top,Br.width<=0&&ce===!0&&console.warn("[LayerCake] Target div has zero or negative width. Did you forget to set an explicit width in CSS on the container?"),Br.height<=0&&ce===!0&&console.warn("[LayerCake] Target div has zero or negative height. Did you forget to set an explicit height in CSS on the container?"),Br}),Ft=nn([Ha],([de])=>de.width);qt(c,Ft,de=>m(8,an=de));const Ji=nn([Ha],([de])=>de.height);qt(c,Ji,de=>m(9,Ni=de));const Rr=nn([Le,yn,Be],([de,Si,Ci])=>{const Br=Tp(Si,Ci);return Object.keys(Br).length>0?{...Xg(de,Br),...Ci}:{}}),Nr=nn([Rr,Ve],xh("x")),Zn=nn([Rr,It],xh("y")),Qr=nn([Rr,Ye],xh("z")),sa=nn([Rr,Ot],xh("r")),fs=nn([Pr,Rr,Nr,Lt,sr,ri,Ft,Ji,Kr,te],Th("x")),Ca=nn([Xe,fs],Ih),Oo=nn([mn,Rr,Zn,$t,Ct,Kt,Ft,Ji,wi,te],Th("y")),el=nn([xe,Oo],Ih),Ja=nn([qr,Rr,Qr,Yr,Qt,mr,Ft,Ji,so,te],Th("z")),la=nn([Je,Ja],Ih),wo=nn([Xr,Rr,sa,ao,Mt,rr,Ft,Ji,Qo,te],Th("r")),Ds=nn([Ue,wo],Ih),gn=nn([fs],kh),Mn=nn([Oo],kh),Gn=nn([Ja],kh),Ls=nn([wo],kh),lo=nn([Ft,Ji],([de,Si])=>de/Si);qt(c,lo,de=>m(10,Xt=de));function uo(de){El[de?"unshift":"push"](()=>{Gr=de,m(2,Gr)})}function Fo(){Ai=this.clientWidth,Ro=this.clientHeight,m(0,Ai),m(1,Ro)}return c.$$set=de=>{"ssr"in de&&m(3,Lr=de.ssr),"pointerEvents"in de&&m(4,kn=de.pointerEvents),"position"in de&&m(5,zn=de.position),"percentRange"in de&&m(51,Gt=de.percentRange),"width"in de&&m(52,An=de.width),"height"in de&&m(53,bi=de.height),"containerWidth"in de&&m(0,Ai=de.containerWidth),"containerHeight"in de&&m(1,Ro=de.containerHeight),"element"in de&&m(2,Gr=de.element),"x"in de&&m(54,ci=de.x),"y"in de&&m(55,jr=de.y),"z"in de&&m(56,Pn=de.z),"r"in de&&m(57,Xi=de.r),"data"in de&&m(58,Wi=de.data),"xDomain"in de&&m(59,Pi=de.xDomain),"yDomain"in de&&m(60,Ui=de.yDomain),"zDomain"in de&&m(61,hi=de.zDomain),"rDomain"in de&&m(62,vo=de.rDomain),"xNice"in de&&m(63,Jo=de.xNice),"yNice"in de&&m(64,Cn=de.yNice),"zNice"in de&&m(65,ro=de.zNice),"rNice"in de&&m(66,io=de.rNice),"xReverse"in de&&m(67,Yo=de.xReverse),"yReverse"in de&&m(68,xo=de.yReverse),"zReverse"in de&&m(69,ji=de.zReverse),"rReverse"in de&&m(70,pi=de.rReverse),"xPadding"in de&&m(71,sn=de.xPadding),"yPadding"in de&&m(72,Bo=de.yPadding),"zPadding"in de&&m(73,qn=de.zPadding),"rPadding"in de&&m(74,Pa=de.rPadding),"xScale"in de&&m(75,no=de.xScale),"yScale"in de&&m(76,qi=de.yScale),"zScale"in de&&m(77,Hi=de.zScale),"rScale"in de&&m(78,bo=de.rScale),"xRange"in de&&m(79,oo=de.xRange),"yRange"in de&&m(80,dr=de.yRange),"zRange"in de&&m(81,M=de.zRange),"rRange"in de&&m(82,R=de.rRange),"padding"in de&&m(83,F=de.padding),"extents"in de&&m(84,G=de.extents),"flatData"in de&&m(85,J=de.flatData),"custom"in de&&m(86,le=de.custom),"$$scope"in de&&m(89,Bt=de.$$scope)},c.$$.update=()=>{c.$$.dirty[1]&8388608&&ci&&m(87,O.x=ci,O),c.$$.dirty[1]&16777216&&jr&&m(87,O.y=jr,O),c.$$.dirty[1]&33554432&&Pn&&m(87,O.z=Pn,O),c.$$.dirty[1]&67108864&&Xi&&m(87,O.r=Xi,O),c.$$.dirty[1]&268435456&&Pi&&m(87,O.xDomain=Pi,O),c.$$.dirty[1]&536870912&&Ui&&m(87,O.yDomain=Ui,O),c.$$.dirty[1]&1073741824&&hi&&m(87,O.zDomain=hi,O),c.$$.dirty[2]&1&&vo&&m(87,O.rDomain=vo,O),c.$$.dirty[2]&131072&&oo&&m(87,O.xRange=oo,O),c.$$.dirty[2]&262144&&dr&&m(87,O.yRange=dr,O),c.$$.dirty[2]&524288&&M&&m(87,O.zRange=M,O),c.$$.dirty[2]&1048576&&R&&m(87,O.rRange=R,O),c.$$.dirty[1]&1048576&&Ir(te,on=Gt,on),c.$$.dirty[0]&1&&Ir(me,Tr=Ai,Tr),c.$$.dirty[0]&2&&Ir(Ce,lr=Ro,lr),c.$$.dirty[2]&4194304&&Ir(Be,Ze=Tp(G),Ze),c.$$.dirty[1]&134217728&&Ir(Se,rt=Wi,rt),c.$$.dirty[1]&134217728|c.$$.dirty[2]&8388608&&Ir(Le,tr=J||Wi,tr),c.$$.dirty[2]&2097152&&Ir(st,Pt=F,Pt),c.$$.dirty[1]&8388608&&Ir(Xe,Vr=Kl(ci),Vr),c.$$.dirty[1]&16777216&&Ir(xe,pr=Kl(jr),pr),c.$$.dirty[1]&33554432&&Ir(Je,tt=Kl(Pn),tt),c.$$.dirty[1]&67108864&&Ir(Ue,nr=Kl(Xi),nr),c.$$.dirty[1]&268435456&&Ir(Ve,At=Pi,At),c.$$.dirty[1]&536870912&&Ir(It,_r=Ui,_r),c.$$.dirty[1]&1073741824&&Ir(Ye,qe=hi,qe),c.$$.dirty[2]&1&&Ir(Ot,Jt=vo,Jt),c.$$.dirty[2]&2&&Ir(sr,Ht=Jo,Ht),c.$$.dirty[2]&4&&Ir(Ct,hr=Cn,hr),c.$$.dirty[2]&8&&Ir(Qt,Er=ro,Er),c.$$.dirty[2]&16&&Ir(Mt,He=io,He),c.$$.dirty[2]&32&&Ir(ri,mt=Yo,mt),c.$$.dirty[2]&64&&Ir(Kt,Dt=xo,Dt),c.$$.dirty[2]&128&&Ir(mr,Nt=ji,Nt),c.$$.dirty[2]&256&&Ir(rr,Ke=pi,Ke),c.$$.dirty[2]&512&&Ir(Lt,Ge=sn,Ge),c.$$.dirty[2]&1024&&Ir($t,ze=Bo,ze),c.$$.dirty[2]&2048&&Ir(Yr,Re=qn,Re),c.$$.dirty[2]&4096&&Ir(ao,pe=Pa,pe),c.$$.dirty[2]&131072&&Ir(Kr,H=oo,H),c.$$.dirty[2]&262144&&Ir(wi,K=dr,K),c.$$.dirty[2]&524288&&Ir(so,W=M,W),c.$$.dirty[2]&1048576&&Ir(Qo,N=R,N),c.$$.dirty[2]&8192&&Ir(Pr,V=no,V),c.$$.dirty[2]&16384&&Ir(mn,A=qi,A),c.$$.dirty[2]&32768&&Ir(qr,C=Hi,C),c.$$.dirty[2]&65536&&Ir(Xr,s=bo,s),c.$$.dirty[2]&16777216&&Ir(yr,E=le,E),c.$$.dirty[2]&33554432&&Ir(fi,S=O,S),c.$$.dirty[2]&67108864&&Am("LayerCake",v)},m(88,v={activeGetters:yn,width:Ft,height:Ji,percentRange:te,aspectRatio:lo,containerWidth:me,containerHeight:Ce,x:Xe,y:xe,z:Je,r:Ue,custom:yr,data:Se,xNice:sr,yNice:Ct,zNice:Qt,rNice:Mt,xReverse:ri,yReverse:Kt,zReverse:mr,rReverse:rr,xPadding:Lt,yPadding:$t,zPadding:Yr,rPadding:ao,padding:ln,flatData:Le,extents:Rr,xDomain:Nr,yDomain:Zn,zDomain:Qr,rDomain:sa,xRange:gn,yRange:Mn,zRange:Gn,rRange:Ls,config:fi,xScale:fs,xGet:Ca,yScale:Oo,yGet:el,zScale:Ja,zGet:la,rScale:wo,rGet:Ds}),[Ai,Ro,Gr,Lr,kn,zn,lr,Tr,an,Ni,Xt,te,me,Ce,Be,Se,Le,st,Xe,xe,Je,Ue,Ve,It,Ye,Ot,sr,Ct,Qt,Mt,ri,Kt,mr,rr,Lt,$t,Yr,ao,Kr,wi,so,Qo,Pr,mn,qr,Xr,fi,yr,Ft,Ji,lo,Gt,An,bi,ci,jr,Pn,Xi,Wi,Pi,Ui,hi,vo,Jo,Cn,ro,io,Yo,xo,ji,pi,sn,Bo,qn,Pa,no,qi,Hi,bo,oo,dr,M,R,F,G,J,le,O,v,Bt,wr,uo,Fo]}class cv extends Ka{constructor(p){super(),Xa(this,p,uv,lv,Wa,{ssr:3,pointerEvents:4,position:5,percentRange:51,width:52,height:53,containerWidth:0,containerHeight:1,element:2,x:54,y:55,z:56,r:57,data:58,xDomain:59,yDomain:60,zDomain:61,rDomain:62,xNice:63,yNice:64,zNice:65,rNice:66,xReverse:67,yReverse:68,zReverse:69,rReverse:70,xPadding:71,yPadding:72,zPadding:73,rPadding:74,xScale:75,yScale:76,zScale:77,rScale:78,xRange:79,yRange:80,zRange:81,rRange:82,padding:83,extents:84,flatData:85,custom:86},null,[-1,-1,-1,-1,-1])}}const hv=c=>({element:c&1}),jd=c=>({element:c[0]}),pv=c=>({element:c&1}),qd=c=>({element:c[0]});function fv(c){let p,m,v,S,E;const s=c[12].defs,C=Ic(s,c,c[11],qd),A=c[12].default,V=Ic(A,c,c[11],jd);return{c(){p=Wo("svg"),m=Wo("defs"),C&&C.c(),v=Wo("g"),V&&V.c(),this.h()},l(N){p=Ho(N,"svg",{class:!0,viewBox:!0,width:!0,height:!0});var W=we(p);m=Ho(W,"defs",{});var K=we(m);C&&C.l(K),K.forEach(ae),v=Ho(W,"g",{class:!0,transform:!0});var H=we(v);V&&V.l(H),H.forEach(ae),W.forEach(ae),this.h()},h(){X(v,"class","layercake-layout-svg_g"),X(v,"transform",S="translate("+c[7].left+", "+c[7].top+")"),X(p,"class","layercake-layout-svg svelte-u84d8d"),X(p,"viewBox",c[4]),X(p,"width",c[5]),X(p,"height",c[6]),Me(p,"z-index",c[2],!1),Me(p,"pointer-events",c[3]===!1?"none":null,!1)},m(N,W){dt(N,p,W),ie(p,m),C&&C.m(m,null),ie(p,v),V&&V.m(v,null),c[13](v),c[14](p),E=!0},p(N,[W]){C&&C.p&&(!E||W&2049)&&kc(C,s,N,N[11],E?Ac(s,N[11],W,pv):zc(N[11]),qd),V&&V.p&&(!E||W&2049)&&kc(V,A,N,N[11],E?Ac(A,N[11],W,hv):zc(N[11]),jd),(!E||W&128&&S!==(S="translate("+N[7].left+", "+N[7].top+")"))&&X(v,"transform",S),(!E||W&16)&&X(p,"viewBox",N[4]),(!E||W&32)&&X(p,"width",N[5]),(!E||W&64)&&X(p,"height",N[6]),W&4&&Me(p,"z-index",N[2],!1),W&8&&Me(p,"pointer-events",N[3]===!1?"none":null,!1)},i(N){E||(Zt(C,N),Zt(V,N),E=!0)},o(N){ir(C,N),ir(V,N),E=!1},d(N){N&&ae(p),C&&C.d(N),V&&V.d(N),c[13](null),c[14](null)}}}function dv(c,p,m){let v,S,E,{$$slots:s={},$$scope:C}=p,{element:A=void 0}=p,{innerElement:V=void 0}=p,{zIndex:N=void 0}=p,{pointerEvents:W=void 0}=p,{viewBox:K=void 0}=p;const{containerWidth:H,containerHeight:pe,padding:Re}=Dc("LayerCake");qt(c,H,Ke=>m(5,v=Ke)),qt(c,pe,Ke=>m(6,S=Ke)),qt(c,Re,Ke=>m(7,E=Ke));function ze(Ke){El[Ke?"unshift":"push"](()=>{V=Ke,m(1,V)})}function Ge(Ke){El[Ke?"unshift":"push"](()=>{A=Ke,m(0,A)})}return c.$$set=Ke=>{"element"in Ke&&m(0,A=Ke.element),"innerElement"in Ke&&m(1,V=Ke.innerElement),"zIndex"in Ke&&m(2,N=Ke.zIndex),"pointerEvents"in Ke&&m(3,W=Ke.pointerEvents),"viewBox"in Ke&&m(4,K=Ke.viewBox),"$$scope"in Ke&&m(11,C=Ke.$$scope)},[A,V,N,W,K,v,S,E,H,pe,Re,C,s,ze,Ge]}class mv extends Ka{constructor(p){super(),Xa(this,p,dv,fv,Wa,{element:0,innerElement:1,zIndex:2,pointerEvents:3,viewBox:4})}}function Zd(c,p,m){const v=c.slice();return v[24]=p[m],v[26]=m,v}function Gd(c){let p,m,v,S;return{c(){p=Wo("rect"),this.h()},l(E){p=Ho(E,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),we(p).forEach(ae),this.h()},h(){X(p,"class","group-rect"),X(p,"data-id",c[26]),X(p,"x",m=c[11].bandwidth?c[7](c[24]):c[7](c[24])[0]),X(p,"y",v=c[13](c[12](c[24]))-1),X(p,"width",S=c[11].bandwidth?c[11].bandwidth():c[9](c[24])),X(p,"height","3"),X(p,"fill","#CEDC20"),X(p,"stroke",c[0]),X(p,"stroke-width",c[1])},m(E,s){dt(E,p,s)},p(E,s){s&3200&&m!==(m=E[11].bandwidth?E[7](E[24]):E[7](E[24])[0])&&X(p,"x",m),s&13312&&v!==(v=E[13](E[12](E[24]))-1)&&X(p,"y",v),s&3584&&S!==(S=E[11].bandwidth?E[11].bandwidth():E[9](E[24]))&&X(p,"width",S),s&1&&X(p,"stroke",E[0]),s&2&&X(p,"stroke-width",E[1])},d(E){E&&ae(p)}}}function Kd(c){let p,m,v,S,E,s,C,A,V=c[12]&&Gd(c);return{c(){p=Wo("rect"),V&&V.c(),s=Wo("text"),this.h()},l(N){p=Ho(N,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),we(p).forEach(ae),V&&V.l(N),s=Ho(N,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0}),we(s).forEach(ae),this.h()},h(){X(p,"class","group-rect"),X(p,"data-id",c[26]),X(p,"x",m=c[11].bandwidth?c[7](c[24]):c[7](c[24])[0]),X(p,"y",v=c[6](c[24])),X(p,"width",S=c[11].bandwidth?c[11].bandwidth():c[9](c[24])),X(p,"height",E=c[8](c[24])),X(p,"fill",c[4]),X(p,"stroke",c[0]),X(p,"stroke-width",c[1]),X(s,"x",C=c[11].bandwidth?c[7](c[24])+c[11].bandwidth()/2:c[7](c[24])[0]),X(s,"y",A=c[6](c[24])-4),X(s,"dx",c[2]),X(s,"dy",c[3]),X(s,"text-anchor",c[5])},m(N,W){dt(N,p,W),V&&V.m(N,W),dt(N,s,W)},p(N,W){W&3200&&m!==(m=N[11].bandwidth?N[7](N[24]):N[7](N[24])[0])&&X(p,"x",m),W&1088&&v!==(v=N[6](N[24]))&&X(p,"y",v),W&3584&&S!==(S=N[11].bandwidth?N[11].bandwidth():N[9](N[24]))&&X(p,"width",S),W&1280&&E!==(E=N[8](N[24]))&&X(p,"height",E),W&16&&X(p,"fill",N[4]),W&1&&X(p,"stroke",N[0]),W&2&&X(p,"stroke-width",N[1]),N[12]?V?V.p(N,W):(V=Gd(N),V.c(),V.m(s.parentNode,s)):V&&(V.d(1),V=null),W&3200&&C!==(C=N[11].bandwidth?N[7](N[24])+N[11].bandwidth()/2:N[7](N[24])[0])&&X(s,"x",C),W&1088&&A!==(A=N[6](N[24])-4)&&X(s,"y",A),W&4&&X(s,"dx",N[2]),W&8&&X(s,"dy",N[3]),W&32&&X(s,"text-anchor",N[5])},d(N){N&&ae(p),V&&V.d(N),N&&ae(s)}}}function yv(c){let p,m=c[10],v=[];for(let S=0;S<m.length;S+=1)v[S]=Kd(Zd(c,m,S));return{c(){p=Wo("g");for(let S=0;S<v.length;S+=1)v[S].c();this.h()},l(S){p=Ho(S,"g",{class:!0});var E=we(p);for(let s=0;s<v.length;s+=1)v[s].l(E);E.forEach(ae),this.h()},h(){X(p,"class","column-group svelte-wgzwsk")},m(S,E){dt(S,p,E);for(let s=0;s<v.length;s+=1)v[s].m(p,null)},p(S,[E]){if(E&16383){m=S[10];let s;for(s=0;s<m.length;s+=1){const C=Zd(S,m,s);v[s]?v[s].p(C,E):(v[s]=Kd(C),v[s].c(),v[s].m(p,null))}for(;s<v.length;s+=1)v[s].d(1);v.length=m.length}},i:ps,o:ps,d(S){S&&ae(p),Ms(v,S)}}}function gv(c,p,m){let v,S,E,s,C,A,V,N,W;const{data:K,xGet:H,yGet:pe,yRange:Re,xScale:ze,yScale:Ge,y:Ke,z:Nt}=Dc("LayerCake");qt(c,K,qe=>m(10,A=qe)),qt(c,H,qe=>m(7,C=qe)),qt(c,pe,qe=>m(6,E=qe)),qt(c,Re,qe=>m(22,s=qe)),qt(c,ze,qe=>m(11,V=qe)),qt(c,Ge,qe=>m(13,W=qe)),qt(c,Nt,qe=>m(12,N=qe));let{stroke:Dt=""}=p,{strokeWidth:mt=0}=p,{dxTick:He=0}=p,{dyTick:Er=0}=p,{formatVal:hr=qe=>qe}=p,{fill:Ht="#00205b"}=p,{textAnchor:Jt="middle"}=p;return c.$$set=qe=>{"stroke"in qe&&m(0,Dt=qe.stroke),"strokeWidth"in qe&&m(1,mt=qe.strokeWidth),"dxTick"in qe&&m(2,He=qe.dxTick),"dyTick"in qe&&m(3,Er=qe.dyTick),"formatVal"in qe&&m(21,hr=qe.formatVal),"fill"in qe&&m(4,Ht=qe.fill),"textAnchor"in qe&&m(5,Jt=qe.textAnchor)},c.$$.update=()=>{c.$$.dirty&128&&m(9,v=qe=>{const _r=C(qe);return Math.max(0,_r[1]-_r[0])}),c.$$.dirty&4194368&&m(8,S=qe=>s[0]-E(qe))},[Dt,mt,He,Er,Ht,Jt,E,C,S,v,A,V,N,W,K,H,pe,Re,ze,Ge,Nt,hr,s]}class _v extends Ka{constructor(p){super(),Xa(this,p,gv,yv,Wa,{stroke:0,strokeWidth:1,dxTick:2,dyTick:3,formatVal:21,fill:4,textAnchor:5})}}function Xd(c,p,m){const v=c.slice();return v[28]=p[m],v[30]=m,v}function Wd(c){let p,m,v,S;return{c(){p=Wo("line"),this.h()},l(E){p=Ho(E,"line",{y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0,"stroke-width":!0,class:!0}),we(p).forEach(ae),this.h()},h(){X(p,"y1",m=c[20]*-1),X(p,"y2",v=c[14]&&c[30]%2==0?c[10]+c[8]+2:c[10]+c[8]-13),X(p,"x1","0"),X(p,"x2","0"),X(p,"stroke",c[11]),X(p,"stroke-width",S=c[15]&&Array.isArray(c[4])&&c[30]==Math.floor(c[4].length/2)?2:1),X(p,"class","svelte-fwjh80"),fn(p,"baseline",c[13])},m(E,s){dt(E,p,s)},p(E,s){s&1048576&&m!==(m=E[20]*-1)&&X(p,"y1",m),s&17664&&v!==(v=E[14]&&E[30]%2==0?E[10]+E[8]+2:E[10]+E[8]-13)&&X(p,"y2",v),s&2048&&X(p,"stroke",E[11]),s&32784&&S!==(S=E[15]&&Array.isArray(E[4])&&E[30]==Math.floor(E[4].length/2)?2:1)&&X(p,"stroke-width",S),s&8192&&fn(p,"baseline",E[13])},d(E){E&&ae(p)}}}function vv(c){let p=c[1](c[28])+"",m;return{c(){m=$e(p)},l(v){m=et(v,p)},m(v,S){dt(v,m,S)},p(v,S){S&262146&&p!==(p=v[1](v[28])+"")&&Ar(m,p)},d(v){v&&ae(m)}}}function xv(c){let p,m=c[1](c[28])+"",v,S;return{c(){p=$e(c[5]),v=$e(m),S=$e(c[6])},l(E){p=et(E,c[5]),v=et(E,m),S=et(E,c[6])},m(E,s){dt(E,p,s),dt(E,v,s),dt(E,S,s)},p(E,s){s&32&&Ar(p,E[5]),s&262146&&m!==(m=E[1](E[28])+"")&&Ar(v,m),s&64&&Ar(S,E[6])},d(E){E&&ae(p),E&&ae(v),E&&ae(S)}}}function Hd(c){let p,m,v,S,E,s,C,A=c[0]!==!1&&Wd(c);function V(K,H){return K[30]==K[18].length-1?xv:vv}let N=V(c),W=N(c);return{c(){p=Wo("g"),A&&A.c(),m=Wo("text"),W.c(),this.h()},l(K){p=Ho(K,"g",{class:!0,transform:!0});var H=we(p);A&&A.l(H),m=Ho(H,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0,fill:!0,class:!0});var pe=we(m);W.l(pe),pe.forEach(ae),H.forEach(ae),this.h()},h(){X(m,"x",v=c[7]||c[16]?c[17].bandwidth()/2:0),X(m,"y",S=c[3]?c[20]*-1-6:c[14]&&c[30]%2==0?c[8]+15:c[8]),X(m,"dx",E=c[24](c[30])=="start"?c[9]-2:c[24](c[30])=="end"?c[9]+2:c[9]),X(m,"dy",c[10]),X(m,"text-anchor",c[24](c[30])),X(m,"fill",c[12]),X(m,"class","svelte-fwjh80"),fn(m,"bold",c[15]&&Array.isArray(c[4])&&c[30]==Math.floor(c[4].length/2)),X(p,"class",s="tick tick-"+c[28]+" svelte-fwjh80"),X(p,"transform",C="translate("+c[17](c[28])+","+c[19][0]+")")},m(K,H){dt(K,p,H),A&&A.m(p,null),ie(p,m),W.m(m,null)},p(K,H){K[0]!==!1?A?A.p(K,H):(A=Wd(K),A.c(),A.m(p,m)):A&&(A.d(1),A=null),N===(N=V(K))&&W?W.p(K,H):(W.d(1),W=N(K),W&&(W.c(),W.m(m,null))),H&196736&&v!==(v=K[7]||K[16]?K[17].bandwidth()/2:0)&&X(m,"x",v),H&1065224&&S!==(S=K[3]?K[20]*-1-6:K[14]&&K[30]%2==0?K[8]+15:K[8])&&X(m,"y",S),H&512&&E!==(E=K[24](K[30])=="start"?K[9]-2:K[24](K[30])=="end"?K[9]+2:K[9])&&X(m,"dx",E),H&1024&&X(m,"dy",K[10]),H&4096&&X(m,"fill",K[12]),H&32784&&fn(m,"bold",K[15]&&Array.isArray(K[4])&&K[30]==Math.floor(K[4].length/2)),H&262144&&s!==(s="tick tick-"+K[28]+" svelte-fwjh80")&&X(p,"class",s),H&917504&&C!==(C="translate("+K[17](K[28])+","+K[19][0]+")")&&X(p,"transform",C)},d(K){K&&ae(p),A&&A.d(),W.d()}}}function Jd(c){let p,m,v;return{c(){p=Wo("line"),this.h()},l(S){p=Ho(S,"line",{class:!0,y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0}),we(p).forEach(ae),this.h()},h(){X(p,"class","baseline svelte-fwjh80"),X(p,"y1",c[20]),X(p,"y2","0"),X(p,"x1",m=c[17](0)),X(p,"x2",v=c[17](0)),X(p,"stroke",c[11])},m(S,E){dt(S,p,E)},p(S,E){E&1048576&&X(p,"y1",S[20]),E&131072&&m!==(m=S[17](0))&&X(p,"x1",m),E&131072&&v!==(v=S[17](0))&&X(p,"x2",v),E&2048&&X(p,"stroke",S[11])},d(S){S&&ae(p)}}}function bv(c){let p,m,v=c[18],S=[];for(let s=0;s<v.length;s+=1)S[s]=Hd(Xd(c,v,s));let E=c[2]===!0&&Jd(c);return{c(){p=Wo("g");for(let s=0;s<S.length;s+=1)S[s].c();m=dn(),E&&E.c(),this.h()},l(s){p=Ho(s,"g",{class:!0});var C=we(p);for(let A=0;A<S.length;A+=1)S[A].l(C);m=dn(),E&&E.l(C),C.forEach(ae),this.h()},h(){X(p,"class","axis x-axis")},m(s,C){dt(s,p,C);for(let A=0;A<S.length;A+=1)S[A].m(p,null);ie(p,m),E&&E.m(p,null)},p(s,[C]){if(C&18874363){v=s[18];let A;for(A=0;A<v.length;A+=1){const V=Xd(s,v,A);S[A]?S[A].p(V,C):(S[A]=Hd(V),S[A].c(),S[A].m(p,m))}for(;A<S.length;A+=1)S[A].d(1);S.length=v.length}s[2]===!0?E?E.p(s,C):(E=Jd(s),E.c(),E.m(p,null)):E&&(E.d(1),E=null)},i:ps,o:ps,d(s){s&&ae(p),Ms(S,s),E&&E.d()}}}function wv(c,p,m){let v,S,E,s,C;const{width:A,height:V,xScale:N,yScale:W,yRange:K}=Dc("LayerCake");qt(c,V,tt=>m(20,C=tt)),qt(c,N,tt=>m(17,E=tt)),qt(c,K,tt=>m(19,s=tt));let{gridlines:H=!0}=p,{formatTick:pe=tt=>tt}=p,{baseline:Re=!1}=p,{flipped:ze=!1}=p,{snapTicks:Ge=!1}=p,{ticks:Ke=void 0}=p,{prefix:Nt=""}=p,{suffix:Dt=""}=p,{xTick:mt=void 0}=p,{yTick:He=15}=p,{dxTick:Er=0}=p,{dyTick:hr=0}=p,{lineColor:Ht="#999"}=p,{textColor:Jt="#555"}=p,{solid:qe=!1}=p,{stagger:_r=!1}=p,{median:At=!0}=p;function nr(tt){if(Ge===!0){if(tt===0)return"start";if(tt===S.length-1)return"end"}return"middle"}return c.$$set=tt=>{"gridlines"in tt&&m(0,H=tt.gridlines),"formatTick"in tt&&m(1,pe=tt.formatTick),"baseline"in tt&&m(2,Re=tt.baseline),"flipped"in tt&&m(3,ze=tt.flipped),"snapTicks"in tt&&m(25,Ge=tt.snapTicks),"ticks"in tt&&m(4,Ke=tt.ticks),"prefix"in tt&&m(5,Nt=tt.prefix),"suffix"in tt&&m(6,Dt=tt.suffix),"xTick"in tt&&m(7,mt=tt.xTick),"yTick"in tt&&m(8,He=tt.yTick),"dxTick"in tt&&m(9,Er=tt.dxTick),"dyTick"in tt&&m(10,hr=tt.dyTick),"lineColor"in tt&&m(11,Ht=tt.lineColor),"textColor"in tt&&m(12,Jt=tt.textColor),"solid"in tt&&m(13,qe=tt.solid),"stagger"in tt&&m(14,_r=tt.stagger),"median"in tt&&m(15,At=tt.median)},c.$$.update=()=>{c.$$.dirty&131072&&m(16,v=typeof E.bandwidth=="function"),c.$$.dirty&196624&&m(18,S=Array.isArray(Ke)?Ke:v?E.domain():E.ticks(Ke))},[H,pe,Re,ze,Ke,Nt,Dt,mt,He,Er,hr,Ht,Jt,qe,_r,At,v,E,S,s,C,V,N,K,nr,Ge]}class Sv extends Ka{constructor(p){super(),Xa(this,p,wv,bv,Wa,{gridlines:0,formatTick:1,baseline:2,flipped:3,snapTicks:25,ticks:4,prefix:5,suffix:6,xTick:7,yTick:8,dxTick:9,dyTick:10,lineColor:11,textColor:12,solid:13,stagger:14,median:15})}}function Ev(c){let p,m,v,S;return p=new _v({props:{fill:c[1],formatVal:c[5]}}),v=new Sv({props:{gridlines:!1}}),{c(){gi(p.$$.fragment),m=pt(),gi(v.$$.fragment)},l(E){_i(p.$$.fragment,E),m=ft(E),_i(v.$$.fragment,E)},m(E,s){vi(p,E,s),dt(E,m,s),vi(v,E,s),S=!0},p(E,s){const C={};s&2&&(C.fill=E[1]),s&32&&(C.formatVal=E[5]),p.$set(C)},i(E){S||(Zt(p.$$.fragment,E),Zt(v.$$.fragment,E),S=!0)},o(E){ir(p.$$.fragment,E),ir(v.$$.fragment,E),S=!1},d(E){xi(p,E),E&&ae(m),xi(v,E)}}}function Tv(c){let p,m;return p=new mv({props:{$$slots:{default:[Ev]},$$scope:{ctx:c}}}),{c(){gi(p.$$.fragment)},l(v){_i(p.$$.fragment,v)},m(v,S){vi(p,v,S),m=!0},p(v,S){const E={};S&1058&&(E.$$scope={dirty:S,ctx:v}),p.$set(E)},i(v){m||(Zt(p.$$.fragment,v),m=!0)},o(v){ir(p.$$.fragment,v),m=!1},d(v){xi(p,v)}}}function Iv(c){let p,m,v;return m=new cv({props:{padding:{top:15,right:0,bottom:20,left:0},x:c[2],y:c[3],z:c[4],xScale:Bm().paddingInner([.02]).round(!0),xDomain:c[7],yDomain:c[6],zDomain:c[6],data:c[0],$$slots:{default:[Tv]},$$scope:{ctx:c}}}),{c(){p=Ie("div"),gi(m.$$.fragment),this.h()},l(S){p=ke(S,"DIV",{class:!0});var E=we(p);_i(m.$$.fragment,E),E.forEach(ae),this.h()},h(){X(p,"class","chart-container svelte-s9z6lx")},m(S,E){dt(S,p,E),vi(m,p,null),v=!0},p(S,[E]){const s={};E&4&&(s.x=S[2]),E&8&&(s.y=S[3]),E&16&&(s.z=S[4]),E&128&&(s.xDomain=S[7]),E&64&&(s.yDomain=S[6]),E&64&&(s.zDomain=S[6]),E&1&&(s.data=S[0]),E&1058&&(s.$$scope={dirty:E,ctx:S}),m.$set(s)},i(S){v||(Zt(m.$$.fragment,S),v=!0)},o(S){ir(m.$$.fragment,S),v=!1},d(S){S&&ae(p),xi(m)}}}function kv(c,p,m){let v,S,E,{data:s}=p,{suffix:C="%"}=p,{decimals:A=0}=p,{fill:V="#00205B"}=p,{xKey:N="x"}=p,{yKey:W="y"}=p,{zKey:K=null}=p;return c.$$set=H=>{"data"in H&&m(0,s=H.data),"suffix"in H&&m(8,C=H.suffix),"decimals"in H&&m(9,A=H.decimals),"fill"in H&&m(1,V=H.fill),"xKey"in H&&m(2,N=H.xKey),"yKey"in H&&m(3,W=H.yKey),"zKey"in H&&m(4,K=H.zKey)},c.$$.update=()=>{c.$$.dirty&5&&m(7,v=s.map(H=>H[N])),c.$$.dirty&9&&m(6,S=[0,Math.max(...s.map(H=>H[W]))]),c.$$.dirty&768&&m(5,E=H=>H.toFixed(A)+C)},[s,V,N,W,K,E,S,v,C,A]}class wc extends Ka{constructor(p){super(),Xa(this,p,kv,Iv,Wa,{data:0,suffix:8,decimals:9,fill:1,xKey:2,yKey:3,zKey:4})}}function Yd(c,p,m){const v=c.slice();return v[7]=p[m],v[9]=m,v}function Qd(c){let p,m=c[0],v=[];for(let S=0;S<m.length;S+=1)v[S]=$d(Yd(c,m,S));return{c(){p=Wo("svg");for(let S=0;S<v.length;S+=1)v[S].c();this.h()},l(S){p=Ho(S,"svg",{class:!0});var E=we(p);for(let s=0;s<v.length;s+=1)v[s].l(E);E.forEach(ae),this.h()},h(){X(p,"class","stack svelte-q6mgyr")},m(S,E){dt(S,p,E);for(let s=0;s<v.length;s+=1)v[s].m(p,null)},p(S,E){if(E&31){m=S[0];let s;for(s=0;s<m.length;s+=1){const C=Yd(S,m,s);v[s]?v[s].p(C,E):(v[s]=$d(C),v[s].c(),v[s].m(p,null))}for(;s<v.length;s+=1)v[s].d(1);v.length=m.length}},d(S){S&&ae(p),Ms(v,S)}}}function $d(c){let p,m;return{c(){p=Wo("rect"),this.h()},l(v){p=Ho(v,"rect",{class:!0,x:!0,style:!0}),we(p).forEach(ae),this.h()},h(){X(p,"class","cell svelte-q6mgyr"),X(p,"x",m=c[4][c[9]]/c[3]*100+"%"),Me(p,"width",c[7][c[1]]/c[3]*100+"%"),Me(p,"fill",c[2][c[9]])},m(v,S){dt(v,p,S)},p(v,S){S&24&&m!==(m=v[4][v[9]]/v[3]*100+"%")&&X(p,"x",m),S&11&&Me(p,"width",v[7][v[1]]/v[3]*100+"%"),S&4&&Me(p,"fill",v[2][v[9]])},d(v){v&&ae(p)}}}function zv(c){let p,m=c[3]&&c[4]&&Qd(c);return{c(){m&&m.c(),p=dn()},l(v){m&&m.l(v),p=dn()},m(v,S){m&&m.m(v,S),dt(v,p,S)},p(v,[S]){v[3]&&v[4]?m?m.p(v,S):(m=Qd(v),m.c(),m.m(p.parentNode,p)):m&&(m.d(1),m=null)},i:ps,o:ps,d(v){m&&m.d(v),v&&ae(p)}}}function Av(c,p,m){let{data:v}=p,{xKey:S="x"}=p,{yKey:E="y"}=p,{colors:s=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=p,C,A;function V(){m(3,C=v.map(W=>W[E]).reduce((W,K)=>W+K,0));let N=[0];v.forEach(W=>N.push(N[N.length-1]+W[E])),m(4,A=N)}return c.$$set=N=>{"data"in N&&m(0,v=N.data),"xKey"in N&&m(5,S=N.xKey),"yKey"in N&&m(1,E=N.yKey),"colors"in N&&m(2,s=N.colors)},c.$$.update=()=>{c.$$.dirty&3&&(v||E)&&V()},[v,E,s,C,A,S]}class Xm extends Ka{constructor(p){super(),Xa(this,p,Av,zv,Wa,{data:0,xKey:5,yKey:1,colors:2})}}function em(c,p,m){const v=c.slice();return v[12]=p[m],v[14]=m,v}function Pv(c){let p,m,v=Bh(Math.round(c[12][c[3]]),"%)")+"",S;return{c(){p=Ie("span"),m=$e("(NI "),S=$e(v),this.h()},l(E){p=ke(E,"SPAN",{class:!0,style:!0});var s=we(p);m=et(s,"(NI "),S=et(s,v),s.forEach(ae),this.h()},h(){X(p,"class",""),Me(p,"color","#3878C5")},m(E,s){dt(E,p,s),ie(p,m),ie(p,S)},p(E,s){s&9&&v!==(v=Bh(Math.round(E[12][E[3]]),"%)")+"")&&Ar(S,v)},d(E){E&&ae(p)}}}function Cv(c){let p,m,v=Bh(Math.round(c[12][c[3]]),"%)")+"",S;return{c(){p=Ie("span"),m=$e("(2011 "),S=$e(v),this.h()},l(E){p=ke(E,"SPAN",{class:!0,style:!0});var s=we(p);m=et(s,"(2011 "),S=et(s,v),s.forEach(ae),this.h()},h(){X(p,"class",""),Me(p,"color","#3878C5")},m(E,s){dt(E,p,s),ie(p,m),ie(p,S)},p(E,s){s&9&&v!==(v=Bh(Math.round(E[12][E[3]]),"%)")+"")&&Ar(S,v)},d(E){E&&ae(p)}}}function tm(c){let p,m,v,S,E=c[12][c[1]]+"",s,C,A=c[6](c[12][c[2]])+"",V,N,W,K;function H(ze,Ge){if(ze[3]=="prev")return Cv;if(ze[3])return Pv}let pe=H(c),Re=pe&&pe(c);return{c(){p=Ie("li"),m=Wo("svg"),v=Wo("rect"),S=pt(),s=$e(E),C=pt(),V=$e(A),N=pt(),Re&&Re.c(),W=pt(),K=Ie("br"),this.h()},l(ze){p=ke(ze,"LI",{style:!0,class:!0});var Ge=we(p);m=Ho(Ge,"svg",{width:!0,height:!0,class:!0});var Ke=we(m);v=Ho(Ke,"rect",{width:!0,height:!0,style:!0});var Nt=we(v);Nt.forEach(ae),Ke.forEach(ae),S=ft(Ge),s=et(Ge,E),C=ft(Ge),V=et(Ge,A),N=ft(Ge),Re&&Re.l(Ge),Ge.forEach(ae),W=ft(ze),K=ke(ze,"BR",{}),this.h()},h(){X(v,"width","20"),X(v,"height","30"),Me(v,"fill",c[4][c[14]]),X(m,"width","20"),X(m,"height","30"),X(m,"class","bullet svelte-17303hq"),Me(p,"color",c[5]),X(p,"class","svelte-17303hq")},m(ze,Ge){dt(ze,p,Ge),ie(p,m),ie(m,v),ie(p,S),ie(p,s),ie(p,C),ie(p,V),ie(p,N),Re&&Re.m(p,null),dt(ze,W,Ge),dt(ze,K,Ge)},p(ze,Ge){Ge&16&&Me(v,"fill",ze[4][ze[14]]),Ge&3&&E!==(E=ze[12][ze[1]]+"")&&Ar(s,E),Ge&5&&A!==(A=ze[6](ze[12][ze[2]])+"")&&Ar(V,A),pe===(pe=H(ze))&&Re?Re.p(ze,Ge):(Re&&Re.d(1),Re=pe&&pe(ze),Re&&(Re.c(),Re.m(p,null))),Ge&32&&Me(p,"color",ze[5])},d(ze){ze&&ae(p),Re&&Re.d(),ze&&ae(W),ze&&ae(K)}}}function Mv(c){let p,m=c[0],v=[];for(let S=0;S<m.length;S+=1)v[S]=tm(em(c,m,S));return{c(){p=Ie("ul");for(let S=0;S<v.length;S+=1)v[S].c();this.h()},l(S){p=ke(S,"UL",{class:!0});var E=we(p);for(let s=0;s<v.length;s+=1)v[s].l(E);E.forEach(ae),this.h()},h(){X(p,"class","svelte-17303hq")},m(S,E){dt(S,p,E);for(let s=0;s<v.length;s+=1)v[s].m(p,null)},p(S,[E]){if(E&127){m=S[0];let s;for(s=0;s<m.length;s+=1){const C=em(S,m,s);v[s]?v[s].p(C,E):(v[s]=tm(C),v[s].c(),v[s].m(p,null))}for(;s<v.length;s+=1)v[s].d(1);v.length=m.length}},i:ps,o:ps,d(S){S&&ae(p),Ms(v,S)}}}function Dv(c,p,m){let v,{data:S}=p,{xKey:E="x"}=p,{yKey:s="y"}=p,{zKey:C="ew"}=p,{colors:A=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=p,{textColor:V="#555"}=p,{mutedColor:N="#999"}=p,{decimals:W=null}=p,{round:K=!1}=p;function H(pe){let Re;return W?Re=(pe/v*100).toFixed(W)+"%":pe/v*100<1?Re="<1%":Re=(pe/v*100).toFixed(0)+"%",Re}return c.$$set=pe=>{"data"in pe&&m(0,S=pe.data),"xKey"in pe&&m(1,E=pe.xKey),"yKey"in pe&&m(2,s=pe.yKey),"zKey"in pe&&m(3,C=pe.zKey),"colors"in pe&&m(4,A=pe.colors),"textColor"in pe&&m(5,V=pe.textColor),"mutedColor"in pe&&m(7,N=pe.mutedColor),"decimals"in pe&&m(8,W=pe.decimals),"round"in pe&&m(9,K=pe.round)},c.$$.update=()=>{c.$$.dirty&5&&(v=S.map(pe=>pe[s]).reduce((pe,Re)=>pe+Re,0)),c.$$.dirty&9&&S.map(pe=>pe[C]).reduce((pe,Re)=>pe+Re,0)},[S,E,s,C,A,V,H,N,W,K]}class Lv extends Ka{constructor(p){super(),Xa(this,p,Dv,Mv,Wa,{data:0,xKey:1,yKey:2,zKey:3,colors:4,textColor:5,mutedColor:7,decimals:8,round:9})}}function rm(c){let p,m,v,S;m=new Xm({props:{data:c[0],yKey:c[4],colors:c[5]}});let E=c[7]&&im(c);return{c(){p=Ie("div"),gi(m.$$.fragment),v=pt(),E&&E.c(),this.h()},l(s){p=ke(s,"DIV",{class:!0,style:!0});var C=we(p);_i(m.$$.fragment,C),v=ft(C),E&&E.l(C),C.forEach(ae),this.h()},h(){X(p,"class","chart svelte-1tebgpk"),Me(p,"height",c[1]*.28+"px")},m(s,C){dt(s,p,C),vi(m,p,null),ie(p,v),E&&E.m(p,null),S=!0},p(s,C){const A={};C&1&&(A.data=s[0]),C&16&&(A.yKey=s[4]),C&32&&(A.colors=s[5]),m.$set(A),s[7]?E?E.p(s,C):(E=im(s),E.c(),E.m(p,null)):E&&(E.d(1),E=null),(!S||C&2)&&Me(p,"height",s[1]*.28+"px")},i(s){S||(Zt(m.$$.fragment,s),S=!0)},o(s){ir(m.$$.fragment,s),S=!1},d(s){s&&ae(p),xi(m),E&&E.d()}}}function im(c){let p,m;return{c(){p=Ie("div"),m=$e(c[7]),this.h()},l(v){p=ke(v,"DIV",{class:!0});var S=we(p);m=et(S,c[7]),S.forEach(ae),this.h()},h(){X(p,"class","label svelte-1tebgpk")},m(v,S){dt(v,p,S),ie(p,m)},p(v,S){S&128&&Ar(m,v[7])},d(v){v&&ae(p)}}}function Rv(c){let p,m,v,S,E,s,C;m=new Xm({props:{data:c[0],yKey:c[3],colors:c[5]}});let A=c[4]&&rm(c);return s=new Lv({props:{data:c[0],xKey:c[2],yKey:c[3],zKey:c[4],decimals:c[6],colors:c[5]}}),{c(){p=Ie("div"),gi(m.$$.fragment),v=pt(),A&&A.c(),S=pt(),E=Ie("div"),gi(s.$$.fragment),this.h()},l(V){p=ke(V,"DIV",{class:!0,style:!0});var N=we(p);_i(m.$$.fragment,N),N.forEach(ae),v=ft(V),A&&A.l(V),S=ft(V),E=ke(V,"DIV",{class:!0});var W=we(E);_i(s.$$.fragment,W),W.forEach(ae),this.h()},h(){X(p,"class","chart svelte-1tebgpk"),Me(p,"padding-top","3px"),Me(p,"height",(c[4]?c[1]*.72:c[1])+"px"),X(E,"class","legend svelte-1tebgpk")},m(V,N){dt(V,p,N),vi(m,p,null),dt(V,v,N),A&&A.m(V,N),dt(V,S,N),dt(V,E,N),vi(s,E,null),C=!0},p(V,[N]){const W={};N&1&&(W.data=V[0]),N&8&&(W.yKey=V[3]),N&32&&(W.colors=V[5]),m.$set(W),(!C||N&18)&&Me(p,"height",(V[4]?V[1]*.72:V[1])+"px"),V[4]?A?(A.p(V,N),N&16&&Zt(A,1)):(A=rm(V),A.c(),Zt(A,1),A.m(S.parentNode,S)):A&&(mu(),ir(A,1,1,()=>{A=null}),yu());const K={};N&1&&(K.data=V[0]),N&4&&(K.xKey=V[2]),N&8&&(K.yKey=V[3]),N&16&&(K.zKey=V[4]),N&64&&(K.decimals=V[6]),N&32&&(K.colors=V[5]),s.$set(K)},i(V){C||(Zt(m.$$.fragment,V),Zt(A),Zt(s.$$.fragment,V),C=!0)},o(V){ir(m.$$.fragment,V),ir(A),ir(s.$$.fragment,V),C=!1},d(V){V&&ae(p),xi(m),V&&ae(v),A&&A.d(V),V&&ae(S),V&&ae(E),xi(s)}}}function Bv(c,p,m){let{data:v}=p,{height:S=80}=p,{xKey:E="x"}=p,{yKey:s="y"}=p,{zKey:C="ew"}=p,{colors:A=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=p,{decimals:V=null}=p,{label:N=null}=p;return c.$$set=W=>{"data"in W&&m(0,v=W.data),"height"in W&&m(1,S=W.height),"xKey"in W&&m(2,E=W.xKey),"yKey"in W&&m(3,s=W.yKey),"zKey"in W&&m(4,C=W.zKey),"colors"in W&&m(5,A=W.colors),"decimals"in W&&m(6,V=W.decimals),"label"in W&&m(7,N=W.label)},[v,S,E,s,C,A,V,N]}class Ah extends Ka{constructor(p){super(),Xa(this,p,Bv,Rv,Wa,{data:0,height:1,xKey:2,yKey:3,zKey:4,colors:5,decimals:6,label:7})}}var Ov=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Fv={rgb2hsl:Rc,rgb2hsv:qh,rgb2hwb:Bc,rgb2cmyk:Oc,rgb2keyword:Fc,rgb2xyz:qp,rgb2lab:Zp,rgb2lch:Vv,hsl2rgb:Zh,hsl2hsv:Nv,hsl2hwb:Uv,hsl2cmyk:jv,hsl2keyword:qv,hsv2rgb:Gh,hsv2hsl:Zv,hsv2hwb:Gv,hsv2cmyk:Kv,hsv2keyword:Xv,hwb2rgb:Vc,hwb2hsl:Wv,hwb2hsv:Hv,hwb2cmyk:Jv,hwb2keyword:Yv,cmyk2rgb:Nc,cmyk2hsl:Qv,cmyk2hsv:$v,cmyk2hwb:e0,cmyk2keyword:t0,keyword2rgb:vu,keyword2hsl:o0,keyword2hsv:a0,keyword2hwb:s0,keyword2cmyk:l0,keyword2lab:u0,keyword2xyz:c0,xyz2rgb:Wm,xyz2lab:Hm,xyz2lch:r0,lab2xyz:Gp,lab2rgb:Jm,lab2lch:Kp,lch2lab:Xp,lch2xyz:i0,lch2rgb:n0};function Rc(c){var p=c[0]/255,m=c[1]/255,v=c[2]/255,S=Math.min(p,m,v),E=Math.max(p,m,v),s=E-S,C,A,V;return E==S?C=0:p==E?C=(m-v)/s:m==E?C=2+(v-p)/s:v==E&&(C=4+(p-m)/s),C=Math.min(C*60,360),C<0&&(C+=360),V=(S+E)/2,E==S?A=0:V<=.5?A=s/(E+S):A=s/(2-E-S),[C,A*100,V*100]}function qh(c){var p=c[0],m=c[1],v=c[2],S=Math.min(p,m,v),E=Math.max(p,m,v),s=E-S,C,A,V;return E==0?A=0:A=s/E*1e3/10,E==S?C=0:p==E?C=(m-v)/s:m==E?C=2+(v-p)/s:v==E&&(C=4+(p-m)/s),C=Math.min(C*60,360),C<0&&(C+=360),V=E/255*1e3/10,[C,A,V]}function Bc(c){var p=c[0],m=c[1],E=c[2],v=Rc(c)[0],S=1/255*Math.min(p,Math.min(m,E)),E=1-1/255*Math.max(p,Math.max(m,E));return[v,S*100,E*100]}function Oc(c){var p=c[0]/255,m=c[1]/255,v=c[2]/255,S,E,s,C;return C=Math.min(1-p,1-m,1-v),S=(1-p-C)/(1-C)||0,E=(1-m-C)/(1-C)||0,s=(1-v-C)/(1-C)||0,[S*100,E*100,s*100,C*100]}function Fc(c){return Ym[JSON.stringify(c)]}function qp(c){var p=c[0]/255,m=c[1]/255,v=c[2]/255;p=p>.04045?Math.pow((p+.055)/1.055,2.4):p/12.92,m=m>.04045?Math.pow((m+.055)/1.055,2.4):m/12.92,v=v>.04045?Math.pow((v+.055)/1.055,2.4):v/12.92;var S=p*.4124+m*.3576+v*.1805,E=p*.2126+m*.7152+v*.0722,s=p*.0193+m*.1192+v*.9505;return[S*100,E*100,s*100]}function Zp(c){var p=qp(c),m=p[0],v=p[1],S=p[2],E,s,C;return m/=95.047,v/=100,S/=108.883,m=m>.008856?Math.pow(m,1/3):7.787*m+16/116,v=v>.008856?Math.pow(v,1/3):7.787*v+16/116,S=S>.008856?Math.pow(S,1/3):7.787*S+16/116,E=116*v-16,s=500*(m-v),C=200*(v-S),[E,s,C]}function Vv(c){return Kp(Zp(c))}function Zh(c){var p=c[0]/360,m=c[1]/100,v=c[2]/100,S,E,s,C,A;if(m==0)return A=v*255,[A,A,A];v<.5?E=v*(1+m):E=v+m-v*m,S=2*v-E,C=[0,0,0];for(var V=0;V<3;V++)s=p+1/3*-(V-1),s<0&&s++,s>1&&s--,6*s<1?A=S+(E-S)*6*s:2*s<1?A=E:3*s<2?A=S+(E-S)*(2/3-s)*6:A=S,C[V]=A*255;return C}function Nv(c){var p=c[0],m=c[1]/100,v=c[2]/100,S,E;return v===0?[0,0,0]:(v*=2,m*=v<=1?v:2-v,E=(v+m)/2,S=2*m/(v+m),[p,S*100,E*100])}function Uv(c){return Bc(Zh(c))}function jv(c){return Oc(Zh(c))}function qv(c){return Fc(Zh(c))}function Gh(c){var p=c[0]/60,m=c[1]/100,A=c[2]/100,v=Math.floor(p)%6,S=p-Math.floor(p),E=255*A*(1-m),s=255*A*(1-m*S),C=255*A*(1-m*(1-S)),A=255*A;switch(v){case 0:return[A,C,E];case 1:return[s,A,E];case 2:return[E,A,C];case 3:return[E,s,A];case 4:return[C,E,A];case 5:return[A,E,s]}}function Zv(c){var p=c[0],m=c[1]/100,v=c[2]/100,S,E;return E=(2-m)*v,S=m*v,S/=E<=1?E:2-E,S=S||0,E/=2,[p,S*100,E*100]}function Gv(c){return Bc(Gh(c))}function Kv(c){return Oc(Gh(c))}function Xv(c){return Fc(Gh(c))}function Vc(c){var p=c[0]/360,m=c[1]/100,v=c[2]/100,S=m+v,E,s,C,A;switch(S>1&&(m/=S,v/=S),E=Math.floor(6*p),s=1-v,C=6*p-E,(E&1)!=0&&(C=1-C),A=m+C*(s-m),E){default:case 6:case 0:r=s,g=A,b=m;break;case 1:r=A,g=s,b=m;break;case 2:r=m,g=s,b=A;break;case 3:r=m,g=A,b=s;break;case 4:r=A,g=m,b=s;break;case 5:r=s,g=m,b=A;break}return[r*255,g*255,b*255]}function Wv(c){return Rc(Vc(c))}function Hv(c){return qh(Vc(c))}function Jv(c){return Oc(Vc(c))}function Yv(c){return Fc(Vc(c))}function Nc(c){var p=c[0]/100,m=c[1]/100,v=c[2]/100,S=c[3]/100,E,s,C;return E=1-Math.min(1,p*(1-S)+S),s=1-Math.min(1,m*(1-S)+S),C=1-Math.min(1,v*(1-S)+S),[E*255,s*255,C*255]}function Qv(c){return Rc(Nc(c))}function $v(c){return qh(Nc(c))}function e0(c){return Bc(Nc(c))}function t0(c){return Fc(Nc(c))}function Wm(c){var p=c[0]/100,m=c[1]/100,v=c[2]/100,S,E,s;return S=p*3.2406+m*-1.5372+v*-.4986,E=p*-.9689+m*1.8758+v*.0415,s=p*.0557+m*-.204+v*1.057,S=S>.0031308?1.055*Math.pow(S,1/2.4)-.055:S=S*12.92,E=E>.0031308?1.055*Math.pow(E,1/2.4)-.055:E=E*12.92,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s=s*12.92,S=Math.min(Math.max(0,S),1),E=Math.min(Math.max(0,E),1),s=Math.min(Math.max(0,s),1),[S*255,E*255,s*255]}function Hm(c){var p=c[0],m=c[1],v=c[2],S,E,s;return p/=95.047,m/=100,v/=108.883,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,m=m>.008856?Math.pow(m,1/3):7.787*m+16/116,v=v>.008856?Math.pow(v,1/3):7.787*v+16/116,S=116*m-16,E=500*(p-m),s=200*(m-v),[S,E,s]}function r0(c){return Kp(Hm(c))}function Gp(c){var p=c[0],m=c[1],v=c[2],S,E,s,C;return p<=8?(E=p*100/903.3,C=7.787*(E/100)+16/116):(E=100*Math.pow((p+16)/116,3),C=Math.pow(E/100,1/3)),S=S/95.047<=.008856?S=95.047*(m/500+C-16/116)/7.787:95.047*Math.pow(m/500+C,3),s=s/108.883<=.008859?s=108.883*(C-v/200-16/116)/7.787:108.883*Math.pow(C-v/200,3),[S,E,s]}function Kp(c){var p=c[0],m=c[1],v=c[2],S,E,s;return S=Math.atan2(v,m),E=S*360/2/Math.PI,E<0&&(E+=360),s=Math.sqrt(m*m+v*v),[p,s,E]}function Jm(c){return Wm(Gp(c))}function Xp(c){var p=c[0],m=c[1],v=c[2],S,E,s;return s=v/360*2*Math.PI,S=m*Math.cos(s),E=m*Math.sin(s),[p,S,E]}function i0(c){return Gp(Xp(c))}function n0(c){return Jm(Xp(c))}function vu(c){return Bp[c]}function o0(c){return Rc(vu(c))}function a0(c){return qh(vu(c))}function s0(c){return Bc(vu(c))}function l0(c){return Oc(vu(c))}function u0(c){return Zp(vu(c))}function c0(c){return qp(vu(c))}var Bp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Ym={};for(var nm in Bp)Ym[JSON.stringify(Bp[nm])]=nm;var zp=Fv,Ku=function(){return new Uc};for(var Sc in zp){Ku[Sc+"Raw"]=function(c){return function(p){return typeof p=="number"&&(p=Array.prototype.slice.call(arguments)),zp[c](p)}}(Sc);var om=/(\w+)2(\w+)/.exec(Sc),Ap=om[1],h0=om[2];Ku[Ap]=Ku[Ap]||{},Ku[Ap][h0]=Ku[Sc]=function(c){return function(p){typeof p=="number"&&(p=Array.prototype.slice.call(arguments));var m=zp[c](p);if(typeof m=="string"||m===void 0)return m;for(var v=0;v<m.length;v++)m[v]=Math.round(m[v]);return m}}(Sc)}var Uc=function(){this.convs={}};Uc.prototype.routeSpace=function(c,p){var m=p[0];return m===void 0?this.getValues(c):(typeof m=="number"&&(m=Array.prototype.slice.call(p)),this.setValues(c,m))};Uc.prototype.setValues=function(c,p){return this.space=c,this.convs={},this.convs[c]=p,this};Uc.prototype.getValues=function(c){var p=this.convs[c];if(!p){var m=this.space,v=this.convs[m];p=Ku[m][c](v),this.convs[c]=p}return p};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(c){Uc.prototype[c]=function(p){return this.routeSpace(c,arguments)}});function am(c,p,m){const v=c.slice();return v[33]=p[m],v[36]=p,v[35]=m,v}function sm(c,p,m){const v=c.slice();return v[33]=p[m],v[34]=p,v[35]=m,v}function p0(c){let p,m,v=(c[0]?c[0]:"Select one")+"",S,E,s,C,A,V;return{c(){p=Ie("a"),m=Ie("span"),S=$e(v),E=pt(),s=Ie("span"),C=$e("\xA0"),this.h()},l(N){p=ke(N,"A",{id:!0,class:!0});var W=we(p);m=ke(W,"SPAN",{class:!0});var K=we(m);S=et(K,v),K.forEach(ae),E=ft(W),s=ke(W,"SPAN",{class:!0});var H=we(s);C=et(H,"\xA0"),H.forEach(ae),W.forEach(ae),this.h()},h(){X(m,"class","svelte-3tt915"),X(s,"class","button svelte-3tt915"),fn(s,"search",c[3]),fn(s,"down",!c[3]),X(p,"id","toggle"),X(p,"class","svelte-3tt915")},m(N,W){dt(N,p,W),ie(p,m),ie(m,S),ie(p,E),ie(p,s),ie(s,C),A||(V=jn(p,"click",c[12]),A=!0)},p(N,W){W[0]&1&&v!==(v=(N[0]?N[0]:"Select one")+"")&&Ar(S,v),W[0]&8&&fn(s,"search",N[3]),W[0]&8&&fn(s,"down",!N[3])},d(N){N&&ae(p),A=!1,V()}}}function f0(c){let p,m,v=c[5][c[1]]+"",S,E,s,C,A,V,N,W=c[2]&&lm(c);return{c(){p=Ie("a"),m=Ie("span"),S=$e(v),E=pt(),W&&W.c(),s=pt(),C=Ie("span"),A=$e("\xA0"),this.h()},l(K){p=ke(K,"A",{id:!0,class:!0});var H=we(p);m=ke(H,"SPAN",{class:!0});var pe=we(m);S=et(pe,v),E=ft(pe),W&&W.l(pe),pe.forEach(ae),s=ft(H),C=ke(H,"SPAN",{class:!0});var Re=we(C);A=et(Re,"\xA0"),Re.forEach(ae),H.forEach(ae),this.h()},h(){X(m,"class","selection svelte-3tt915"),X(C,"class","button close svelte-3tt915"),X(p,"id","toggle"),X(p,"class","selected svelte-3tt915")},m(K,H){dt(K,p,H),ie(p,m),ie(m,S),ie(m,E),W&&W.m(m,null),ie(p,s),ie(p,C),ie(C,A),V||(N=[jn(C,"click",c[14]),jn(p,"click",c[12])],V=!0)},p(K,H){H[0]&34&&v!==(v=K[5][K[1]]+"")&&Ar(S,v),K[2]?W?W.p(K,H):(W=lm(K),W.c(),W.m(m,null)):W&&(W.d(1),W=null)},d(K){K&&ae(p),W&&W.d(),V=!1,gu(N)}}}function lm(c){let p,m=c[5][c[2]]+"",v;return{c(){p=Ie("small"),v=$e(m),this.h()},l(S){p=ke(S,"SMALL",{class:!0});var E=we(p);v=et(E,m),E.forEach(ae),this.h()},h(){X(p,"class","svelte-3tt915")},m(S,E){dt(S,p,E),ie(p,v)},p(S,E){E[0]&36&&m!==(m=S[5][S[2]]+"")&&Ar(v,m)},d(S){S&&ae(p)}}}function um(c){let p,m,v,S,E,s;function C(N,W){return N[4].length<3?g0:N[8][0]&&N[2]?y0:N[8][0]?m0:d0}let A=C(c),V=A(c);return{c(){p=Ie("div"),m=Ie("input"),v=pt(),S=Ie("ul"),V.c(),this.h()},l(N){p=ke(N,"DIV",{id:!0,style:!0,class:!0});var W=we(p);m=ke(W,"INPUT",{type:!0,placeholder:!0,autocomplete:!0,onfocus:!0,class:!0}),v=ft(W),S=ke(W,"UL",{class:!0});var K=we(S);V.l(K),K.forEach(ae),W.forEach(ae),this.h()},h(){X(m,"type","text"),X(m,"placeholder",""),X(m,"autocomplete","false"),m.autofocus="autofocus",X(m,"onfocus","this.select()"),X(m,"class","svelte-3tt915"),X(S,"class","svelte-3tt915"),X(p,"id","dropdown"),Me(p,"top","0"),X(p,"class","svelte-3tt915")},m(N,W){dt(N,p,W),ie(p,m),md(m,c[4]),c[24](m),ie(p,v),ie(p,S),V.m(S,null),c[31](p),m.focus(),E||(s=[jn(m,"input",c[23]),jn(m,"keyup",c[16])],E=!0)},p(N,W){W[0]&16&&m.value!==N[4]&&md(m,N[4]),A===(A=C(N))&&V?V.p(N,W):(V.d(1),V=A(N),V&&(V.c(),V.m(S,null)))},d(N){N&&ae(p),c[24](null),V.d(),c[31](null),E=!1,gu(s)}}}function d0(c){let p,m;return{c(){p=Ie("li"),m=$e("No results"),this.h()},l(v){p=ke(v,"LI",{class:!0});var S=we(p);m=et(S,"No results"),S.forEach(ae),this.h()},h(){X(p,"class","svelte-3tt915")},m(v,S){dt(v,p,S),ie(p,m)},p:ps,d(v){v&&ae(p)}}}function m0(c){let p,m=c[8],v=[];for(let S=0;S<m.length;S+=1)v[S]=cm(am(c,m,S));return{c(){for(let S=0;S<v.length;S+=1)v[S].c();p=dn()},l(S){for(let E=0;E<v.length;E+=1)v[E].l(S);p=dn()},m(S,E){for(let s=0;s<v.length;s+=1)v[s].m(S,E);dt(S,p,E)},p(S,E){if(E[0]&10626){m=S[8];let s;for(s=0;s<m.length;s+=1){const C=am(S,m,s);v[s]?v[s].p(C,E):(v[s]=cm(C),v[s].c(),v[s].m(p.parentNode,p))}for(;s<v.length;s+=1)v[s].d(1);v.length=m.length}},d(S){Ms(v,S),S&&ae(p)}}}function y0(c){let p,m=c[8],v=[];for(let S=0;S<m.length;S+=1)v[S]=hm(sm(c,m,S));return{c(){for(let S=0;S<v.length;S+=1)v[S].c();p=dn()},l(S){for(let E=0;E<v.length;E+=1)v[E].l(S);p=dn()},m(S,E){for(let s=0;s<v.length;s+=1)v[s].m(S,E);dt(S,p,E)},p(S,E){if(E[0]&10630){m=S[8];let s;for(s=0;s<m.length;s+=1){const C=sm(S,m,s);v[s]?v[s].p(C,E):(v[s]=hm(C),v[s].c(),v[s].m(p.parentNode,p))}for(;s<v.length;s+=1)v[s].d(1);v.length=m.length}},d(S){Ms(v,S),S&&ae(p)}}}function g0(c){let p,m;return{c(){p=Ie("li"),m=$e("Type a name..."),this.h()},l(v){p=ke(v,"LI",{class:!0});var S=we(p);m=et(S,"Type a name..."),S.forEach(ae),this.h()},h(){X(p,"class","svelte-3tt915")},m(v,S){dt(v,p,S),ie(p,m)},p:ps,d(v){v&&ae(p)}}}function cm(c){let p,m=c[33][c[1]]+"",v,S,E=c[35],s,C;function A(){return c[28](c[33])}function V(){return c[29](c[35])}const N=()=>c[30](p,E),W=()=>c[30](null,E);return{c(){p=Ie("li"),v=$e(m),S=pt(),this.h()},l(K){p=ke(K,"LI",{class:!0});var H=we(p);v=et(H,m),S=ft(H),H.forEach(ae),this.h()},h(){X(p,"class","svelte-3tt915"),fn(p,"highlight",c[7]==c[35])},m(K,H){dt(K,p,H),ie(p,v),ie(p,S),N(),s||(C=[jn(p,"click",A),jn(p,"mouseover",V)],s=!0)},p(K,H){c=K,H[0]&258&&m!==(m=c[33][c[1]]+"")&&Ar(v,m),E!==c[35]&&(W(),E=c[35],N()),H[0]&128&&fn(p,"highlight",c[7]==c[35])},d(K){K&&ae(p),W(),s=!1,gu(C)}}}function hm(c){let p,m=c[33][c[1]]+"",v,S,E,s=c[33][c[2]]+"",C,A,V=c[35],N,W;function K(){return c[25](c[33])}function H(){return c[26](c[35])}const pe=()=>c[27](p,V),Re=()=>c[27](null,V);return{c(){p=Ie("li"),v=$e(m),S=pt(),E=Ie("small"),C=$e(s),A=pt(),this.h()},l(ze){p=ke(ze,"LI",{class:!0});var Ge=we(p);v=et(Ge,m),S=ft(Ge),E=ke(Ge,"SMALL",{class:!0});var Ke=we(E);C=et(Ke,s),Ke.forEach(ae),A=ft(Ge),Ge.forEach(ae),this.h()},h(){X(E,"class","svelte-3tt915"),X(p,"class","svelte-3tt915"),fn(p,"highlight",c[7]==c[35])},m(ze,Ge){dt(ze,p,Ge),ie(p,v),ie(p,S),ie(p,E),ie(E,C),ie(p,A),pe(),N||(W=[jn(p,"click",K),jn(p,"mouseover",H)],N=!0)},p(ze,Ge){c=ze,Ge[0]&258&&m!==(m=c[33][c[1]]+"")&&Ar(v,m),Ge[0]&260&&s!==(s=c[33][c[2]]+"")&&Ar(C,s),V!==c[35]&&(Re(),V=c[35],pe()),Ge[0]&128&&fn(p,"highlight",c[7]==c[35])},d(ze){ze&&ae(p),Re(),N=!1,gu(W)}}}function _0(c){let p,m,v,S;function E(V,N){return V[5]&&!V[3]?f0:p0}let s=E(c),C=s(c),A=c[6]&&um(c);return{c(){p=Ie("div"),C.c(),m=pt(),A&&A.c(),this.h()},l(V){p=ke(V,"DIV",{id:!0,class:!0});var N=we(p);C.l(N),m=ft(N),A&&A.l(N),N.forEach(ae),this.h()},h(){X(p,"id","select"),X(p,"class","svelte-3tt915"),fn(p,"active",c[6])},m(V,N){dt(V,p,N),C.m(p,null),ie(p,m),A&&A.m(p,null),v||(S=[jn(window,"click",c[17]),jn(p,"keydown",c[15])],v=!0)},p(V,N){s===(s=E(V))&&C?C.p(V,N):(C.d(1),C=s(V),C&&(C.c(),C.m(p,m))),V[6]?A?A.p(V,N):(A=um(V),A.c(),A.m(p,null)):A&&(A.d(1),A=null),N[0]&64&&fn(p,"active",V[6])},i:ps,o:ps,d(V){V&&ae(p),C.d(),A&&A.d(),v=!1,gu(S)}}}function v0(c){return new Promise(p=>setTimeout(p,c))}function x0(c,p,m){let v;const S=Pm();let{options:E}=p,{selected:s=null}=p,{placeholder:C="Enter a town or area name"}=p,{value:A="code"}=p,{label:V="name"}=p,{group:N=null}=p,{search:W=!1}=p,K=s,H=s?E.find(rt=>{rt[A]==s[A]}):null,pe=!1,Re="",ze=null,Ge,Ke,Nt,Dt=[];function mt(rt){rt.stopPropagation(),m(4,Re=""),m(6,pe=!pe),v0(10).then(()=>{Nt&&pe&&Nt.focus()})}function He(rt){m(18,s=rt),m(6,pe=!1),S("select",{selected:rt,value:rt[A]})}function Er(rt){rt.stopPropagation(),m(18,s=null),m(21,K=null),m(5,H=null),S("select",{selected:null,value:null})}function hr(rt){pe&&Ge[0]&&Number.isInteger(ze)&&(rt.keyCode===38?(m(7,ze-=ze>0?1:0),Dt[ze].scrollIntoView({block:"nearest",inline:"start"})):rt.keyCode===40&&(m(7,ze+=ze<Ge.length-1?1:0),Dt[ze].scrollIntoView({block:"nearest",inline:"end"})))}function Ht(rt){Ge[0]&&Number.isInteger(ze)&&rt.keyCode===13&&He(Ge[ze])}function Jt(rt){rt.target!==Ke&&(m(6,pe=!1),m(7,ze=0))}function qe(){Re=this.value,m(4,Re)}function _r(rt){El[rt?"unshift":"push"](()=>{Nt=rt,m(10,Nt)})}const At=rt=>He(rt),nr=rt=>m(7,ze=rt);function tt(rt,Ze){El[rt?"unshift":"push"](()=>{Dt[Ze]=rt,m(11,Dt)})}const pr=rt=>He(rt),Vr=rt=>m(7,ze=rt);function Pt(rt,Ze){El[rt?"unshift":"push"](()=>{Dt[Ze]=rt,m(11,Dt)})}function tr(rt){El[rt?"unshift":"push"](()=>{Ke=rt,m(9,Ke)})}return c.$$set=rt=>{"options"in rt&&m(19,E=rt.options),"selected"in rt&&m(18,s=rt.selected),"placeholder"in rt&&m(0,C=rt.placeholder),"value"in rt&&m(20,A=rt.value),"label"in rt&&m(1,V=rt.label),"group"in rt&&m(2,N=rt.group),"search"in rt&&m(3,W=rt.search)},c.$$.update=()=>{c.$$.dirty[0]&16&&m(22,v=Re?new RegExp(Re,"i"):null),c.$$.dirty[0]&4718594&&(m(8,Ge=v?E.filter(rt=>v.test(rt[V])):E),m(7,ze=0)),c.$$.dirty[0]&3932160&&K!=s&&(m(5,H=E.find(rt=>rt[A]==s[A])),m(21,K=s))},[C,V,N,W,Re,H,pe,ze,Ge,Ke,Nt,Dt,mt,He,Er,hr,Ht,Jt,s,E,A,K,v,qe,_r,At,nr,tt,pr,Vr,Pt,tr]}class b0 extends Ka{constructor(p){super(),Xa(this,p,x0,_0,Wa,{options:19,selected:18,placeholder:0,value:20,label:1,group:2,search:3},null,[-1,-1])}}var Tc={exports:{}};(function(c,p){(function(m,v){c.exports=v()})(Ov,function(){var m,v,S;function E(s,C){if(!m)m=C;else if(!v)v=C;else{var A="var sharedChunk = {}; ("+m+")(sharedChunk); ("+v+")(sharedChunk);",V={};m(V),S=C(V),typeof window<"u"&&(S.workerUrl=window.URL.createObjectURL(new Blob([A],{type:"text/javascript"})))}}return E(["exports"],function(s){function C(e,t){return e(t={exports:{}},t.exports),t.exports}var A=V;function V(e,t,i,l){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=l,this.p2x=i,this.p2y=l}V.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},V.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},V.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},V.prototype.solveCurveX=function(e,t){var i,l,h,f,y;for(t===void 0&&(t=1e-6),h=e,y=0;y<8;y++){if(f=this.sampleCurveX(h)-e,Math.abs(f)<t)return h;var w=this.sampleCurveDerivativeX(h);if(Math.abs(w)<1e-6)break;h-=f/w}if((h=e)<(i=0))return i;if(h>(l=1))return l;for(;i<l;){if(f=this.sampleCurveX(h),Math.abs(f-e)<t)return h;e>f?i=h:l=h,h=.5*(l-i)+i}return h},V.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var N=W;function W(e,t){this.x=e,this.y=t}W.prototype={clone:function(){return new W(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(e,t){var i=Math.cos(e),l=Math.sin(e),h=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},W.convert=function(e){return e instanceof W?e:Array.isArray(e)?new W(e[0],e[1]):e};var K=typeof self<"u"?self:{},H=Math.pow(2,53)-1;function pe(e,t,i,l){var h=new A(e,t,i,l);return function(f){return h.solve(f)}}var Re=pe(.25,.1,.25,1);function ze(e,t,i){return Math.min(i,Math.max(t,e))}function Ge(e,t,i){var l=i-t,h=((e-t)%l+l)%l+t;return h===t?i:h}function Ke(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,h=t;l<h.length;l+=1){var f=h[l];for(var y in f)e[y]=f[y]}return e}var Nt=1;function Dt(){return Nt++}function mt(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function He(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Er(e,t){e.forEach(function(i){t[i]&&(t[i]=t[i].bind(t))})}function hr(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Ht(e,t,i){var l={};for(var h in e)l[h]=t.call(i||this,e[h],h,e);return l}function Jt(e,t,i){var l={};for(var h in e)t.call(i||this,e[h],h,e)&&(l[h]=e[h]);return l}function qe(e){return Array.isArray(e)?e.map(qe):typeof e=="object"&&e?Ht(e,qe):e}var _r={};function At(e){_r[e]||(typeof console<"u"&&console.warn(e),_r[e]=!0)}function nr(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function tt(e){for(var t=0,i=0,l=e.length,h=l-1,f=void 0,y=void 0;i<l;h=i++)t+=((y=e[h]).x-(f=e[i]).x)*(f.y+y.y);return t}function pr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Vr(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(l,h,f,y){var w=f||y;return t[h]=!w||w.toLowerCase(),""}),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var Pt=null;function tr(e){if(Pt==null){var t=e.navigator?e.navigator.userAgent:null;Pt=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Pt}function rt(e){try{var t=K[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var Ze,lr,Tr,on,an=K.performance&&K.performance.now?K.performance.now.bind(K.performance):Date.now.bind(Date),Ni=K.requestAnimationFrame||K.mozRequestAnimationFrame||K.webkitRequestAnimationFrame||K.msRequestAnimationFrame,Xt=K.cancelAnimationFrame||K.mozCancelAnimationFrame||K.webkitCancelAnimationFrame||K.msCancelAnimationFrame,wr={now:an,frame:function(e){var t=Ni(e);return{cancel:function(){return Xt(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var i=K.document.createElement("canvas"),l=i.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return i.width=e.width,i.height=e.height,l.drawImage(e,0,0,e.width,e.height),l.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return Ze||(Ze=K.document.createElement("a")),Ze.href=e,Ze.href},hardwareConcurrency:K.navigator&&K.navigator.hardwareConcurrency||4,get devicePixelRatio(){return K.devicePixelRatio},get prefersReducedMotion(){return!!K.matchMedia&&(lr==null&&(lr=K.matchMedia("(prefers-reduced-motion: reduce)")),lr.matches)}},Bt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Lr={supported:!1,testSupport:function(e){!kn&&on&&(zn?Gt(e):Tr=e)}},kn=!1,zn=!1;function Gt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,on),e.isContextLost())return;Lr.supported=!0}catch{}e.deleteTexture(t),kn=!0}K.document&&((on=K.document.createElement("img")).onload=function(){Tr&&Gt(Tr),Tr=null,zn=!0},on.onerror=function(){kn=!0,Tr=null},on.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var An="01",bi=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function Ai(e){return e.indexOf("mapbox:")===0}bi.prototype._createSkuToken=function(){var e=function(){for(var t="",i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",An,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},bi.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},bi.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},bi.prototype.normalizeStyleURL=function(e,t){if(!Ai(e))return e;var i=jr(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},bi.prototype.normalizeGlyphsURL=function(e,t){if(!Ai(e))return e;var i=jr(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},bi.prototype.normalizeSourceURL=function(e,t){if(!Ai(e))return e;var i=jr(e);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||t)},bi.prototype.normalizeSpriteURL=function(e,t,i,l){var h=jr(e);return Ai(e)?(h.path="/styles/v1"+h.path+"/sprite"+t+i,this._makeAPIURL(h,this._customAccessToken||l)):(h.path+=""+t+i,Pn(h))},bi.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!Ai(e))return e;var i=jr(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(wr.devicePixelRatio>=2||t===512?"@2x":"")+(Lr.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var l=this._customAccessToken||function(h){for(var f=0,y=h;f<y.length;f+=1){var w=y[f].match(/^access_token=(.*)$/);if(w)return w[1]}return null}(i.params)||Bt.ACCESS_TOKEN;return Bt.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,l)},bi.prototype.canonicalizeTileURL=function(e,t){var i=jr(e);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return e;var l="mapbox://tiles/";l+=i.path.replace("/v4/","");var h=i.params;return t&&(h=h.filter(function(f){return!f.match(/^access_token=/)})),h.length&&(l+="?"+h.join("&")),l},bi.prototype.canonicalizeTileset=function(e,t){for(var i=!!t&&Ai(t),l=[],h=0,f=e.tiles||[];h<f.length;h+=1){var y=f[h];Gr(y)?l.push(this.canonicalizeTileURL(y,i)):l.push(y)}return l},bi.prototype._makeAPIURL=function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=jr(Bt.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){var h=e.params.indexOf("secure");h>=0&&e.params.splice(h,1)}if(l.path!=="/"&&(e.path=""+l.path+e.path),!Bt.REQUIRE_ACCESS_TOKEN)return Pn(e);if(!(t=t||Bt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return e.params=e.params.filter(function(f){return f.indexOf("access_token")===-1}),e.params.push("access_token="+t),Pn(e)};var Ro=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Gr(e){return Ro.test(e)}var ci=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function jr(e){var t=e.match(ci);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Pn(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Xi(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(K.atob(t[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Wi=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Wi.prototype.getStorageKey=function(e){var t,i=Xi(Bt.ACCESS_TOKEN);return t=i&&i.u?K.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(l,h){return String.fromCharCode(Number("0x"+h))})):Bt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},Wi.prototype.fetchEventData=function(){var e=rt("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{var l=K.localStorage.getItem(t);l&&(this.eventData=JSON.parse(l));var h=K.localStorage.getItem(i);h&&(this.anonId=h)}catch{At("Unable to read from LocalStorage")}},Wi.prototype.saveEventData=function(){var e=rt("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{K.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&K.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{At("Unable to write to LocalStorage")}},Wi.prototype.processRequests=function(e){},Wi.prototype.postEvent=function(e,t,i,l){var h=this;if(Bt.EVENTS_URL){var f=jr(Bt.EVENTS_URL);f.params.push("access_token="+(l||Bt.ACCESS_TOKEN||""));var y={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:An,userId:this.anonId},w=t?Ke(y,t):y,I={url:Pn(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([w])};this.pendingRequest=dr(I,function(k){h.pendingRequest=null,i(k),h.saveEventData(),h.processRequests(l)})}},Wi.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Pi,Ui,hi=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(i,l,h,f){this.skuToken=h,(Bt.EVENTS_URL&&f||Bt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(y){return Ai(y)||Gr(y)}))&&this.queueRequest({id:l,timestamp:Date.now()},f)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){var h=this.queue.shift(),f=h.id,y=h.timestamp;f&&this.success[f]||(this.anonId||this.fetchEventData(),He(this.anonId)||(this.anonId=mt()),this.postEvent(y,{skuToken:this.skuToken},function(w){w||f&&(l.success[f]=!0)},i))}},t}(Wi),vo=new(function(e){function t(i){e.call(this,"appUserTurnstile"),this._customAccessToken=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(i,l){Bt.EVENTS_URL&&Bt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(h){return Ai(h)||Gr(h)})&&this.queueRequest(Date.now(),l)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var h=Xi(Bt.ACCESS_TOKEN),f=h?h.u:Bt.ACCESS_TOKEN,y=f!==this.eventData.tokenU;He(this.anonId)||(this.anonId=mt(),y=!0);var w=this.queue.shift();if(this.eventData.lastSuccess){var I=new Date(this.eventData.lastSuccess),k=new Date(w),P=(w-this.eventData.lastSuccess)/864e5;y=y||P>=1||P<-1||I.getDate()!==k.getDate()}else y=!0;if(!y)return this.processRequests();this.postEvent(w,{"enabled.telemetry":!1},function(D){D||(l.eventData.lastSuccess=w,l.eventData.tokenU=f)},i)}},t}(Wi)),Jo=vo.postTurnstileEvent.bind(vo),Cn=new hi,ro=Cn.postMapLoadEvent.bind(Cn),io=500,Yo=50;function xo(){K.caches&&!Pi&&(Pi=K.caches.open("mapbox-tiles"))}function ji(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var pi,sn=1/0;function Bo(){return pi==null&&(pi=K.OffscreenCanvas&&new K.OffscreenCanvas(1,1).getContext("2d")&&typeof K.createImageBitmap=="function"),pi}var qn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(qn);var Pa=function(e){function t(i,l,h){l===401&&Gr(h)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,i),this.status=l,this.url=h,this.name=this.constructor.name,this.message=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),no=pr()?function(){return self.worker&&self.worker.referrer}:function(){return(K.location.protocol==="blob:"?K.parent:K).location.href},qi,Hi,bo=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(no())&&!/^\w+:/.test(i))){if(K.fetch&&K.Request&&K.AbortController&&K.Request.prototype.hasOwnProperty("signal"))return function(l,h){var f,y=new K.AbortController,w=new K.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:no(),signal:y.signal}),I=!1,k=!1,P=(f=w.url).indexOf("sku=")>0&&Gr(f);l.type==="json"&&w.headers.set("Accept","application/json");var D=function(U,Q,ee){if(!k){if(U&&U.message!=="SecurityError"&&At(U),Q&&ee)return B(Q);var ue=Date.now();K.fetch(w).then(function(ne){if(ne.ok){var fe=P?ne.clone():null;return B(ne,fe,ue)}return h(new Pa(ne.statusText,ne.status,l.url))}).catch(function(ne){ne.code!==20&&h(new Error(ne.message))})}},B=function(U,Q,ee){(l.type==="arrayBuffer"?U.arrayBuffer():l.type==="json"?U.json():U.text()).then(function(ue){k||(Q&&ee&&function(ne,fe,_e){if(xo(),Pi){var be={status:fe.status,statusText:fe.statusText,headers:new K.Headers};fe.headers.forEach(function(Pe,Oe){return be.headers.set(Oe,Pe)});var Ee=Vr(fe.headers.get("Cache-Control")||"");Ee["no-store"]||(Ee["max-age"]&&be.headers.set("Expires",new Date(_e+1e3*Ee["max-age"]).toUTCString()),new Date(be.headers.get("Expires")).getTime()-_e<42e4||function(Pe,Oe){if(Ui===void 0)try{new Response(new ReadableStream),Ui=!0}catch{Ui=!1}Ui?Oe(Pe.body):Pe.blob().then(Oe)}(fe,function(Pe){var Oe=new K.Response(Pe,be);xo(),Pi&&Pi.then(function(We){return We.put(ji(ne.url),Oe)}).catch(function(We){return At(We.message)})}))}}(w,Q,ee),I=!0,h(null,ue,U.headers.get("Cache-Control"),U.headers.get("Expires")))}).catch(function(ue){k||h(new Error(ue.message))})};return P?function(U,Q){if(xo(),!Pi)return Q(null);var ee=ji(U.url);Pi.then(function(ue){ue.match(ee).then(function(ne){var fe=function(_e){if(!_e)return!1;var be=new Date(_e.headers.get("Expires")||0),Ee=Vr(_e.headers.get("Cache-Control")||"");return be>Date.now()&&!Ee["no-cache"]}(ne);ue.delete(ee),fe&&ue.put(ee,ne.clone()),Q(null,ne,fe)}).catch(Q)}).catch(Q)}(w,D):D(null,null),{cancel:function(){k=!0,I||y.abort()}}}(e,t);if(pr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(l,h){var f=new K.XMLHttpRequest;for(var y in f.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(f.responseType="arraybuffer"),l.headers)f.setRequestHeader(y,l.headers[y]);return l.type==="json"&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials=l.credentials==="include",f.onerror=function(){h(new Error(f.statusText))},f.onload=function(){if((f.status>=200&&f.status<300||f.status===0)&&f.response!==null){var w=f.response;if(l.type==="json")try{w=JSON.parse(f.response)}catch(I){return h(I)}h(null,w,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else h(new Pa(f.statusText,f.status,l.url))},f.send(l.body),{cancel:function(){return f.abort()}}}(e,t)},oo=function(e,t){return bo(Ke(e,{type:"arrayBuffer"}),t)},dr=function(e,t){return bo(Ke(e,{method:"POST"}),t)},M="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";qi=[],Hi=0;var R=function(e,t){if(Lr.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),Hi>=Bt.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return qi.push(i),i}Hi++;var l=!1,h=function(){if(!l)for(l=!0,Hi--;qi.length&&Hi<Bt.MAX_PARALLEL_IMAGE_REQUESTS;){var y=qi.shift();y.cancelled||(y.cancel=R(y.requestParameters,y.callback).cancel)}},f=oo(e,function(y,w,I,k){h(),y?t(y):w&&(Bo()?function(P,D){var B=new K.Blob([new Uint8Array(P)],{type:"image/png"});K.createImageBitmap(B).then(function(U){D(null,U)}).catch(function(U){D(new Error("Could not load image because of "+U.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(w,t):function(P,D,B,U){var Q=new K.Image,ee=K.URL;Q.onload=function(){D(null,Q),ee.revokeObjectURL(Q.src),Q.onload=null,K.requestAnimationFrame(function(){Q.src=M})},Q.onerror=function(){return D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var ue=new K.Blob([new Uint8Array(P)],{type:"image/png"});Q.cacheControl=B,Q.expires=U,Q.src=P.byteLength?ee.createObjectURL(ue):M}(w,t,I,k))});return{cancel:function(){f.cancel(),h()}}};function F(e,t,i){i[e]&&i[e].indexOf(t)!==-1||(i[e]=i[e]||[],i[e].push(t))}function G(e,t,i){if(i&&i[e]){var l=i[e].indexOf(t);l!==-1&&i[e].splice(l,1)}}var J=function(e,t){t===void 0&&(t={}),Ke(this,t),this.type=e},le=function(e){function t(i,l){l===void 0&&(l={}),e.call(this,"error",Ke({error:i},l))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(J),ce=function(){};ce.prototype.on=function(e,t){return this._listeners=this._listeners||{},F(e,t,this._listeners),this},ce.prototype.off=function(e,t){return G(e,t,this._listeners),G(e,t,this._oneTimeListeners),this},ce.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},F(e,t,this._oneTimeListeners),this},ce.prototype.fire=function(e,t){typeof e=="string"&&(e=new J(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;for(var l=0,h=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];l<h.length;l+=1)h[l].call(this,e);for(var f=0,y=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];f<y.length;f+=1){var w=y[f];G(i,w,this._oneTimeListeners),w.call(this,e)}var I=this._eventedParent;I&&(Ke(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),I.fire(e))}else e instanceof le&&console.error(e.error);return this},ce.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},ce.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var O={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},te=function(e,t,i,l){this.message=(e?e+": ":"")+i,l&&(this.identifier=l),t!=null&&t.__line__&&(this.line=t.__line__)};function me(e){var t=e.value;return t?[new te(e.key,t,"constants have been deprecated as of v8")]:[]}function Ce(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,h=t;l<h.length;l+=1){var f=h[l];for(var y in f)e[y]=f[y]}return e}function Be(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Se(e){if(Array.isArray(e))return e.map(Se);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=Se(e[i]);return t}return Be(e)}var Le=function(e){function t(i,l){e.call(this,l),this.message=l,this.key=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),st=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,l=t;i<l.length;i+=1){var h=l[i];this.bindings[h[0]]=h[1]}};st.prototype.concat=function(e){return new st(this,e)},st.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},st.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var Xe={kind:"null"},xe={kind:"number"},Je={kind:"string"},Ue={kind:"boolean"},Ve={kind:"color"},It={kind:"object"},Ye={kind:"value"},Ot={kind:"collator"},sr={kind:"formatted"},Ct={kind:"resolvedImage"};function Qt(e,t){return{kind:"array",itemType:e,N:t}}function Mt(e){if(e.kind==="array"){var t=Mt(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var ri=[Xe,xe,Je,Ue,Ve,sr,It,Qt(Ye),Ct];function Kt(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Kt(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var i=0,l=ri;i<l.length;i+=1)if(!Kt(l[i],t))return null}}return"Expected "+Mt(e)+" but found "+Mt(t)+" instead."}function mr(e,t){return t.some(function(i){return i.kind===e.kind})}function rr(e,t){return t.some(function(i){return i==="null"?e===null:i==="array"?Array.isArray(e):i==="object"?e&&!Array.isArray(e)&&typeof e=="object":i===typeof e})}var Lt=C(function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(w){return(w=Math.round(w))<0?0:w>255?255:w}function h(w){return l(w[w.length-1]==="%"?parseFloat(w)/100*255:parseInt(w))}function f(w){return(I=w[w.length-1]==="%"?parseFloat(w)/100:parseFloat(w))<0?0:I>1?1:I;var I}function y(w,I,k){return k<0?k+=1:k>1&&(k-=1),6*k<1?w+(I-w)*k*6:2*k<1?I:3*k<2?w+(I-w)*(2/3-k)*6:w}try{t.parseCSSColor=function(w){var I,k=w.replace(/ /g,"").toLowerCase();if(k in i)return i[k].slice();if(k[0]==="#")return k.length===4?(I=parseInt(k.substr(1),16))>=0&&I<=4095?[(3840&I)>>4|(3840&I)>>8,240&I|(240&I)>>4,15&I|(15&I)<<4,1]:null:k.length===7&&(I=parseInt(k.substr(1),16))>=0&&I<=16777215?[(16711680&I)>>16,(65280&I)>>8,255&I,1]:null;var P=k.indexOf("("),D=k.indexOf(")");if(P!==-1&&D+1===k.length){var B=k.substr(0,P),U=k.substr(P+1,D-(P+1)).split(","),Q=1;switch(B){case"rgba":if(U.length!==4)return null;Q=f(U.pop());case"rgb":return U.length!==3?null:[h(U[0]),h(U[1]),h(U[2]),Q];case"hsla":if(U.length!==4)return null;Q=f(U.pop());case"hsl":if(U.length!==3)return null;var ee=(parseFloat(U[0])%360+360)%360/360,ue=f(U[1]),ne=f(U[2]),fe=ne<=.5?ne*(ue+1):ne+ue-ne*ue,_e=2*ne-fe;return[l(255*y(_e,fe,ee+1/3)),l(255*y(_e,fe,ee)),l(255*y(_e,fe,ee-1/3)),Q];default:return null}}return null}}catch{}}).parseCSSColor,$t=function(e,t,i,l){l===void 0&&(l=1),this.r=e,this.g=t,this.b=i,this.a=l};$t.parse=function(e){if(e){if(e instanceof $t)return e;if(typeof e=="string"){var t=Lt(e);if(t)return new $t(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},$t.prototype.toString=function(){var e=this.toArray(),t=e[1],i=e[2],l=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(i)+","+l+")"},$t.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},$t.black=new $t(0,0,0,1),$t.white=new $t(1,1,1,1),$t.transparent=new $t(0,0,0,0),$t.red=new $t(1,0,0,1);var Yr=function(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Yr.prototype.compare=function(e,t){return this.collator.compare(e,t)},Yr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ao=function(e,t,i,l,h){this.text=e,this.image=t,this.scale=i,this.fontStack=l,this.textColor=h},Kr=function(e){this.sections=e};Kr.fromString=function(e){return new Kr([new ao(e,null,null,null,null)])},Kr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Kr.factory=function(e){return e instanceof Kr?e:Kr.fromString(e)},Kr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Kr.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];if(l.image)e.push(["image",l.image.name]);else{e.push(l.text);var h={};l.fontStack&&(h["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(h["font-scale"]=l.scale),l.textColor&&(h["text-color"]=["rgba"].concat(l.textColor.toArray())),e.push(h)}}return e};var wi=function(e){this.name=e.name,this.available=e.available};function so(e,t,i,l){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:"Invalid rgba value ["+[e,t,i,l].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof l=="number"?[e,t,i,l]:[e,t,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Qo(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof $t||e instanceof Yr||e instanceof Kr||e instanceof wi)return!0;if(Array.isArray(e)){for(var t=0,i=e;t<i.length;t+=1)if(!Qo(i[t]))return!1;return!0}if(typeof e=="object"){for(var l in e)if(!Qo(e[l]))return!1;return!0}return!1}function Pr(e){if(e===null)return Xe;if(typeof e=="string")return Je;if(typeof e=="boolean")return Ue;if(typeof e=="number")return xe;if(e instanceof $t)return Ve;if(e instanceof Yr)return Ot;if(e instanceof Kr)return sr;if(e instanceof wi)return Ct;if(Array.isArray(e)){for(var t,i=e.length,l=0,h=e;l<h.length;l+=1){var f=Pr(h[l]);if(t){if(t===f)continue;t=Ye;break}t=f}return Qt(t||Ye,i)}return It}function mn(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof $t||e instanceof Kr||e instanceof wi?e.toString():JSON.stringify(e)}wi.prototype.toString=function(){return this.name},wi.fromString=function(e){return e?new wi({name:e,available:!1}):null},wi.prototype.serialize=function(){return["image",this.name]};var qr=function(e,t){this.type=e,this.value=t};qr.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Qo(e[1]))return t.error("invalid value");var i=e[1],l=Pr(i),h=t.expectedType;return l.kind!=="array"||l.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(l=h),new qr(l,i)},qr.prototype.evaluate=function(){return this.value},qr.prototype.eachChild=function(){},qr.prototype.outputDefined=function(){return!0},qr.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof $t?["rgba"].concat(this.value.toArray()):this.value instanceof Kr?this.value.serialize():this.value};var Xr=function(e){this.name="ExpressionEvaluationError",this.message=e};Xr.prototype.toJSON=function(){return this.message};var fi={string:Je,number:xe,boolean:Ue,object:It},yr=function(e,t){this.type=e,this.args=t};yr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i,l=1,h=e[0];if(h==="array"){var f,y;if(e.length>2){var w=e[1];if(typeof w!="string"||!(w in fi)||w==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);f=fi[w],l++}else f=Ye;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);y=e[2],l++}i=Qt(f,y)}else i=fi[h];for(var I=[];l<e.length;l++){var k=t.parse(e[l],l,Ye);if(!k)return null;I.push(k)}return new yr(i,I)},yr.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!Kt(this.type,Pr(i)))return i;if(t===this.args.length-1)throw new Xr("Expected value to be of type "+Mt(this.type)+", but found "+Mt(Pr(i))+" instead.")}return null},yr.prototype.eachChild=function(e){this.args.forEach(e)},yr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},yr.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var l=e.N;(typeof l=="number"||this.args.length>1)&&t.push(l)}}return t.concat(this.args.map(function(h){return h.serialize()}))};var yn=function(e){this.type=sr,this.sections=e};yn.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var l=[],h=!1,f=1;f<=e.length-1;++f){var y=e[f];if(h&&typeof y=="object"&&!Array.isArray(y)){h=!1;var w=null;if(y["font-scale"]&&!(w=t.parse(y["font-scale"],1,xe)))return null;var I=null;if(y["text-font"]&&!(I=t.parse(y["text-font"],1,Qt(Je))))return null;var k=null;if(y["text-color"]&&!(k=t.parse(y["text-color"],1,Ve)))return null;var P=l[l.length-1];P.scale=w,P.font=I,P.textColor=k}else{var D=t.parse(e[f],1,Ye);if(!D)return null;var B=D.type.kind;if(B!=="string"&&B!=="value"&&B!=="null"&&B!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,l.push({content:D,scale:null,font:null,textColor:null})}}return new yn(l)},yn.prototype.evaluate=function(e){return new Kr(this.sections.map(function(t){var i=t.content.evaluate(e);return Pr(i)===Ct?new ao("",i,null,null,null):new ao(mn(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},yn.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}},yn.prototype.outputDefined=function(){return!1},yn.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e.push(l.content.serialize());var h={};l.scale&&(h["font-scale"]=l.scale.serialize()),l.font&&(h["text-font"]=l.font.serialize()),l.textColor&&(h["text-color"]=l.textColor.serialize()),e.push(h)}return e};var ln=function(e){this.type=Ct,this.input=e};ln.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,Je);return i?new ln(i):t.error("No image name provided.")},ln.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=wi.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i},ln.prototype.eachChild=function(e){e(this.input)},ln.prototype.outputDefined=function(){return!1},ln.prototype.serialize=function(){return["image",this.input.serialize()]};var Ha={"to-boolean":Ue,"to-color":Ve,"to-number":xe,"to-string":Je},Ft=function(e,t){this.type=e,this.args=t};Ft.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var l=Ha[i],h=[],f=1;f<e.length;f++){var y=t.parse(e[f],f,Ye);if(!y)return null;h.push(y)}return new Ft(l,h)},Ft.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,i,l=0,h=this.args;l<h.length;l+=1){if(i=null,(t=h[l].evaluate(e))instanceof $t)return t;if(typeof t=="string"){var f=e.parseColor(t);if(f)return f}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":so(t[0],t[1],t[2],t[3])))return new $t(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Xr(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var y=null,w=0,I=this.args;w<I.length;w+=1){if((y=I[w].evaluate(e))===null)return 0;var k=Number(y);if(!isNaN(k))return k}throw new Xr("Could not convert "+JSON.stringify(y)+" to number.")}return this.type.kind==="formatted"?Kr.fromString(mn(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?wi.fromString(mn(this.args[0].evaluate(e))):mn(this.args[0].evaluate(e))},Ft.prototype.eachChild=function(e){this.args.forEach(e)},Ft.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ft.prototype.serialize=function(){if(this.type.kind==="formatted")return new yn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new ln(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ji=["Unknown","Point","LineString","Polygon"],Rr=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Rr.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Rr.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Ji[this.feature.type]:this.feature.type:null},Rr.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Rr.prototype.canonicalID=function(){return this.canonical},Rr.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Rr.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=$t.parse(e)),t};var Nr=function(e,t,i,l){this.name=e,this.type=t,this._evaluate=i,this.args=l};Nr.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Nr.prototype.eachChild=function(e){this.args.forEach(e)},Nr.prototype.outputDefined=function(){return!1},Nr.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Nr.parse=function(e,t){var i,l=e[0],h=Nr.definitions[l];if(!h)return t.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0);for(var f=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,w=y.filter(function(bt){var at=bt[0];return!Array.isArray(at)||at.length===e.length-1}),I=null,k=0,P=w;k<P.length;k+=1){var D=P[k],B=D[0],U=D[1];I=new Br(t.registry,t.path,null,t.scope);for(var Q=[],ee=!1,ue=1;ue<e.length;ue++){var ne=e[ue],fe=Array.isArray(B)?B[ue-1]:B.type,_e=I.parse(ne,1+Q.length,fe);if(!_e){ee=!0;break}Q.push(_e)}if(!ee)if(Array.isArray(B)&&B.length!==Q.length)I.error("Expected "+B.length+" arguments, but found "+Q.length+" instead.");else{for(var be=0;be<Q.length;be++){var Ee=Array.isArray(B)?B[be]:B.type,Pe=Q[be];I.concat(be+1).checkSubtype(Ee,Pe.type)}if(I.errors.length===0)return new Nr(l,f,U,Q)}}if(w.length===1)(i=t.errors).push.apply(i,I.errors);else{for(var Oe=(w.length?w:y).map(function(bt){var at;return at=bt[0],Array.isArray(at)?"("+at.map(Mt).join(", ")+")":"("+Mt(at.type)+"...)"}).join(" | "),We=[],gt=1;gt<e.length;gt++){var it=t.parse(e[gt],1+We.length);if(!it)return null;We.push(Mt(it.type))}t.error("Expected arguments of type "+Oe+", but found ("+We.join(", ")+") instead.")}return null},Nr.register=function(e,t){for(var i in Nr.definitions=t,t)e[i]=Nr};var Zn=function(e,t,i){this.type=Ot,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};function Qr(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function sa(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function fs(e,t){var i=(180+e[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(i*h*8192),Math.round(l*h*8192)]}function Ca(e,t,i){return t[1]>e[1]!=i[1]>e[1]&&e[0]<(i[0]-t[0])*(e[1]-t[1])/(i[1]-t[1])+t[0]}function Oo(e,t){for(var i,l,h,f,y,w,I,k=!1,P=0,D=t.length;P<D;P++)for(var B=t[P],U=0,Q=B.length;U<Q-1;U++){if((f=(i=e)[0]-(l=B[U])[0])*(I=i[1]-(h=B[U+1])[1])-(w=i[0]-h[0])*(y=i[1]-l[1])==0&&f*w<=0&&y*I<=0)return!1;Ca(e,B[U],B[U+1])&&(k=!k)}return k}function el(e,t){for(var i=0;i<t.length;i++)if(Oo(e,t[i]))return!0;return!1}function Ja(e,t,i,l){var h=l[0]-i[0],f=l[1]-i[1],y=(e[0]-i[0])*f-h*(e[1]-i[1]),w=(t[0]-i[0])*f-h*(t[1]-i[1]);return y>0&&w<0||y<0&&w>0}function la(e,t,i){for(var l=0,h=i;l<h.length;l+=1)for(var f=h[l],y=0;y<f.length-1;++y)if((D=[(P=f[y+1])[0]-(k=f[y])[0],P[1]-k[1]])[0]*(B=[(I=t)[0]-(w=e)[0],I[1]-w[1]])[1]-D[1]*B[0]!=0&&Ja(w,I,k,P)&&Ja(k,P,w,I))return!0;var w,I,k,P,D,B;return!1}function wo(e,t){for(var i=0;i<e.length;++i)if(!Oo(e[i],t))return!1;for(var l=0;l<e.length-1;++l)if(la(e[l],e[l+1],t))return!1;return!0}function Ds(e,t){for(var i=0;i<t.length;i++)if(wo(e,t[i]))return!0;return!1}function gn(e,t,i){for(var l=[],h=0;h<e.length;h++){for(var f=[],y=0;y<e[h].length;y++){var w=fs(e[h][y],i);Qr(t,w),f.push(w)}l.push(f)}return l}function Mn(e,t,i){for(var l=[],h=0;h<e.length;h++){var f=gn(e[h],t,i);l.push(f)}return l}function Gn(e,t,i,l){if(e[0]<i[0]||e[0]>i[2]){var h=.5*l,f=e[0]-i[0]>h?-l:i[0]-e[0]>h?l:0;f===0&&(f=e[0]-i[2]>h?-l:i[2]-e[0]>h?l:0),e[0]+=f}Qr(t,e)}function Ls(e,t,i,l){for(var h=8192*Math.pow(2,l.z),f=[8192*l.x,8192*l.y],y=[],w=0,I=e;w<I.length;w+=1)for(var k=0,P=I[w];k<P.length;k+=1){var D=P[k],B=[D.x+f[0],D.y+f[1]];Gn(B,t,i,h),y.push(B)}return y}function lo(e,t,i,l){for(var h,f=8192*Math.pow(2,l.z),y=[8192*l.x,8192*l.y],w=[],I=0,k=e;I<k.length;I+=1){for(var P=[],D=0,B=k[I];D<B.length;D+=1){var U=B[D],Q=[U.x+y[0],U.y+y[1]];Qr(t,Q),P.push(Q)}w.push(P)}if(t[2]-t[0]<=f/2){(h=t)[0]=h[1]=1/0,h[2]=h[3]=-1/0;for(var ee=0,ue=w;ee<ue.length;ee+=1)for(var ne=0,fe=ue[ee];ne<fe.length;ne+=1)Gn(fe[ne],t,i,f)}return w}Zn.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var l=t.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Ue);if(!l)return null;var h=t.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Ue);if(!h)return null;var f=null;return i.locale&&!(f=t.parse(i.locale,1,Je))?null:new Zn(l,h,f)},Zn.prototype.evaluate=function(e){return new Yr(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Zn.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Zn.prototype.outputDefined=function(){return!1},Zn.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var uo=function(e,t){this.type=Ue,this.geojson=e,this.geometries=t};function Fo(e){if(e instanceof Nr&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof uo)return!1;var t=!0;return e.eachChild(function(i){t&&!Fo(i)&&(t=!1)}),t}function de(e){if(e instanceof Nr&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(i){t&&!de(i)&&(t=!1)}),t}function Si(e,t){if(e instanceof Nr&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild(function(l){i&&!Si(l,t)&&(i=!1)}),i}uo.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Qo(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var l=0;l<i.features.length;++l){var h=i.features[l].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new uo(i,i.features[l].geometry)}else if(i.type==="Feature"){var f=i.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new uo(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new uo(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},uo.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],f=t.canonicalID();if(i.type==="Polygon"){var y=gn(i.coordinates,h,f),w=Ls(t.geometry(),l,h,f);if(!sa(l,h))return!1;for(var I=0,k=w;I<k.length;I+=1)if(!Oo(k[I],y))return!1}if(i.type==="MultiPolygon"){var P=Mn(i.coordinates,h,f),D=Ls(t.geometry(),l,h,f);if(!sa(l,h))return!1;for(var B=0,U=D;B<U.length;B+=1)if(!el(U[B],P))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],f=t.canonicalID();if(i.type==="Polygon"){var y=gn(i.coordinates,h,f),w=lo(t.geometry(),l,h,f);if(!sa(l,h))return!1;for(var I=0,k=w;I<k.length;I+=1)if(!wo(k[I],y))return!1}if(i.type==="MultiPolygon"){var P=Mn(i.coordinates,h,f),D=lo(t.geometry(),l,h,f);if(!sa(l,h))return!1;for(var B=0,U=D;B<U.length;B+=1)if(!Ds(U[B],P))return!1}return!0}(e,this.geometries)}return!1},uo.prototype.eachChild=function(){},uo.prototype.outputDefined=function(){return!0},uo.prototype.serialize=function(){return["within",this.geojson]};var Ci=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Ci.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new Ci(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Ci.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Ci.prototype.eachChild=function(){},Ci.prototype.outputDefined=function(){return!1},Ci.prototype.serialize=function(){return["var",this.name]};var Br=function(e,t,i,l,h){t===void 0&&(t=[]),l===void 0&&(l=new st),h===void 0&&(h=[]),this.registry=e,this.path=t,this.key=t.map(function(f){return"["+f+"]"}).join(""),this.scope=l,this.errors=h,this.expectedType=i};function _n(e,t){for(var i,l=e.length-1,h=0,f=l,y=0;h<=f;)if((i=e[y=Math.floor((h+f)/2)])<=t){if(y===l||t<e[y+1])return y;h=y+1}else{if(!(i>t))throw new Xr("Input is not a number.");f=y-1}return 0}Br.prototype.parse=function(e,t,i,l,h){return h===void 0&&(h={}),t?this.concat(t,i,l)._parse(e,h):this._parse(e,h)},Br.prototype._parse=function(e,t){function i(k,P,D){return D==="assert"?new yr(P,[k]):D==="coerce"?new Ft(P,[k]):k}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var l=e[0];if(typeof l!="string")return this.error("Expression name must be a string, but found "+typeof l+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var h=this.registry[l];if(h){var f=h.parse(e,this);if(!f)return null;if(this.expectedType){var y=this.expectedType,w=f.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||w.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||w.kind!=="value"&&w.kind!=="string"){if(this.checkSubtype(y,w))return null}else f=i(f,y,t.typeAnnotation||"coerce");else f=i(f,y,t.typeAnnotation||"assert")}if(!(f instanceof qr)&&f.type.kind!=="resolvedImage"&&function k(P){if(P instanceof Ci)return k(P.boundExpression);if(P instanceof Nr&&P.name==="error"||P instanceof Zn||P instanceof uo)return!1;var D=P instanceof Ft||P instanceof yr,B=!0;return P.eachChild(function(U){B=D?B&&k(U):B&&U instanceof qr}),!!B&&Fo(P)&&Si(P,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(f)){var I=new Rr;try{f=new qr(f.type,f.evaluate(I))}catch(k){return this.error(k.message),null}}return f}return this.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Br.prototype.concat=function(e,t,i){var l=typeof e=="number"?this.path.concat(e):this.path,h=i?this.scope.concat(i):this.scope;return new Br(this.registry,l,t||null,h,this.errors)},Br.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var l=""+this.key+t.map(function(h){return"["+h+"]"}).join("");this.errors.push(new Le(l,e))},Br.prototype.checkSubtype=function(e,t){var i=Kt(e,t);return i&&this.error(i),i};var Mi=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var l=0,h=i;l<h.length;l+=1){var f=h[l],y=f[1];this.labels.push(f[0]),this.outputs.push(y)}};function ii(e,t,i){return e*(1-i)+t*i}Mi.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,xe);if(!i)return null;var l=[],h=null;t.expectedType&&t.expectedType.kind!=="value"&&(h=t.expectedType);for(var f=1;f<e.length;f+=2){var y=f===1?-1/0:e[f],w=e[f+1],I=f,k=f+1;if(typeof y!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(l.length&&l[l.length-1][0]>=y)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);var P=t.parse(w,k,h);if(!P)return null;h=h||P.type,l.push([y,P])}return new Mi(h,i,l)},Mi.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var h=t.length;return l>=t[h-1]?i[h-1].evaluate(e):i[_n(t,l)].evaluate(e)},Mi.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},Mi.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Mi.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Kn=Object.freeze({__proto__:null,number:ii,color:function(e,t,i){return new $t(ii(e.r,t.r,i),ii(e.g,t.g,i),ii(e.b,t.b,i),ii(e.a,t.a,i))},array:function(e,t,i){return e.map(function(l,h){return ii(l,t[h],i)})}}),So=6/29*3*(6/29),Ma=Math.PI/180,Jl=180/Math.PI;function Da(e){return e>.008856451679035631?Math.pow(e,1/3):e/So+4/29}function Yl(e){return e>6/29?e*e*e:So*(e-4/29)}function tl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function La(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ds(e){var t=La(e.r),i=La(e.g),l=La(e.b),h=Da((.4124564*t+.3575761*i+.1804375*l)/.95047),f=Da((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*f-16,a:500*(h-f),b:200*(f-Da((.0193339*t+.119192*i+.9503041*l)/1.08883)),alpha:e.a}}function Tl(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,l=isNaN(e.b)?t:t-e.b/200;return t=1*Yl(t),i=.95047*Yl(i),l=1.08883*Yl(l),new $t(tl(3.2404542*i-1.5371385*t-.4985314*l),tl(-.969266*i+1.8760108*t+.041556*l),tl(.0556434*i-.2040259*t+1.0572252*l),e.alpha)}function Ql(e,t,i){var l=t-e;return e+i*(l>180||l<-180?l-360*Math.round(l/360):l)}var Vo={forward:ds,reverse:Tl,interpolate:function(e,t,i){return{l:ii(e.l,t.l,i),a:ii(e.a,t.a,i),b:ii(e.b,t.b,i),alpha:ii(e.alpha,t.alpha,i)}}},ms={forward:function(e){var t=ds(e),i=t.l,l=t.a,h=t.b,f=Math.atan2(h,l)*Jl;return{h:f<0?f+360:f,c:Math.sqrt(l*l+h*h),l:i,alpha:e.a}},reverse:function(e){var t=e.h*Ma,i=e.c;return Tl({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:Ql(e.h,t.h,i),c:ii(e.c,t.c,i),l:ii(e.l,t.l,i),alpha:ii(e.alpha,t.alpha,i)}}},Ya=Object.freeze({__proto__:null,lab:Vo,hcl:ms}),ni=function(e,t,i,l,h){this.type=e,this.operator=t,this.interpolation=i,this.input=l,this.labels=[],this.outputs=[];for(var f=0,y=h;f<y.length;f+=1){var w=y[f],I=w[1];this.labels.push(w[0]),this.outputs.push(I)}};function rl(e,t,i,l){var h=l-i,f=e-i;return h===0?0:t===1?f/h:(Math.pow(t,f)-1)/(Math.pow(t,h)-1)}ni.interpolationFactor=function(e,t,i,l){var h=0;if(e.name==="exponential")h=rl(t,e.base,i,l);else if(e.name==="linear")h=rl(t,1,i,l);else if(e.name==="cubic-bezier"){var f=e.controlPoints;h=new A(f[0],f[1],f[2],f[3]).solve(rl(t,1,i,l))}return h},ni.parse=function(e,t){var i=e[0],l=e[1],h=e[2],f=e.slice(3);if(!Array.isArray(l)||l.length===0)return t.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){var y=l[1];if(typeof y!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:y}}else{if(l[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(l[0]),1,0);var w=l.slice(1);if(w.length!==4||w.some(function(ue){return typeof ue!="number"||ue<0||ue>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:w}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(h=t.parse(h,2,xe)))return null;var I=[],k=null;i==="interpolate-hcl"||i==="interpolate-lab"?k=Ve:t.expectedType&&t.expectedType.kind!=="value"&&(k=t.expectedType);for(var P=0;P<f.length;P+=2){var D=f[P],B=f[P+1],U=P+3,Q=P+4;if(typeof D!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(I.length&&I[I.length-1][0]>=D)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);var ee=t.parse(B,Q,k);if(!ee)return null;k=k||ee.type,I.push([D,ee])}return k.kind==="number"||k.kind==="color"||k.kind==="array"&&k.itemType.kind==="number"&&typeof k.N=="number"?new ni(k,i,l,h,I):t.error("Type "+Mt(k)+" is not interpolatable.")},ni.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var h=t.length;if(l>=t[h-1])return i[h-1].evaluate(e);var f=_n(t,l),y=ni.interpolationFactor(this.interpolation,l,t[f],t[f+1]),w=i[f].evaluate(e),I=i[f+1].evaluate(e);return this.operator==="interpolate"?Kn[this.type.kind.toLowerCase()](w,I,y):this.operator==="interpolate-hcl"?ms.reverse(ms.interpolate(ms.forward(w),ms.forward(I),y)):Vo.reverse(Vo.interpolate(Vo.forward(w),Vo.forward(I),y))},ni.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},ni.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},ni.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};var co=function(e,t){this.type=e,this.args=t};co.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,l=t.expectedType;l&&l.kind!=="value"&&(i=l);for(var h=[],f=0,y=e.slice(1);f<y.length;f+=1){var w=t.parse(y[f],1+h.length,i,void 0,{typeAnnotation:"omit"});if(!w)return null;i=i||w.type,h.push(w)}var I=l&&h.some(function(k){return Kt(l,k.type)});return new co(I?Ye:i,h)},co.prototype.evaluate=function(e){for(var t,i=null,l=0,h=0,f=this.args;h<f.length&&(l++,(i=f[h].evaluate(e))&&i instanceof wi&&!i.available&&(t||(t=i.name),i=null,l===this.args.length&&(i=t)),i===null);h+=1);return i},co.prototype.eachChild=function(e){this.args.forEach(e)},co.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},co.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var No=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};No.prototype.evaluate=function(e){return this.result.evaluate(e)},No.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1)e(i[t][1]);e(this.result)},No.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],l=1;l<e.length-1;l+=2){var h=e[l];if(typeof h!="string")return t.error("Expected string, but found "+typeof h+" instead.",l);if(/[^a-zA-Z0-9_]/.test(h))return t.error("Variable names must contain only alphanumeric characters or '_'.",l);var f=t.parse(e[l+1],l+1);if(!f)return null;i.push([h,f])}var y=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return y?new No(i,y):null},No.prototype.outputDefined=function(){return this.result.outputDefined()},No.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var l=i[t];e.push(l[0],l[1].serialize())}return e.push(this.result.serialize()),e};var ua=function(e,t,i){this.type=e,this.index=t,this.input=i};ua.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,xe),l=t.parse(e[2],2,Qt(t.expectedType||Ye));return i&&l?new ua(l.type.itemType,i,l):null},ua.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new Xr("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new Xr("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new Xr("Array index must be an integer, but found "+t+" instead.");return i[t]},ua.prototype.eachChild=function(e){e(this.index),e(this.input)},ua.prototype.outputDefined=function(){return!1},ua.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ra=function(e,t){this.type=Ue,this.needle=e,this.haystack=t};Ra.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,Ye),l=t.parse(e[2],2,Ye);return i&&l?mr(i.type,[Ue,Je,xe,Xe,Ye])?new Ra(i,l):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Mt(i.type)+" instead"):null},Ra.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!rr(t,["boolean","string","number","null"]))throw new Xr("Expected first argument to be of type boolean, string, number or null, but found "+Mt(Pr(t))+" instead.");if(!rr(i,["string","array"]))throw new Xr("Expected second argument to be of type array or string, but found "+Mt(Pr(i))+" instead.");return i.indexOf(t)>=0},Ra.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},Ra.prototype.outputDefined=function(){return!0},Ra.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var ca=function(e,t,i){this.type=xe,this.needle=e,this.haystack=t,this.fromIndex=i};ca.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,Ye),l=t.parse(e[2],2,Ye);if(!i||!l)return null;if(!mr(i.type,[Ue,Je,xe,Xe,Ye]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Mt(i.type)+" instead");if(e.length===4){var h=t.parse(e[3],3,xe);return h?new ca(i,l,h):null}return new ca(i,l)},ca.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!rr(t,["boolean","string","number","null"]))throw new Xr("Expected first argument to be of type boolean, string, number or null, but found "+Mt(Pr(t))+" instead.");if(!rr(i,["string","array"]))throw new Xr("Expected second argument to be of type array or string, but found "+Mt(Pr(i))+" instead.");if(this.fromIndex){var l=this.fromIndex.evaluate(e);return i.indexOf(t,l)}return i.indexOf(t)},ca.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},ca.prototype.outputDefined=function(){return!1},ca.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Dn=function(e,t,i,l,h,f){this.inputType=e,this.type=t,this.input=i,this.cases=l,this.outputs=h,this.otherwise=f};Dn.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var i,l;t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(var h={},f=[],y=2;y<e.length-1;y+=2){var w=e[y],I=e[y+1];Array.isArray(w)||(w=[w]);var k=t.concat(y);if(w.length===0)return k.error("Expected at least one branch label.");for(var P=0,D=w;P<D.length;P+=1){var B=D[P];if(typeof B!="number"&&typeof B!="string")return k.error("Branch labels must be numbers or strings.");if(typeof B=="number"&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return k.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof B=="number"&&Math.floor(B)!==B)return k.error("Numeric branch labels must be integer values.");if(i){if(k.checkSubtype(i,Pr(B)))return null}else i=Pr(B);if(h[String(B)]!==void 0)return k.error("Branch labels must be unique.");h[String(B)]=f.length}var U=t.parse(I,y,l);if(!U)return null;l=l||U.type,f.push(U)}var Q=t.parse(e[1],1,Ye);if(!Q)return null;var ee=t.parse(e[e.length-1],e.length-1,l);return ee?Q.type.kind!=="value"&&t.concat(1).checkSubtype(i,Q.type)?null:new Dn(i,l,Q,h,f,ee):null},Dn.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Pr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},Dn.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Dn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},Dn.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],l={},h=0,f=Object.keys(this.cases).sort();h<f.length;h+=1){var y=f[h];(D=l[this.cases[y]])===void 0?(l[this.cases[y]]=i.length,i.push([this.cases[y],[y]])):i[D][1].push(y)}for(var w=function(U){return e.inputType.kind==="number"?Number(U):U},I=0,k=i;I<k.length;I+=1){var P=k[I],D=P[0],B=P[1];t.push(B.length===1?w(B[0]):B.map(w)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var un=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};un.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var l=[],h=1;h<e.length-1;h+=2){var f=t.parse(e[h],h,Ue);if(!f)return null;var y=t.parse(e[h+1],h+1,i);if(!y)return null;l.push([f,y]),i=i||y.type}var w=t.parse(e[e.length-1],e.length-1,i);return w?new un(i,l,w):null},un.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],h=l[1];if(l[0].evaluate(e))return h.evaluate(e)}return this.otherwise.evaluate(e)},un.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],h=l[1];e(l[0]),e(h)}e(this.otherwise)},un.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},un.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ln=function(e,t,i,l){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=l};function Il(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Qa(e,t,i,l){return l.compare(t,i)===0}function Cr(e,t,i){var l=e!=="=="&&e!=="!=";return function(){function h(f,y,w){this.type=Ue,this.lhs=f,this.rhs=y,this.collator=w,this.hasUntypedArgument=f.type.kind==="value"||y.type.kind==="value"}return h.parse=function(f,y){if(f.length!==3&&f.length!==4)return y.error("Expected two or three arguments.");var w=f[0],I=y.parse(f[1],1,Ye);if(!I)return null;if(!Il(w,I.type))return y.concat(1).error('"'+w+`" comparisons are not supported for type '`+Mt(I.type)+"'.");var k=y.parse(f[2],2,Ye);if(!k)return null;if(!Il(w,k.type))return y.concat(2).error('"'+w+`" comparisons are not supported for type '`+Mt(k.type)+"'.");if(I.type.kind!==k.type.kind&&I.type.kind!=="value"&&k.type.kind!=="value")return y.error("Cannot compare types '"+Mt(I.type)+"' and '"+Mt(k.type)+"'.");l&&(I.type.kind==="value"&&k.type.kind!=="value"?I=new yr(k.type,[I]):I.type.kind!=="value"&&k.type.kind==="value"&&(k=new yr(I.type,[k])));var P=null;if(f.length===4){if(I.type.kind!=="string"&&k.type.kind!=="string"&&I.type.kind!=="value"&&k.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(!(P=y.parse(f[3],3,Ot)))return null}return new h(I,k,P)},h.prototype.evaluate=function(f){var y=this.lhs.evaluate(f),w=this.rhs.evaluate(f);if(l&&this.hasUntypedArgument){var I=Pr(y),k=Pr(w);if(I.kind!==k.kind||I.kind!=="string"&&I.kind!=="number")throw new Xr('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+I.kind+", "+k.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){var P=Pr(y),D=Pr(w);if(P.kind!=="string"||D.kind!=="string")return t(f,y,w)}return this.collator?i(f,y,w,this.collator.evaluate(f)):t(f,y,w)},h.prototype.eachChild=function(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)},h.prototype.outputDefined=function(){return!0},h.prototype.serialize=function(){var f=[e];return this.eachChild(function(y){f.push(y.serialize())}),f},h}()}Ln.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,Ye),l=t.parse(e[2],2,xe);if(!i||!l)return null;if(!mr(i.type,[Qt(Ye),Je,Ye]))return t.error("Expected first argument to be of type array or string, but found "+Mt(i.type)+" instead");if(e.length===4){var h=t.parse(e[3],3,xe);return h?new Ln(i.type,i,l,h):null}return new Ln(i.type,i,l)},Ln.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!rr(t,["string","array"]))throw new Xr("Expected first argument to be of type array or string, but found "+Mt(Pr(t))+" instead.");if(this.endIndex){var l=this.endIndex.evaluate(e);return t.slice(i,l)}return t.slice(i)},Ln.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Ln.prototype.outputDefined=function(){return!1},Ln.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var $l=Cr("==",function(e,t,i){return t===i},Qa),ha=Cr("!=",function(e,t,i){return t!==i},function(e,t,i,l){return!Qa(0,t,i,l)}),ys=Cr("<",function(e,t,i){return t<i},function(e,t,i,l){return l.compare(t,i)<0}),kl=Cr(">",function(e,t,i){return t>i},function(e,t,i,l){return l.compare(t,i)>0}),zl=Cr("<=",function(e,t,i){return t<=i},function(e,t,i,l){return l.compare(t,i)<=0}),Ba=Cr(">=",function(e,t,i){return t>=i},function(e,t,i,l){return l.compare(t,i)>=0}),Oa=function(e,t,i,l,h){this.type=Je,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=l,this.maxFractionDigits=h};Oa.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,xe);if(!i)return null;var l=e[2];if(typeof l!="object"||Array.isArray(l))return t.error("NumberFormat options argument must be an object.");var h=null;if(l.locale&&!(h=t.parse(l.locale,1,Je)))return null;var f=null;if(l.currency&&!(f=t.parse(l.currency,1,Je)))return null;var y=null;if(l["min-fraction-digits"]&&!(y=t.parse(l["min-fraction-digits"],1,xe)))return null;var w=null;return l["max-fraction-digits"]&&!(w=t.parse(l["max-fraction-digits"],1,xe))?null:new Oa(i,h,f,y,w)},Oa.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Oa.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Oa.prototype.outputDefined=function(){return!1},Oa.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var vn=function(e){this.type=xe,this.input=e};vn.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Mt(i.type)+" instead."):new vn(i):null},vn.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new Xr("Expected value to be of type string or array, but found "+Mt(Pr(t))+" instead.")},vn.prototype.eachChild=function(e){e(this.input)},vn.prototype.outputDefined=function(){return!1},vn.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var cn={"==":$l,"!=":ha,">":kl,"<":ys,">=":Ba,"<=":zl,array:yr,at:ua,boolean:yr,case:un,coalesce:co,collator:Zn,format:yn,image:ln,in:Ra,"index-of":ca,interpolate:ni,"interpolate-hcl":ni,"interpolate-lab":ni,length:vn,let:No,literal:qr,match:Dn,number:yr,"number-format":Oa,object:yr,slice:Ln,step:Mi,string:yr,"to-boolean":Ft,"to-color":Ft,"to-number":Ft,"to-string":Ft,var:Ci,within:uo};function pa(e,t){var i=t[0],l=t[1],h=t[2],f=t[3];i=i.evaluate(e),l=l.evaluate(e),h=h.evaluate(e);var y=f?f.evaluate(e):1,w=so(i,l,h,y);if(w)throw new Xr(w);return new $t(i/255*y,l/255*y,h/255*y,y)}function Al(e,t){return e in t}function Fa(e,t){var i=t[e];return i===void 0?null:i}function gs(e){return{type:e}}function Pl(e){return{result:"success",value:e}}function Eo(e){return{result:"error",value:e}}function Uo(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Cl(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function _s(e){return!!e.expression&&e.expression.interpolated}function gr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function $o(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function eu(e){return e}function Xn(e,t,i){return e!==void 0?e:t!==void 0?t:i!==void 0?i:void 0}function To(e,t,i,l,h){return Xn(typeof i===h?l[i]:void 0,e.default,t.default)}function Va(e,t,i){if(gr(i)!=="number")return Xn(e.default,t.default);var l=e.stops.length;if(l===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[l-1][0])return e.stops[l-1][1];var h=_n(e.stops.map(function(f){return f[0]}),i);return e.stops[h][1]}function Ml(e,t,i){var l=e.base!==void 0?e.base:1;if(gr(i)!=="number")return Xn(e.default,t.default);var h=e.stops.length;if(h===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[h-1][0])return e.stops[h-1][1];var f=_n(e.stops.map(function(D){return D[0]}),i),y=function(D,B,U,Q){var ee=Q-U,ue=D-U;return ee===0?0:B===1?ue/ee:(Math.pow(B,ue)-1)/(Math.pow(B,ee)-1)}(i,l,e.stops[f][0],e.stops[f+1][0]),w=e.stops[f][1],I=e.stops[f+1][1],k=Kn[t.type]||eu;if(e.colorSpace&&e.colorSpace!=="rgb"){var P=Ya[e.colorSpace];k=function(D,B){return P.reverse(P.interpolate(P.forward(D),P.forward(B),y))}}return typeof w.evaluate=="function"?{evaluate:function(){for(var D=[],B=arguments.length;B--;)D[B]=arguments[B];var U=w.evaluate.apply(void 0,D),Q=I.evaluate.apply(void 0,D);if(U!==void 0&&Q!==void 0)return k(U,Q,y)}}:k(w,I,y)}function fa(e,t,i){return t.type==="color"?i=$t.parse(i):t.type==="formatted"?i=Kr.fromString(i.toString()):t.type==="resolvedImage"?i=wi.fromString(i.toString()):gr(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),Xn(i,e.default,t.default)}Nr.register(cn,{error:[{kind:"error"},[Je],function(e,t){throw new Xr(t[0].evaluate(e))}],typeof:[Je,[Ye],function(e,t){return Mt(Pr(t[0].evaluate(e)))}],"to-rgba":[Qt(xe,4),[Ve],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Ve,[xe,xe,xe],pa],rgba:[Ve,[xe,xe,xe,xe],pa],has:{type:Ue,overloads:[[[Je],function(e,t){return Al(t[0].evaluate(e),e.properties())}],[[Je,It],function(e,t){var i=t[1];return Al(t[0].evaluate(e),i.evaluate(e))}]]},get:{type:Ye,overloads:[[[Je],function(e,t){return Fa(t[0].evaluate(e),e.properties())}],[[Je,It],function(e,t){var i=t[1];return Fa(t[0].evaluate(e),i.evaluate(e))}]]},"feature-state":[Ye,[Je],function(e,t){return Fa(t[0].evaluate(e),e.featureState||{})}],properties:[It,[],function(e){return e.properties()}],"geometry-type":[Je,[],function(e){return e.geometryType()}],id:[Ye,[],function(e){return e.id()}],zoom:[xe,[],function(e){return e.globals.zoom}],"heatmap-density":[xe,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[xe,[],function(e){return e.globals.lineProgress||0}],accumulated:[Ye,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[xe,gs(xe),function(e,t){for(var i=0,l=0,h=t;l<h.length;l+=1)i+=h[l].evaluate(e);return i}],"*":[xe,gs(xe),function(e,t){for(var i=1,l=0,h=t;l<h.length;l+=1)i*=h[l].evaluate(e);return i}],"-":{type:xe,overloads:[[[xe,xe],function(e,t){var i=t[1];return t[0].evaluate(e)-i.evaluate(e)}],[[xe],function(e,t){return-t[0].evaluate(e)}]]},"/":[xe,[xe,xe],function(e,t){var i=t[1];return t[0].evaluate(e)/i.evaluate(e)}],"%":[xe,[xe,xe],function(e,t){var i=t[1];return t[0].evaluate(e)%i.evaluate(e)}],ln2:[xe,[],function(){return Math.LN2}],pi:[xe,[],function(){return Math.PI}],e:[xe,[],function(){return Math.E}],"^":[xe,[xe,xe],function(e,t){var i=t[1];return Math.pow(t[0].evaluate(e),i.evaluate(e))}],sqrt:[xe,[xe],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[xe,[xe],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[xe,[xe],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[xe,[xe],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[xe,[xe],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[xe,[xe],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[xe,[xe],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[xe,[xe],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[xe,[xe],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[xe,[xe],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[xe,gs(xe),function(e,t){return Math.min.apply(Math,t.map(function(i){return i.evaluate(e)}))}],max:[xe,gs(xe),function(e,t){return Math.max.apply(Math,t.map(function(i){return i.evaluate(e)}))}],abs:[xe,[xe],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[xe,[xe],function(e,t){var i=t[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[xe,[xe],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[xe,[xe],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Ue,[Je,Ye],function(e,t){var i=t[0],l=t[1];return e.properties()[i.value]===l.value}],"filter-id-==":[Ue,[Ye],function(e,t){var i=t[0];return e.id()===i.value}],"filter-type-==":[Ue,[Je],function(e,t){var i=t[0];return e.geometryType()===i.value}],"filter-<":[Ue,[Je,Ye],function(e,t){var i=t[0],l=t[1],h=e.properties()[i.value],f=l.value;return typeof h==typeof f&&h<f}],"filter-id-<":[Ue,[Ye],function(e,t){var i=t[0],l=e.id(),h=i.value;return typeof l==typeof h&&l<h}],"filter->":[Ue,[Je,Ye],function(e,t){var i=t[0],l=t[1],h=e.properties()[i.value],f=l.value;return typeof h==typeof f&&h>f}],"filter-id->":[Ue,[Ye],function(e,t){var i=t[0],l=e.id(),h=i.value;return typeof l==typeof h&&l>h}],"filter-<=":[Ue,[Je,Ye],function(e,t){var i=t[0],l=t[1],h=e.properties()[i.value],f=l.value;return typeof h==typeof f&&h<=f}],"filter-id-<=":[Ue,[Ye],function(e,t){var i=t[0],l=e.id(),h=i.value;return typeof l==typeof h&&l<=h}],"filter->=":[Ue,[Je,Ye],function(e,t){var i=t[0],l=t[1],h=e.properties()[i.value],f=l.value;return typeof h==typeof f&&h>=f}],"filter-id->=":[Ue,[Ye],function(e,t){var i=t[0],l=e.id(),h=i.value;return typeof l==typeof h&&l>=h}],"filter-has":[Ue,[Ye],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Ue,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Ue,[Qt(Je)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Ue,[Qt(Ye)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Ue,[Je,Qt(Ye)],function(e,t){var i=t[0];return t[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[Ue,[Je,Qt(Ye)],function(e,t){var i=t[0],l=t[1];return function(h,f,y,w){for(;y<=w;){var I=y+w>>1;if(f[I]===h)return!0;f[I]>h?w=I-1:y=I+1}return!1}(e.properties()[i.value],l.value,0,l.value.length-1)}],all:{type:Ue,overloads:[[[Ue,Ue],function(e,t){var i=t[1];return t[0].evaluate(e)&&i.evaluate(e)}],[gs(Ue),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(!l[i].evaluate(e))return!1;return!0}]]},any:{type:Ue,overloads:[[[Ue,Ue],function(e,t){var i=t[1];return t[0].evaluate(e)||i.evaluate(e)}],[gs(Ue),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(l[i].evaluate(e))return!0;return!1}]]},"!":[Ue,[Ue],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Ue,[Je],function(e,t){var i=e.globals&&e.globals.isSupportedScript;return!i||i(t[0].evaluate(e))}],upcase:[Je,[Je],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[Je,[Je],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[Je,gs(Ye),function(e,t){return t.map(function(i){return mn(i.evaluate(e))}).join("")}],"resolved-locale":[Je,[Ot],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Rs=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Rr,this._defaultValue=t?function(i){return i.type==="color"&&$o(i.default)?new $t(0,0,0,0):i.type==="color"?$t.parse(i.default)||null:i.default===void 0?null:i.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function vs(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in cn}function da(e,t){var i=new Br(cn,[],t?function(h){var f={color:Ve,string:Je,number:xe,enum:Je,boolean:Ue,formatted:sr,resolvedImage:Ct};return h.type==="array"?Qt(f[h.value]||Ye,h.length):f[h.type]}(t):void 0),l=i.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Pl(new Rs(l,t)):Eo(i.errors)}Rs.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,h,f){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=l,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=f,this.expression.evaluate(this._evaluator)},Rs.prototype.evaluate=function(e,t,i,l,h,f){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=l,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=f||null;try{var y=this.expression.evaluate(this._evaluator);if(y==null||typeof y=="number"&&y!=y)return this._defaultValue;if(this._enumValues&&!(y in this._enumValues))throw new Xr("Expected value to be one of "+Object.keys(this._enumValues).map(function(w){return JSON.stringify(w)}).join(", ")+", but found "+JSON.stringify(y)+" instead.");return y}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}};var ma=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!de(t.expression)};ma.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,h,f){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,h,f)},ma.prototype.evaluate=function(e,t,i,l,h,f){return this._styleExpression.evaluate(e,t,i,l,h,f)};var $a=function(e,t,i,l){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!de(t.expression),this.interpolationType=l};function Dl(e,t){if((e=da(e,t)).result==="error")return e;var i=e.value.expression,l=Fo(i);if(!l&&!Uo(t))return Eo([new Le("","data expressions not supported")]);var h=Si(i,["zoom"]);if(!h&&!Cl(t))return Eo([new Le("","zoom expressions not supported")]);var f=function y(w){var I=null;if(w instanceof No)I=y(w.result);else if(w instanceof co)for(var k=0,P=w.args;k<P.length&&!(I=y(P[k]));k+=1);else(w instanceof Mi||w instanceof ni)&&w.input instanceof Nr&&w.input.name==="zoom"&&(I=w);return I instanceof Le||w.eachChild(function(D){var B=y(D);B instanceof Le?I=B:!I&&B?I=new Le("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):I&&B&&I!==B&&(I=new Le("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),I}(i);return f||h?f instanceof Le?Eo([f]):f instanceof ni&&!_s(t)?Eo([new Le("",'"interpolate" expressions cannot be used with this property')]):Pl(f?new $a(l?"camera":"composite",e.value,f.labels,f instanceof ni?f.interpolation:void 0):new ma(l?"constant":"source",e.value)):Eo([new Le("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}$a.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,h,f){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,h,f)},$a.prototype.evaluate=function(e,t,i,l,h,f){return this._styleExpression.evaluate(e,t,i,l,h,f)},$a.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?ni.interpolationFactor(this.interpolationType,e,t,i):0};var Io=function(e,t){this._parameters=e,this._specification=t,Ce(this,function i(l,h){var f,y,w,I=h.type==="color",k=l.stops&&typeof l.stops[0][0]=="object",P=k||!(k||l.property!==void 0),D=l.type||(_s(h)?"exponential":"interval");if(I&&((l=Ce({},l)).stops&&(l.stops=l.stops.map(function(it){return[it[0],$t.parse(it[1])]})),l.default=$t.parse(l.default?l.default:h.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!Ya[l.colorSpace])throw new Error("Unknown color space: "+l.colorSpace);if(D==="exponential")f=Ml;else if(D==="interval")f=Va;else if(D==="categorical"){f=To,y=Object.create(null);for(var B=0,U=l.stops;B<U.length;B+=1){var Q=U[B];y[Q[0]]=Q[1]}w=typeof l.stops[0][0]}else{if(D!=="identity")throw new Error('Unknown function type "'+D+'"');f=fa}if(k){for(var ee={},ue=[],ne=0;ne<l.stops.length;ne++){var fe=l.stops[ne],_e=fe[0].zoom;ee[_e]===void 0&&(ee[_e]={zoom:_e,type:l.type,property:l.property,default:l.default,stops:[]},ue.push(_e)),ee[_e].stops.push([fe[0].value,fe[1]])}for(var be=[],Ee=0,Pe=ue;Ee<Pe.length;Ee+=1){var Oe=Pe[Ee];be.push([ee[Oe].zoom,i(ee[Oe],h)])}var We={name:"linear"};return{kind:"composite",interpolationType:We,interpolationFactor:ni.interpolationFactor.bind(void 0,We),zoomStops:be.map(function(it){return it[0]}),evaluate:function(it,bt){var at=it.zoom;return Ml({stops:be,base:l.base},h,at).evaluate(at,bt)}}}if(P){var gt=D==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:gt,interpolationFactor:ni.interpolationFactor.bind(void 0,gt),zoomStops:l.stops.map(function(it){return it[0]}),evaluate:function(it){return f(l,h,it.zoom,y,w)}}}return{kind:"source",evaluate:function(it,bt){var at=bt&&bt.properties?bt.properties[l.property]:void 0;return at===void 0?Xn(l.default,h.default):f(l,h,at,y,w)}}}(this._parameters,this._specification))};function ko(e){var t=e.key,i=e.value,l=e.valueSpec||{},h=e.objectElementValidators||{},f=e.style,y=e.styleSpec,w=[],I=gr(i);if(I!=="object")return[new te(t,i,"object expected, "+I+" found")];for(var k in i){var P=k.split(".")[0],D=l[P]||l["*"],B=void 0;if(h[P])B=h[P];else if(l[P])B=Ut;else if(h["*"])B=h["*"];else{if(!l["*"]){w.push(new te(t,i[k],'unknown property "'+k+'"'));continue}B=Ut}w=w.concat(B({key:(t&&t+".")+k,value:i[k],valueSpec:D,style:f,styleSpec:y,object:i,objectKey:k},i))}for(var U in l)h[U]||l[U].required&&l[U].default===void 0&&i[U]===void 0&&w.push(new te(t,i,'missing required property "'+U+'"'));return w}function es(e){var t=e.value,i=e.valueSpec,l=e.style,h=e.styleSpec,f=e.key,y=e.arrayElementValidator||Ut;if(gr(t)!=="array")return[new te(f,t,"array expected, "+gr(t)+" found")];if(i.length&&t.length!==i.length)return[new te(f,t,"array length "+i.length+" expected, length "+t.length+" found")];if(i["min-length"]&&t.length<i["min-length"])return[new te(f,t,"array length at least "+i["min-length"]+" expected, length "+t.length+" found")];var w={type:i.value,values:i.values};h.$version<7&&(w.function=i.function),gr(i.value)==="object"&&(w=i.value);for(var I=[],k=0;k<t.length;k++)I=I.concat(y({array:t,arrayIndex:k,value:t[k],valueSpec:w,style:l,styleSpec:h,key:f+"["+k+"]"}));return I}function ts(e){var t=e.key,i=e.value,l=e.valueSpec,h=gr(i);return h==="number"&&i!=i&&(h="NaN"),h!=="number"?[new te(t,i,"number expected, "+h+" found")]:"minimum"in l&&i<l.minimum?[new te(t,i,i+" is less than the minimum value "+l.minimum)]:"maximum"in l&&i>l.maximum?[new te(t,i,i+" is greater than the maximum value "+l.maximum)]:[]}function Ll(e){var t,i,l,h=e.valueSpec,f=Be(e.value.type),y={},w=f!=="categorical"&&e.value.property===void 0,I=!w,k=gr(e.value.stops)==="array"&&gr(e.value.stops[0])==="array"&&gr(e.value.stops[0][0])==="object",P=ko({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(U){if(f==="identity")return[new te(U.key,U.value,'identity function may not have a "stops" property')];var Q=[],ee=U.value;return Q=Q.concat(es({key:U.key,value:ee,valueSpec:U.valueSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:D})),gr(ee)==="array"&&ee.length===0&&Q.push(new te(U.key,ee,"array must have at least one stop")),Q},default:function(U){return Ut({key:U.key,value:U.value,valueSpec:h,style:U.style,styleSpec:U.styleSpec})}}});return f==="identity"&&w&&P.push(new te(e.key,e.value,'missing required property "property"')),f==="identity"||e.value.stops||P.push(new te(e.key,e.value,'missing required property "stops"')),f==="exponential"&&e.valueSpec.expression&&!_s(e.valueSpec)&&P.push(new te(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(I&&!Uo(e.valueSpec)?P.push(new te(e.key,e.value,"property functions not supported")):w&&!Cl(e.valueSpec)&&P.push(new te(e.key,e.value,"zoom functions not supported"))),f!=="categorical"&&!k||e.value.property!==void 0||P.push(new te(e.key,e.value,'"property" property is required')),P;function D(U){var Q=[],ee=U.value,ue=U.key;if(gr(ee)!=="array")return[new te(ue,ee,"array expected, "+gr(ee)+" found")];if(ee.length!==2)return[new te(ue,ee,"array length 2 expected, length "+ee.length+" found")];if(k){if(gr(ee[0])!=="object")return[new te(ue,ee,"object expected, "+gr(ee[0])+" found")];if(ee[0].zoom===void 0)return[new te(ue,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new te(ue,ee,"object stop key must have value")];if(l&&l>Be(ee[0].zoom))return[new te(ue,ee[0].zoom,"stop zoom values must appear in ascending order")];Be(ee[0].zoom)!==l&&(l=Be(ee[0].zoom),i=void 0,y={}),Q=Q.concat(ko({key:ue+"[0]",value:ee[0],valueSpec:{zoom:{}},style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:ts,value:B}}))}else Q=Q.concat(B({key:ue+"[0]",value:ee[0],valueSpec:{},style:U.style,styleSpec:U.styleSpec},ee));return vs(Se(ee[1]))?Q.concat([new te(ue+"[1]",ee[1],"expressions are not allowed in function stops.")]):Q.concat(Ut({key:ue+"[1]",value:ee[1],valueSpec:h,style:U.style,styleSpec:U.styleSpec}))}function B(U,Q){var ee=gr(U.value),ue=Be(U.value),ne=U.value!==null?U.value:Q;if(t){if(ee!==t)return[new te(U.key,ne,ee+" stop domain type must match previous stop domain type "+t)]}else t=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean")return[new te(U.key,ne,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&f!=="categorical"){var fe="number expected, "+ee+" found";return Uo(h)&&f===void 0&&(fe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new te(U.key,ne,fe)]}return f!=="categorical"||ee!=="number"||isFinite(ue)&&Math.floor(ue)===ue?f!=="categorical"&&ee==="number"&&i!==void 0&&ue<i?[new te(U.key,ne,"stop domain values must appear in ascending order")]:(i=ue,f==="categorical"&&ue in y?[new te(U.key,ne,"stop domain values must be unique")]:(y[ue]=!0,[])):[new te(U.key,ne,"integer expected, found "+ue)]}}function zo(e){var t=(e.expressionContext==="property"?Dl:da)(Se(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(l){return new te(""+e.key+l.key,e.value,l.message)});var i=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!i.outputDefined())return[new te(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!de(i))return[new te(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!de(i))return[new te(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!Si(i,["zoom","feature-state"]))return[new te(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Fo(i))return[new te(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Na(e){var t=e.key,i=e.value,l=e.valueSpec,h=[];return Array.isArray(l.values)?l.values.indexOf(Be(i))===-1&&h.push(new te(t,i,"expected one of ["+l.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(l.values).indexOf(Be(i))===-1&&h.push(new te(t,i,"expected one of ["+Object.keys(l.values).join(", ")+"], "+JSON.stringify(i)+" found")),h}function xs(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,i=e.slice(1);t<i.length;t+=1){var l=i[t];if(!xs(l)&&typeof l!="boolean")return!1}return!0;default:return!0}}Io.deserialize=function(e){return new Io(e._parameters,e._specification)},Io.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var il={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Bs(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};xs(e)||(e=Wn(e));var t=da(e,il);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,l,h){return t.value.evaluate(i,l,{},h)},needGeometry:function i(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(var h=1;h<l.length;h++)if(i(l[h]))return!0;return!1}(e)}}function ya(e,t){return e<t?-1:e>t?1:0}function Wn(e){if(!e)return!0;var t,i=e[0];return e.length<=1?i!=="any":i==="=="?ea(e[1],e[2],"=="):i==="!="?Bl(ea(e[1],e[2],"==")):i==="<"||i===">"||i==="<="||i===">="?ea(e[1],e[2],i):i==="any"?(t=e.slice(1),["any"].concat(t.map(Wn))):i==="all"?["all"].concat(e.slice(1).map(Wn)):i==="none"?["all"].concat(e.slice(1).map(Wn).map(Bl)):i==="in"?Rl(e[1],e.slice(2)):i==="!in"?Bl(Rl(e[1],e.slice(2))):i==="has"?rs(e[1]):i==="!has"?Bl(rs(e[1])):i!=="within"||e}function ea(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function Rl(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(i){return typeof i!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(ya)]]:["filter-in-small",e,["literal",t]]}}function rs(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Bl(e){return["!",e]}function nl(e){return xs(Se(e.value))?zo(Ce({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(i){var l=i.value,h=i.key;if(gr(l)!=="array")return[new te(h,l,"array expected, "+gr(l)+" found")];var f,y=i.styleSpec,w=[];if(l.length<1)return[new te(h,l,"filter array must have at least 1 element")];switch(w=w.concat(Na({key:h+"[0]",value:l[0],valueSpec:y.filter_operator,style:i.style,styleSpec:i.styleSpec})),Be(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Be(l[1])==="$type"&&w.push(new te(h,l,'"$type" cannot be use with operator "'+l[0]+'"'));case"==":case"!=":l.length!==3&&w.push(new te(h,l,'filter array for operator "'+l[0]+'" must have 3 elements'));case"in":case"!in":l.length>=2&&(f=gr(l[1]))!=="string"&&w.push(new te(h+"[1]",l[1],"string expected, "+f+" found"));for(var I=2;I<l.length;I++)f=gr(l[I]),Be(l[1])==="$type"?w=w.concat(Na({key:h+"["+I+"]",value:l[I],valueSpec:y.geometry_type,style:i.style,styleSpec:i.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&w.push(new te(h+"["+I+"]",l[I],"string, number, or boolean expected, "+f+" found"));break;case"any":case"all":case"none":for(var k=1;k<l.length;k++)w=w.concat(t({key:h+"["+k+"]",value:l[k],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":f=gr(l[1]),l.length!==2?w.push(new te(h,l,'filter array for "'+l[0]+'" operator must have 2 elements')):f!=="string"&&w.push(new te(h+"[1]",l[1],"string expected, "+f+" found"));break;case"within":f=gr(l[1]),l.length!==2?w.push(new te(h,l,'filter array for "'+l[0]+'" operator must have 2 elements')):f!=="object"&&w.push(new te(h+"[1]",l[1],"object expected, "+f+" found"))}return w}(e)}function Ua(e,t){var i=e.key,l=e.style,h=e.styleSpec,f=e.value,y=e.objectKey,w=h[t+"_"+e.layerType];if(!w)return[];var I=y.match(/^(.*)-transition$/);if(t==="paint"&&I&&w[I[1]]&&w[I[1]].transition)return Ut({key:i,value:f,valueSpec:h.transition,style:l,styleSpec:h});var k,P=e.valueSpec||w[y];if(!P)return[new te(i,f,'unknown property "'+y+'"')];if(gr(f)==="string"&&Uo(P)&&!P.tokens&&(k=/^{([^}]+)}$/.exec(f)))return[new te(i,f,'"'+y+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(k[1])+" }`.")];var D=[];return e.layerType==="symbol"&&(y==="text-field"&&l&&!l.glyphs&&D.push(new te(i,f,'use of "text-field" requires a style "glyphs" property')),y==="text-font"&&$o(Se(f))&&Be(f.type)==="identity"&&D.push(new te(i,f,'"text-font" does not support identity functions'))),D.concat(Ut({key:e.key,value:f,valueSpec:P,style:l,styleSpec:h,expressionContext:"property",propertyType:t,propertyKey:y}))}function is(e){return Ua(e,"paint")}function bs(e){return Ua(e,"layout")}function Ol(e){var t=[],i=e.value,l=e.key,h=e.style,f=e.styleSpec;i.type||i.ref||t.push(new te(l,i,'either "type" or "ref" is required'));var y,w=Be(i.type),I=Be(i.ref);if(i.id)for(var k=Be(i.id),P=0;P<e.arrayIndex;P++){var D=h.layers[P];Be(D.id)===k&&t.push(new te(l,i.id,'duplicate layer id "'+i.id+'", previously used at line '+D.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(Q){Q in i&&t.push(new te(l,i[Q],'"'+Q+'" is prohibited for ref layers'))}),h.layers.forEach(function(Q){Be(Q.id)===I&&(y=Q)}),y?y.ref?t.push(new te(l,i.ref,"ref cannot reference another ref layer")):w=Be(y.type):t.push(new te(l,i.ref,'ref layer "'+I+'" not found'));else if(w!=="background")if(i.source){var B=h.sources&&h.sources[i.source],U=B&&Be(B.type);B?U==="vector"&&w==="raster"?t.push(new te(l,i.source,'layer "'+i.id+'" requires a raster source')):U==="raster"&&w!=="raster"?t.push(new te(l,i.source,'layer "'+i.id+'" requires a vector source')):U!=="vector"||i["source-layer"]?U==="raster-dem"&&w!=="hillshade"?t.push(new te(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!i.paint||!i.paint["line-gradient"]||U==="geojson"&&B.lineMetrics||t.push(new te(l,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new te(l,i,'layer "'+i.id+'" must specify a "source-layer"')):t.push(new te(l,i.source,'source "'+i.source+'" not found'))}else t.push(new te(l,i,'missing required property "source"'));return t=t.concat(ko({key:l,value:i,valueSpec:f.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ut({key:l+".type",value:i.type,valueSpec:f.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:nl,layout:function(Q){return ko({layer:i,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{"*":function(ee){return bs(Ce({layerType:w},ee))}}})},paint:function(Q){return ko({layer:i,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{"*":function(ee){return is(Ce({layerType:w},ee))}}})}}}))}function ho(e){var t=e.value,i=e.key,l=gr(t);return l!=="string"?[new te(i,t,"string expected, "+l+" found")]:[]}var Sr={promoteId:function(e){var t=e.key,i=e.value;if(gr(i)==="string")return ho({key:t,value:i});var l=[];for(var h in i)l.push.apply(l,ho({key:t+"."+h,value:i[h]}));return l}};function Os(e){var t=e.value,i=e.key,l=e.styleSpec,h=e.style;if(!t.type)return[new te(i,t,'"type" is required')];var f,y=Be(t.type);switch(y){case"vector":case"raster":case"raster-dem":return ko({key:i,value:t,valueSpec:l["source_"+y.replace("-","_")],style:e.style,styleSpec:l,objectElementValidators:Sr});case"geojson":if(f=ko({key:i,value:t,valueSpec:l.source_geojson,style:h,styleSpec:l,objectElementValidators:Sr}),t.cluster)for(var w in t.clusterProperties){var I=t.clusterProperties[w],k=I[0],P=typeof k=="string"?[k,["accumulated"],["get",w]]:k;f.push.apply(f,zo({key:i+"."+w+".map",value:I[1],expressionContext:"cluster-map"})),f.push.apply(f,zo({key:i+"."+w+".reduce",value:P,expressionContext:"cluster-reduce"}))}return f;case"video":return ko({key:i,value:t,valueSpec:l.source_video,style:h,styleSpec:l});case"image":return ko({key:i,value:t,valueSpec:l.source_image,style:h,styleSpec:l});case"canvas":return[new te(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Na({key:i+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,styleSpec:l})}}function Rn(e){var t=e.value,i=e.styleSpec,l=i.light,h=e.style,f=[],y=gr(t);if(t===void 0)return f;if(y!=="object")return f.concat([new te("light",t,"object expected, "+y+" found")]);for(var w in t){var I=w.match(/^(.*)-transition$/);f=f.concat(I&&l[I[1]]&&l[I[1]].transition?Ut({key:w,value:t[w],valueSpec:i.transition,style:h,styleSpec:i}):l[w]?Ut({key:w,value:t[w],valueSpec:l[w],style:h,styleSpec:i}):[new te(w,t[w],'unknown property "'+w+'"')])}return f}var Yi={"*":function(){return[]},array:es,boolean:function(e){var t=e.value,i=e.key,l=gr(t);return l!=="boolean"?[new te(i,t,"boolean expected, "+l+" found")]:[]},number:ts,color:function(e){var t=e.key,i=e.value,l=gr(i);return l!=="string"?[new te(t,i,"color expected, "+l+" found")]:Lt(i)===null?[new te(t,i,'color expected, "'+i+'" found')]:[]},constants:me,enum:Na,filter:nl,function:Ll,layer:Ol,object:ko,source:Os,light:Rn,string:ho,formatted:function(e){return ho(e).length===0?[]:zo(e)},resolvedImage:function(e){return ho(e).length===0?[]:zo(e)}};function Ut(e){var t=e.value,i=e.valueSpec,l=e.styleSpec;return i.expression&&$o(Be(t))?Ll(e):i.expression&&vs(Se(t))?zo(e):i.type&&Yi[i.type]?Yi[i.type](e):ko(Ce({},e,{valueSpec:i.type?l[i.type]:i}))}function Mr(e){var t=e.value,i=e.key,l=ho(e);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new te(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new te(i,t,'"glyphs" url must include a "{range}" token'))),l}function Qi(e,t){t===void 0&&(t=O);var i=[];return i=i.concat(Ut({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Mr,"*":function(){return[]}}})),e.constants&&(i=i.concat(me({key:"constants",value:e.constants,style:e,styleSpec:t}))),ol(i)}function ol(e){return[].concat(e).sort(function(t,i){return t.line-i.line})}function ns(e){return function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return ol(e.apply(this,t))}}Qi.source=ns(Os),Qi.light=ns(Rn),Qi.layer=ns(Ol),Qi.filter=ns(nl),Qi.paintProperty=ns(is),Qi.layoutProperty=ns(bs);var ta=Qi,Fs=ta.light,tu=ta.paintProperty,ws=ta.layoutProperty;function jo(e,t){var i=!1;if(t&&t.length)for(var l=0,h=t;l<h.length;l+=1)e.fire(new le(new Error(h[l].message))),i=!0;return i}var ra=Or;function Or(e,t,i){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var h=new Int32Array(this.arrayBuffer);e=h[0],this.d=(t=h[1])+2*(i=h[2]);for(var f=0;f<this.d*this.d;f++){var y=h[3+f],w=h[3+f+1];l.push(y===w?null:h.subarray(y,w))}var I=h[3+l.length+1];this.keys=h.subarray(h[3+l.length],I),this.bboxes=h.subarray(I),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var k=0;k<this.d*this.d;k++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var P=i/t*e;this.min=-P,this.max=e+P}Or.prototype.insert=function(e,t,i,l,h){this._forEachCell(t,i,l,h,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(h)},Or.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Or.prototype._insertCell=function(e,t,i,l,h,f){this.cells[h].push(f)},Or.prototype.query=function(e,t,i,l,h){var f=this.min,y=this.max;if(e<=f&&t<=f&&y<=i&&y<=l&&!h)return Array.prototype.slice.call(this.keys);var w=[];return this._forEachCell(e,t,i,l,this._queryCell,w,{},h),w},Or.prototype._queryCell=function(e,t,i,l,h,f,y,w){var I=this.cells[h];if(I!==null)for(var k=this.keys,P=this.bboxes,D=0;D<I.length;D++){var B=I[D];if(y[B]===void 0){var U=4*B;(w?w(P[U+0],P[U+1],P[U+2],P[U+3]):e<=P[U+2]&&t<=P[U+3]&&i>=P[U+0]&&l>=P[U+1])?(y[B]=!0,f.push(k[B])):y[B]=!1}}},Or.prototype._forEachCell=function(e,t,i,l,h,f,y,w){for(var I=this._convertToCellCoord(e),k=this._convertToCellCoord(t),P=this._convertToCellCoord(i),D=this._convertToCellCoord(l),B=I;B<=P;B++)for(var U=k;U<=D;U++){var Q=this.d*U+B;if((!w||w(this._convertFromCellCoord(B),this._convertFromCellCoord(U),this._convertFromCellCoord(B+1),this._convertFromCellCoord(U+1)))&&h.call(this,e,t,i,l,Q,f,y,w))return}},Or.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Or.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Or.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var h=new Int32Array(t+i+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var f=t,y=0;y<e.length;y++){var w=e[y];h[3+y]=f,h.set(w,f),f+=w.length}return h[3+e.length]=f,h.set(this.keys,f),h[3+e.length+1]=f+=this.keys.length,h.set(this.bboxes,f),f+=this.bboxes.length,h.buffer};var Bn=K.ImageData,ga=K.ImageBitmap,oi={};function Qe(e,t,i){i===void 0&&(i={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),oi[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}for(var po in Qe("Object",Object),ra.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},ra.deserialize=function(e){return new ra(e.buffer)},Qe("Grid",ra),Qe("Color",$t),Qe("Error",Error),Qe("ResolvedImage",wi),Qe("StylePropertyFunction",Io),Qe("StyleExpression",Rs,{omit:["_evaluator"]}),Qe("ZoomDependentExpression",$a),Qe("ZoomConstantExpression",ma),Qe("CompoundExpression",Nr,{omit:["_evaluate"]}),cn)cn[po]._classRegistryKey||Qe("Expression_"+po,cn[po]);function Vs(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function qo(e){return ga&&e instanceof ga}function On(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Vs(e)||qo(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return t&&t.push(i.buffer),i}if(e instanceof Bn)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var l=[],h=0,f=e;h<f.length;h+=1)l.push(On(f[h],t));return l}if(typeof e=="object"){var y=e.constructor,w=y._classRegistryKey;if(!w)throw new Error("can't serialize object of unregistered class");var I=y.serialize?y.serialize(e,t):{};if(!y.serialize){for(var k in e)if(e.hasOwnProperty(k)&&!(oi[w].omit.indexOf(k)>=0)){var P=e[k];I[k]=oi[w].shallow.indexOf(k)>=0?P:On(P,t)}e instanceof Error&&(I.message=e.message)}if(I.$name)throw new Error("$name property is reserved for worker serialization logic.");return w!=="Object"&&(I.$name=w),I}throw new Error("can't serialize object of type "+typeof e)}function Fn(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Vs(e)||qo(e)||ArrayBuffer.isView(e)||e instanceof Bn)return e;if(Array.isArray(e))return e.map(Fn);if(typeof e=="object"){var t=e.$name||"Object",i=oi[t].klass;if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);for(var l=Object.create(i.prototype),h=0,f=Object.keys(e);h<f.length;h+=1){var y=f[h];if(y!=="$name"){var w=e[y];l[y]=oi[t].shallow.indexOf(y)>=0?w:Fn(w)}}return l}throw new Error("can't deserialize object of type "+typeof e)}var al=function(){this.first=!0};al.prototype.update=function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))};var je={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function _a(e){for(var t=0,i=e;t<i.length;t+=1)if(sl(i[t].charCodeAt(0)))return!0;return!1}function sl(e){return!(e!==746&&e!==747&&(e<4352||!(je["Bopomofo Extended"](e)||je.Bopomofo(e)||je["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||je["CJK Compatibility Ideographs"](e)||je["CJK Compatibility"](e)||je["CJK Radicals Supplement"](e)||je["CJK Strokes"](e)||!(!je["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||je["CJK Unified Ideographs Extension A"](e)||je["CJK Unified Ideographs"](e)||je["Enclosed CJK Letters and Months"](e)||je["Hangul Compatibility Jamo"](e)||je["Hangul Jamo Extended-A"](e)||je["Hangul Jamo Extended-B"](e)||je["Hangul Jamo"](e)||je["Hangul Syllables"](e)||je.Hiragana(e)||je["Ideographic Description Characters"](e)||je.Kanbun(e)||je["Kangxi Radicals"](e)||je["Katakana Phonetic Extensions"](e)||je.Katakana(e)&&e!==12540||!(!je["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!je["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||je["Unified Canadian Aboriginal Syllabics"](e)||je["Unified Canadian Aboriginal Syllabics Extended"](e)||je["Vertical Forms"](e)||je["Yijing Hexagram Symbols"](e)||je["Yi Syllables"](e)||je["Yi Radicals"](e))))}function Ei(e){return!(sl(e)||function(t){return!!(je["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||je["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||je["Letterlike Symbols"](t)||je["Number Forms"](t)||je["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||je["Control Pictures"](t)&&t!==9251||je["Optical Character Recognition"](t)||je["Enclosed Alphanumerics"](t)||je["Geometric Shapes"](t)||je["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||je["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||je["CJK Symbols and Punctuation"](t)||je.Katakana(t)||je["Private Use Area"](t)||je["CJK Compatibility Forms"](t)||je["Small Form Variants"](t)||je["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function fo(e){return e>=1424&&e<=2303||je["Arabic Presentation Forms-A"](e)||je["Arabic Presentation Forms-B"](e)}function Hn(e,t){return!(!t&&fo(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||je.Khmer(e))}function ll(e){for(var t=0,i=e;t<i.length;t+=1)if(fo(i[t].charCodeAt(0)))return!0;return!1}var Ss=null,ai="unavailable",si=null,xn=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(ai="error"),Ss&&Ss(e)};function ul(){Fl.fire(new J("pluginStateChange",{pluginStatus:ai,pluginURL:si}))}var Fl=new ce,Vl=function(){return ai},mo=function(){if(ai!=="deferred"||!si)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ai="loading",ul(),si&&oo({url:si},function(e){e?xn(e):(ai="loaded",ul())})},di={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return ai==="loaded"||di.applyArabicShaping!=null},isLoading:function(){return ai==="loading"},setState:function(e){ai=e.pluginStatus,si=e.pluginURL},isParsed:function(){return di.applyArabicShaping!=null&&di.processBidirectionalText!=null&&di.processStyledBidirectionalText!=null},getPluginURL:function(){return si}},Yt=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new al,this.transition={})};Yt.prototype.isSupportedScript=function(e){return function(t,i){for(var l=0,h=t;l<h.length;l+=1)if(!Hn(h[l].charCodeAt(0),i))return!1;return!0}(e,di.isLoaded())},Yt.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Yt.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}};var Ao=function(e,t){this.property=e,this.value=t,this.expression=function(i,l){if($o(i))return new Io(i,l);if(vs(i)){var h=Dl(i,l);if(h.result==="error")throw new Error(h.value.map(function(y){return y.key+": "+y.message}).join(", "));return h.value}var f=i;return typeof i=="string"&&l.type==="color"&&(f=$t.parse(i)),{kind:"constant",evaluate:function(){return f}}}(t===void 0?e.specification.default:t,e.specification)};Ao.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Ao.prototype.possiblyEvaluate=function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)};var Ti=function(e){this.property=e,this.value=new Ao(e,void 0)};Ti.prototype.transitioned=function(e,t){return new ut(this.property,this.value,t,Ke({},e.transition,this.transition),e.now)},Ti.prototype.untransitioned=function(){return new ut(this.property,this.value,null,{},0)};var ye=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};ye.prototype.getValue=function(e){return qe(this._values[e].value.value)},ye.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ti(this._values[e].property)),this._values[e].value=new Ao(this._values[e].property,t===null?void 0:qe(t))},ye.prototype.getTransition=function(e){return qe(this._values[e].transition)},ye.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ti(this._values[e].property)),this._values[e].transition=qe(t)||void 0},ye.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],h=this.getValue(l);h!==void 0&&(e[l]=h);var f=this.getTransition(l);f!==void 0&&(e[l+"-transition"]=f)}return e},ye.prototype.transitioned=function(e,t){for(var i=new bn(this._properties),l=0,h=Object.keys(this._values);l<h.length;l+=1){var f=h[l];i._values[f]=this._values[f].transitioned(e,t._values[f])}return i},ye.prototype.untransitioned=function(){for(var e=new bn(this._properties),t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t];e._values[l]=this._values[l].untransitioned()}return e};var ut=function(e,t,i,l,h){this.property=e,this.value=t,this.begin=h+l.delay||0,this.end=this.begin+l.duration||0,e.specification.transition&&(l.delay||l.duration)&&(this.prior=i)};ut.prototype.possiblyEvaluate=function(e,t,i){var l=e.now||0,h=this.value.possiblyEvaluate(e,t,i),f=this.prior;if(f){if(l>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(l<this.begin)return f.possiblyEvaluate(e,t,i);var y=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(f.possiblyEvaluate(e,t,i),h,function(w){if(w<=0)return 0;if(w>=1)return 1;var I=w*w,k=I*w;return 4*(w<.5?k:3*(w-I)+k-.75)}(y))}return h};var bn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};bn.prototype.possiblyEvaluate=function(e,t,i){for(var l=new ia(this._properties),h=0,f=Object.keys(this._values);h<f.length;h+=1){var y=f[h];l._values[y]=this._values[y].possiblyEvaluate(e,t,i)}return l},bn.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var Di=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};Di.prototype.getValue=function(e){return qe(this._values[e].value)},Di.prototype.setValue=function(e,t){this._values[e]=new Ao(this._values[e].property,t===null?void 0:qe(t))},Di.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],h=this.getValue(l);h!==void 0&&(e[l]=h)}return e},Di.prototype.possiblyEvaluate=function(e,t,i){for(var l=new ia(this._properties),h=0,f=Object.keys(this._values);h<f.length;h+=1){var y=f[h];l._values[y]=this._values[y].possiblyEvaluate(e,t,i)}return l};var Li=function(e,t,i){this.property=e,this.value=t,this.parameters=i};Li.prototype.isConstant=function(){return this.value.kind==="constant"},Li.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Li.prototype.evaluate=function(e,t,i,l){return this.property.evaluate(this.value,this.parameters,e,t,i,l)};var ia=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};ia.prototype.get=function(e){return this._values[e]};var ct=function(e){this.specification=e};ct.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},ct.prototype.interpolate=function(e,t,i){var l=Kn[this.specification.type];return l?l(e,t,i):e};var lt=function(e,t){this.specification=e,this.overrides=t};lt.prototype.possiblyEvaluate=function(e,t,i,l){return new Li(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},i,l)}:e.expression,t)},lt.prototype.interpolate=function(e,t,i){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new Li(this,{kind:"constant",value:void 0},e.parameters);var l=Kn[this.specification.type];return l?new Li(this,{kind:"constant",value:l(e.value.value,t.value.value,i)},e.parameters):e},lt.prototype.evaluate=function(e,t,i,l,h,f){return e.kind==="constant"?e.value:e.evaluate(t,i,l,h,f)};var va=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l,h,f){if(i.value===void 0)return new Li(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){var y=i.expression.evaluate(l,null,{},h,f),w=i.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,I=this._calculate(w,w,w,l);return new Li(this,{kind:"constant",value:I},l)}if(i.expression.kind==="camera"){var k=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new Li(this,{kind:"constant",value:k},l)}return new Li(this,i.expression,l)},t.prototype.evaluate=function(i,l,h,f,y,w){if(i.kind==="source"){var I=i.evaluate(l,h,f,y,w);return this._calculate(I,I,I,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},h,f),i.evaluate({zoom:Math.floor(l.zoom)},h,f),i.evaluate({zoom:Math.floor(l.zoom)+1},h,f),l):i.value},t.prototype._calculate=function(i,l,h,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:h,to:l}},t.prototype.interpolate=function(i){return i},t}(lt),Ii=function(e){this.specification=e};Ii.prototype.possiblyEvaluate=function(e,t,i,l){if(e.value!==void 0){if(e.expression.kind==="constant"){var h=e.expression.evaluate(t,null,{},i,l);return this._calculate(h,h,h,t)}return this._calculate(e.expression.evaluate(new Yt(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Yt(Math.floor(t.zoom),t)),e.expression.evaluate(new Yt(Math.floor(t.zoom+1),t)),t)}},Ii.prototype._calculate=function(e,t,i,l){return l.zoom>l.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}},Ii.prototype.interpolate=function(e){return e};var mi=function(e){this.specification=e};mi.prototype.possiblyEvaluate=function(e,t,i,l){return!!e.expression.evaluate(t,null,{},i,l)},mi.prototype.interpolate=function(){return!1};var li=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var i=e[t];i.specification.overridable&&this.overridableProperties.push(t);var l=this.defaultPropertyValues[t]=new Ao(i,void 0),h=this.defaultTransitionablePropertyValues[t]=new Ti(i);this.defaultTransitioningPropertyValues[t]=h.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=l.possiblyEvaluate({})}};Qe("DataDrivenProperty",lt),Qe("DataConstantProperty",ct),Qe("CrossFadedDataDrivenProperty",va),Qe("CrossFadedProperty",Ii),Qe("ColorRampProperty",mi);var Vn=function(e){function t(i,l){if(e.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new Di(l.layout)),l.paint)){for(var h in this._transitionablePaint=new ye(l.paint),i.paint)this.setPaintProperty(h,i.paint[h],{validate:!1});for(var f in i.layout)this.setLayoutProperty(f,i.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ia(l.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},t.prototype.setLayoutProperty=function(i,l,h){h===void 0&&(h={}),l!=null&&this._validate(ws,"layers."+this.id+".layout."+i,i,l,h)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)},t.prototype.getPaintProperty=function(i){return hr(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},t.prototype.setPaintProperty=function(i,l,h){if(h===void 0&&(h={}),l!=null&&this._validate(tu,"layers."+this.id+".paint."+i,i,l,h))return!1;if(hr(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),l||void 0),!1;var f=this._transitionablePaint._values[i],y=f.property.specification["property-type"]==="cross-faded-data-driven",w=f.value.isDataDriven(),I=f.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);var k=this._transitionablePaint._values[i].value;return k.isDataDriven()||w||y||this._handleOverridablePaintPropertyUpdate(i,I,k)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,h){return!1},t.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)},t.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),Jt(i,function(l,h){return!(l===void 0||h==="layout"&&!Object.keys(l).length||h==="paint"&&!Object.keys(l).length)})},t.prototype._validate=function(i,l,h,f,y){return y===void 0&&(y={}),(!y||y.validate!==!1)&&jo(this,i.call(ta,{key:l,layerType:this.type,objectKey:h,value:f,styleSpec:O,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var i in this.paint._values){var l=this.paint.get(i);if(l instanceof Li&&Uo(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1},t}(ce),os={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},cl=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},vr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Zi(e,t){t===void 0&&(t=1);var i=0,l=0;return{members:e.map(function(h){var f=os[h.type].BYTES_PER_ELEMENT,y=i=Es(i,Math.max(t,f)),w=h.components||1;return l=Math.max(l,f),i+=f*w,{name:h.name,type:h.type,components:w,offset:y}}),size:Es(i,Math.max(l,t)),alignment:t}}function Es(e,t){return Math.ceil(e/t)*t}vr.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},vr.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},vr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},vr.prototype.clear=function(){this.length=0},vr.prototype.resize=function(e){this.reserve(e),this.length=e},vr.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},vr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Zo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var h=this.length;return this.resize(h+1),this.emplace(h,i,l)},t.prototype.emplace=function(i,l,h){var f=2*i;return this.int16[f+0]=l,this.int16[f+1]=h,i},t}(vr);Zo.prototype.bytesPerElement=4,Qe("StructArrayLayout2i4",Zo);var Nl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f){var y=this.length;return this.resize(y+1),this.emplace(y,i,l,h,f)},t.prototype.emplace=function(i,l,h,f,y){var w=4*i;return this.int16[w+0]=l,this.int16[w+1]=h,this.int16[w+2]=f,this.int16[w+3]=y,i},t}(vr);Nl.prototype.bytesPerElement=8,Qe("StructArrayLayout4i8",Nl);var Jn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,h,f,y,w)},t.prototype.emplace=function(i,l,h,f,y,w,I){var k=6*i;return this.int16[k+0]=l,this.int16[k+1]=h,this.int16[k+2]=f,this.int16[k+3]=y,this.int16[k+4]=w,this.int16[k+5]=I,i},t}(vr);Jn.prototype.bytesPerElement=12,Qe("StructArrayLayout2i4i12",Jn);var Yn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,h,f,y,w)},t.prototype.emplace=function(i,l,h,f,y,w,I){var k=4*i,P=8*i;return this.int16[k+0]=l,this.int16[k+1]=h,this.uint8[P+4]=f,this.uint8[P+5]=y,this.uint8[P+6]=w,this.uint8[P+7]=I,i},t}(vr);Yn.prototype.bytesPerElement=8,Qe("StructArrayLayout2i4ub8",Yn);var as=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var h=this.length;return this.resize(h+1),this.emplace(h,i,l)},t.prototype.emplace=function(i,l,h){var f=2*i;return this.float32[f+0]=l,this.float32[f+1]=h,i},t}(vr);as.prototype.bytesPerElement=8,Qe("StructArrayLayout2f8",as);var xa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w,I,k,P,D){var B=this.length;return this.resize(B+1),this.emplace(B,i,l,h,f,y,w,I,k,P,D)},t.prototype.emplace=function(i,l,h,f,y,w,I,k,P,D,B){var U=10*i;return this.uint16[U+0]=l,this.uint16[U+1]=h,this.uint16[U+2]=f,this.uint16[U+3]=y,this.uint16[U+4]=w,this.uint16[U+5]=I,this.uint16[U+6]=k,this.uint16[U+7]=P,this.uint16[U+8]=D,this.uint16[U+9]=B,i},t}(vr);xa.prototype.bytesPerElement=20,Qe("StructArrayLayout10ui20",xa);var hl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w,I,k,P,D,B,U){var Q=this.length;return this.resize(Q+1),this.emplace(Q,i,l,h,f,y,w,I,k,P,D,B,U)},t.prototype.emplace=function(i,l,h,f,y,w,I,k,P,D,B,U,Q){var ee=12*i;return this.int16[ee+0]=l,this.int16[ee+1]=h,this.int16[ee+2]=f,this.int16[ee+3]=y,this.uint16[ee+4]=w,this.uint16[ee+5]=I,this.uint16[ee+6]=k,this.uint16[ee+7]=P,this.int16[ee+8]=D,this.int16[ee+9]=B,this.int16[ee+10]=U,this.int16[ee+11]=Q,i},t}(vr);hl.prototype.bytesPerElement=24,Qe("StructArrayLayout4i4ui4i24",hl);var Ts=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h){var f=this.length;return this.resize(f+1),this.emplace(f,i,l,h)},t.prototype.emplace=function(i,l,h,f){var y=3*i;return this.float32[y+0]=l,this.float32[y+1]=h,this.float32[y+2]=f,i},t}(vr);Ts.prototype.bytesPerElement=12,Qe("StructArrayLayout3f12",Ts);var Ns=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint32[1*i+0]=l,i},t}(vr);Ns.prototype.bytesPerElement=4,Qe("StructArrayLayout1ul4",Ns);var ja=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w,I,k,P){var D=this.length;return this.resize(D+1),this.emplace(D,i,l,h,f,y,w,I,k,P)},t.prototype.emplace=function(i,l,h,f,y,w,I,k,P,D){var B=10*i,U=5*i;return this.int16[B+0]=l,this.int16[B+1]=h,this.int16[B+2]=f,this.int16[B+3]=y,this.int16[B+4]=w,this.int16[B+5]=I,this.uint32[U+3]=k,this.uint16[B+8]=P,this.uint16[B+9]=D,i},t}(vr);ja.prototype.bytesPerElement=20,Qe("StructArrayLayout6i1ul2ui20",ja);var Is=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,h,f,y,w)},t.prototype.emplace=function(i,l,h,f,y,w,I){var k=6*i;return this.int16[k+0]=l,this.int16[k+1]=h,this.int16[k+2]=f,this.int16[k+3]=y,this.int16[k+4]=w,this.int16[k+5]=I,i},t}(vr);Is.prototype.bytesPerElement=12,Qe("StructArrayLayout2i2i2i12",Is);var qa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y){var w=this.length;return this.resize(w+1),this.emplace(w,i,l,h,f,y)},t.prototype.emplace=function(i,l,h,f,y,w){var I=4*i,k=8*i;return this.float32[I+0]=l,this.float32[I+1]=h,this.float32[I+2]=f,this.int16[k+6]=y,this.int16[k+7]=w,i},t}(vr);qa.prototype.bytesPerElement=16,Qe("StructArrayLayout2f1f2i16",qa);var ru=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f){var y=this.length;return this.resize(y+1),this.emplace(y,i,l,h,f)},t.prototype.emplace=function(i,l,h,f,y){var w=12*i,I=3*i;return this.uint8[w+0]=l,this.uint8[w+1]=h,this.float32[I+1]=f,this.float32[I+2]=y,i},t}(vr);ru.prototype.bytesPerElement=12,Qe("StructArrayLayout2ub2f12",ru);var Za=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h){var f=this.length;return this.resize(f+1),this.emplace(f,i,l,h)},t.prototype.emplace=function(i,l,h,f){var y=3*i;return this.uint16[y+0]=l,this.uint16[y+1]=h,this.uint16[y+2]=f,i},t}(vr);Za.prototype.bytesPerElement=6,Qe("StructArrayLayout3ui6",Za);var Ga=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w,I,k,P,D,B,U,Q,ee,ue,ne,fe){var _e=this.length;return this.resize(_e+1),this.emplace(_e,i,l,h,f,y,w,I,k,P,D,B,U,Q,ee,ue,ne,fe)},t.prototype.emplace=function(i,l,h,f,y,w,I,k,P,D,B,U,Q,ee,ue,ne,fe,_e){var be=24*i,Ee=12*i,Pe=48*i;return this.int16[be+0]=l,this.int16[be+1]=h,this.uint16[be+2]=f,this.uint16[be+3]=y,this.uint32[Ee+2]=w,this.uint32[Ee+3]=I,this.uint32[Ee+4]=k,this.uint16[be+10]=P,this.uint16[be+11]=D,this.uint16[be+12]=B,this.float32[Ee+7]=U,this.float32[Ee+8]=Q,this.uint8[Pe+36]=ee,this.uint8[Pe+37]=ue,this.uint8[Pe+38]=ne,this.uint32[Ee+10]=fe,this.int16[be+22]=_e,i},t}(vr);Ga.prototype.bytesPerElement=48,Qe("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ga);var pl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f,y,w,I,k,P,D,B,U,Q,ee,ue,ne,fe,_e,be,Ee,Pe,Oe,We,gt,it,bt,at,Wt){var zt=this.length;return this.resize(zt+1),this.emplace(zt,i,l,h,f,y,w,I,k,P,D,B,U,Q,ee,ue,ne,fe,_e,be,Ee,Pe,Oe,We,gt,it,bt,at,Wt)},t.prototype.emplace=function(i,l,h,f,y,w,I,k,P,D,B,U,Q,ee,ue,ne,fe,_e,be,Ee,Pe,Oe,We,gt,it,bt,at,Wt,zt){var ht=34*i,er=17*i;return this.int16[ht+0]=l,this.int16[ht+1]=h,this.int16[ht+2]=f,this.int16[ht+3]=y,this.int16[ht+4]=w,this.int16[ht+5]=I,this.int16[ht+6]=k,this.int16[ht+7]=P,this.uint16[ht+8]=D,this.uint16[ht+9]=B,this.uint16[ht+10]=U,this.uint16[ht+11]=Q,this.uint16[ht+12]=ee,this.uint16[ht+13]=ue,this.uint16[ht+14]=ne,this.uint16[ht+15]=fe,this.uint16[ht+16]=_e,this.uint16[ht+17]=be,this.uint16[ht+18]=Ee,this.uint16[ht+19]=Pe,this.uint16[ht+20]=Oe,this.uint16[ht+21]=We,this.uint16[ht+22]=gt,this.uint32[er+12]=it,this.float32[er+13]=bt,this.float32[er+14]=at,this.float32[er+15]=Wt,this.float32[er+16]=zt,i},t}(vr);pl.prototype.bytesPerElement=68,Qe("StructArrayLayout8i15ui1ul4f68",pl);var Qn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.float32[1*i+0]=l,i},t}(vr);Qn.prototype.bytesPerElement=4,Qe("StructArrayLayout1f4",Qn);var Nn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h){var f=this.length;return this.resize(f+1),this.emplace(f,i,l,h)},t.prototype.emplace=function(i,l,h,f){var y=3*i;return this.int16[y+0]=l,this.int16[y+1]=h,this.int16[y+2]=f,i},t}(vr);Nn.prototype.bytesPerElement=6,Qe("StructArrayLayout3i6",Nn);var fl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h){var f=this.length;return this.resize(f+1),this.emplace(f,i,l,h)},t.prototype.emplace=function(i,l,h,f){var y=4*i;return this.uint32[2*i+0]=l,this.uint16[y+2]=h,this.uint16[y+3]=f,i},t}(vr);fl.prototype.bytesPerElement=8,Qe("StructArrayLayout1ul2ui8",fl);var Us=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var h=this.length;return this.resize(h+1),this.emplace(h,i,l)},t.prototype.emplace=function(i,l,h){var f=2*i;return this.uint16[f+0]=l,this.uint16[f+1]=h,i},t}(vr);Us.prototype.bytesPerElement=4,Qe("StructArrayLayout2ui4",Us);var Ul=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint16[1*i+0]=l,i},t}(vr);Ul.prototype.bytesPerElement=2,Qe("StructArrayLayout1ui2",Ul);var ss=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,h,f){var y=this.length;return this.resize(y+1),this.emplace(y,i,l,h,f)},t.prototype.emplace=function(i,l,h,f,y){var w=4*i;return this.float32[w+0]=l,this.float32[w+1]=h,this.float32[w+2]=f,this.float32[w+3]=y,i},t}(vr);ss.prototype.bytesPerElement=16,Qe("StructArrayLayout4f16",ss);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new N(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,i),t}(cl);n.prototype.size=20;var a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new n(this,i)},t}(ja);Qe("CollisionBoxArray",a);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(l){this._structArray.uint8[this._pos1+37]=l},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(l){this._structArray.uint8[this._pos1+38]=l},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+10]=l},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,i),t}(cl);o.prototype.size=48;var u=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new o(this,i)},t}(Ga);Qe("PlacedSymbolArray",u);var d=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+12]=l},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,i),t}(cl);d.prototype.size=68;var _=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new d(this,i)},t}(pl);Qe("SymbolInstanceArray",_);var x=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(i){return this.float32[1*i+0]},t}(Qn);Qe("GlyphOffsetArray",x);var T=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(i){return this.int16[3*i+0]},t.prototype.gety=function(i){return this.int16[3*i+1]},t.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},t}(Nn);Qe("SymbolLineVertexArray",T);var z=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,i),t}(cl);z.prototype.size=8;var L=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new z(this,i)},t}(fl);Qe("FeatureIndexArray",L);var j=Zi([{name:"a_pos",components:2,type:"Int16"}],4).members,q=function(e){e===void 0&&(e=[]),this.segments=e};function Z(e,t){return 256*(e=ze(Math.floor(e),0,255))+ze(Math.floor(t),0,255)}q.prototype.prepareSegment=function(e,t,i,l){var h=this.segments[this.segments.length-1];return e>q.MAX_VERTEX_ARRAY_LENGTH&&At("Max vertices per segment is "+q.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!h||h.vertexLength+e>q.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==l)&&(h={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},l!==void 0&&(h.sortKey=l),this.segments.push(h)),h},q.prototype.get=function(){return this.segments},q.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var i=t[e];for(var l in i.vaos)i.vaos[l].destroy()}},q.simpleSegment=function(e,t,i,l){return new q([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:l,vaos:{},sortKey:0}])},q.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Qe("SegmentVector",q);var re=Zi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),$=C(function(e){e.exports=function(t,i){var l,h,f,y,w,I,k,P;for(h=t.length-(l=3&t.length),f=i,w=3432918353,I=461845907,P=0;P<h;)k=255&t.charCodeAt(P)|(255&t.charCodeAt(++P))<<8|(255&t.charCodeAt(++P))<<16|(255&t.charCodeAt(++P))<<24,++P,f=27492+(65535&(y=5*(65535&(f=(f^=k=(65535&(k=(k=(65535&k)*w+(((k>>>16)*w&65535)<<16)&4294967295)<<15|k>>>17))*I+(((k>>>16)*I&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(k=0,l){case 3:k^=(255&t.charCodeAt(P+2))<<16;case 2:k^=(255&t.charCodeAt(P+1))<<8;case 1:f^=k=(65535&(k=(k=(65535&(k^=255&t.charCodeAt(P)))*w+(((k>>>16)*w&65535)<<16)&4294967295)<<15|k>>>17))*I+(((k>>>16)*I&65535)<<16)&4294967295}return f^=t.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0}}),se=C(function(e){e.exports=function(t,i){for(var l,h=t.length,f=i^h,y=0;h>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(y)|(255&t.charCodeAt(++y))<<8|(255&t.charCodeAt(++y))<<16|(255&t.charCodeAt(++y))<<24))+((1540483477*(l>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),h-=4,++y;switch(h){case 3:f^=(255&t.charCodeAt(y+2))<<16;case 2:f^=(255&t.charCodeAt(y+1))<<8;case 1:f=1540483477*(65535&(f^=255&t.charCodeAt(y)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0}}),Y=$,oe=se;Y.murmur3=$,Y.murmur2=oe;var he=function(){this.ids=[],this.positions=[],this.indexed=!1};he.prototype.add=function(e,t,i,l){this.ids.push(Te(e)),this.positions.push(t,i,l)},he.prototype.getPositions=function(e){for(var t=Te(e),i=0,l=this.ids.length-1;i<l;){var h=i+l>>1;this.ids[h]>=t?l=h:i=h+1}for(var f=[];this.ids[i]===t;)f.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return f},he.serialize=function(e,t){var i=new Float64Array(e.ids),l=new Uint32Array(e.positions);return function h(f,y,w,I){for(;w<I;){for(var k=f[w+I>>1],P=w-1,D=I+1;;){do P++;while(f[P]<k);do D--;while(f[D]>k);if(P>=D)break;ve(f,P,D),ve(y,3*P,3*D),ve(y,3*P+1,3*D+1),ve(y,3*P+2,3*D+2)}D-w<I-D?(h(f,y,w,D),w=D+1):(h(f,y,D+1,I),I=D)}}(i,l,0,i.length-1),t&&t.push(i.buffer,l.buffer),{ids:i,positions:l}},he.deserialize=function(e){var t=new he;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var ge=Math.pow(2,53)-1;function Te(e){var t=+e;return!isNaN(t)&&t<=ge?t:Y(String(e))}function ve(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}Qe("FeaturePositionMap",he);var Ae=function(e,t){this.gl=e.gl,this.location=t},De=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},t}(Ae),Ne=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},t}(Ae),Fe=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},t}(Ae),nt=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},t}(Ae),yt=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},t}(Ae),vt=function(e){function t(i,l){e.call(this,i,l),this.current=$t.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},t}(Ae),_t=new Float32Array(16),or=function(e){function t(i,l){e.call(this,i,l),this.current=_t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},t}(Ae);function ot(e){return[Z(255*e.r,255*e.g),Z(255*e.b,255*e.a)]}var St=function(e,t,i){this.value=e,this.uniformNames=t.map(function(l){return"u_"+l}),this.type=i};St.prototype.setUniform=function(e,t,i){e.set(i.constantOr(this.value))},St.prototype.getBinding=function(e,t,i){return this.type==="color"?new vt(e,t):new Ne(e,t)};var Vt=function(e,t){this.uniformNames=t.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Vt.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Vt.prototype.setUniform=function(e,t,i,l){var h=l==="u_pattern_to"?this.patternTo:l==="u_pattern_from"?this.patternFrom:l==="u_pixel_ratio_to"?this.pixelRatioTo:l==="u_pixel_ratio_from"?this.pixelRatioFrom:null;h&&e.set(h)},Vt.prototype.getBinding=function(e,t,i){return i.substr(0,9)==="u_pattern"?new yt(e,t):new Ne(e,t)};var Tt=function(e,t,i,l){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(function(h){return{name:"a_"+h,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new l};Tt.prototype.populatePaintArray=function(e,t,i,l,h){var f=this.paintVertexArray.length,y=this.expression.evaluate(new Yt(0),t,{},l,[],h);this.paintVertexArray.resize(e),this._setPaintValue(f,e,y)},Tt.prototype.updatePaintArray=function(e,t,i,l){var h=this.expression.evaluate({zoom:0},i,l);this._setPaintValue(e,t,h)},Tt.prototype._setPaintValue=function(e,t,i){if(this.type==="color")for(var l=ot(i),h=e;h<t;h++)this.paintVertexArray.emplace(h,l[0],l[1]);else{for(var f=e;f<t;f++)this.paintVertexArray.emplace(f,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Tt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Tt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var kt=function(e,t,i,l,h,f){this.expression=e,this.uniformNames=t.map(function(y){return"u_"+y+"_t"}),this.type=i,this.useIntegerZoom=l,this.zoom=h,this.maxValue=0,this.paintVertexAttributes=t.map(function(y){return{name:"a_"+y,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new f};kt.prototype.populatePaintArray=function(e,t,i,l,h){var f=this.expression.evaluate(new Yt(this.zoom),t,{},l,[],h),y=this.expression.evaluate(new Yt(this.zoom+1),t,{},l,[],h),w=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(w,e,f,y)},kt.prototype.updatePaintArray=function(e,t,i,l){var h=this.expression.evaluate({zoom:this.zoom},i,l),f=this.expression.evaluate({zoom:this.zoom+1},i,l);this._setPaintValue(e,t,h,f)},kt.prototype._setPaintValue=function(e,t,i,l){if(this.type==="color")for(var h=ot(i),f=ot(l),y=e;y<t;y++)this.paintVertexArray.emplace(y,h[0],h[1],f[0],f[1]);else{for(var w=e;w<t;w++)this.paintVertexArray.emplace(w,i,l);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(l))}},kt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},kt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},kt.prototype.setUniform=function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,l=ze(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(l)},kt.prototype.getBinding=function(e,t,i){return new Ne(e,t)};var Rt=function(e,t,i,l,h,f){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=l,this.layerId=f,this.zoomInPaintVertexArray=new h,this.zoomOutPaintVertexArray=new h};Rt.prototype.populatePaintArray=function(e,t,i){var l=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(l,e,t.patterns&&t.patterns[this.layerId],i)},Rt.prototype.updatePaintArray=function(e,t,i,l,h){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],h)},Rt.prototype._setPaintValues=function(e,t,i,l){if(l&&i){var h=l[i.min],f=l[i.mid],y=l[i.max];if(h&&f&&y)for(var w=e;w<t;w++)this.zoomInPaintVertexArray.emplace(w,f.tl[0],f.tl[1],f.br[0],f.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1],f.pixelRatio,h.pixelRatio),this.zoomOutPaintVertexArray.emplace(w,f.tl[0],f.tl[1],f.br[0],f.br[1],y.tl[0],y.tl[1],y.br[0],y.br[1],f.pixelRatio,y.pixelRatio)}},Rt.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,re.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,re.members,this.expression.isStateDependent))},Rt.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Et=function(e,t,i){this.binders={},this._buffers=[];var l=[];for(var h in e.paint._values)if(i(h)){var f=e.paint.get(h);if(f instanceof Li&&Uo(f.property.specification)){var y=Ri(h,e.type),w=f.value,I=f.property.specification.type,k=f.property.useIntegerZoom,P=f.property.specification["property-type"],D=P==="cross-faded"||P==="cross-faded-data-driven";if(w.kind==="constant")this.binders[h]=D?new Vt(w.value,y):new St(w.value,y,I),l.push("/u_"+h);else if(w.kind==="source"||D){var B=Wr(h,I,"source");this.binders[h]=D?new Rt(w,I,k,t,B,e.id):new Tt(w,y,I,B),l.push("/a_"+h)}else{var U=Wr(h,I,"composite");this.binders[h]=new kt(w,y,I,k,t,U),l.push("/z_"+h)}}}this.cacheKey=l.sort().join("")};Et.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Tt||t instanceof kt?t.maxValue:0},Et.prototype.populatePaintArrays=function(e,t,i,l,h){for(var f in this.binders){var y=this.binders[f];(y instanceof Tt||y instanceof kt||y instanceof Rt)&&y.populatePaintArray(e,t,i,l,h)}},Et.prototype.setConstantPatternPositions=function(e,t){for(var i in this.binders){var l=this.binders[i];l instanceof Vt&&l.setConstantPatternPositions(e,t)}},Et.prototype.updatePaintArrays=function(e,t,i,l,h){var f=!1;for(var y in e)for(var w=0,I=t.getPositions(y);w<I.length;w+=1){var k=I[w],P=i.feature(k.index);for(var D in this.binders){var B=this.binders[D];if((B instanceof Tt||B instanceof kt||B instanceof Rt)&&B.expression.isStateDependent===!0){var U=l.paint.get(D);B.expression=U.value,B.updatePaintArray(k.start,k.end,P,e[y],h),f=!0}}}return f},Et.prototype.defines=function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof St||i instanceof Vt)&&e.push.apply(e,i.uniformNames.map(function(l){return"#define HAS_UNIFORM_"+l}))}return e},Et.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Tt||i instanceof kt)for(var l=0;l<i.paintVertexAttributes.length;l++)e.push(i.paintVertexAttributes[l].name);else if(i instanceof Rt)for(var h=0;h<re.members.length;h++)e.push(re.members[h].name)}return e},Et.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof St||i instanceof Vt||i instanceof kt)for(var l=0,h=i.uniformNames;l<h.length;l+=1)e.push(h[l])}return e},Et.prototype.getPaintVertexBuffers=function(){return this._buffers},Et.prototype.getUniforms=function(e,t){var i=[];for(var l in this.binders){var h=this.binders[l];if(h instanceof St||h instanceof Vt||h instanceof kt)for(var f=0,y=h.uniformNames;f<y.length;f+=1){var w=y[f];if(t[w]){var I=h.getBinding(e,t[w],w);i.push({name:w,property:l,binding:I})}}}return i},Et.prototype.setUniforms=function(e,t,i,l){for(var h=0,f=t;h<f.length;h+=1){var y=f[h],w=y.name,I=y.property;this.binders[I].setUniform(y.binding,l,i.get(I),w)}},Et.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof Rt){var l=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;l&&this._buffers.push(l)}else(i instanceof Tt||i instanceof kt)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},Et.prototype.upload=function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof Tt||i instanceof kt||i instanceof Rt)&&i.upload(e)}this.updatePaintBuffers()},Et.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Tt||t instanceof kt||t instanceof Rt)&&t.destroy()}};var xt=function(e,t,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var l=0,h=e;l<h.length;l+=1){var f=h[l];this.programConfigurations[f.id]=new Et(f,t,i)}this.needsUpload=!1,this._featureMap=new he,this._bufferOffset=0};function Ri(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Wr(e,t,i){var l={color:{source:as,composite:ss},number:{source:Qn,composite:as}},h=function(f){return{"line-pattern":{source:xa,composite:xa},"fill-pattern":{source:xa,composite:xa},"fill-extrusion-pattern":{source:xa,composite:xa}}[f]}(e);return h&&h[i]||l[t][i]}xt.prototype.populatePaintArrays=function(e,t,i,l,h,f){for(var y in this.programConfigurations)this.programConfigurations[y].populatePaintArrays(e,t,l,h,f);t.id!==void 0&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},xt.prototype.updatePaintArrays=function(e,t,i,l){for(var h=0,f=i;h<f.length;h+=1){var y=f[h];this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(e,this._featureMap,t,y,l)||this.needsUpload}},xt.prototype.get=function(e){return this.programConfigurations[e]},xt.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},xt.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},Qe("ConstantBinder",St),Qe("CrossFadedConstantBinder",Vt),Qe("SourceExpressionBinder",Tt),Qe("CrossFadedCompositeBinder",Rt),Qe("CompositeExpressionBinder",kt),Qe("ProgramConfiguration",Et,{omit:["_buffers"]}),Qe("ProgramConfigurationSet",xt);var wn=Math.pow(2,14)-1,Gi=-wn-1;function Hr(e){for(var t=8192/e.extent,i=e.loadGeometry(),l=0;l<i.length;l++)for(var h=i[l],f=0;f<h.length;f++){var y=h[f],w=Math.round(y.x*t),I=Math.round(y.y*t);y.x=ze(w,Gi,wn),y.y=ze(I,Gi,wn),(w<y.x||w>y.x+1||I<y.y||I>y.y+1)&&At("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function ui(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Hr(e):[]}}function $i(e,t,i,l,h){e.emplaceBack(2*t+(l+1)/2,2*i+(h+1)/2)}var Sn=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Zo,this.indexArray=new Za,this.segments=new q,this.programConfigurations=new xt(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function ba(e,t){for(var i=0;i<e.length;i++)if(Ko(t,e[i]))return!0;for(var l=0;l<t.length;l++)if(Ko(e,t[l]))return!0;return!!js(e,t)}function $n(e,t,i){return!!Ko(e,t)||!!wa(t,e,i)}function Go(e,t){if(e.length===1)return qs(t,e[0]);for(var i=0;i<t.length;i++)for(var l=t[i],h=0;h<l.length;h++)if(Ko(e,l[h]))return!0;for(var f=0;f<e.length;f++)if(qs(t,e[f]))return!0;for(var y=0;y<t.length;y++)if(js(e,t[y]))return!0;return!1}function Po(e,t,i){if(e.length>1){if(js(e,t))return!0;for(var l=0;l<t.length;l++)if(wa(t[l],e,i))return!0}for(var h=0;h<e.length;h++)if(wa(e[h],t,i))return!0;return!1}function js(e,t){if(e.length===0||t.length===0)return!1;for(var i=0;i<e.length-1;i++)for(var l=e[i],h=e[i+1],f=0;f<t.length-1;f++)if(ls(l,h,t[f],t[f+1]))return!0;return!1}function ls(e,t,i,l){return nr(e,i,l)!==nr(t,i,l)&&nr(e,t,i)!==nr(e,t,l)}function wa(e,t,i){var l=i*i;if(t.length===1)return e.distSqr(t[0])<l;for(var h=1;h<t.length;h++)if(na(e,t[h-1],t[h])<l)return!0;return!1}function na(e,t,i){var l=t.distSqr(i);if(l===0)return e.distSqr(t);var h=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/l;return e.distSqr(h<0?t:h>1?i:i.sub(t)._mult(h)._add(t))}function qs(e,t){for(var i,l,h,f=!1,y=0;y<e.length;y++)for(var w=0,I=(i=e[y]).length-1;w<i.length;I=w++)(l=i[w]).y>t.y!=(h=i[I]).y>t.y&&t.x<(h.x-l.x)*(t.y-l.y)/(h.y-l.y)+l.x&&(f=!f);return f}function Ko(e,t){for(var i=!1,l=0,h=e.length-1;l<e.length;h=l++){var f=e[l],y=e[h];f.y>t.y!=y.y>t.y&&t.x<(y.x-f.x)*(t.y-f.y)/(y.y-f.y)+f.x&&(i=!i)}return i}function dl(e,t,i){var l=i[0],h=i[2];if(e.x<l.x&&t.x<l.x||e.x>h.x&&t.x>h.x||e.y<l.y&&t.y<l.y||e.y>h.y&&t.y>h.y)return!1;var f=nr(e,t,i[0]);return f!==nr(e,t,i[1])||f!==nr(e,t,i[2])||f!==nr(e,t,i[3])}function oa(e,t,i){var l=t.paint.get(e).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Bi(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Sa(e,t,i,l,h){if(!t[0]&&!t[1])return e;var f=N.convert(t)._mult(h);i==="viewport"&&f._rotate(-l);for(var y=[],w=0;w<e.length;w++)y.push(e[w].sub(f));return y}Sn.prototype.populate=function(e,t,i){var l=this.layers[0],h=[],f=null;l.type==="circle"&&(f=l.layout.get("circle-sort-key"));for(var y=0,w=e;y<w.length;y+=1){var I=w[y],k=I.feature,P=I.id,D=I.index,B=I.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,Q=ui(k,U);if(this.layers[0]._featureFilter.filter(new Yt(this.zoom),Q,i)){var ee=f?f.evaluate(Q,{},i):void 0,ue={id:P,properties:k.properties,type:k.type,sourceLayerIndex:B,index:D,geometry:U?Q.geometry:Hr(k),patterns:{},sortKey:ee};h.push(ue)}}f&&h.sort(function(We,gt){return We.sortKey-gt.sortKey});for(var ne=0,fe=h;ne<fe.length;ne+=1){var _e=fe[ne],be=_e.geometry,Ee=_e.index,Pe=_e.sourceLayerIndex,Oe=e[Ee].feature;this.addFeature(_e,be,Ee,i),t.featureIndex.insert(Oe,be,Ee,Pe,this.index)}},Sn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Sn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Sn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Sn.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,j),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Sn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Sn.prototype.addFeature=function(e,t,i,l){for(var h=0,f=t;h<f.length;h+=1)for(var y=0,w=f[h];y<w.length;y+=1){var I=w[y],k=I.x,P=I.y;if(!(k<0||k>=8192||P<0||P>=8192)){var D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),B=D.vertexLength;$i(this.layoutVertexArray,k,P,-1,-1),$i(this.layoutVertexArray,k,P,1,-1),$i(this.layoutVertexArray,k,P,1,1),$i(this.layoutVertexArray,k,P,-1,1),this.indexArray.emplaceBack(B,B+1,B+2),this.indexArray.emplaceBack(B,B+3,B+2),D.vertexLength+=4,D.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},l)},Qe("CircleBucket",Sn,{omit:["layers"]});var Co=new li({"circle-sort-key":new lt(O.layout_circle["circle-sort-key"])}),us={paint:new li({"circle-radius":new lt(O.paint_circle["circle-radius"]),"circle-color":new lt(O.paint_circle["circle-color"]),"circle-blur":new lt(O.paint_circle["circle-blur"]),"circle-opacity":new lt(O.paint_circle["circle-opacity"]),"circle-translate":new ct(O.paint_circle["circle-translate"]),"circle-translate-anchor":new ct(O.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ct(O.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ct(O.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new lt(O.paint_circle["circle-stroke-width"]),"circle-stroke-color":new lt(O.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new lt(O.paint_circle["circle-stroke-opacity"])}),layout:Co},ur=typeof Float32Array<"u"?Float32Array:Array;function Mo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Un(e,t,i){var l=t[0],h=t[1],f=t[2],y=t[3],w=t[4],I=t[5],k=t[6],P=t[7],D=t[8],B=t[9],U=t[10],Q=t[11],ee=t[12],ue=t[13],ne=t[14],fe=t[15],_e=i[0],be=i[1],Ee=i[2],Pe=i[3];return e[0]=_e*l+be*w+Ee*D+Pe*ee,e[1]=_e*h+be*I+Ee*B+Pe*ue,e[2]=_e*f+be*k+Ee*U+Pe*ne,e[3]=_e*y+be*P+Ee*Q+Pe*fe,e[4]=(_e=i[4])*l+(be=i[5])*w+(Ee=i[6])*D+(Pe=i[7])*ee,e[5]=_e*h+be*I+Ee*B+Pe*ue,e[6]=_e*f+be*k+Ee*U+Pe*ne,e[7]=_e*y+be*P+Ee*Q+Pe*fe,e[8]=(_e=i[8])*l+(be=i[9])*w+(Ee=i[10])*D+(Pe=i[11])*ee,e[9]=_e*h+be*I+Ee*B+Pe*ue,e[10]=_e*f+be*k+Ee*U+Pe*ne,e[11]=_e*y+be*P+Ee*Q+Pe*fe,e[12]=(_e=i[12])*l+(be=i[13])*w+(Ee=i[14])*D+(Pe=i[15])*ee,e[13]=_e*h+be*I+Ee*B+Pe*ue,e[14]=_e*f+be*k+Ee*U+Pe*ne,e[15]=_e*y+be*P+Ee*Q+Pe*fe,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,i=arguments.length;i--;)t+=e[i]*e[i];return Math.sqrt(t)});var cs,Zs=Un;function ml(e,t,i){var l=t[0],h=t[1],f=t[2],y=t[3];return e[0]=i[0]*l+i[4]*h+i[8]*f+i[12]*y,e[1]=i[1]*l+i[5]*h+i[9]*f+i[13]*y,e[2]=i[2]*l+i[6]*h+i[10]*f+i[14]*y,e[3]=i[3]*l+i[7]*h+i[11]*f+i[15]*y,e}cs=new ur(3),ur!=Float32Array&&(cs[0]=0,cs[1]=0,cs[2]=0),function(){var e=new ur(4);ur!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var iu=(function(){var e=new ur(2);ur!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(i){e.call(this,i,us)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Sn(i)},t.prototype.queryRadius=function(i){var l=i;return oa("circle-radius",this,l)+oa("circle-stroke-width",this,l)+Bi(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(i,l,h,f,y,w,I,k){for(var P=Sa(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),w.angle,I),D=this.paint.get("circle-radius").evaluate(l,h)+this.paint.get("circle-stroke-width").evaluate(l,h),B=this.paint.get("circle-pitch-alignment")==="map",U=B?P:function(Oe,We){return Oe.map(function(gt){return yl(gt,We)})}(P,k),Q=B?D*I:D,ee=0,ue=f;ee<ue.length;ee+=1)for(var ne=0,fe=ue[ee];ne<fe.length;ne+=1){var _e=fe[ne],be=B?_e:yl(_e,k),Ee=Q,Pe=ml([],[_e.x,_e.y,0,1],k);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ee*=Pe[3]/w.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ee*=w.cameraToCenterDistance/Pe[3]),$n(U,be,Ee))return!0}return!1},t}(Vn));function yl(e,t){var i=ml([],[e.x,e.y,0,1],t);return new N(i[0]/i[3],i[1]/i[3])}var nu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Sn);function ks(e,t,i,l){var h=t.width,f=t.height;if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==h*f*i)throw new RangeError("mismatched image size")}else l=new Uint8Array(h*f*i);return e.width=h,e.height=f,e.data=l,e}function gl(e,t,i){var l=t.width,h=t.height;if(l!==e.width||h!==e.height){var f=ks({},{width:l,height:h},i);Kh(e,f,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,l),height:Math.min(e.height,h)},i),e.width=l,e.height=h,e.data=f.data}}function Kh(e,t,i,l,h,f){if(h.width===0||h.height===0)return t;if(h.width>e.width||h.height>e.height||i.x>e.width-h.width||i.y>e.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||l.x>t.width-h.width||l.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");for(var y=e.data,w=t.data,I=0;I<h.height;I++)for(var k=((i.y+I)*e.width+i.x)*f,P=((l.y+I)*t.width+l.x)*f,D=0;D<h.width*f;D++)w[P+D]=y[k+D];return t}Qe("HeatmapBucket",nu,{omit:["layers"]});var ou=function(e,t){ks(this,e,1,t)};ou.prototype.resize=function(e){gl(this,e,1)},ou.prototype.clone=function(){return new ou({width:this.width,height:this.height},new Uint8Array(this.data))},ou.copy=function(e,t,i,l,h){Kh(e,t,i,l,h,1)};var Xo=function(e,t){ks(this,e,4,t)};Xo.prototype.resize=function(e){gl(this,e,4)},Xo.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Xo.prototype.clone=function(){return new Xo({width:this.width,height:this.height},new Uint8Array(this.data))},Xo.copy=function(e,t,i,l,h){Kh(e,t,i,l,h,4)},Qe("AlphaImage",ou),Qe("RGBAImage",Xo);var $m={paint:new li({"heatmap-radius":new lt(O.paint_heatmap["heatmap-radius"]),"heatmap-weight":new lt(O.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ct(O.paint_heatmap["heatmap-intensity"]),"heatmap-color":new mi(O.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ct(O.paint_heatmap["heatmap-opacity"])})};function Wp(e){var t={},i=e.resolution||256,l=e.clips?e.clips.length:1,h=e.image||new Xo({width:i,height:l}),f=function(Q,ee,ue){t[e.evaluationKey]=ue;var ne=e.expression.evaluate(t);h.data[Q+ee+0]=Math.floor(255*ne.r/ne.a),h.data[Q+ee+1]=Math.floor(255*ne.g/ne.a),h.data[Q+ee+2]=Math.floor(255*ne.b/ne.a),h.data[Q+ee+3]=Math.floor(255*ne.a)};if(e.clips)for(var y=0,w=0;y<l;++y,w+=4*i)for(var I=0,k=0;I<i;I++,k+=4){var P=I/(i-1),D=e.clips[y];f(w,k,D.start*(1-P)+D.end*P)}else for(var B=0,U=0;B<i;B++,U+=4)f(0,U,B/(i-1));return h}var ey=function(e){function t(i){e.call(this,i,$m),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new nu(i)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Wp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Vn),ty={paint:new li({"hillshade-illumination-direction":new ct(O.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ct(O.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ct(O.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ct(O.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ct(O.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ct(O.paint_hillshade["hillshade-accent-color"])})},ry=function(e){function t(i){e.call(this,i,ty)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Vn),iy=Zi([{name:"a_pos",components:2,type:"Int16"}],4).members,Xh=jc,ny=jc;function jc(e,t,i){i=i||2;var l,h,f,y,w,I,k,P=t&&t.length,D=P?t[0]*i:e.length,B=Hp(e,0,D,i,!0),U=[];if(!B||B.next===B.prev)return U;if(P&&(B=function(ee,ue,ne,fe){var _e,be,Ee,Pe=[];for(_e=0,be=ue.length;_e<be;_e++)(Ee=Hp(ee,ue[_e]*fe,_e<be-1?ue[_e+1]*fe:ee.length,fe,!1))===Ee.next&&(Ee.steiner=!0),Pe.push(py(Ee));for(Pe.sort(uy),_e=0;_e<Pe.length;_e++)cy(Pe[_e],ne),ne=jl(ne,ne.next);return ne}(e,t,B,i)),e.length>80*i){l=f=e[0],h=y=e[1];for(var Q=i;Q<D;Q+=i)(w=e[Q])<l&&(l=w),(I=e[Q+1])<h&&(h=I),w>f&&(f=w),I>y&&(y=I);k=(k=Math.max(f-l,y-h))!==0?1/k:0}return Ju(B,U,i,l,h,k),U}function Hp(e,t,i,l,h){var f,y;if(h===Jh(e,t,i,l)>0)for(f=t;f<i;f+=l)y=Qp(f,e[f],e[f+1],y);else for(f=i-l;f>=t;f-=l)y=Qp(f,e[f],e[f+1],y);return y&&qc(y,y.next)&&(Qu(y),y=y.next),y}function jl(e,t){if(!e)return e;t||(t=e);var i,l=e;do if(i=!1,l.steiner||!qc(l,l.next)&&en(l.prev,l,l.next)!==0)l=l.next;else{if(Qu(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function Ju(e,t,i,l,h,f,y){if(e){!y&&f&&function(P,D,B,U){var Q=P;do Q.z===null&&(Q.z=Wh(Q.x,Q.y,D,B,U)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==P);Q.prevZ.nextZ=null,Q.prevZ=null,function(ee){var ue,ne,fe,_e,be,Ee,Pe,Oe,We=1;do{for(ne=ee,ee=null,be=null,Ee=0;ne;){for(Ee++,fe=ne,Pe=0,ue=0;ue<We&&(Pe++,fe=fe.nextZ);ue++);for(Oe=We;Pe>0||Oe>0&&fe;)Pe!==0&&(Oe===0||!fe||ne.z<=fe.z)?(_e=ne,ne=ne.nextZ,Pe--):(_e=fe,fe=fe.nextZ,Oe--),be?be.nextZ=_e:ee=_e,_e.prevZ=be,be=_e;ne=fe}be.nextZ=null,We*=2}while(Ee>1)}(Q)}(e,l,h,f);for(var w,I,k=e;e.prev!==e.next;)if(w=e.prev,I=e.next,f?ay(e,l,h,f):oy(e))t.push(w.i/i),t.push(e.i/i),t.push(I.i/i),Qu(e),e=I.next,k=I.next;else if((e=I)===k){y?y===1?Ju(e=sy(jl(e),t,i),t,i,l,h,f,2):y===2&&ly(e,t,i,l,h,f):Ju(jl(e),t,i,l,h,f,1);break}}}function oy(e){var t=e.prev,i=e,l=e.next;if(en(t,i,l)>=0)return!1;for(var h=e.next.next;h!==e.prev;){if(xu(t.x,t.y,i.x,i.y,l.x,l.y,h.x,h.y)&&en(h.prev,h,h.next)>=0)return!1;h=h.next}return!0}function ay(e,t,i,l){var h=e.prev,f=e,y=e.next;if(en(h,f,y)>=0)return!1;for(var w=h.x>f.x?h.x>y.x?h.x:y.x:f.x>y.x?f.x:y.x,I=h.y>f.y?h.y>y.y?h.y:y.y:f.y>y.y?f.y:y.y,k=Wh(h.x<f.x?h.x<y.x?h.x:y.x:f.x<y.x?f.x:y.x,h.y<f.y?h.y<y.y?h.y:y.y:f.y<y.y?f.y:y.y,t,i,l),P=Wh(w,I,t,i,l),D=e.prevZ,B=e.nextZ;D&&D.z>=k&&B&&B.z<=P;){if(D!==e.prev&&D!==e.next&&xu(h.x,h.y,f.x,f.y,y.x,y.y,D.x,D.y)&&en(D.prev,D,D.next)>=0||(D=D.prevZ,B!==e.prev&&B!==e.next&&xu(h.x,h.y,f.x,f.y,y.x,y.y,B.x,B.y)&&en(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;D&&D.z>=k;){if(D!==e.prev&&D!==e.next&&xu(h.x,h.y,f.x,f.y,y.x,y.y,D.x,D.y)&&en(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;B&&B.z<=P;){if(B!==e.prev&&B!==e.next&&xu(h.x,h.y,f.x,f.y,y.x,y.y,B.x,B.y)&&en(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function sy(e,t,i){var l=e;do{var h=l.prev,f=l.next.next;!qc(h,f)&&Jp(h,l,l.next,f)&&Yu(h,f)&&Yu(f,h)&&(t.push(h.i/i),t.push(l.i/i),t.push(f.i/i),Qu(l),Qu(l.next),l=e=f),l=l.next}while(l!==e);return jl(l)}function ly(e,t,i,l,h,f){var y=e;do{for(var w=y.next.next;w!==y.prev;){if(y.i!==w.i&&fy(y,w)){var I=Yp(y,w);return y=jl(y,y.next),I=jl(I,I.next),Ju(y,t,i,l,h,f),void Ju(I,t,i,l,h,f)}w=w.next}y=y.next}while(y!==e)}function uy(e,t){return e.x-t.x}function cy(e,t){if(t=function(l,h){var f,y=h,w=l.x,I=l.y,k=-1/0;do{if(I<=y.y&&I>=y.next.y&&y.next.y!==y.y){var P=y.x+(I-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(P<=w&&P>k){if(k=P,P===w){if(I===y.y)return y;if(I===y.next.y)return y.next}f=y.x<y.next.x?y:y.next}}y=y.next}while(y!==h);if(!f)return null;if(w===k)return f;var D,B=f,U=f.x,Q=f.y,ee=1/0;y=f;do w>=y.x&&y.x>=U&&w!==y.x&&xu(I<Q?w:k,I,U,Q,I<Q?k:w,I,y.x,y.y)&&(D=Math.abs(I-y.y)/(w-y.x),Yu(y,l)&&(D<ee||D===ee&&(y.x>f.x||y.x===f.x&&hy(f,y)))&&(f=y,ee=D)),y=y.next;while(y!==B);return f}(e,t)){var i=Yp(t,e);jl(t,t.next),jl(i,i.next)}}function hy(e,t){return en(e.prev,e,t.prev)<0&&en(t.next,e,e.next)<0}function Wh(e,t,i,l,h){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*h)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-l)*h)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function py(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function xu(e,t,i,l,h,f,y,w){return(h-y)*(t-w)-(e-y)*(f-w)>=0&&(e-y)*(l-w)-(i-y)*(t-w)>=0&&(i-y)*(f-w)-(h-y)*(l-w)>=0}function fy(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(i,l){var h=i;do{if(h.i!==i.i&&h.next.i!==i.i&&h.i!==l.i&&h.next.i!==l.i&&Jp(h,h.next,i,l))return!0;h=h.next}while(h!==i);return!1}(e,t)&&(Yu(e,t)&&Yu(t,e)&&function(i,l){var h=i,f=!1,y=(i.x+l.x)/2,w=(i.y+l.y)/2;do h.y>w!=h.next.y>w&&h.next.y!==h.y&&y<(h.next.x-h.x)*(w-h.y)/(h.next.y-h.y)+h.x&&(f=!f),h=h.next;while(h!==i);return f}(e,t)&&(en(e.prev,e,t.prev)||en(e,t.prev,t))||qc(e,t)&&en(e.prev,e,e.next)>0&&en(t.prev,t,t.next)>0)}function en(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function qc(e,t){return e.x===t.x&&e.y===t.y}function Jp(e,t,i,l){var h=Gc(en(e,t,i)),f=Gc(en(e,t,l)),y=Gc(en(i,l,e)),w=Gc(en(i,l,t));return h!==f&&y!==w||!(h!==0||!Zc(e,i,t))||!(f!==0||!Zc(e,l,t))||!(y!==0||!Zc(i,e,l))||!(w!==0||!Zc(i,t,l))}function Zc(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Gc(e){return e>0?1:e<0?-1:0}function Yu(e,t){return en(e.prev,e,e.next)<0?en(e,t,e.next)>=0&&en(e,e.prev,t)>=0:en(e,t,e.prev)<0||en(e,e.next,t)<0}function Yp(e,t){var i=new Hh(e.i,e.x,e.y),l=new Hh(t.i,t.x,t.y),h=e.next,f=t.prev;return e.next=t,t.prev=e,i.next=h,h.prev=i,l.next=i,i.prev=l,f.next=l,l.prev=f,l}function Qp(e,t,i,l){var h=new Hh(e,t,i);return l?(h.next=l.next,h.prev=l,l.next.prev=h,l.next=h):(h.prev=h,h.next=h),h}function Qu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Hh(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Jh(e,t,i,l){for(var h=0,f=t,y=i-l;f<i;f+=l)h+=(e[y]-e[f])*(e[f+1]+e[y+1]),y=f;return h}function dy(e,t,i,l,h){(function f(y,w,I,k,P){for(;k>I;){if(k-I>600){var D=k-I+1,B=w-I+1,U=Math.log(D),Q=.5*Math.exp(2*U/3),ee=.5*Math.sqrt(U*Q*(D-Q)/D)*(B-D/2<0?-1:1);f(y,w,Math.max(I,Math.floor(w-B*Q/D+ee)),Math.min(k,Math.floor(w+(D-B)*Q/D+ee)),P)}var ue=y[w],ne=I,fe=k;for($u(y,I,w),P(y[k],ue)>0&&$u(y,I,k);ne<fe;){for($u(y,ne,fe),ne++,fe--;P(y[ne],ue)<0;)ne++;for(;P(y[fe],ue)>0;)fe--}P(y[I],ue)===0?$u(y,I,fe):$u(y,++fe,k),fe<=w&&(I=fe+1),w<=fe&&(k=fe-1)}})(e,t,i||0,l||e.length-1,h||my)}function $u(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}function my(e,t){return e<t?-1:e>t?1:0}function Yh(e,t){var i=e.length;if(i<=1)return[e];for(var l,h,f=[],y=0;y<i;y++){var w=tt(e[y]);w!==0&&(e[y].area=Math.abs(w),h===void 0&&(h=w<0),h===w<0?(l&&f.push(l),l=[e[y]]):l.push(e[y]))}if(l&&f.push(l),t>1)for(var I=0;I<f.length;I++)f[I].length<=t||(dy(f[I],t,1,f[I].length-1,yy),f[I]=f[I].slice(0,t));return f}function yy(e,t){return t.area-e.area}function Qh(e,t,i){for(var l=i.patternDependencies,h=!1,f=0,y=t;f<y.length;f+=1){var w=y[f].paint.get(e+"-pattern");w.isConstant()||(h=!0);var I=w.constantOr(null);I&&(h=!0,l[I.to]=!0,l[I.from]=!0)}return h}function $h(e,t,i,l,h){for(var f=h.patternDependencies,y=0,w=t;y<w.length;y+=1){var I=w[y],k=I.paint.get(e+"-pattern").value;if(k.kind!=="constant"){var P=k.evaluate({zoom:l-1},i,{},h.availableImages),D=k.evaluate({zoom:l},i,{},h.availableImages),B=k.evaluate({zoom:l+1},i,{},h.availableImages);D=D&&D.name?D.name:D,B=B&&B.name?B.name:B,f[P=P&&P.name?P.name:P]=!0,f[D]=!0,f[B]=!0,i.patterns[I.id]={min:P,mid:D,max:B}}}return i}jc.deviation=function(e,t,i,l){var h=t&&t.length,f=Math.abs(Jh(e,0,h?t[0]*i:e.length,i));if(h)for(var y=0,w=t.length;y<w;y++)f-=Math.abs(Jh(e,t[y]*i,y<w-1?t[y+1]*i:e.length,i));var I=0;for(y=0;y<l.length;y+=3){var k=l[y]*i,P=l[y+1]*i,D=l[y+2]*i;I+=Math.abs((e[k]-e[D])*(e[P+1]-e[k+1])-(e[k]-e[P])*(e[D+1]-e[k+1]))}return f===0&&I===0?0:Math.abs((I-f)/f)},jc.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,h=0;h<e.length;h++){for(var f=0;f<e[h].length;f++)for(var y=0;y<t;y++)i.vertices.push(e[h][f][y]);h>0&&i.holes.push(l+=e[h-1].length)}return i},Xh.default=ny;var zs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Zo,this.indexArray=new Za,this.indexArray2=new Us,this.programConfigurations=new xt(e.layers,e.zoom),this.segments=new q,this.segments2=new q,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};zs.prototype.populate=function(e,t,i){this.hasPattern=Qh("fill",this.layers,t);for(var l=this.layers[0].layout.get("fill-sort-key"),h=[],f=0,y=e;f<y.length;f+=1){var w=y[f],I=w.feature,k=w.id,P=w.index,D=w.sourceLayerIndex,B=this.layers[0]._featureFilter.needGeometry,U=ui(I,B);if(this.layers[0]._featureFilter.filter(new Yt(this.zoom),U,i)){var Q=l?l.evaluate(U,{},i,t.availableImages):void 0,ee={id:k,properties:I.properties,type:I.type,sourceLayerIndex:D,index:P,geometry:B?U.geometry:Hr(I),patterns:{},sortKey:Q};h.push(ee)}}l&&h.sort(function(Oe,We){return Oe.sortKey-We.sortKey});for(var ue=0,ne=h;ue<ne.length;ue+=1){var fe=ne[ue],_e=fe.geometry,be=fe.index,Ee=fe.sourceLayerIndex;if(this.hasPattern){var Pe=$h("fill",this.layers,fe,this.zoom,t);this.patternFeatures.push(Pe)}else this.addFeature(fe,_e,be,i,{});t.featureIndex.insert(e[be].feature,_e,be,Ee,this.index)}},zs.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},zs.prototype.addFeatures=function(e,t,i){for(var l=0,h=this.patternFeatures;l<h.length;l+=1){var f=h[l];this.addFeature(f,f.geometry,f.index,t,i)}},zs.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},zs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},zs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,iy),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},zs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},zs.prototype.addFeature=function(e,t,i,l,h){for(var f=0,y=Yh(t,500);f<y.length;f+=1){for(var w=y[f],I=0,k=0,P=w;k<P.length;k+=1)I+=P[k].length;for(var D=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),B=D.vertexLength,U=[],Q=[],ee=0,ue=w;ee<ue.length;ee+=1){var ne=ue[ee];if(ne.length!==0){ne!==w[0]&&Q.push(U.length/2);var fe=this.segments2.prepareSegment(ne.length,this.layoutVertexArray,this.indexArray2),_e=fe.vertexLength;this.layoutVertexArray.emplaceBack(ne[0].x,ne[0].y),this.indexArray2.emplaceBack(_e+ne.length-1,_e),U.push(ne[0].x),U.push(ne[0].y);for(var be=1;be<ne.length;be++)this.layoutVertexArray.emplaceBack(ne[be].x,ne[be].y),this.indexArray2.emplaceBack(_e+be-1,_e+be),U.push(ne[be].x),U.push(ne[be].y);fe.vertexLength+=ne.length,fe.primitiveLength+=ne.length}}for(var Ee=Xh(U,Q),Pe=0;Pe<Ee.length;Pe+=3)this.indexArray.emplaceBack(B+Ee[Pe],B+Ee[Pe+1],B+Ee[Pe+2]);D.vertexLength+=I,D.primitiveLength+=Ee.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,h,l)},Qe("FillBucket",zs,{omit:["layers","patternFeatures"]});var gy=new li({"fill-sort-key":new lt(O.layout_fill["fill-sort-key"])}),_y={paint:new li({"fill-antialias":new ct(O.paint_fill["fill-antialias"]),"fill-opacity":new lt(O.paint_fill["fill-opacity"]),"fill-color":new lt(O.paint_fill["fill-color"]),"fill-outline-color":new lt(O.paint_fill["fill-outline-color"]),"fill-translate":new ct(O.paint_fill["fill-translate"]),"fill-translate-anchor":new ct(O.paint_fill["fill-translate-anchor"]),"fill-pattern":new va(O.paint_fill["fill-pattern"])}),layout:gy},vy=function(e){function t(i){e.call(this,i,_y)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l);var h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(i){return new zs(i)},t.prototype.queryRadius=function(){return Bi(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(i,l,h,f,y,w,I){return Go(Sa(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),w.angle,I),f)},t.prototype.isTileClipped=function(){return!0},t}(Vn),xy=Zi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,$p=bu;function bu(e,t,i,l,h){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=l,this._values=h,e.readFields(by,this,t)}function by(e,t,i){e==1?t.id=i.readVarint():e==2?function(l,h){for(var f=l.readVarint()+l.pos;l.pos<f;){var y=h._keys[l.readVarint()],w=h._values[l.readVarint()];h.properties[y]=w}}(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function wy(e){for(var t,i,l=0,h=0,f=e.length,y=f-1;h<f;y=h++)l+=((i=e[y]).x-(t=e[h]).x)*(t.y+i.y);return l}bu.types=["Unknown","Point","LineString","Polygon"],bu.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,l=1,h=0,f=0,y=0,w=[];e.pos<i;){if(h<=0){var I=e.readVarint();l=7&I,h=I>>3}if(h--,l===1||l===2)f+=e.readSVarint(),y+=e.readSVarint(),l===1&&(t&&w.push(t),t=[]),t.push(new N(f,y));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&w.push(t),w},bu.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,l=0,h=0,f=0,y=1/0,w=-1/0,I=1/0,k=-1/0;e.pos<t;){if(l<=0){var P=e.readVarint();i=7&P,l=P>>3}if(l--,i===1||i===2)(h+=e.readSVarint())<y&&(y=h),h>w&&(w=h),(f+=e.readSVarint())<I&&(I=f),f>k&&(k=f);else if(i!==7)throw new Error("unknown command "+i)}return[y,I,w,k]},bu.prototype.toGeoJSON=function(e,t,i){var l,h,f=this.extent*Math.pow(2,i),y=this.extent*e,w=this.extent*t,I=this.loadGeometry(),k=bu.types[this.type];function P(U){for(var Q=0;Q<U.length;Q++){var ee=U[Q];U[Q]=[360*(ee.x+y)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(ee.y+w)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var D=[];for(l=0;l<I.length;l++)D[l]=I[l][0];P(I=D);break;case 2:for(l=0;l<I.length;l++)P(I[l]);break;case 3:for(I=function(U){var Q=U.length;if(Q<=1)return[U];for(var ee,ue,ne=[],fe=0;fe<Q;fe++){var _e=wy(U[fe]);_e!==0&&(ue===void 0&&(ue=_e<0),ue===_e<0?(ee&&ne.push(ee),ee=[U[fe]]):ee.push(U[fe]))}return ee&&ne.push(ee),ne}(I),l=0;l<I.length;l++)for(h=0;h<I[l].length;h++)P(I[l][h])}I.length===1?I=I[0]:k="Multi"+k;var B={type:"Feature",geometry:{type:k,coordinates:I},properties:this.properties};return"id"in this&&(B.id=this.id),B};var ef=tf;function tf(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Sy,this,t),this.length=this._features.length}function Sy(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(function(l){for(var h=null,f=l.readVarint()+l.pos;l.pos<f;){var y=l.readVarint()>>3;h=y===1?l.readString():y===2?l.readFloat():y===3?l.readDouble():y===4?l.readVarint64():y===5?l.readVarint():y===6?l.readSVarint():y===7?l.readBoolean():null}return h}(i))}function Ey(e,t,i){if(e===3){var l=new ef(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}tf.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new $p(this._pbf,t,this.extent,this._keys,this._values)};var wu={VectorTile:function(e,t){this.layers=e.readFields(Ey,{},t)},VectorTileFeature:$p,VectorTileLayer:ef},Ty=wu.VectorTileFeature.types,ep=Math.pow(2,13);function ec(e,t,i,l,h,f,y,w){e.emplaceBack(t,i,2*Math.floor(l*ep)+y,h*ep*2,f*ep*2,Math.round(w))}var As=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Jn,this.indexArray=new Za,this.programConfigurations=new xt(e.layers,e.zoom),this.segments=new q,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Iy(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}As.prototype.populate=function(e,t,i){this.features=[],this.hasPattern=Qh("fill-extrusion",this.layers,t);for(var l=0,h=e;l<h.length;l+=1){var f=h[l],y=f.feature,w=f.id,I=f.index,k=f.sourceLayerIndex,P=this.layers[0]._featureFilter.needGeometry,D=ui(y,P);if(this.layers[0]._featureFilter.filter(new Yt(this.zoom),D,i)){var B={id:w,sourceLayerIndex:k,index:I,geometry:P?D.geometry:Hr(y),properties:y.properties,type:y.type,patterns:{}};this.hasPattern?this.features.push($h("fill-extrusion",this.layers,B,this.zoom,t)):this.addFeature(B,B.geometry,I,i,{}),t.featureIndex.insert(y,B.geometry,I,k,this.index,!0)}}},As.prototype.addFeatures=function(e,t,i){for(var l=0,h=this.features;l<h.length;l+=1){var f=h[l];this.addFeature(f,f.geometry,f.index,t,i)}},As.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},As.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},As.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},As.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xy),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},As.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},As.prototype.addFeature=function(e,t,i,l,h){for(var f=0,y=Yh(t,500);f<y.length;f+=1){for(var w=y[f],I=0,k=0,P=w;k<P.length;k+=1)I+=P[k].length;for(var D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),B=0,U=w;B<U.length;B+=1){var Q=U[B];if(Q.length!==0&&!((er=Q).every(function(jt){return jt.x<0})||er.every(function(jt){return jt.x>8192})||er.every(function(jt){return jt.y<0})||er.every(function(jt){return jt.y>8192})))for(var ee=0,ue=0;ue<Q.length;ue++){var ne=Q[ue];if(ue>=1){var fe=Q[ue-1];if(!Iy(ne,fe)){D.vertexLength+4>q.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _e=ne.sub(fe)._perp()._unit(),be=fe.dist(ne);ee+be>32768&&(ee=0),ec(this.layoutVertexArray,ne.x,ne.y,_e.x,_e.y,0,0,ee),ec(this.layoutVertexArray,ne.x,ne.y,_e.x,_e.y,0,1,ee),ec(this.layoutVertexArray,fe.x,fe.y,_e.x,_e.y,0,0,ee+=be),ec(this.layoutVertexArray,fe.x,fe.y,_e.x,_e.y,0,1,ee);var Ee=D.vertexLength;this.indexArray.emplaceBack(Ee,Ee+2,Ee+1),this.indexArray.emplaceBack(Ee+1,Ee+2,Ee+3),D.vertexLength+=4,D.primitiveLength+=2}}}}if(D.vertexLength+I>q.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),Ty[e.type]==="Polygon"){for(var Pe=[],Oe=[],We=D.vertexLength,gt=0,it=w;gt<it.length;gt+=1){var bt=it[gt];if(bt.length!==0){bt!==w[0]&&Oe.push(Pe.length/2);for(var at=0;at<bt.length;at++){var Wt=bt[at];ec(this.layoutVertexArray,Wt.x,Wt.y,0,0,1,1,0),Pe.push(Wt.x),Pe.push(Wt.y)}}}for(var zt=Xh(Pe,Oe),ht=0;ht<zt.length;ht+=3)this.indexArray.emplaceBack(We+zt[ht],We+zt[ht+2],We+zt[ht+1]);D.primitiveLength+=zt.length/3,D.vertexLength+=I}}var er;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,h,l)},Qe("FillExtrusionBucket",As,{omit:["layers","features"]});var ky={paint:new li({"fill-extrusion-opacity":new ct(O["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new lt(O["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ct(O["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ct(O["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new va(O["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new lt(O["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new lt(O["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ct(O["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},zy=function(e){function t(i){e.call(this,i,ky)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new As(i)},t.prototype.queryRadius=function(){return Bi(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,l,h,f,y,w,I,k){var P=Sa(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),w.angle,I),D=this.paint.get("fill-extrusion-height").evaluate(l,h),B=this.paint.get("fill-extrusion-base").evaluate(l,h),U=function(ee,ue,ne,fe){for(var _e=[],be=0,Ee=ee;be<Ee.length;be+=1){var Pe=Ee[be],Oe=[Pe.x,Pe.y,0,1];ml(Oe,Oe,ue),_e.push(new N(Oe[0]/Oe[3],Oe[1]/Oe[3]))}return _e}(P,k),Q=function(ee,ue,ne,fe){for(var _e=[],be=[],Ee=fe[8]*ue,Pe=fe[9]*ue,Oe=fe[10]*ue,We=fe[11]*ue,gt=fe[8]*ne,it=fe[9]*ne,bt=fe[10]*ne,at=fe[11]*ne,Wt=0,zt=ee;Wt<zt.length;Wt+=1){for(var ht=[],er=[],jt=0,cr=zt[Wt];jt<cr.length;jt+=1){var wt=cr[jt],xr=wt.x,ei=wt.y,ki=fe[0]*xr+fe[4]*ei+fe[12],yi=fe[1]*xr+fe[5]*ei+fe[13],ti=fe[2]*xr+fe[6]*ei+fe[14],zi=fe[3]*xr+fe[7]*ei+fe[15],hn=ti+Oe,pn=zi+We,go=ki+gt,Tn=yi+it,_o=ti+bt,Oi=zi+at,In=new N((ki+Ee)/pn,(yi+Pe)/pn);In.z=hn/pn,ht.push(In);var ar=new N(go/Oi,Tn/Oi);ar.z=_o/Oi,er.push(ar)}_e.push(ht),be.push(er)}return[_e,be]}(f,B,D,k);return function(ee,ue,ne){var fe=1/0;Go(ne,ue)&&(fe=rf(ne,ue[0]));for(var _e=0;_e<ue.length;_e++)for(var be=ue[_e],Ee=ee[_e],Pe=0;Pe<be.length-1;Pe++){var Oe=be[Pe],We=[Oe,be[Pe+1],Ee[Pe+1],Ee[Pe],Oe];ba(ne,We)&&(fe=Math.min(fe,rf(ne,We)))}return fe!==1/0&&fe}(Q[0],Q[1],U)},t}(Vn);function tc(e,t){return e.x*t.x+e.y*t.y}function rf(e,t){if(e.length===1){for(var i,l=0,h=t[l++];!i||h.equals(i);)if(!(i=t[l++]))return 1/0;for(;l<t.length;l++){var f=t[l],y=e[0],w=i.sub(h),I=f.sub(h),k=y.sub(h),P=tc(w,w),D=tc(w,I),B=tc(I,I),U=tc(k,w),Q=tc(k,I),ee=P*B-D*D,ue=(B*U-D*Q)/ee,ne=(P*Q-D*U)/ee,fe=h.z*(1-ue-ne)+i.z*ue+f.z*ne;if(isFinite(fe))return fe}return 1/0}for(var _e=1/0,be=0,Ee=t;be<Ee.length;be+=1)_e=Math.min(_e,Ee[be].z);return _e}var Ay=Zi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Py=Zi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Cy=wu.VectorTileFeature.types,My=Math.cos(Math.PI/180*37.5),nf=Math.pow(2,14)/.5,Do=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){t.gradients[i.id]={}}),this.layoutVertexArray=new Yn,this.layoutVertexArray2=new as,this.indexArray=new Za,this.programConfigurations=new xt(e.layers,e.zoom),this.segments=new q,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};Do.prototype.populate=function(e,t,i){this.hasPattern=Qh("line",this.layers,t);for(var l=this.layers[0].layout.get("line-sort-key"),h=[],f=0,y=e;f<y.length;f+=1){var w=y[f],I=w.feature,k=w.id,P=w.index,D=w.sourceLayerIndex,B=this.layers[0]._featureFilter.needGeometry,U=ui(I,B);if(this.layers[0]._featureFilter.filter(new Yt(this.zoom),U,i)){var Q=l?l.evaluate(U,{},i):void 0,ee={id:k,properties:I.properties,type:I.type,sourceLayerIndex:D,index:P,geometry:B?U.geometry:Hr(I),patterns:{},sortKey:Q};h.push(ee)}}l&&h.sort(function(Oe,We){return Oe.sortKey-We.sortKey});for(var ue=0,ne=h;ue<ne.length;ue+=1){var fe=ne[ue],_e=fe.geometry,be=fe.index,Ee=fe.sourceLayerIndex;if(this.hasPattern){var Pe=$h("line",this.layers,fe,this.zoom,t);this.patternFeatures.push(Pe)}else this.addFeature(fe,_e,be,i,{});t.featureIndex.insert(e[be].feature,_e,be,Ee,this.index)}},Do.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Do.prototype.addFeatures=function(e,t,i){for(var l=0,h=this.patternFeatures;l<h.length;l+=1){var f=h[l];this.addFeature(f,f.geometry,f.index,t,i)}},Do.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Do.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Do.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Py)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ay),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Do.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Do.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Do.prototype.addFeature=function(e,t,i,l,h){var f=this.layers[0].layout,y=f.get("line-join").evaluate(e,{}),w=f.get("line-cap"),I=f.get("line-miter-limit"),k=f.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var P=0,D=t;P<D.length;P+=1)this.addLine(D[P],e,y,w,I,k);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,h,l)},Do.prototype.addLine=function(e,t,i,l,h,f){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var y=0;y<e.length-1;y++)this.totalDistance+=e[y].dist(e[y+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var w=Cy[t.type]==="Polygon",I=e.length;I>=2&&e[I-1].equals(e[I-2]);)I--;for(var k=0;k<I-1&&e[k].equals(e[k+1]);)k++;if(!(I<(w?3:2))){i==="bevel"&&(h=1.05);var P,D=this.overscaling<=16?122880/(512*this.overscaling):0,B=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray),U=void 0,Q=void 0,ee=void 0,ue=void 0;this.e1=this.e2=-1,w&&(ue=e[k].sub(P=e[I-2])._unit()._perp());for(var ne=k;ne<I;ne++)if(!(Q=ne===I-1?w?e[k+1]:void 0:e[ne+1])||!e[ne].equals(Q)){ue&&(ee=ue),P&&(U=P),P=e[ne],ue=Q?Q.sub(P)._unit()._perp():ee;var fe=(ee=ee||ue).add(ue);fe.x===0&&fe.y===0||fe._unit();var _e=ee.x*ue.x+ee.y*ue.y,be=fe.x*ue.x+fe.y*ue.y,Ee=be!==0?1/be:1/0,Pe=2*Math.sqrt(2-2*be),Oe=be<My&&U&&Q,We=ee.x*ue.y-ee.y*ue.x>0;if(Oe&&ne>k){var gt=P.dist(U);if(gt>2*D){var it=P.sub(P.sub(U)._mult(D/gt)._round());this.updateDistance(U,it),this.addCurrentVertex(it,ee,0,0,B),U=it}}var bt=U&&Q,at=bt?i:w?"butt":l;if(bt&&at==="round"&&(Ee<f?at="miter":Ee<=2&&(at="fakeround")),at==="miter"&&Ee>h&&(at="bevel"),at==="bevel"&&(Ee>2&&(at="flipbevel"),Ee<h&&(at="miter")),U&&this.updateDistance(U,P),at==="miter")fe._mult(Ee),this.addCurrentVertex(P,fe,0,0,B);else if(at==="flipbevel"){if(Ee>100)fe=ue.mult(-1);else{var Wt=Ee*ee.add(ue).mag()/ee.sub(ue).mag();fe._perp()._mult(Wt*(We?-1:1))}this.addCurrentVertex(P,fe,0,0,B),this.addCurrentVertex(P,fe.mult(-1),0,0,B)}else if(at==="bevel"||at==="fakeround"){var zt=-Math.sqrt(Ee*Ee-1),ht=We?zt:0,er=We?0:zt;if(U&&this.addCurrentVertex(P,ee,ht,er,B),at==="fakeround")for(var jt=Math.round(180*Pe/Math.PI/20),cr=1;cr<jt;cr++){var wt=cr/jt;if(wt!==.5){var xr=wt-.5;wt+=wt*xr*(wt-1)*((1.0904+_e*(_e*(3.55645-1.43519*_e)-3.2452))*xr*xr+(.848013+_e*(.215638*_e-1.06021)))}var ei=ue.sub(ee)._mult(wt)._add(ee)._unit()._mult(We?-1:1);this.addHalfVertex(P,ei.x,ei.y,!1,We,0,B)}Q&&this.addCurrentVertex(P,ue,-ht,-er,B)}else if(at==="butt")this.addCurrentVertex(P,fe,0,0,B);else if(at==="square"){var ki=U?1:-1;this.addCurrentVertex(P,fe,ki,ki,B)}else at==="round"&&(U&&(this.addCurrentVertex(P,ee,0,0,B),this.addCurrentVertex(P,ee,1,1,B,!0)),Q&&(this.addCurrentVertex(P,ue,-1,-1,B,!0),this.addCurrentVertex(P,ue,0,0,B)));if(Oe&&ne<I-1){var yi=P.dist(Q);if(yi>2*D){var ti=P.add(Q.sub(P)._mult(D/yi)._round());this.updateDistance(P,ti),this.addCurrentVertex(ti,ue,0,0,B),P=ti}}}}},Do.prototype.addCurrentVertex=function(e,t,i,l,h,f){f===void 0&&(f=!1);var y=t.y*l-t.x,w=-t.y-t.x*l;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,f,!1,i,h),this.addHalfVertex(e,y,w,f,!0,-l,h),this.distance>nf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,i,l,h,f))},Do.prototype.addHalfVertex=function(e,t,i,l,h,f,y){var w=.5*(this.lineClips?this.scaledDistance*(nf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(l?1:0),(e.y<<1)+(h?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(f===0?0:f<0?-1:1)|(63&w)<<2,w>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var I=y.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),y.primitiveLength++),h?this.e2=I:this.e1=I},Do.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Do.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},Qe("LineBucket",Do,{omit:["layers","patternFeatures"]});var Dy=new li({"line-cap":new ct(O.layout_line["line-cap"]),"line-join":new lt(O.layout_line["line-join"]),"line-miter-limit":new ct(O.layout_line["line-miter-limit"]),"line-round-limit":new ct(O.layout_line["line-round-limit"]),"line-sort-key":new lt(O.layout_line["line-sort-key"])}),of={paint:new li({"line-opacity":new lt(O.paint_line["line-opacity"]),"line-color":new lt(O.paint_line["line-color"]),"line-translate":new ct(O.paint_line["line-translate"]),"line-translate-anchor":new ct(O.paint_line["line-translate-anchor"]),"line-width":new lt(O.paint_line["line-width"]),"line-gap-width":new lt(O.paint_line["line-gap-width"]),"line-offset":new lt(O.paint_line["line-offset"]),"line-blur":new lt(O.paint_line["line-blur"]),"line-dasharray":new Ii(O.paint_line["line-dasharray"]),"line-pattern":new va(O.paint_line["line-pattern"]),"line-gradient":new mi(O.paint_line["line-gradient"])}),layout:Dy},af=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l){return l=new Yt(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),e.prototype.possiblyEvaluate.call(this,i,l)},t.prototype.evaluate=function(i,l,h,f){return l=Ke({},l,{zoom:Math.floor(l.zoom)}),e.prototype.evaluate.call(this,i,l,h,f)},t}(lt))(of.paint.properties["line-width"].specification);af.useIntegerZoom=!0;var Ly=function(e){function t(i){e.call(this,i,of),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Mi,this.gradientVersion=(this.gradientVersion+1)%H)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l),this.paint._values["line-floorwidth"]=af.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},t.prototype.createBucket=function(i){return new Do(i)},t.prototype.queryRadius=function(i){var l=i,h=sf(oa("line-width",this,l),oa("line-gap-width",this,l)),f=oa("line-offset",this,l);return h/2+Math.abs(f)+Bi(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,l,h,f,y,w,I){var k=Sa(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),w.angle,I),P=I/2*sf(this.paint.get("line-width").evaluate(l,h),this.paint.get("line-gap-width").evaluate(l,h)),D=this.paint.get("line-offset").evaluate(l,h);return D&&(f=function(B,U){for(var Q=[],ee=new N(0,0),ue=0;ue<B.length;ue++){for(var ne=B[ue],fe=[],_e=0;_e<ne.length;_e++){var be=ne[_e],Ee=ne[_e+1],Pe=_e===0?ee:be.sub(ne[_e-1])._unit()._perp(),Oe=_e===ne.length-1?ee:Ee.sub(be)._unit()._perp(),We=Pe._add(Oe)._unit();We._mult(1/(We.x*Oe.x+We.y*Oe.y)),fe.push(We._mult(U)._add(be))}Q.push(fe)}return Q}(f,D*I)),function(B,U,Q){for(var ee=0;ee<U.length;ee++){var ue=U[ee];if(B.length>=3){for(var ne=0;ne<ue.length;ne++)if(Ko(B,ue[ne]))return!0}if(Po(B,ue,Q))return!0}return!1}(k,f,P)},t.prototype.isTileClipped=function(){return!0},t}(Vn);function sf(e,t){return t>0?t+2*e:e}var Ry=Zi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),By=Zi([{name:"a_projected_pos",components:3,type:"Float32"}],4),Oy=(Zi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Zi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),lf=(Zi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Zi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Fy=Zi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Vy(e,t,i){return e.sections.forEach(function(l){l.text=function(h,f,y){var w=f.layout.get("text-transform").evaluate(y,{});return w==="uppercase"?h=h.toLocaleUpperCase():w==="lowercase"&&(h=h.toLocaleLowerCase()),di.applyArabicShaping&&(h=di.applyArabicShaping(h)),h}(l.text,t,i)}),e}Zi([{name:"triangle",components:3,type:"Uint16"}]),Zi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Zi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Zi([{type:"Float32",name:"offsetX"}]),Zi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var rc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},uf=function(e,t,i,l,h){var f,y,w=8*h-l-1,I=(1<<w)-1,k=I>>1,P=-7,D=i?h-1:0,B=i?-1:1,U=e[t+D];for(D+=B,f=U&(1<<-P)-1,U>>=-P,P+=w;P>0;f=256*f+e[t+D],D+=B,P-=8);for(y=f&(1<<-P)-1,f>>=-P,P+=l;P>0;y=256*y+e[t+D],D+=B,P-=8);if(f===0)f=1-k;else{if(f===I)return y?NaN:1/0*(U?-1:1);y+=Math.pow(2,l),f-=k}return(U?-1:1)*y*Math.pow(2,f-l)},cf=function(e,t,i,l,h,f){var y,w,I,k=8*f-h-1,P=(1<<k)-1,D=P>>1,B=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,U=l?0:f-1,Q=l?1:-1,ee=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(w=isNaN(t)?1:0,y=P):(y=Math.floor(Math.log(t)/Math.LN2),t*(I=Math.pow(2,-y))<1&&(y--,I*=2),(t+=y+D>=1?B/I:B*Math.pow(2,1-D))*I>=2&&(y++,I/=2),y+D>=P?(w=0,y=P):y+D>=1?(w=(t*I-1)*Math.pow(2,h),y+=D):(w=t*Math.pow(2,D-1)*Math.pow(2,h),y=0));h>=8;e[i+U]=255&w,U+=Q,w/=256,h-=8);for(y=y<<h|w,k+=h;k>0;e[i+U]=255&y,U+=Q,y/=256,k-=8);e[i+U-Q]|=128*ee},Kc=Zr;function Zr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Zr.Varint=0,Zr.Fixed64=1,Zr.Bytes=2,Zr.Fixed32=5;var hf=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function _l(e){return e.type===Zr.Bytes?e.readVarint()+e.pos:e.pos+1}function Su(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function pf(e,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var h=i.pos-1;h>=e;h--)i.buf[h+l]=i.buf[h]}function Ny(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function Uy(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function jy(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function qy(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function Zy(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function Gy(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function Ky(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function Xy(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function Wy(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Xc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Eu(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function ff(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Hy(e,t,i){e===1&&i.readMessage(Jy,t)}function Jy(e,t,i){if(e===3){var l=i.readMessage(Yy,{}),h=l.width,f=l.height,y=l.left,w=l.top,I=l.advance;t.push({id:l.id,bitmap:new ou({width:h+6,height:f+6},l.bitmap),metrics:{width:h,height:f,left:y,top:w,advance:I}})}}function Yy(e,t,i){e===1?t.id=i.readVarint():e===2?t.bitmap=i.readBytes():e===3?t.width=i.readVarint():e===4?t.height=i.readVarint():e===5?t.left=i.readSVarint():e===6?t.top=i.readSVarint():e===7&&(t.advance=i.readVarint())}function df(e){for(var t=0,i=0,l=0,h=e;l<h.length;l+=1){var f=h[l];t+=f.w*f.h,i=Math.max(i,f.w)}e.sort(function(ee,ue){return ue.h-ee.h});for(var y=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}],w=0,I=0,k=0,P=e;k<P.length;k+=1)for(var D=P[k],B=y.length-1;B>=0;B--){var U=y[B];if(!(D.w>U.w||D.h>U.h)){if(D.x=U.x,D.y=U.y,I=Math.max(I,D.y+D.h),w=Math.max(w,D.x+D.w),D.w===U.w&&D.h===U.h){var Q=y.pop();B<y.length&&(y[B]=Q)}else D.h===U.h?(U.x+=D.w,U.w-=D.w):D.w===U.w?(U.y+=D.h,U.h-=D.h):(y.push({x:U.x+D.w,y:U.y,w:U.w-D.w,h:D.h}),U.y+=D.h,U.h-=D.h);break}}return{w,h:I,fill:t/(w*I)||0}}Zr.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),h=l>>3,f=this.pos;this.type=7&l,e(h,t,this),this.pos===f&&this.skip(l)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Xc(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=ff(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Xc(this.buf,this.pos)+4294967296*Xc(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Xc(this.buf,this.pos)+4294967296*ff(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=uf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=uf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(h,f,y){var w,I,k=y.buf;if(w=(112&(I=k[y.pos++]))>>4,I<128||(w|=(127&(I=k[y.pos++]))<<3,I<128)||(w|=(127&(I=k[y.pos++]))<<10,I<128)||(w|=(127&(I=k[y.pos++]))<<17,I<128)||(w|=(127&(I=k[y.pos++]))<<24,I<128)||(w|=(1&(I=k[y.pos++]))<<31,I<128))return Su(h,w,f);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&hf?function(i,l,h){return hf.decode(i.subarray(l,h))}(this.buf,t,e):function(i,l,h){for(var f="",y=l;y<h;){var w,I,k,P=i[y],D=null,B=P>239?4:P>223?3:P>191?2:1;if(y+B>h)break;B===1?P<128&&(D=P):B===2?(192&(w=i[y+1]))==128&&(D=(31&P)<<6|63&w)<=127&&(D=null):B===3?(I=i[y+2],(192&(w=i[y+1]))==128&&(192&I)==128&&((D=(15&P)<<12|(63&w)<<6|63&I)<=2047||D>=55296&&D<=57343)&&(D=null)):B===4&&(I=i[y+2],k=i[y+3],(192&(w=i[y+1]))==128&&(192&I)==128&&(192&k)==128&&((D=(15&P)<<18|(63&w)<<12|(63&I)<<6|63&k)<=65535||D>=1114112)&&(D=null)),D===null?(D=65533,B=1):D>65535&&(D-=65536,f+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),f+=String.fromCharCode(D),y+=B}return f}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Zr.Bytes)return e.push(this.readVarint(t));var i=_l(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Zr.Bytes)return e.push(this.readSVarint());var t=_l(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Zr.Bytes)return e.push(this.readBoolean());var t=_l(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Zr.Bytes)return e.push(this.readFloat());var t=_l(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Zr.Bytes)return e.push(this.readDouble());var t=_l(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Zr.Bytes)return e.push(this.readFixed32());var t=_l(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Zr.Bytes)return e.push(this.readSFixed32());var t=_l(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Zr.Bytes)return e.push(this.readFixed64());var t=_l(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Zr.Bytes)return e.push(this.readSFixed64());var t=_l(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Zr.Varint)for(;this.buf[this.pos++]>127;);else if(t===Zr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Zr.Fixed32)this.pos+=4;else{if(t!==Zr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Eu(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Eu(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Eu(this.buf,-1&e,this.pos),Eu(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Eu(this.buf,-1&e,this.pos),Eu(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,i){var l,h;if(t>=0?(l=t%4294967296|0,h=t/4294967296|0):(h=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,h=h+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(f,y,w){w.buf[w.pos++]=127&f|128,f>>>=7,w.buf[w.pos++]=127&f|128,f>>>=7,w.buf[w.pos++]=127&f|128,f>>>=7,w.buf[w.pos++]=127&f|128,w.buf[w.pos]=127&(f>>>=7)}(l,0,i),function(f,y){var w=(7&f)<<4;y.buf[y.pos++]|=w|((f>>>=3)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f)))))}(h,i)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(l,h,f){for(var y,w,I=0;I<h.length;I++){if((y=h.charCodeAt(I))>55295&&y<57344){if(!w){y>56319||I+1===h.length?(l[f++]=239,l[f++]=191,l[f++]=189):w=y;continue}if(y<56320){l[f++]=239,l[f++]=191,l[f++]=189,w=y;continue}y=w-55296<<10|y-56320|65536,w=null}else w&&(l[f++]=239,l[f++]=191,l[f++]=189,w=null);y<128?l[f++]=y:(y<2048?l[f++]=y>>6|192:(y<65536?l[f++]=y>>12|224:(l[f++]=y>>18|240,l[f++]=y>>12&63|128),l[f++]=y>>6&63|128),l[f++]=63&y|128)}return f}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&pf(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),cf(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),cf(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var l=this.pos-i;l>=128&&pf(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(e,t,i){this.writeTag(e,Zr.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Ny,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Uy,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,Zy,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,jy,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,qy,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,Gy,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Ky,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Xy,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Wy,t)},writeBytesField:function(e,t){this.writeTag(e,Zr.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Zr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Zr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Zr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Zr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Zr.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Zr.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Zr.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Zr.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Zr.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var Wc=function(e,t){var i=t.pixelRatio,l=t.version,h=t.stretchX,f=t.stretchY,y=t.content;this.paddedRect=e,this.pixelRatio=i,this.stretchX=h,this.stretchY=f,this.content=y,this.version=l},ic={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};ic.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},ic.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},ic.tlbr.get=function(){return this.tl.concat(this.br)},ic.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Wc.prototype,ic);var nc=function(e,t){var i={},l={};this.haveRenderCallbacks=[];var h=[];this.addImages(e,i,h),this.addImages(t,l,h);var f=df(h),y=new Xo({width:f.w||1,height:f.h||1});for(var w in e){var I=e[w],k=i[w].paddedRect;Xo.copy(I.data,y,{x:0,y:0},{x:k.x+1,y:k.y+1},I.data)}for(var P in t){var D=t[P],B=l[P].paddedRect,U=B.x+1,Q=B.y+1,ee=D.data.width,ue=D.data.height;Xo.copy(D.data,y,{x:0,y:0},{x:U,y:Q},D.data),Xo.copy(D.data,y,{x:0,y:ue-1},{x:U,y:Q-1},{width:ee,height:1}),Xo.copy(D.data,y,{x:0,y:0},{x:U,y:Q+ue},{width:ee,height:1}),Xo.copy(D.data,y,{x:ee-1,y:0},{x:U-1,y:Q},{width:1,height:ue}),Xo.copy(D.data,y,{x:0,y:0},{x:U+ee,y:Q},{width:1,height:ue})}this.image=y,this.iconPositions=i,this.patternPositions=l};nc.prototype.addImages=function(e,t,i){for(var l in e){var h=e[l],f={x:0,y:0,w:h.data.width+2,h:h.data.height+2};i.push(f),t[l]=new Wc(f,h),h.hasRenderCallback&&this.haveRenderCallbacks.push(l)}},nc.prototype.patchUpdatedImages=function(e,t){for(var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)},nc.prototype.patchUpdatedImage=function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var l=e.tl;i.update(t.data,void 0,{x:l[0],y:l[1]})}},Qe("ImagePosition",Wc),Qe("ImageAtlas",nc);var Ea={horizontal:1,vertical:2,horizontalOnly:3},Tu=function(){this.scale=1,this.fontStack="",this.imageName=null};Tu.forText=function(e,t){var i=new Tu;return i.scale=e||1,i.fontStack=t,i},Tu.forImage=function(e){var t=new Tu;return t.imageName=e,t};var yo=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Hc(e,t,i,l,h,f,y,w,I,k,P,D,B,U,Q,ee){var ue,ne=yo.fromFeature(e,h);D===Ea.vertical&&ne.verticalizePunctuation();var fe=di.processBidirectionalText,_e=di.processStyledBidirectionalText;if(fe&&ne.sections.length===1){ue=[];for(var be=0,Ee=fe(ne.toString(),tp(ne,k,f,t,l,U,Q));be<Ee.length;be+=1){var Pe=Ee[be],Oe=new yo;Oe.text=Pe,Oe.sections=ne.sections;for(var We=0;We<Pe.length;We++)Oe.sectionIndex.push(0);ue.push(Oe)}}else if(_e){ue=[];for(var gt=0,it=_e(ne.text,ne.sectionIndex,tp(ne,k,f,t,l,U,Q));gt<it.length;gt+=1){var bt=it[gt],at=new yo;at.text=bt[0],at.sectionIndex=bt[1],at.sections=ne.sections,ue.push(at)}}else ue=function(ht,er){for(var jt=[],cr=ht.text,wt=0,xr=0,ei=er;xr<ei.length;xr+=1){var ki=ei[xr];jt.push(ht.substring(wt,ki)),wt=ki}return wt<cr.length&&jt.push(ht.substring(wt,cr.length)),jt}(ne,tp(ne,k,f,t,l,U,Q));var Wt=[],zt={positionedLines:Wt,text:ne.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:D,iconsInText:!1,verticalizable:!1};return function(ht,er,jt,cr,wt,xr,ei,ki,yi,ti,zi,hn){for(var pn=0,go=-17,Tn=0,_o=0,Oi=ki==="right"?1:ki==="left"?0:.5,In=0,ar=0,Ur=wt;ar<Ur.length;ar+=1){var Dr=Ur[ar];Dr.trim();var fr=Dr.getMaxScale(),Lo=24*(fr-1),eo={positionedGlyphs:[],lineOffset:0};ht.positionedLines[In]=eo;var Jr=eo.positionedGlyphs,Ki=0;if(Dr.length()){for(var to=0;to<Dr.length();to++){var br=Dr.getSection(to),Gs=Dr.getSectionIndex(to),Ta=Dr.getCharCode(to),Ks=0,Fi=null,Xs=null,hs=null,Du=24,uu=!(yi===Ea.horizontal||!zi&&!sl(Ta)||zi&&(Jc[Ta]||(wl=Ta,je.Arabic(wl)||je["Arabic Supplement"](wl)||je["Arabic Extended-A"](wl)||je["Arabic Presentation Forms-A"](wl)||je["Arabic Presentation Forms-B"](wl))));if(br.imageName){var Lu=cr[br.imageName];if(!Lu)continue;hs=br.imageName,ht.iconsInText=ht.iconsInText||!0,Xs=Lu.paddedRect;var bl=Lu.displaySize;br.scale=24*br.scale/hn,Ks=Lo+(24-bl[1]*br.scale),Du=(Fi={width:bl[0],height:bl[1],left:1,top:-3,advance:uu?bl[1]:bl[0]}).advance;var Ru=uu?bl[0]*br.scale-24*fr:bl[1]*br.scale-24*fr;Ru>0&&Ru>Ki&&(Ki=Ru)}else{var oh=jt[br.fontStack],Bu=oh&&oh[Ta];if(Bu&&Bu.rect)Xs=Bu.rect,Fi=Bu.metrics;else{var sc=er[br.fontStack],ah=sc&&sc[Ta];if(!ah)continue;Fi=ah.metrics}Ks=24*(fr-br.scale)}uu?(ht.verticalizable=!0,Jr.push({glyph:Ta,imageName:hs,x:pn,y:go+Ks,vertical:uu,scale:br.scale,fontStack:br.fontStack,sectionIndex:Gs,metrics:Fi,rect:Xs}),pn+=Du*br.scale+ti):(Jr.push({glyph:Ta,imageName:hs,x:pn,y:go+Ks,vertical:uu,scale:br.scale,fontStack:br.fontStack,sectionIndex:Gs,metrics:Fi,rect:Xs}),pn+=Fi.advance*br.scale+ti)}Jr.length!==0&&(Tn=Math.max(pn-ti,Tn),$y(Jr,0,Jr.length-1,Oi,Ki)),pn=0;var sh=xr*fr+Ki;eo.lineOffset=Math.max(Ki,Lo),go+=sh,_o=Math.max(sh,_o),++In}else go+=xr,++In}var wl,lc=go- -17,Ou=rp(ei),Zl=Ou.horizontalAlign,Fu=Ou.verticalAlign;(function(lh,uh,uc,cc,ch,hc,pc,fc,hh){var Vu,ph=(uh-uc)*ch;Vu=hc!==pc?-fc*cc- -17:(-cc*hh+.5)*pc;for(var Nu=0,dc=lh;Nu<dc.length;Nu+=1)for(var cu=0,mc=dc[Nu].positionedGlyphs;cu<mc.length;cu+=1){var Uu=mc[cu];Uu.x+=ph,Uu.y+=Vu}})(ht.positionedLines,Oi,Zl,Fu,Tn,_o,xr,lc,wt.length),ht.top+=-Fu*lc,ht.bottom=ht.top+lc,ht.left+=-Zl*Tn,ht.right=ht.left+Tn}(zt,t,i,l,ue,y,w,I,D,k,B,ee),!function(ht){for(var er=0,jt=ht;er<jt.length;er+=1)if(jt[er].positionedGlyphs.length!==0)return!1;return!0}(Wt)&&zt}yo.fromFeature=function(e,t){for(var i=new yo,l=0;l<e.sections.length;l++){var h=e.sections[l];h.image?i.addImageSection(h):i.addTextSection(h,t)}return i},yo.prototype.length=function(){return this.text.length},yo.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},yo.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},yo.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},yo.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",i=0;i<e.length;i++){var l=e.charCodeAt(i+1)||null,h=e.charCodeAt(i-1)||null;t+=l&&Ei(l)&&!rc[e[i+1]]||h&&Ei(h)&&!rc[e[i-1]]||!rc[e[i]]?e[i]:rc[e[i]]}return t}(this.text)},yo.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Jc[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,l=this.text.length-1;l>=0&&l>=e&&Jc[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)},yo.prototype.substring=function(e,t){var i=new yo;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i},yo.prototype.toString=function(){return this.text},yo.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,i){return Math.max(t,e.sections[i].scale)},0)},yo.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(Tu.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,l=0;l<e.text.length;++l)this.sectionIndex.push(i)},yo.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(Tu.forImage(t)),this.sectionIndex.push(this.sections.length-1)):At("Reached maximum number of images 6401")}else At("Can't add FormattedSection with an empty image.")},yo.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Jc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},aa={};function mf(e,t,i,l,h,f){if(t.imageName){var y=l[t.imageName];return y?y.displaySize[0]*t.scale*24/f+h:0}var w=i[t.fontStack],I=w&&w[e];return I?I.metrics.advance*t.scale+h:0}function yf(e,t,i,l){var h=Math.pow(e-t,2);return l?e<t?h/2:2*h:h+Math.abs(i)*i}function Qy(e,t,i){var l=0;return e===10&&(l-=1e4),i&&(l+=150),e!==40&&e!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function gf(e,t,i,l,h,f){for(var y=null,w=yf(t,i,h,f),I=0,k=l;I<k.length;I+=1){var P=k[I],D=yf(t-P.x,i,h,f)+P.badness;D<=w&&(y=P,w=D)}return{index:e,x:t,priorBreak:y,badness:w}}function tp(e,t,i,l,h,f,y){if(f!=="point")return[];if(!e)return[];for(var w,I=[],k=function(ue,ne,fe,_e,be,Ee){for(var Pe=0,Oe=0;Oe<ue.length();Oe++){var We=ue.getSection(Oe);Pe+=mf(ue.getCharCode(Oe),We,_e,be,ne,Ee)}return Pe/Math.max(1,Math.ceil(Pe/fe))}(e,t,i,l,h,y),P=e.text.indexOf("\u200B")>=0,D=0,B=0;B<e.length();B++){var U=e.getSection(B),Q=e.getCharCode(B);if(Jc[Q]||(D+=mf(Q,U,l,h,t,y)),B<e.length()-1){var ee=!((w=Q)<11904||!(je["Bopomofo Extended"](w)||je.Bopomofo(w)||je["CJK Compatibility Forms"](w)||je["CJK Compatibility Ideographs"](w)||je["CJK Compatibility"](w)||je["CJK Radicals Supplement"](w)||je["CJK Strokes"](w)||je["CJK Symbols and Punctuation"](w)||je["CJK Unified Ideographs Extension A"](w)||je["CJK Unified Ideographs"](w)||je["Enclosed CJK Letters and Months"](w)||je["Halfwidth and Fullwidth Forms"](w)||je.Hiragana(w)||je["Ideographic Description Characters"](w)||je["Kangxi Radicals"](w)||je["Katakana Phonetic Extensions"](w)||je.Katakana(w)||je["Vertical Forms"](w)||je["Yi Radicals"](w)||je["Yi Syllables"](w)));(aa[Q]||ee||U.imageName)&&I.push(gf(B+1,D,k,I,Qy(Q,e.getCharCode(B+1),ee&&P),!1))}}return function ue(ne){return ne?ue(ne.priorBreak).concat(ne.index):[]}(gf(e.length(),D,k,I,0,!0))}function rp(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function $y(e,t,i,l,h){if(l||h)for(var f=e[i],y=(e[i].x+f.metrics.advance*f.scale)*l,w=t;w<=i;w++)e[w].x-=y,e[w].y+=h}function _f(e,t,i,l,h,f){var y,w=e.image;if(w.content){var I=w.content,k=w.pixelRatio||1;y=[I[0]/k,I[1]/k,w.displaySize[0]-I[2]/k,w.displaySize[1]-I[3]/k]}var P,D,B,U,Q=t.left*f,ee=t.right*f;i==="width"||i==="both"?(U=h[0]+Q-l[3],D=h[0]+ee+l[1]):D=(U=h[0]+(Q+ee-w.displaySize[0])/2)+w.displaySize[0];var ue=t.top*f,ne=t.bottom*f;return i==="height"||i==="both"?(P=h[1]+ue-l[0],B=h[1]+ne+l[2]):B=(P=h[1]+(ue+ne-w.displaySize[1])/2)+w.displaySize[1],{image:w,top:P,right:D,bottom:B,left:U,collisionPadding:y}}aa[10]=!0,aa[32]=!0,aa[38]=!0,aa[40]=!0,aa[41]=!0,aa[43]=!0,aa[45]=!0,aa[47]=!0,aa[173]=!0,aa[183]=!0,aa[8203]=!0,aa[8208]=!0,aa[8211]=!0,aa[8231]=!0;var Iu=function(e){function t(i,l,h,f){e.call(this,i,l),this.angle=h,f!==void 0&&(this.segment=f)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(N);function ip(e,t){var i=t.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new Yt(e+1))};if(i.kind==="source")return{kind:"source"};for(var l=i.zoomStops,h=i.interpolationType,f=0;f<l.length&&l[f]<=e;)f++;for(var y=f=Math.max(0,f-1);y<l.length&&l[y]<e+1;)y++;y=Math.min(l.length-1,y);var w=l[f],I=l[y];return i.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:I,interpolationType:h}:{kind:"camera",minZoom:w,maxZoom:I,minSize:i.evaluate(new Yt(w)),maxSize:i.evaluate(new Yt(I)),interpolationType:h}}function vf(e,t,i){var l=t.uSize,h=i.lowerSize;return e.kind==="source"?h/128:e.kind==="composite"?ii(h/128,i.upperSize/128,t.uSizeT):l}function xf(e,t){var i=0,l=0;if(e.kind==="constant")l=e.layoutSize;else if(e.kind!=="source"){var h=e.interpolationType,f=h?ze(ni.interpolationFactor(h,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?l=ii(e.minSize,e.maxSize,f):i=f}return{uSizeT:i,uSize:l}}Qe("Anchor",Iu);var eg=Object.freeze({__proto__:null,getSizeData:ip,evaluateSizeForFeature:vf,evaluateSizeForZoom:xf,SIZE_PACK_FACTOR:128});function bf(e,t,i,l,h){if(t.segment===void 0)return!0;for(var f=t,y=t.segment+1,w=0;w>-i/2;){if(--y<0)return!1;w-=e[y].dist(f),f=e[y]}w+=e[y].dist(e[y+1]),y++;for(var I=[],k=0;w<i/2;){var P=e[y],D=e[y+1];if(!D)return!1;var B=e[y-1].angleTo(P)-P.angleTo(D);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:w,angleDelta:B}),k+=B;w-I[0].distance>l;)k-=I.shift().angleDelta;if(k>h)return!1;y++,w+=P.dist(D)}return!0}function wf(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function Sf(e,t,i){return e?.6*t*i:0}function Ef(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function tg(e,t,i,l,h,f){for(var y=Sf(i,h,f),w=Ef(i,l)*f,I=0,k=wf(e)/2,P=0;P<e.length-1;P++){var D=e[P],B=e[P+1],U=D.dist(B);if(I+U>k){var Q=(k-I)/U,ee=ii(D.x,B.x,Q),ue=ii(D.y,B.y,Q),ne=new Iu(ee,ue,B.angleTo(D),P);return ne._round(),!y||bf(e,ne,w,y,t)?ne:void 0}I+=U}}function rg(e,t,i,l,h,f,y,w,I){var k=Sf(l,f,y),P=Ef(l,h),D=P*y,B=e[0].x===0||e[0].x===I||e[0].y===0||e[0].y===I;return t-D<t/4&&(t=D+t/4),function U(Q,ee,ue,ne,fe,_e,be,Ee,Pe){for(var Oe=_e/2,We=wf(Q),gt=0,it=ee-ue,bt=[],at=0;at<Q.length-1;at++){for(var Wt=Q[at],zt=Q[at+1],ht=Wt.dist(zt),er=zt.angleTo(Wt);it+ue<gt+ht;){var jt=((it+=ue)-gt)/ht,cr=ii(Wt.x,zt.x,jt),wt=ii(Wt.y,zt.y,jt);if(cr>=0&&cr<Pe&&wt>=0&&wt<Pe&&it-Oe>=0&&it+Oe<=We){var xr=new Iu(cr,wt,er,at);xr._round(),ne&&!bf(Q,xr,_e,ne,fe)||bt.push(xr)}}gt+=ht}return Ee||bt.length||be||(bt=U(Q,gt/2,ue,ne,fe,_e,be,!0,Pe)),bt}(e,B?t/2*w%t:(P/2+2*f)*y*w%t,t,k,i,D,B,!1,I)}function Tf(e,t,i,l,h){for(var f=[],y=0;y<e.length;y++)for(var w=e[y],I=void 0,k=0;k<w.length-1;k++){var P=w[k],D=w[k+1];P.x<t&&D.x<t||(P.x<t?P=new N(t,P.y+(t-P.x)/(D.x-P.x)*(D.y-P.y))._round():D.x<t&&(D=new N(t,P.y+(t-P.x)/(D.x-P.x)*(D.y-P.y))._round()),P.y<i&&D.y<i||(P.y<i?P=new N(P.x+(i-P.y)/(D.y-P.y)*(D.x-P.x),i)._round():D.y<i&&(D=new N(P.x+(i-P.y)/(D.y-P.y)*(D.x-P.x),i)._round()),P.x>=l&&D.x>=l||(P.x>=l?P=new N(l,P.y+(l-P.x)/(D.x-P.x)*(D.y-P.y))._round():D.x>=l&&(D=new N(l,P.y+(l-P.x)/(D.x-P.x)*(D.y-P.y))._round()),P.y>=h&&D.y>=h||(P.y>=h?P=new N(P.x+(h-P.y)/(D.y-P.y)*(D.x-P.x),h)._round():D.y>=h&&(D=new N(P.x+(h-P.y)/(D.y-P.y)*(D.x-P.x),h)._round()),I&&P.equals(I[I.length-1])||f.push(I=[P]),I.push(D)))))}return f}function If(e,t,i,l){var h=[],f=e.image,y=f.pixelRatio,w=f.paddedRect.w-2,I=f.paddedRect.h-2,k=e.right-e.left,P=e.bottom-e.top,D=f.stretchX||[[0,w]],B=f.stretchY||[[0,I]],U=function(cr,wt){return cr+wt[1]-wt[0]},Q=D.reduce(U,0),ee=B.reduce(U,0),ue=w-Q,ne=I-ee,fe=0,_e=Q,be=0,Ee=ee,Pe=0,Oe=ue,We=0,gt=ne;if(f.content&&l){var it=f.content;fe=Yc(D,0,it[0]),be=Yc(B,0,it[1]),_e=Yc(D,it[0],it[2]),Ee=Yc(B,it[1],it[3]),Pe=it[0]-fe,We=it[1]-be,Oe=it[2]-it[0]-_e,gt=it[3]-it[1]-Ee}var bt=function(cr,wt,xr,ei){var ki=Qc(cr.stretch-fe,_e,k,e.left),yi=$c(cr.fixed-Pe,Oe,cr.stretch,Q),ti=Qc(wt.stretch-be,Ee,P,e.top),zi=$c(wt.fixed-We,gt,wt.stretch,ee),hn=Qc(xr.stretch-fe,_e,k,e.left),pn=$c(xr.fixed-Pe,Oe,xr.stretch,Q),go=Qc(ei.stretch-be,Ee,P,e.top),Tn=$c(ei.fixed-We,gt,ei.stretch,ee),_o=new N(ki,ti),Oi=new N(hn,ti),In=new N(hn,go),ar=new N(ki,go),Ur=new N(yi/y,zi/y),Dr=new N(pn/y,Tn/y),fr=t*Math.PI/180;if(fr){var Lo=Math.sin(fr),eo=Math.cos(fr),Jr=[eo,-Lo,Lo,eo];_o._matMult(Jr),Oi._matMult(Jr),ar._matMult(Jr),In._matMult(Jr)}var Ki=cr.stretch+cr.fixed,to=wt.stretch+wt.fixed;return{tl:_o,tr:Oi,bl:ar,br:In,tex:{x:f.paddedRect.x+1+Ki,y:f.paddedRect.y+1+to,w:xr.stretch+xr.fixed-Ki,h:ei.stretch+ei.fixed-to},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ur,pixelOffsetBR:Dr,minFontScaleX:Oe/y/k,minFontScaleY:gt/y/P,isSDF:i}};if(l&&(f.stretchX||f.stretchY))for(var at=kf(D,ue,Q),Wt=kf(B,ne,ee),zt=0;zt<at.length-1;zt++)for(var ht=at[zt],er=at[zt+1],jt=0;jt<Wt.length-1;jt++)h.push(bt(ht,Wt[jt],er,Wt[jt+1]));else h.push(bt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:I+1}));return h}function Yc(e,t,i){for(var l=0,h=0,f=e;h<f.length;h+=1){var y=f[h];l+=Math.max(t,Math.min(i,y[1]))-Math.max(t,Math.min(i,y[0]))}return l}function kf(e,t,i){for(var l=[{fixed:-1,stretch:0}],h=0,f=e;h<f.length;h+=1){var y=f[h],w=y[0],I=y[1],k=l[l.length-1];l.push({fixed:w-k.stretch,stretch:k.stretch}),l.push({fixed:w-k.stretch,stretch:k.stretch+(I-w)})}return l.push({fixed:t+1,stretch:i}),l}function Qc(e,t,i,l){return e/t*i+l}function $c(e,t,i,l){return e-t*i/l}var eh=function(e,t,i,l,h,f,y,w,I,k){if(this.boxStartIndex=e.length,I){var P=f.top,D=f.bottom,B=f.collisionPadding;B&&(P-=B[1],D+=B[3]);var U=D-P;U>0&&(U=Math.max(10,U),this.circleDiameter=U)}else{var Q=f.top*y-w,ee=f.bottom*y+w,ue=f.left*y-w,ne=f.right*y+w,fe=f.collisionPadding;if(fe&&(ue-=fe[0]*y,Q-=fe[1]*y,ne+=fe[2]*y,ee+=fe[3]*y),k){var _e=new N(ue,Q),be=new N(ne,Q),Ee=new N(ue,ee),Pe=new N(ne,ee),Oe=k*Math.PI/180;_e._rotate(Oe),be._rotate(Oe),Ee._rotate(Oe),Pe._rotate(Oe),ue=Math.min(_e.x,be.x,Ee.x,Pe.x),ne=Math.max(_e.x,be.x,Ee.x,Pe.x),Q=Math.min(_e.y,be.y,Ee.y,Pe.y),ee=Math.max(_e.y,be.y,Ee.y,Pe.y)}e.emplaceBack(t.x,t.y,ue,Q,ne,ee,i,l,h)}this.boxEndIndex=e.length},ku=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=ig),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function ig(e,t){return e<t?-1:e>t?1:0}function ng(e,t,i){t===void 0&&(t=1),i===void 0&&(i=!1);for(var l=1/0,h=1/0,f=-1/0,y=-1/0,w=e[0],I=0;I<w.length;I++){var k=w[I];(!I||k.x<l)&&(l=k.x),(!I||k.y<h)&&(h=k.y),(!I||k.x>f)&&(f=k.x),(!I||k.y>y)&&(y=k.y)}var P=Math.min(f-l,y-h),D=P/2,B=new ku([],og);if(P===0)return new N(l,h);for(var U=l;U<f;U+=P)for(var Q=h;Q<y;Q+=P)B.push(new zu(U+D,Q+D,D,e));for(var ee=function(fe){for(var _e=0,be=0,Ee=0,Pe=fe[0],Oe=0,We=Pe.length,gt=We-1;Oe<We;gt=Oe++){var it=Pe[Oe],bt=Pe[gt],at=it.x*bt.y-bt.x*it.y;be+=(it.x+bt.x)*at,Ee+=(it.y+bt.y)*at,_e+=3*at}return new zu(be/_e,Ee/_e,0,fe)}(e),ue=B.length;B.length;){var ne=B.pop();(ne.d>ee.d||!ee.d)&&(ee=ne,i&&console.log("found best %d after %d probes",Math.round(1e4*ne.d)/1e4,ue)),ne.max-ee.d<=t||(B.push(new zu(ne.p.x-(D=ne.h/2),ne.p.y-D,D,e)),B.push(new zu(ne.p.x+D,ne.p.y-D,D,e)),B.push(new zu(ne.p.x-D,ne.p.y+D,D,e)),B.push(new zu(ne.p.x+D,ne.p.y+D,D,e)),ue+=4)}return i&&(console.log("num probes: "+ue),console.log("best distance: "+ee.d)),ee.p}function og(e,t){return t.max-e.max}function zu(e,t,i,l){this.p=new N(e,t),this.h=i,this.d=function(h,f){for(var y=!1,w=1/0,I=0;I<f.length;I++)for(var k=f[I],P=0,D=k.length,B=D-1;P<D;B=P++){var U=k[P],Q=k[B];U.y>h.y!=Q.y>h.y&&h.x<(Q.x-U.x)*(h.y-U.y)/(Q.y-U.y)+U.x&&(y=!y),w=Math.min(w,na(h,U,Q))}return(y?1:-1)*Math.sqrt(w)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}ku.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},ku.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},ku.prototype.peek=function(){return this.data[0]},ku.prototype._up=function(e){for(var t=this.data,i=this.compare,l=t[e];e>0;){var h=e-1>>1,f=t[h];if(i(l,f)>=0)break;t[e]=f,e=h}t[e]=l},ku.prototype._down=function(e){for(var t=this.data,i=this.compare,l=this.length>>1,h=t[e];e<l;){var f=1+(e<<1),y=t[f],w=f+1;if(w<this.length&&i(t[w],y)<0&&(f=w,y=t[w]),i(y,h)>=0)break;t[e]=y,e=f}t[e]=h};var np=Number.POSITIVE_INFINITY;function zf(e,t){return t[1]!==np?function(i,l,h){var f=0,y=0;switch(l=Math.abs(l),h=Math.abs(h),i){case"top-right":case"top-left":case"top":y=h-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-h}switch(i){case"top-right":case"bottom-right":case"right":f=-l;break;case"top-left":case"bottom-left":case"left":f=l}return[f,y]}(e,t[0],t[1]):function(i,l){var h=0,f=0;l<0&&(l=0);var y=l/Math.sqrt(2);switch(i){case"top-right":case"top-left":f=y-7;break;case"bottom-right":case"bottom-left":f=7-y;break;case"bottom":f=7-l;break;case"top":f=l-7}switch(i){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=l;break;case"right":h=-l}return[h,f]}(e,t[0])}function op(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Af(e,t,i,l,h,f,y,w,I,k,P,D,B,U,Q){var ee=function(be,Ee,Pe,Oe,We,gt,it,bt){for(var at=Oe.layout.get("text-rotate").evaluate(gt,{})*Math.PI/180,Wt=[],zt=0,ht=Ee.positionedLines;zt<ht.length;zt+=1)for(var er=ht[zt],jt=0,cr=er.positionedGlyphs;jt<cr.length;jt+=1){var wt=cr[jt];if(wt.rect){var xr=wt.rect||{},ei=4,ki=!0,yi=1,ti=0,zi=(We||bt)&&wt.vertical,hn=wt.metrics.advance*wt.scale/2;if(bt&&Ee.verticalizable&&(ti=er.lineOffset/2-(wt.imageName?-(24-wt.metrics.width*wt.scale)/2:24*(wt.scale-1))),wt.imageName){var pn=it[wt.imageName];ki=pn.sdf,ei=1/(yi=pn.pixelRatio)}var go=We?[wt.x+hn,wt.y]:[0,0],Tn=We?[0,0]:[wt.x+hn+Pe[0],wt.y+Pe[1]-ti],_o=[0,0];zi&&(_o=Tn,Tn=[0,0]);var Oi=(wt.metrics.left-ei)*wt.scale-hn+Tn[0],In=(-wt.metrics.top-ei)*wt.scale+Tn[1],ar=Oi+xr.w*wt.scale/yi,Ur=In+xr.h*wt.scale/yi,Dr=new N(Oi,In),fr=new N(ar,In),Lo=new N(Oi,Ur),eo=new N(ar,Ur);if(zi){var Jr=new N(-hn,hn- -17),Ki=-Math.PI/2,to=12-hn,br=new N(22-to,-(wt.imageName?to:0)),Gs=new(Function.prototype.bind.apply(N,[null].concat(_o)));Dr._rotateAround(Ki,Jr)._add(br)._add(Gs),fr._rotateAround(Ki,Jr)._add(br)._add(Gs),Lo._rotateAround(Ki,Jr)._add(br)._add(Gs),eo._rotateAround(Ki,Jr)._add(br)._add(Gs)}if(at){var Ta=Math.sin(at),Ks=Math.cos(at),Fi=[Ks,-Ta,Ta,Ks];Dr._matMult(Fi),fr._matMult(Fi),Lo._matMult(Fi),eo._matMult(Fi)}var Xs=new N(0,0),hs=new N(0,0);Wt.push({tl:Dr,tr:fr,bl:Lo,br:eo,tex:xr,writingMode:Ee.writingMode,glyphOffset:go,sectionIndex:wt.sectionIndex,isSDF:ki,pixelOffsetTL:Xs,pixelOffsetBR:hs,minFontScaleX:0,minFontScaleY:0})}}return Wt}(0,i,w,h,f,y,l,e.allowVerticalPlacement),ue=e.textSizeData,ne=null;ue.kind==="source"?(ne=[128*h.layout.get("text-size").evaluate(y,{})])[0]>32640&&At(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):ue.kind==="composite"&&((ne=[128*U.compositeTextSizes[0].evaluate(y,{},Q),128*U.compositeTextSizes[1].evaluate(y,{},Q)])[0]>32640||ne[1]>32640)&&At(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,ee,ne,w,f,y,k,t,I.lineStartIndex,I.lineLength,B,Q);for(var fe=0,_e=P;fe<_e.length;fe+=1)D[_e[fe]]=e.text.placedSymbolArray.length-1;return 4*ee.length}function Pf(e){for(var t in e)return e[t];return null}function ag(e,t,i,l){var h=e.compareText;if(t in h){for(var f=h[t],y=f.length-1;y>=0;y--)if(l.dist(f[y])<i)return!0}else h[t]=[];return h[t].push(l),!1}var sg=wu.VectorTileFeature.types,lg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function th(e,t,i,l,h,f,y,w,I,k,P,D,B){var U=w?Math.min(32640,Math.round(w[0])):0,Q=w?Math.min(32640,Math.round(w[1])):0;e.emplaceBack(t,i,Math.round(32*l),Math.round(32*h),f,y,(U<<1)+(I?1:0),Q,16*k,16*P,256*D,256*B)}function ap(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function ug(e){for(var t=0,i=e.sections;t<i.length;t+=1)if(ll(i[t].text))return!0;return!1}var Au=function(e){this.layoutVertexArray=new hl,this.indexArray=new Za,this.programConfigurations=e,this.segments=new q,this.dynamicLayoutVertexArray=new Ts,this.opacityVertexArray=new Ns,this.placedSymbolArray=new u};Au.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Au.prototype.upload=function(e,t,i,l){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ry.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,By.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,lg,!0),this.opacityVertexBuffer.itemSize=1),(i||l)&&this.programConfigurations.upload(e))},Au.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Qe("SymbolBuffers",Au);var oc=function(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new q,this.collisionVertexArray=new ru};oc.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Oy.members,!0)},oc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Qe("CollisionBuffers",oc);var Fr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(f){return f.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Mo([]),this.placementViewportMatrix=Mo([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ip(this.zoom,t["text-size"]),this.iconSizeData=ip(this.zoom,t["icon-size"]);var i=this.layers[0].layout,l=i.get("symbol-sort-key"),h=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(f){return Ea[f]})),this.stateDependentLayerIds=this.layers.filter(function(f){return f.isStateDependent()}).map(function(f){return f.id}),this.sourceID=e.sourceID};Fr.prototype.createArrays=function(){this.text=new Au(new xt(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new Au(new xt(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new x,this.lineVertexArray=new T,this.symbolInstances=new _},Fr.prototype.calculateGlyphDependencies=function(e,t,i,l,h){for(var f=0;f<e.length;f++)if(t[e.charCodeAt(f)]=!0,(i||l)&&h){var y=rc[e.charAt(f)];y&&(t[y.charCodeAt(0)]=!0)}},Fr.prototype.populate=function(e,t,i){var l=this.layers[0],h=l.layout,f=h.get("text-font"),y=h.get("text-field"),w=h.get("icon-image"),I=(y.value.kind!=="constant"||y.value.value instanceof Kr&&!y.value.value.isEmpty()||y.value.value.toString().length>0)&&(f.value.kind!=="constant"||f.value.value.length>0),k=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,P=h.get("symbol-sort-key");if(this.features=[],I||k){for(var D=t.iconDependencies,B=t.glyphDependencies,U=t.availableImages,Q=new Yt(this.zoom),ee=0,ue=e;ee<ue.length;ee+=1){var ne=ue[ee],fe=ne.feature,_e=ne.id,be=ne.index,Ee=ne.sourceLayerIndex,Pe=l._featureFilter.needGeometry,Oe=ui(fe,Pe);if(l._featureFilter.filter(Q,Oe,i)){Pe||(Oe.geometry=Hr(fe));var We=void 0;if(I){var gt=l.getValueAndResolveTokens("text-field",Oe,i,U),it=Kr.factory(gt);ug(it)&&(this.hasRTLText=!0),(!this.hasRTLText||Vl()==="unavailable"||this.hasRTLText&&di.isParsed())&&(We=Vy(it,l,Oe))}var bt=void 0;if(k){var at=l.getValueAndResolveTokens("icon-image",Oe,i,U);bt=at instanceof wi?at:wi.fromString(at)}if(We||bt){var Wt=this.sortFeaturesByKey?P.evaluate(Oe,{},i):void 0;if(this.features.push({id:_e,text:We,icon:bt,index:be,sourceLayerIndex:Ee,geometry:Oe.geometry,properties:fe.properties,type:sg[fe.type],sortKey:Wt}),bt&&(D[bt.name]=!0),We){var zt=f.evaluate(Oe,{},i).join(","),ht=h.get("text-rotation-alignment")==="map"&&h.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ea.vertical)>=0;for(var er=0,jt=We.sections;er<jt.length;er+=1){var cr=jt[er];if(cr.image)D[cr.image.name]=!0;else{var wt=_a(We.toString()),xr=cr.fontStack||zt,ei=B[xr]=B[xr]||{};this.calculateGlyphDependencies(cr.text,ei,ht,this.allowVerticalPlacement,wt)}}}}}}h.get("symbol-placement")==="line"&&(this.features=function(ki){var yi={},ti={},zi=[],hn=0;function pn(Jr){zi.push(ki[Jr]),hn++}function go(Jr,Ki,to){var br=ti[Jr];return delete ti[Jr],ti[Ki]=br,zi[br].geometry[0].pop(),zi[br].geometry[0]=zi[br].geometry[0].concat(to[0]),br}function Tn(Jr,Ki,to){var br=yi[Ki];return delete yi[Ki],yi[Jr]=br,zi[br].geometry[0].shift(),zi[br].geometry[0]=to[0].concat(zi[br].geometry[0]),br}function _o(Jr,Ki,to){var br=to?Ki[0][Ki[0].length-1]:Ki[0][0];return Jr+":"+br.x+":"+br.y}for(var Oi=0;Oi<ki.length;Oi++){var In=ki[Oi],ar=In.geometry,Ur=In.text?In.text.toString():null;if(Ur){var Dr=_o(Ur,ar),fr=_o(Ur,ar,!0);if(Dr in ti&&fr in yi&&ti[Dr]!==yi[fr]){var Lo=Tn(Dr,fr,ar),eo=go(Dr,fr,zi[Lo].geometry);delete yi[Dr],delete ti[fr],ti[_o(Ur,zi[eo].geometry,!0)]=eo,zi[Lo].geometry=null}else Dr in ti?go(Dr,fr,ar):fr in yi?Tn(Dr,fr,ar):(pn(Oi),yi[Dr]=hn-1,ti[fr]=hn-1)}else pn(Oi)}return zi.filter(function(Jr){return Jr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(ki,yi){return ki.sortKey-yi.sortKey})}},Fr.prototype.update=function(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))},Fr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Fr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Fr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Fr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Fr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Fr.prototype.addToLineVertexArray=function(e,t){var i=this.lineVertexArray.length;if(e.segment!==void 0){for(var l=e.dist(t[e.segment+1]),h=e.dist(t[e.segment]),f={},y=e.segment+1;y<t.length;y++)f[y]={x:t[y].x,y:t[y].y,tileUnitDistanceFromAnchor:l},y<t.length-1&&(l+=t[y+1].dist(t[y]));for(var w=e.segment||0;w>=0;w--)f[w]={x:t[w].x,y:t[w].y,tileUnitDistanceFromAnchor:h},w>0&&(h+=t[w-1].dist(t[w]));for(var I=0;I<t.length;I++){var k=f[I];this.lineVertexArray.emplaceBack(k.x,k.y,k.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Fr.prototype.addSymbols=function(e,t,i,l,h,f,y,w,I,k,P,D){for(var B=e.indexArray,U=e.layoutVertexArray,Q=e.segments.prepareSegment(4*t.length,U,B,this.canOverlap?f.sortKey:void 0),ee=this.glyphOffsetArray.length,ue=Q.vertexLength,ne=this.allowVerticalPlacement&&y===Ea.vertical?Math.PI/2:0,fe=f.text&&f.text.sections,_e=0;_e<t.length;_e++){var be=t[_e],Ee=be.tl,Pe=be.tr,Oe=be.bl,We=be.br,gt=be.tex,it=be.pixelOffsetTL,bt=be.pixelOffsetBR,at=be.minFontScaleX,Wt=be.minFontScaleY,zt=be.glyphOffset,ht=be.isSDF,er=be.sectionIndex,jt=Q.vertexLength,cr=zt[1];th(U,w.x,w.y,Ee.x,cr+Ee.y,gt.x,gt.y,i,ht,it.x,it.y,at,Wt),th(U,w.x,w.y,Pe.x,cr+Pe.y,gt.x+gt.w,gt.y,i,ht,bt.x,it.y,at,Wt),th(U,w.x,w.y,Oe.x,cr+Oe.y,gt.x,gt.y+gt.h,i,ht,it.x,bt.y,at,Wt),th(U,w.x,w.y,We.x,cr+We.y,gt.x+gt.w,gt.y+gt.h,i,ht,bt.x,bt.y,at,Wt),ap(e.dynamicLayoutVertexArray,w,ne),B.emplaceBack(jt,jt+1,jt+2),B.emplaceBack(jt+1,jt+2,jt+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(zt[0]),_e!==t.length-1&&er===t[_e+1].sectionIndex||e.programConfigurations.populatePaintArrays(U.length,f,f.index,{},D,fe&&fe[er])}e.placedSymbolArray.emplaceBack(w.x,w.y,ee,this.glyphOffsetArray.length-ee,ue,I,k,w.segment,i?i[0]:0,i?i[1]:0,l[0],l[1],y,0,!1,0,P)},Fr.prototype._addCollisionDebugVertex=function(e,t,i,l,h,f){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,l,h,Math.round(f.x),Math.round(f.y))},Fr.prototype.addCollisionDebugVertices=function(e,t,i,l,h,f,y){var w=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),I=w.vertexLength,k=h.layoutVertexArray,P=h.collisionVertexArray,D=y.anchorX,B=y.anchorY;this._addCollisionDebugVertex(k,P,f,D,B,new N(e,t)),this._addCollisionDebugVertex(k,P,f,D,B,new N(i,t)),this._addCollisionDebugVertex(k,P,f,D,B,new N(i,l)),this._addCollisionDebugVertex(k,P,f,D,B,new N(e,l)),w.vertexLength+=4;var U=h.indexArray;U.emplaceBack(I,I+1),U.emplaceBack(I+1,I+2),U.emplaceBack(I+2,I+3),U.emplaceBack(I+3,I),w.primitiveLength+=4},Fr.prototype.addDebugCollisionBoxes=function(e,t,i,l){for(var h=e;h<t;h++){var f=this.collisionBoxArray.get(h);this.addCollisionDebugVertices(f.x1,f.y1,f.x2,f.y2,l?this.textCollisionBox:this.iconCollisionBox,f.anchorPoint,i)}},Fr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new oc(Is,lf.members,Us),this.iconCollisionBox=new oc(Is,lf.members,Us);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Fr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,i,l,h,f,y,w,I){for(var k={},P=t;P<i;P++){var D=e.get(P);k.textBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},k.textFeatureIndex=D.featureIndex;break}for(var B=l;B<h;B++){var U=e.get(B);k.verticalTextBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},k.verticalTextFeatureIndex=U.featureIndex;break}for(var Q=f;Q<y;Q++){var ee=e.get(Q);k.iconBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},k.iconFeatureIndex=ee.featureIndex;break}for(var ue=w;ue<I;ue++){var ne=e.get(ue);k.verticalIconBox={x1:ne.x1,y1:ne.y1,x2:ne.x2,y2:ne.y2,anchorPointX:ne.anchorPointX,anchorPointY:ne.anchorPointY},k.verticalIconFeatureIndex=ne.featureIndex;break}return k},Fr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Fr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Fr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Fr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Fr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Fr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Fr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var i=e.placedSymbolArray.get(t),l=i.vertexStartIndex+4*i.numGlyphs,h=i.vertexStartIndex;h<l;h+=4)e.indexArray.emplaceBack(h,h+1,h+2),e.indexArray.emplaceBack(h+1,h+2,h+3)},Fr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),l=[],h=[],f=[],y=0;y<this.symbolInstances.length;++y){f.push(y);var w=this.symbolInstances.get(y);l.push(0|Math.round(t*w.anchorX+i*w.anchorY)),h.push(w.featureIndex)}return f.sort(function(I,k){return l[I]-l[k]||h[k]-h[I]}),f},Fr.prototype.addToSortKeyRanges=function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Fr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,l=this.symbolInstanceIndexes;i<l.length;i+=1){var h=this.symbolInstances.get(l[i]);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach(function(f,y,w){f>=0&&w.indexOf(f)===y&&t.addIndicesForPlacedSymbol(t.text,f)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Qe("SymbolBucket",Fr,{omit:["layers","collisionBoxArray","features","compareText"]}),Fr.MAX_GLYPHS=65535,Fr.addDynamicAttributes=ap;var cg=new li({"symbol-placement":new ct(O.layout_symbol["symbol-placement"]),"symbol-spacing":new ct(O.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ct(O.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new lt(O.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ct(O.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ct(O.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ct(O.layout_symbol["icon-ignore-placement"]),"icon-optional":new ct(O.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ct(O.layout_symbol["icon-rotation-alignment"]),"icon-size":new lt(O.layout_symbol["icon-size"]),"icon-text-fit":new ct(O.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ct(O.layout_symbol["icon-text-fit-padding"]),"icon-image":new lt(O.layout_symbol["icon-image"]),"icon-rotate":new lt(O.layout_symbol["icon-rotate"]),"icon-padding":new ct(O.layout_symbol["icon-padding"]),"icon-keep-upright":new ct(O.layout_symbol["icon-keep-upright"]),"icon-offset":new lt(O.layout_symbol["icon-offset"]),"icon-anchor":new lt(O.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ct(O.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ct(O.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ct(O.layout_symbol["text-rotation-alignment"]),"text-field":new lt(O.layout_symbol["text-field"]),"text-font":new lt(O.layout_symbol["text-font"]),"text-size":new lt(O.layout_symbol["text-size"]),"text-max-width":new lt(O.layout_symbol["text-max-width"]),"text-line-height":new ct(O.layout_symbol["text-line-height"]),"text-letter-spacing":new lt(O.layout_symbol["text-letter-spacing"]),"text-justify":new lt(O.layout_symbol["text-justify"]),"text-radial-offset":new lt(O.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ct(O.layout_symbol["text-variable-anchor"]),"text-anchor":new lt(O.layout_symbol["text-anchor"]),"text-max-angle":new ct(O.layout_symbol["text-max-angle"]),"text-writing-mode":new ct(O.layout_symbol["text-writing-mode"]),"text-rotate":new lt(O.layout_symbol["text-rotate"]),"text-padding":new ct(O.layout_symbol["text-padding"]),"text-keep-upright":new ct(O.layout_symbol["text-keep-upright"]),"text-transform":new lt(O.layout_symbol["text-transform"]),"text-offset":new lt(O.layout_symbol["text-offset"]),"text-allow-overlap":new ct(O.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ct(O.layout_symbol["text-ignore-placement"]),"text-optional":new ct(O.layout_symbol["text-optional"])}),sp={paint:new li({"icon-opacity":new lt(O.paint_symbol["icon-opacity"]),"icon-color":new lt(O.paint_symbol["icon-color"]),"icon-halo-color":new lt(O.paint_symbol["icon-halo-color"]),"icon-halo-width":new lt(O.paint_symbol["icon-halo-width"]),"icon-halo-blur":new lt(O.paint_symbol["icon-halo-blur"]),"icon-translate":new ct(O.paint_symbol["icon-translate"]),"icon-translate-anchor":new ct(O.paint_symbol["icon-translate-anchor"]),"text-opacity":new lt(O.paint_symbol["text-opacity"]),"text-color":new lt(O.paint_symbol["text-color"],{runtimeType:Ve,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new lt(O.paint_symbol["text-halo-color"]),"text-halo-width":new lt(O.paint_symbol["text-halo-width"]),"text-halo-blur":new lt(O.paint_symbol["text-halo-blur"]),"text-translate":new ct(O.paint_symbol["text-translate"]),"text-translate-anchor":new ct(O.paint_symbol["text-translate-anchor"])}),layout:cg},Pu=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Xe,this.defaultValue=e};Pu.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},Pu.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},Pu.prototype.outputDefined=function(){return!1},Pu.prototype.serialize=function(){return null},Qe("FormatSectionOverride",Pu,{omit:["defaultValue"]});var hg=function(e){function t(i){e.call(this,i,sp)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){if(e.prototype.recalculate.call(this,i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var h=this.layout.get("text-writing-mode");if(h){for(var f=[],y=0,w=h;y<w.length;y+=1){var I=w[y];f.indexOf(I)<0&&f.push(I)}this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(i,l,h,f){var y=this.layout.get(i).evaluate(l,{},h,f),w=this._unevaluatedLayout._values[i];return w.isDataDriven()||vs(w.value)||!y?y:function(I,k){return k.replace(/{([^{}]+)}/g,function(P,D){return D in I?String(I[D]):""})}(l.properties,y)},t.prototype.createBucket=function(i){return new Fr(i)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var i=0,l=sp.paint.overridableProperties;i<l.length;i+=1){var h=l[i];if(t.hasPaintOverride(this.layout,h)){var f,y=this.paint.get(h),w=new Pu(y),I=new Rs(w,y.property.specification);f=y.value.kind==="constant"||y.value.kind==="source"?new ma("source",I):new $a("composite",I,y.value.zoomStops,y.value._interpolationType),this.paint._values[h]=new Li(y.property,f,y.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,h){return!(!this.layout||l.isDataDriven()||h.isDataDriven())&&t.hasPaintOverride(this.layout,i)},t.hasPaintOverride=function(i,l){var h=i.get("text-field"),f=sp.paint.properties[l],y=!1,w=function(P){for(var D=0,B=P;D<B.length;D+=1)if(f.overrides&&f.overrides.hasOverride(B[D]))return void(y=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Kr)w(h.value.value.sections);else if(h.value.kind==="source"){var I=function(P){y||(P instanceof qr&&Pr(P.value)===sr?w(P.value.sections):P instanceof yn?w(P.sections):P.eachChild(I))},k=h.value;k._styleExpression&&I(k._styleExpression.expression)}return y},t}(Vn),pg={paint:new li({"background-color":new ct(O.paint_background["background-color"]),"background-pattern":new Ii(O.paint_background["background-pattern"]),"background-opacity":new ct(O.paint_background["background-opacity"])})},fg=function(e){function t(i){e.call(this,i,pg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Vn),dg={paint:new li({"raster-opacity":new ct(O.paint_raster["raster-opacity"]),"raster-hue-rotate":new ct(O.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ct(O.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ct(O.paint_raster["raster-brightness-max"]),"raster-saturation":new ct(O.paint_raster["raster-saturation"]),"raster-contrast":new ct(O.paint_raster["raster-contrast"]),"raster-resampling":new ct(O.paint_raster["raster-resampling"]),"raster-fade-duration":new ct(O.paint_raster["raster-fade-duration"])})},mg=function(e){function t(i){e.call(this,i,dg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Vn),yg=function(e){function t(i){e.call(this,i,{}),this.implementation=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},t.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},t}(Vn),gg={circle:iu,heatmap:ey,hillshade:ry,fill:vy,"fill-extrusion":zy,line:Ly,symbol:hg,background:fg,raster:mg},Cf=K.HTMLImageElement,Mf=K.HTMLCanvasElement,Df=K.HTMLVideoElement,Lf=K.ImageData,rh=K.ImageBitmap,au=function(e,t,i,l){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,l)};au.prototype.update=function(e,t,i){var l=e.width,h=e.height,f=!(this.size&&this.size[0]===l&&this.size[1]===h||i),y=this.context,w=y.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),w.bindTexture(w.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!t||t.premultiply!==!1)),f)this.size=[l,h],e instanceof Cf||e instanceof Mf||e instanceof Df||e instanceof Lf||rh&&e instanceof rh?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,e):w.texImage2D(w.TEXTURE_2D,0,this.format,l,h,0,this.format,w.UNSIGNED_BYTE,e.data);else{var I=i||{x:0,y:0},k=I.x,P=I.y;e instanceof Cf||e instanceof Mf||e instanceof Df||e instanceof Lf||rh&&e instanceof rh?w.texSubImage2D(w.TEXTURE_2D,0,k,P,w.RGBA,w.UNSIGNED_BYTE,e):w.texSubImage2D(w.TEXTURE_2D,0,k,P,l,h,w.RGBA,w.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&w.generateMipmap(w.TEXTURE_2D)},au.prototype.bind=function(e,t,i){var l=this.context.gl;l.bindTexture(l.TEXTURE_2D,this.texture),i!==l.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=l.LINEAR),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,t),this.wrap=t)},au.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},au.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var lp=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};lp.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},lp.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Cu=function(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Er(["receive","process"],this),this.invoker=new lp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=pr()?e:K};function Rf(e,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[e*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}Cu.prototype.send=function(e,t,i,l,h){var f=this;h===void 0&&(h=!1);var y=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[y]=i);var w=tr(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:e,hasCallback:!!i,targetMapId:l,mustQueue:h,sourceMapId:this.mapId,data:On(t,w)},w),{cancel:function(){i&&delete f.callbacks[y],f.target.postMessage({id:y,type:"<cancel>",targetMapId:l,sourceMapId:f.mapId})}}},Cu.prototype.receive=function(e){var t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[i];var l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l()}else pr()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},Cu.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},Cu.prototype.processTask=function(e,t){var i=this;if(t.type==="<response>"){var l=this.callbacks[e];delete this.callbacks[e],l&&(t.error?l(Fn(t.error)):l(null,Fn(t.data)))}else{var h=!1,f=tr(this.globalScope)?void 0:[],y=t.hasCallback?function(P,D){h=!0,delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:P?On(P):null,data:On(D,f)},f)}:function(P){h=!0},w=null,I=Fn(t.data);if(this.parent[t.type])w=this.parent[t.type](t.sourceMapId,I,y);else if(this.parent.getWorkerSource){var k=t.type.split(".");w=this.parent.getWorkerSource(t.sourceMapId,k[0],I.source)[k[1]](I,y)}else y(new Error("Could not find function "+t.type));!h&&w&&w.cancel&&(this.cancelCallbacks[e]=w.cancel)}},Cu.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var tn=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};tn.prototype.setNorthEast=function(e){return this._ne=e instanceof $r?new $r(e.lng,e.lat):$r.convert(e),this},tn.prototype.setSouthWest=function(e){return this._sw=e instanceof $r?new $r(e.lng,e.lat):$r.convert(e),this},tn.prototype.extend=function(e){var t,i,l=this._sw,h=this._ne;if(e instanceof $r)t=e,i=e;else{if(!(e instanceof tn))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(tn.convert(e)):this.extend($r.convert(e)):this;if(i=e._ne,!(t=e._sw)||!i)return this}return l||h?(l.lng=Math.min(t.lng,l.lng),l.lat=Math.min(t.lat,l.lat),h.lng=Math.max(i.lng,h.lng),h.lat=Math.max(i.lat,h.lat)):(this._sw=new $r(t.lng,t.lat),this._ne=new $r(i.lng,i.lat)),this},tn.prototype.getCenter=function(){return new $r((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},tn.prototype.getSouthWest=function(){return this._sw},tn.prototype.getNorthEast=function(){return this._ne},tn.prototype.getNorthWest=function(){return new $r(this.getWest(),this.getNorth())},tn.prototype.getSouthEast=function(){return new $r(this.getEast(),this.getSouth())},tn.prototype.getWest=function(){return this._sw.lng},tn.prototype.getSouth=function(){return this._sw.lat},tn.prototype.getEast=function(){return this._ne.lng},tn.prototype.getNorth=function(){return this._ne.lat},tn.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},tn.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},tn.prototype.isEmpty=function(){return!(this._sw&&this._ne)},tn.prototype.contains=function(e){var t=$r.convert(e),i=t.lng,l=t.lat,h=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&h},tn.convert=function(e){return!e||e instanceof tn?e:new tn(e)};var $r=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};$r.prototype.wrap=function(){return new $r(Ge(this.lng,-180,180),this.lat)},$r.prototype.toArray=function(){return[this.lng,this.lat]},$r.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},$r.prototype.distanceTo=function(e){var t=Math.PI/180,i=this.lat*t,l=e.lat*t,h=Math.sin(i)*Math.sin(l)+Math.cos(i)*Math.cos(l)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(h,1))},$r.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new tn(new $r(this.lng-i,this.lat-t),new $r(this.lng+i,this.lat+t))},$r.convert=function(e){if(e instanceof $r)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new $r(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new $r(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Bf=2*Math.PI*63710088e-1;function Of(e){return Bf*Math.cos(e*Math.PI/180)}function Ff(e){return(180+e)/360}function Vf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Nf(e,t){return e/Of(t)}function up(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var su=function(e,t,i){i===void 0&&(i=0),this.x=+e,this.y=+t,this.z=+i};su.fromLngLat=function(e,t){t===void 0&&(t=0);var i=$r.convert(e);return new su(Ff(i.lng),Vf(i.lat),Nf(t,i.lat))},su.prototype.toLngLat=function(){return new $r(360*this.x-180,up(this.y))},su.prototype.toAltitude=function(){return this.z*Of(up(this.y))},su.prototype.meterInMercatorCoordinateUnits=function(){return 1/Bf*(e=up(this.y),1/Math.cos(e*Math.PI/180));var e};var lu=function(e,t,i){this.z=e,this.x=t,this.y=i,this.key=ac(0,e,e,t,i)};lu.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},lu.prototype.url=function(e,t){var i,l,h,f,y,w=(l=this.y,h=this.z,f=Rf(256*(i=this.x),256*(l=Math.pow(2,h)-l-1),h),y=Rf(256*(i+1),256*(l+1),h),f[0]+","+f[1]+","+y[0]+","+y[1]),I=function(k,P,D){for(var B,U="",Q=k;Q>0;Q--)U+=(P&(B=1<<Q-1)?1:0)+(D&B?2:0);return U}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",I).replace("{bbox-epsg-3857}",w)},lu.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new N(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},lu.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Uf=function(e,t){this.wrap=e,this.canonical=t,this.key=ac(e,t.z,t.z,t.x,t.y)},rn=function(e,t,i,l,h){this.overscaledZ=e,this.wrap=t,this.canonical=new lu(i,+l,+h),this.key=ac(t,e,i,l,h)};function ac(e,t,i,l,h){(e*=2)<0&&(e=-1*e-1);var f=1<<i;return(f*f*e+f*h+l).toString(36)+i.toString(36)+t.toString(36)}rn.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},rn.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new rn(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new rn(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},rn.prototype.calculateScaledKey=function(e,t){var i=this.canonical.z-e;return e>this.canonical.z?ac(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):ac(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)},rn.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},rn.prototype.children=function(e){if(this.overscaledZ>=e)return[new rn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,i=2*this.canonical.x,l=2*this.canonical.y;return[new rn(t,this.wrap,t,i,l),new rn(t,this.wrap,t,i+1,l),new rn(t,this.wrap,t,i,l+1),new rn(t,this.wrap,t,i+1,l+1)]},rn.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},rn.prototype.wrapped=function(){return new rn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},rn.prototype.unwrapTo=function(e){return new rn(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},rn.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},rn.prototype.toUnwrapped=function(){return new Uf(this.wrap,this.canonical)},rn.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},rn.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new su(e.x-this.wrap,e.y))},Qe("CanonicalTileID",lu),Qe("OverscaledTileID",rn,{omit:["posMatrix"]});var vl=function(e,t,i){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return At('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var l=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=i||"mapbox";for(var h=0;h<l;h++)this.data[this._idx(-1,h)]=this.data[this._idx(0,h)],this.data[this._idx(l,h)]=this.data[this._idx(l-1,h)],this.data[this._idx(h,-1)]=this.data[this._idx(h,0)],this.data[this._idx(h,l)]=this.data[this._idx(h,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)]};vl.prototype.get=function(e,t){var i=new Uint8Array(this.data.buffer),l=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[l],i[l+1],i[l+2])},vl.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},vl.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},vl.prototype._unpackMapbox=function(e,t,i){return(256*e*256+256*t+i)/10-1e4},vl.prototype._unpackTerrarium=function(e,t,i){return 256*e+t+i/256-32768},vl.prototype.getPixels=function(){return new Xo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},vl.prototype.backfillBorder=function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var l=t*this.dim,h=t*this.dim+this.dim,f=i*this.dim,y=i*this.dim+this.dim;switch(t){case-1:l=h-1;break;case 1:h=l+1}switch(i){case-1:f=y-1;break;case 1:y=f+1}for(var w=-t*this.dim,I=-i*this.dim,k=f;k<y;k++)for(var P=l;P<h;P++)this.data[this._idx(P,k)]=e.data[this._idx(P+w,k+I)]},Qe("DEMData",vl);var ih=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}};ih.prototype.encode=function(e){return this._stringToNumber[e]},ih.prototype.decode=function(e){return this._numberToString[e]};var nh=function(e,t,i,l,h){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=l,this.properties=e.properties,this.id=h},cp={geometry:{configurable:!0}};cp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},cp.geometry.set=function(e){this._geometry=e},nh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(nh.prototype,cp);var Mu=function(){this.state={},this.stateChanges={},this.deletedStates={}};Mu.prototype.updateState=function(e,t,i){var l=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},Ke(this.stateChanges[e][l],i),this.deletedStates[e]===null)for(var h in this.deletedStates[e]={},this.state[e])h!==l&&(this.deletedStates[e][h]=null);else if(this.deletedStates[e]&&this.deletedStates[e][l]===null)for(var f in this.deletedStates[e][l]={},this.state[e][l])i[f]||(this.deletedStates[e][l][f]=null);else for(var y in i)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][y]===null&&delete this.deletedStates[e][l][y]},Mu.prototype.removeFeatureState=function(e,t,i){if(this.deletedStates[e]!==null){var l=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&t!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][i]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(i in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][i]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}},Mu.prototype.getState=function(e,t){var i=String(t),l=Ke({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var h=this.deletedStates[e][t];if(h===null)return{};for(var f in h)delete l[f]}return l},Mu.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},Mu.prototype.coalesceChanges=function(e,t){var i={};for(var l in this.stateChanges){this.state[l]=this.state[l]||{};var h={};for(var f in this.stateChanges[l])this.state[l][f]||(this.state[l][f]={}),Ke(this.state[l][f],this.stateChanges[l][f]),h[f]=this.state[l][f];i[l]=h}for(var y in this.deletedStates){this.state[y]=this.state[y]||{};var w={};if(this.deletedStates[y]===null)for(var I in this.state[y])w[I]={},this.state[y][I]={};else for(var k in this.deletedStates[y]){if(this.deletedStates[y][k]===null)this.state[y][k]={};else for(var P=0,D=Object.keys(this.deletedStates[y][k]);P<D.length;P+=1)delete this.state[y][k][D[P]];w[k]=this.state[y][k]}i[y]=i[y]||{},Ke(i[y],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var B in e)e[B].setFeatureState(i,t)};var xl=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new ra(8192,16,0),this.grid3D=new ra(8192,16,0),this.featureIndexArray=new L,this.promoteId=t};function jf(e,t,i,l,h){return Ht(e,function(f,y){var w=t instanceof ia?t.get(y):null;return w&&w.evaluate?w.evaluate(i,l,h):w})}function qf(e){for(var t=1/0,i=1/0,l=-1/0,h=-1/0,f=0,y=e;f<y.length;f+=1){var w=y[f];t=Math.min(t,w.x),i=Math.min(i,w.y),l=Math.max(l,w.x),h=Math.max(h,w.y)}return{minX:t,minY:i,maxX:l,maxY:h}}function _g(e,t){return t-e}xl.prototype.insert=function(e,t,i,l,h,f){var y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,l,h);for(var w=f?this.grid3D:this.grid,I=0;I<t.length;I++){for(var k=t[I],P=[1/0,1/0,-1/0,-1/0],D=0;D<k.length;D++){var B=k[D];P[0]=Math.min(P[0],B.x),P[1]=Math.min(P[1],B.y),P[2]=Math.max(P[2],B.x),P[3]=Math.max(P[3],B.y)}P[0]<8192&&P[1]<8192&&P[2]>=0&&P[3]>=0&&w.insert(y,P[0],P[1],P[2],P[3])}},xl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new wu.VectorTile(new Kc(this.rawTileData)).layers,this.sourceLayerCoder=new ih(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},xl.prototype.query=function(e,t,i,l){var h=this;this.loadVTLayers();for(var f=e.params||{},y=8192/e.tileSize/e.scale,w=Bs(f.filter),I=e.queryGeometry,k=e.queryPadding*y,P=qf(I),D=this.grid.query(P.minX-k,P.minY-k,P.maxX+k,P.maxY+k),B=qf(e.cameraQueryGeometry),U=this.grid3D.query(B.minX-k,B.minY-k,B.maxX+k,B.maxY+k,function(be,Ee,Pe,Oe){return function(We,gt,it,bt,at){for(var Wt=0,zt=We;Wt<zt.length;Wt+=1){var ht=zt[Wt];if(gt<=ht.x&&it<=ht.y&&bt>=ht.x&&at>=ht.y)return!0}var er=[new N(gt,it),new N(gt,at),new N(bt,at),new N(bt,it)];if(We.length>2){for(var jt=0,cr=er;jt<cr.length;jt+=1)if(Ko(We,cr[jt]))return!0}for(var wt=0;wt<We.length-1;wt++)if(dl(We[wt],We[wt+1],er))return!0;return!1}(e.cameraQueryGeometry,be-k,Ee-k,Pe+k,Oe+k)}),Q=0,ee=U;Q<ee.length;Q+=1)D.push(ee[Q]);D.sort(_g);for(var ue,ne={},fe=function(be){var Ee=D[be];if(Ee!==ue){ue=Ee;var Pe=h.featureIndexArray.get(Ee),Oe=null;h.loadMatchingFeature(ne,Pe.bucketIndex,Pe.sourceLayerIndex,Pe.featureIndex,w,f.layers,f.availableImages,t,i,l,function(We,gt,it){return Oe||(Oe=Hr(We)),gt.queryIntersectsFeature(I,We,it,Oe,h.z,e.transform,y,e.pixelPosMatrix)})}},_e=0;_e<D.length;_e++)fe(_e);return ne},xl.prototype.loadMatchingFeature=function(e,t,i,l,h,f,y,w,I,k,P){var D=this.bucketLayerIDs[t];if(!f||function(We,gt){for(var it=0;it<We.length;it++)if(gt.indexOf(We[it])>=0)return!0;return!1}(f,D)){var B=this.sourceLayerCoder.decode(i),U=this.vtLayers[B].feature(l);if(h.needGeometry){var Q=ui(U,!0);if(!h.filter(new Yt(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!h.filter(new Yt(this.tileID.overscaledZ),U))return;for(var ee=this.getId(U,B),ue=0;ue<D.length;ue++){var ne=D[ue];if(!(f&&f.indexOf(ne)<0)){var fe=w[ne];if(fe){var _e={};ee!==void 0&&k&&(_e=k.getState(fe.sourceLayer||"_geojsonTileLayer",ee));var be=Ke({},I[ne]);be.paint=jf(be.paint,fe.paint,U,_e,y),be.layout=jf(be.layout,fe.layout,U,_e,y);var Ee=!P||P(U,fe,_e);if(Ee){var Pe=new nh(U,this.z,this.x,this.y,ee);Pe.layer=be;var Oe=e[ne];Oe===void 0&&(Oe=e[ne]=[]),Oe.push({featureIndex:l,feature:Pe,intersectionZ:Ee})}}}}}},xl.prototype.lookupSymbolFeatures=function(e,t,i,l,h,f,y,w){var I={};this.loadVTLayers();for(var k=Bs(h),P=0,D=e;P<D.length;P+=1)this.loadMatchingFeature(I,i,l,D[P],k,f,y,w,t);return I},xl.prototype.hasLayer=function(e){for(var t=0,i=this.bucketLayerIDs;t<i.length;t+=1)for(var l=0,h=i[t];l<h.length;l+=1)if(e===h[l])return!0;return!1},xl.prototype.getId=function(e,t){var i=e.id;return this.promoteId&&typeof(i=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(i=Number(i)),i},Qe("FeatureIndex",xl,{omit:["rawTileData","sourceLayerCoder"]});var En=function(e,t){this.tileID=e,this.uid=Dt(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};En.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<wr.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},En.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},En.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var l in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(k,P){var D={};if(!P)return D;for(var B=function(){var ee=Q[U],ue=ee.layerIds.map(function(_e){return P.getLayer(_e)}).filter(Boolean);if(ue.length!==0){ee.layers=ue,ee.stateDependentLayerIds&&(ee.stateDependentLayers=ee.stateDependentLayerIds.map(function(_e){return ue.filter(function(be){return be.id===_e})[0]}));for(var ne=0,fe=ue;ne<fe.length;ne+=1)D[fe[ne].id]=ee}},U=0,Q=k;U<Q.length;U+=1)B();return D}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var h=this.buckets[l];if(h instanceof Fr){if(this.hasSymbolBuckets=!0,!i)break;h.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var f in this.buckets){var y=this.buckets[f];if(y instanceof Fr&&y.hasRTLText){this.hasRTLText=!0,di.isLoading()||di.isLoaded()||Vl()!=="deferred"||mo();break}}for(var w in this.queryPadding=0,this.buckets){var I=this.buckets[w];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(w).queryRadius(I))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new a},En.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},En.prototype.getBucket=function(e){return this.buckets[e.id]},En.prototype.upload=function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var l=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new au(e,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new au(e,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)},En.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},En.prototype.queryRenderedFeatures=function(e,t,i,l,h,f,y,w,I,k){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:h,scale:f,tileSize:this.tileSize,pixelPosMatrix:k,transform:w,params:y,queryPadding:this.queryPadding*I},e,t,i):{}},En.prototype.querySourceFeatures=function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var l=i.loadVTLayers(),h=t?t.sourceLayer:"",f=l._geojsonTileLayer||l[h];if(f)for(var y=Bs(t&&t.filter),w=this.tileID.canonical,I=w.z,k=w.x,P=w.y,D={z:I,x:k,y:P},B=0;B<f.length;B++){var U=f.feature(B);if(y.needGeometry){var Q=ui(U,!0);if(!y.filter(new Yt(this.tileID.overscaledZ),Q,this.tileID.canonical))continue}else if(!y.filter(new Yt(this.tileID.overscaledZ),U))continue;var ee=i.getId(U,h),ue=new nh(U,I,k,P,ee);ue.tile=D,e.push(ue)}}},En.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},En.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},En.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=Vr(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var l=Date.now(),h=!1;if(this.expirationTime>l)h=!1;else if(t)if(this.expirationTime<t)h=!0;else{var f=this.expirationTime-t;f?this.expirationTime=l+Math.max(f,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},En.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},En.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var l in this.buckets)if(t.style.hasLayer(l)){var h=this.buckets[l],f=h.layers[0].sourceLayer||"_geojsonTileLayer",y=i[f],w=e[f];if(y&&w&&Object.keys(w).length!==0){h.update(w,y,this.imageAtlas&&this.imageAtlas.patternPositions||{});var I=t&&t.style&&t.style.getLayer(l);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(h)))}}}},En.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},En.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<wr.now()},En.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},En.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=wr.now()+e},En.prototype.setDependencies=function(e,t){for(var i={},l=0,h=t;l<h.length;l+=1)i[h[l]]=!0;this.dependencies[e]=i},En.prototype.hasDependency=function(e,t){for(var i=0,l=e;i<l.length;i+=1){var h=this.dependencies[l[i]];if(h){for(var f=0,y=t;f<y.length;f+=1)if(h[y[f]])return!0}}return!1};var ql=K.performance,Zf=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},ql.mark(this._marks.start)};Zf.prototype.finish=function(){ql.mark(this._marks.end);var e=ql.getEntriesByName(this._marks.measure);return e.length===0&&(ql.measure(this._marks.measure,this._marks.start,this._marks.end),e=ql.getEntriesByName(this._marks.measure),ql.clearMarks(this._marks.start),ql.clearMarks(this._marks.end),ql.clearMeasures(this._marks.measure)),e},s.Actor=Cu,s.AlphaImage=ou,s.CanonicalTileID=lu,s.CollisionBoxArray=a,s.Color=$t,s.DEMData=vl,s.DataConstantProperty=ct,s.DictionaryCoder=ih,s.EXTENT=8192,s.ErrorEvent=le,s.EvaluationParameters=Yt,s.Event=J,s.Evented=ce,s.FeatureIndex=xl,s.FillBucket=zs,s.FillExtrusionBucket=As,s.ImageAtlas=nc,s.ImagePosition=Wc,s.LineBucket=Do,s.LngLat=$r,s.LngLatBounds=tn,s.MercatorCoordinate=su,s.ONE_EM=24,s.OverscaledTileID=rn,s.Point=N,s.Point$1=N,s.Properties=li,s.Protobuf=Kc,s.RGBAImage=Xo,s.RequestManager=bi,s.RequestPerformance=Zf,s.ResourceType=qn,s.SegmentVector=q,s.SourceFeatureState=Mu,s.StructArrayLayout1ui2=Ul,s.StructArrayLayout2f1f2i16=qa,s.StructArrayLayout2i4=Zo,s.StructArrayLayout3ui6=Za,s.StructArrayLayout4i8=Nl,s.SymbolBucket=Fr,s.Texture=au,s.Tile=En,s.Transitionable=ye,s.Uniform1f=Ne,s.Uniform1i=De,s.Uniform2f=Fe,s.Uniform3f=nt,s.Uniform4f=yt,s.UniformColor=vt,s.UniformMatrix4f=or,s.UnwrappedTileID=Uf,s.ValidationError=te,s.WritingMode=Ea,s.ZoomHistory=al,s.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},s.addDynamicAttributes=ap,s.asyncAll=function(e,t,i){if(!e.length)return i(null,[]);var l=e.length,h=new Array(e.length),f=null;e.forEach(function(y,w){t(y,function(I,k){I&&(f=I),h[w]=k,--l==0&&i(f,h)})})},s.bezier=pe,s.bindAll=Er,s.browser=wr,s.cacheEntryPossiblyAdded=function(e){++sn>Yo&&(e.getActor().send("enforceCacheSizeLimit",io),sn=0)},s.clamp=ze,s.clearTileCache=function(e){var t=K.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},s.clipLine=Tf,s.clone=function(e){var t=new ur(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},s.clone$1=qe,s.clone$2=function(e){var t=new ur(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},s.collisionCircleLayout=Fy,s.config=Bt,s.create=function(){var e=new ur(16);return ur!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},s.create$1=function(){var e=new ur(9);return ur!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},s.create$2=function(){var e=new ur(4);return ur!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},s.createCommonjsModule=C,s.createExpression=da,s.createLayout=Zi,s.createStyleLayer=function(e){return e.type==="custom"?new yg(e):new gg[e.type](e)},s.cross=function(e,t,i){var l=t[0],h=t[1],f=t[2],y=i[0],w=i[1],I=i[2];return e[0]=h*I-f*w,e[1]=f*y-l*I,e[2]=l*w-h*y,e},s.deepEqual=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],i[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(var h in t)if(!e(t[h],i[h]))return!1;return!0}return t===i},s.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},s.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},s.ease=Re,s.emitValidationErrors=jo,s.endsWith=hr,s.enforceCacheSizeLimit=function(e){xo(),Pi&&Pi.then(function(t){t.keys().then(function(i){for(var l=0;l<i.length-e;l++)t.delete(i[l])})})},s.evaluateSizeForFeature=vf,s.evaluateSizeForZoom=xf,s.evaluateVariableOffset=zf,s.evented=Fl,s.extend=Ke,s.featureFilter=Bs,s.filterObject=Jt,s.fromRotation=function(e,t){var i=Math.sin(t),l=Math.cos(t);return e[0]=l,e[1]=i,e[2]=0,e[3]=-i,e[4]=l,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},s.getAnchorAlignment=rp,s.getAnchorJustification=op,s.getArrayBuffer=oo,s.getImage=R,s.getJSON=function(e,t){return bo(Ke(e,{type:"json"}),t)},s.getRTLTextPluginStatus=Vl,s.getReferrer=no,s.getVideo=function(e,t){var i,l,h=K.document.createElement("video");h.muted=!0,h.onloadstart=function(){t(null,h)};for(var f=0;f<e.length;f++){var y=K.document.createElement("source");i=e[f],l=void 0,(l=K.document.createElement("a")).href=i,(l.protocol!==K.document.location.protocol||l.host!==K.document.location.host)&&(h.crossOrigin="Anonymous"),y.src=e[f],h.appendChild(y)}return{cancel:function(){}}},s.identity=Mo,s.invert=function(e,t){var i=t[0],l=t[1],h=t[2],f=t[3],y=t[4],w=t[5],I=t[6],k=t[7],P=t[8],D=t[9],B=t[10],U=t[11],Q=t[12],ee=t[13],ue=t[14],ne=t[15],fe=i*w-l*y,_e=i*I-h*y,be=i*k-f*y,Ee=l*I-h*w,Pe=l*k-f*w,Oe=h*k-f*I,We=P*ee-D*Q,gt=P*ue-B*Q,it=P*ne-U*Q,bt=D*ue-B*ee,at=D*ne-U*ee,Wt=B*ne-U*ue,zt=fe*Wt-_e*at+be*bt+Ee*it-Pe*gt+Oe*We;return zt?(e[0]=(w*Wt-I*at+k*bt)*(zt=1/zt),e[1]=(h*at-l*Wt-f*bt)*zt,e[2]=(ee*Oe-ue*Pe+ne*Ee)*zt,e[3]=(B*Pe-D*Oe-U*Ee)*zt,e[4]=(I*it-y*Wt-k*gt)*zt,e[5]=(i*Wt-h*it+f*gt)*zt,e[6]=(ue*be-Q*Oe-ne*_e)*zt,e[7]=(P*Oe-B*be+U*_e)*zt,e[8]=(y*at-w*it+k*We)*zt,e[9]=(l*it-i*at-f*We)*zt,e[10]=(Q*Pe-ee*be+ne*fe)*zt,e[11]=(D*be-P*Pe-U*fe)*zt,e[12]=(w*gt-y*bt-I*We)*zt,e[13]=(i*bt-l*gt+h*We)*zt,e[14]=(ee*_e-Q*Ee-ue*fe)*zt,e[15]=(P*Ee-D*_e+B*fe)*zt,e):null},s.isChar=je,s.isMapboxURL=Ai,s.keysDifference=function(e,t){var i=[];for(var l in e)l in t||i.push(l);return i},s.makeRequest=bo,s.mapObject=Ht,s.mercatorXfromLng=Ff,s.mercatorYfromLat=Vf,s.mercatorZfromAltitude=Nf,s.mul=Zs,s.multiply=Un,s.mvt=wu,s.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},s.normalize=function(e,t){var i=t[0],l=t[1],h=t[2],f=i*i+l*l+h*h;return f>0&&(f=1/Math.sqrt(f)),e[0]=t[0]*f,e[1]=t[1]*f,e[2]=t[2]*f,e},s.number=ii,s.offscreenCanvasSupported=Bo,s.ortho=function(e,t,i,l,h,f,y){var w=1/(t-i),I=1/(l-h),k=1/(f-y);return e[0]=-2*w,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*I,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*k,e[11]=0,e[12]=(t+i)*w,e[13]=(h+l)*I,e[14]=(y+f)*k,e[15]=1,e},s.parseGlyphPBF=function(e){return new Kc(e).readFields(Hy,[])},s.pbf=Kc,s.performSymbolLayout=function(e,t,i,l,h,f,y){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var w=e.layers[0].layout,I=e.layers[0]._unevaluatedLayout._values,k={};if(e.textSizeData.kind==="composite"){var P=e.textSizeData,D=P.maxZoom;k.compositeTextSizes=[I["text-size"].possiblyEvaluate(new Yt(P.minZoom),y),I["text-size"].possiblyEvaluate(new Yt(D),y)]}if(e.iconSizeData.kind==="composite"){var B=e.iconSizeData,U=B.maxZoom;k.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new Yt(B.minZoom),y),I["icon-size"].possiblyEvaluate(new Yt(U),y)]}k.layoutTextSize=I["text-size"].possiblyEvaluate(new Yt(e.zoom+1),y),k.layoutIconSize=I["icon-size"].possiblyEvaluate(new Yt(e.zoom+1),y),k.textMaxSize=I["text-size"].possiblyEvaluate(new Yt(18));for(var Q=24*w.get("text-line-height"),ee=w.get("text-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point",ue=w.get("text-keep-upright"),ne=w.get("text-size"),fe=function(){var Ee=be[_e],Pe=w.get("text-font").evaluate(Ee,{},y).join(","),Oe=ne.evaluate(Ee,{},y),We=k.layoutTextSize.evaluate(Ee,{},y),gt=k.layoutIconSize.evaluate(Ee,{},y),it={horizontal:{},vertical:void 0},bt=Ee.text,at=[0,0];if(bt){var Wt=bt.toString(),zt=24*w.get("text-letter-spacing").evaluate(Ee,{},y),ht=function(ar){for(var Ur=0,Dr=ar;Ur<Dr.length;Ur+=1)if(fr=Dr[Ur].charCodeAt(0),je.Arabic(fr)||je["Arabic Supplement"](fr)||je["Arabic Extended-A"](fr)||je["Arabic Presentation Forms-A"](fr)||je["Arabic Presentation Forms-B"](fr))return!1;var fr;return!0}(Wt)?zt:0,er=w.get("text-anchor").evaluate(Ee,{},y),jt=w.get("text-variable-anchor");if(!jt){var cr=w.get("text-radial-offset").evaluate(Ee,{},y);at=cr?zf(er,[24*cr,np]):w.get("text-offset").evaluate(Ee,{},y).map(function(ar){return 24*ar})}var wt=ee?"center":w.get("text-justify").evaluate(Ee,{},y),xr=w.get("symbol-placement"),ei=xr==="point"?24*w.get("text-max-width").evaluate(Ee,{},y):0,ki=function(){e.allowVerticalPlacement&&_a(Wt)&&(it.vertical=Hc(bt,t,i,h,Pe,ei,Q,er,"left",ht,at,Ea.vertical,!0,xr,We,Oe))};if(!ee&&jt){for(var yi=wt==="auto"?jt.map(function(ar){return op(ar)}):[wt],ti=!1,zi=0;zi<yi.length;zi++){var hn=yi[zi];if(!it.horizontal[hn])if(ti)it.horizontal[hn]=it.horizontal[0];else{var pn=Hc(bt,t,i,h,Pe,ei,Q,"center",hn,ht,at,Ea.horizontal,!1,xr,We,Oe);pn&&(it.horizontal[hn]=pn,ti=pn.positionedLines.length===1)}}ki()}else{wt==="auto"&&(wt=op(er));var go=Hc(bt,t,i,h,Pe,ei,Q,er,wt,ht,at,Ea.horizontal,!1,xr,We,Oe);go&&(it.horizontal[wt]=go),ki(),_a(Wt)&&ee&&ue&&(it.vertical=Hc(bt,t,i,h,Pe,ei,Q,er,wt,ht,at,Ea.vertical,!1,xr,We,Oe))}}var Tn=void 0,_o=!1;if(Ee.icon&&Ee.icon.name){var Oi=l[Ee.icon.name];Oi&&(Tn=function(ar,Ur,Dr){var fr=rp(Dr),Lo=Ur[0]-ar.displaySize[0]*fr.horizontalAlign,eo=Ur[1]-ar.displaySize[1]*fr.verticalAlign;return{image:ar,top:eo,bottom:eo+ar.displaySize[1],left:Lo,right:Lo+ar.displaySize[0]}}(h[Ee.icon.name],w.get("icon-offset").evaluate(Ee,{},y),w.get("icon-anchor").evaluate(Ee,{},y)),_o=Oi.sdf,e.sdfIcons===void 0?e.sdfIcons=Oi.sdf:e.sdfIcons!==Oi.sdf&&At("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Oi.pixelRatio!==e.pixelRatio||w.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var In=Pf(it.horizontal)||it.vertical;e.iconsInText=!!In&&In.iconsInText,(In||Tn)&&function(ar,Ur,Dr,fr,Lo,eo,Jr,Ki,to,br,Gs){var Ta=eo.textMaxSize.evaluate(Ur,{});Ta===void 0&&(Ta=Jr);var Ks,Fi=ar.layers[0].layout,Xs=Fi.get("icon-offset").evaluate(Ur,{},Gs),hs=Pf(Dr.horizontal),Du=Jr/24,uu=ar.tilePixelRatio*Du,Lu=ar.tilePixelRatio*Ta/24,bl=ar.tilePixelRatio*Ki,Ru=ar.tilePixelRatio*Fi.get("symbol-spacing"),oh=Fi.get("text-padding")*ar.tilePixelRatio,Bu=Fi.get("icon-padding")*ar.tilePixelRatio,sc=Fi.get("text-max-angle")/180*Math.PI,ah=Fi.get("text-rotation-alignment")==="map"&&Fi.get("symbol-placement")!=="point",sh=Fi.get("icon-rotation-alignment")==="map"&&Fi.get("symbol-placement")!=="point",wl=Fi.get("symbol-placement"),lc=Ru/2,Ou=Fi.get("icon-text-fit");fr&&Ou!=="none"&&(ar.allowVerticalPlacement&&Dr.vertical&&(Ks=_f(fr,Dr.vertical,Ou,Fi.get("icon-text-fit-padding"),Xs,Du)),hs&&(fr=_f(fr,hs,Ou,Fi.get("icon-text-fit-padding"),Xs,Du)));var Zl=function(vg,yc){yc.x<0||yc.x>=8192||yc.y<0||yc.y>=8192||function(Vi,Ps,xg,Gl,dp,Xf,fh,Ws,dh,gc,mh,yh,mp,Wf,_c,Hf,Jf,Yf,Qf,$f,Ia,gh,ed,Hs,bg){var td,hu,ju,qu,Zu,Gu=Vi.addToLineVertexArray(Ps,xg),rd=0,id=0,nd=0,od=0,yp=-1,gp=-1,Sl={},ad=Y(""),_p=0,vp=0;if(Ws._unevaluatedLayout.getValue("text-radial-offset")===void 0?(_p=(td=Ws.layout.get("text-offset").evaluate(Ia,{},Hs).map(function(xc){return 24*xc}))[0],vp=td[1]):(_p=24*Ws.layout.get("text-radial-offset").evaluate(Ia,{},Hs),vp=np),Vi.allowVerticalPlacement&&Gl.vertical){var sd=Ws.layout.get("text-rotate").evaluate(Ia,{},Hs)+90;qu=new eh(dh,Ps,gc,mh,yh,Gl.vertical,mp,Wf,_c,sd),fh&&(Zu=new eh(dh,Ps,gc,mh,yh,fh,Jf,Yf,_c,sd))}if(dp){var xp=Ws.layout.get("icon-rotate").evaluate(Ia,{}),ld=Ws.layout.get("icon-text-fit")!=="none",ud=If(dp,xp,ed,ld),bp=fh?If(fh,xp,ed,ld):void 0;ju=new eh(dh,Ps,gc,mh,yh,dp,Jf,Yf,!1,xp),rd=4*ud.length;var cd=Vi.iconSizeData,vc=null;cd.kind==="source"?(vc=[128*Ws.layout.get("icon-size").evaluate(Ia,{})])[0]>32640&&At(Vi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):cd.kind==="composite"&&((vc=[128*gh.compositeIconSizes[0].evaluate(Ia,{},Hs),128*gh.compositeIconSizes[1].evaluate(Ia,{},Hs)])[0]>32640||vc[1]>32640)&&At(Vi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Vi.addSymbols(Vi.icon,ud,vc,$f,Qf,Ia,!1,Ps,Gu.lineStartIndex,Gu.lineLength,-1,Hs),yp=Vi.icon.placedSymbolArray.length-1,bp&&(id=4*bp.length,Vi.addSymbols(Vi.icon,bp,vc,$f,Qf,Ia,Ea.vertical,Ps,Gu.lineStartIndex,Gu.lineLength,-1,Hs),gp=Vi.icon.placedSymbolArray.length-1)}for(var hd in Gl.horizontal){var _h=Gl.horizontal[hd];if(!hu){ad=Y(_h.text);var wg=Ws.layout.get("text-rotate").evaluate(Ia,{},Hs);hu=new eh(dh,Ps,gc,mh,yh,_h,mp,Wf,_c,wg)}var pd=_h.positionedLines.length===1;if(nd+=Af(Vi,Ps,_h,Xf,Ws,_c,Ia,Hf,Gu,Gl.vertical?Ea.horizontal:Ea.horizontalOnly,pd?Object.keys(Gl.horizontal):[hd],Sl,yp,gh,Hs),pd)break}Gl.vertical&&(od+=Af(Vi,Ps,Gl.vertical,Xf,Ws,_c,Ia,Hf,Gu,Ea.vertical,["vertical"],Sl,gp,gh,Hs));var Sg=hu?hu.boxStartIndex:Vi.collisionBoxArray.length,Eg=hu?hu.boxEndIndex:Vi.collisionBoxArray.length,Tg=qu?qu.boxStartIndex:Vi.collisionBoxArray.length,Ig=qu?qu.boxEndIndex:Vi.collisionBoxArray.length,kg=ju?ju.boxStartIndex:Vi.collisionBoxArray.length,zg=ju?ju.boxEndIndex:Vi.collisionBoxArray.length,Ag=Zu?Zu.boxStartIndex:Vi.collisionBoxArray.length,Pg=Zu?Zu.boxEndIndex:Vi.collisionBoxArray.length,Js=-1,vh=function(xc,dd){return xc&&xc.circleDiameter?Math.max(xc.circleDiameter,dd):dd};Js=vh(hu,Js),Js=vh(qu,Js),Js=vh(ju,Js);var fd=(Js=vh(Zu,Js))>-1?1:0;fd&&(Js*=bg/24),Vi.glyphOffsetArray.length>=Fr.MAX_GLYPHS&&At("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ia.sortKey!==void 0&&Vi.addToSortKeyRanges(Vi.symbolInstances.length,Ia.sortKey),Vi.symbolInstances.emplaceBack(Ps.x,Ps.y,Sl.right>=0?Sl.right:-1,Sl.center>=0?Sl.center:-1,Sl.left>=0?Sl.left:-1,Sl.vertical||-1,yp,gp,ad,Sg,Eg,Tg,Ig,kg,zg,Ag,Pg,gc,nd,od,rd,id,fd,0,mp,_p,vp,Js)}(ar,yc,vg,Dr,fr,Lo,Ks,ar.layers[0],ar.collisionBoxArray,Ur.index,Ur.sourceLayerIndex,ar.index,uu,oh,ah,to,bl,Bu,sh,Xs,Ur,eo,br,Gs,Jr)};if(wl==="line")for(var Fu=0,lh=Tf(Ur.geometry,0,0,8192,8192);Fu<lh.length;Fu+=1)for(var uh=lh[Fu],uc=0,cc=rg(uh,Ru,sc,Dr.vertical||hs,fr,24,Lu,ar.overscaling,8192);uc<cc.length;uc+=1){var ch=cc[uc];hs&&ag(ar,hs.text,lc,ch)||Zl(uh,ch)}else if(wl==="line-center")for(var hc=0,pc=Ur.geometry;hc<pc.length;hc+=1){var fc=pc[hc];if(fc.length>1){var hh=tg(fc,sc,Dr.vertical||hs,fr,24,Lu);hh&&Zl(fc,hh)}}else if(Ur.type==="Polygon")for(var Vu=0,ph=Yh(Ur.geometry,0);Vu<ph.length;Vu+=1){var Nu=ph[Vu],dc=ng(Nu,16);Zl(Nu[0],new Iu(dc.x,dc.y,0))}else if(Ur.type==="LineString")for(var cu=0,mc=Ur.geometry;cu<mc.length;cu+=1){var Uu=mc[cu];Zl(Uu,new Iu(Uu[0].x,Uu[0].y,0))}else if(Ur.type==="Point")for(var hp=0,Gf=Ur.geometry;hp<Gf.length;hp+=1)for(var pp=0,Kf=Gf[hp];pp<Kf.length;pp+=1){var fp=Kf[pp];Zl([fp],new Iu(fp.x,fp.y,0))}}(e,Ee,it,Tn,l,k,We,gt,at,_o,y)},_e=0,be=e.features;_e<be.length;_e+=1)fe();f&&e.generateCollisionDebugBuffers()},s.perspective=function(e,t,i,l,h){var f,y=1/Math.tan(t/2);return e[0]=y/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,h!=null&&h!==1/0?(e[10]=(h+l)*(f=1/(l-h)),e[14]=2*h*l*f):(e[10]=-1,e[14]=-2*l),e},s.pick=function(e,t){for(var i={},l=0;l<t.length;l++){var h=t[l];h in e&&(i[h]=e[h])}return i},s.plugin=di,s.polygonIntersectsPolygon=ba,s.postMapLoadEvent=ro,s.postTurnstileEvent=Jo,s.potpack=df,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.register=Qe,s.registerForPluginStateChange=function(e){return e({pluginStatus:ai,pluginURL:si}),Fl.on("pluginStateChange",e),e},s.renderColorRamp=Wp,s.rotate=function(e,t,i){var l=t[0],h=t[1],f=t[2],y=t[3],w=Math.sin(i),I=Math.cos(i);return e[0]=l*I+f*w,e[1]=h*I+y*w,e[2]=l*-w+f*I,e[3]=h*-w+y*I,e},s.rotateX=function(e,t,i){var l=Math.sin(i),h=Math.cos(i),f=t[4],y=t[5],w=t[6],I=t[7],k=t[8],P=t[9],D=t[10],B=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=f*h+k*l,e[5]=y*h+P*l,e[6]=w*h+D*l,e[7]=I*h+B*l,e[8]=k*h-f*l,e[9]=P*h-y*l,e[10]=D*h-w*l,e[11]=B*h-I*l,e},s.rotateZ=function(e,t,i){var l=Math.sin(i),h=Math.cos(i),f=t[0],y=t[1],w=t[2],I=t[3],k=t[4],P=t[5],D=t[6],B=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=f*h+k*l,e[1]=y*h+P*l,e[2]=w*h+D*l,e[3]=I*h+B*l,e[4]=k*h-f*l,e[5]=P*h-y*l,e[6]=D*h-w*l,e[7]=B*h-I*l,e},s.scale=function(e,t,i){var l=i[0],h=i[1],f=i[2];return e[0]=t[0]*l,e[1]=t[1]*l,e[2]=t[2]*l,e[3]=t[3]*l,e[4]=t[4]*h,e[5]=t[5]*h,e[6]=t[6]*h,e[7]=t[7]*h,e[8]=t[8]*f,e[9]=t[9]*f,e[10]=t[10]*f,e[11]=t[11]*f,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},s.scale$1=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},s.scale$2=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},s.setCacheLimits=function(e,t){io=e,Yo=t},s.setRTLTextPlugin=function(e,t,i){if(i===void 0&&(i=!1),ai==="deferred"||ai==="loading"||ai==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");si=wr.resolveURL(e),ai="deferred",Ss=t,ul(),i||mo()},s.sphericalToCartesian=function(e){var t=e[0],i=e[1],l=e[2];return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(l),y:t*Math.sin(i)*Math.sin(l),z:t*Math.cos(l)}},s.sqrLen=function(e){var t=e[0],i=e[1];return t*t+i*i},s.styleSpec=O,s.sub=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},s.symbolSize=eg,s.transformMat3=function(e,t,i){var l=t[0],h=t[1],f=t[2];return e[0]=l*i[0]+h*i[3]+f*i[6],e[1]=l*i[1]+h*i[4]+f*i[7],e[2]=l*i[2]+h*i[5]+f*i[8],e},s.transformMat4=ml,s.translate=function(e,t,i){var l,h,f,y,w,I,k,P,D,B,U,Q,ee=i[0],ue=i[1],ne=i[2];return t===e?(e[12]=t[0]*ee+t[4]*ue+t[8]*ne+t[12],e[13]=t[1]*ee+t[5]*ue+t[9]*ne+t[13],e[14]=t[2]*ee+t[6]*ue+t[10]*ne+t[14],e[15]=t[3]*ee+t[7]*ue+t[11]*ne+t[15]):(h=t[1],f=t[2],y=t[3],w=t[4],I=t[5],k=t[6],P=t[7],D=t[8],B=t[9],U=t[10],Q=t[11],e[0]=l=t[0],e[1]=h,e[2]=f,e[3]=y,e[4]=w,e[5]=I,e[6]=k,e[7]=P,e[8]=D,e[9]=B,e[10]=U,e[11]=Q,e[12]=l*ee+w*ue+D*ne+t[12],e[13]=h*ee+I*ue+B*ne+t[13],e[14]=f*ee+k*ue+U*ne+t[14],e[15]=y*ee+P*ue+Q*ne+t[15]),e},s.triggerPluginCompletionEvent=xn,s.uniqueId=Dt,s.validateCustomStyleLayer=function(e){var t=[],i=e.id;return i===void 0&&t.push({message:"layers."+i+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+i+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),t},s.validateLight=Fs,s.validateStyle=ta,s.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},s.vectorTile=wu,s.version="1.13.2",s.warnOnce=At,s.webpSupported=Lr,s.window=K,s.wrap=Ge}),E(["./shared"],function(s){function C(M){var R=typeof M;if(R==="number"||R==="boolean"||R==="string"||M==null)return JSON.stringify(M);if(Array.isArray(M)){for(var F="[",G=0,J=M;G<J.length;G+=1)F+=C(J[G])+",";return F+"]"}for(var le=Object.keys(M).sort(),ce="{",O=0;O<le.length;O++)ce+=JSON.stringify(le[O])+":"+C(M[le[O]])+",";return ce+"}"}function A(M){for(var R="",F=0,G=s.refProperties;F<G.length;F+=1)R+="/"+C(M[G[F]]);return R}var V=function(M){this.keyCache={},M&&this.replace(M)};V.prototype.replace=function(M){this._layerConfigs={},this._layers={},this.update(M,[])},V.prototype.update=function(M,R){for(var F=this,G=0,J=M;G<J.length;G+=1){var le=J[G];this._layerConfigs[le.id]=le;var ce=this._layers[le.id]=s.createStyleLayer(le);ce._featureFilter=s.featureFilter(ce.filter),this.keyCache[le.id]&&delete this.keyCache[le.id]}for(var O=0,te=R;O<te.length;O+=1){var me=te[O];delete this.keyCache[me],delete this._layerConfigs[me],delete this._layers[me]}this.familiesBySource={};for(var Ce=0,Be=function(Ue,Ve){for(var It={},Ye=0;Ye<Ue.length;Ye++){var Ot=Ve&&Ve[Ue[Ye].id]||A(Ue[Ye]);Ve&&(Ve[Ue[Ye].id]=Ot);var sr=It[Ot];sr||(sr=It[Ot]=[]),sr.push(Ue[Ye])}var Ct=[];for(var Qt in It)Ct.push(It[Qt]);return Ct}(s.values(this._layerConfigs),this.keyCache);Ce<Be.length;Ce+=1){var Se=Be[Ce].map(function(Ue){return F._layers[Ue.id]}),Le=Se[0];if(Le.visibility!=="none"){var st=Le.source||"",Xe=this.familiesBySource[st];Xe||(Xe=this.familiesBySource[st]={});var xe=Le.sourceLayer||"_geojsonTileLayer",Je=Xe[xe];Je||(Je=Xe[xe]=[]),Je.push(Se)}}};var N=function(M){var R={},F=[];for(var G in M){var J=M[G],le=R[G]={};for(var ce in J){var O=J[+ce];if(O&&O.bitmap.width!==0&&O.bitmap.height!==0){var te={x:0,y:0,w:O.bitmap.width+2,h:O.bitmap.height+2};F.push(te),le[ce]={rect:te,metrics:O.metrics}}}}var me=s.potpack(F),Ce=new s.AlphaImage({width:me.w||1,height:me.h||1});for(var Be in M){var Se=M[Be];for(var Le in Se){var st=Se[+Le];if(st&&st.bitmap.width!==0&&st.bitmap.height!==0){var Xe=R[Be][Le].rect;s.AlphaImage.copy(st.bitmap,Ce,{x:0,y:0},{x:Xe.x+1,y:Xe.y+1},st.bitmap)}}}this.image=Ce,this.positions=R};s.register("GlyphAtlas",N);var W=function(M){this.tileID=new s.OverscaledTileID(M.tileID.overscaledZ,M.tileID.wrap,M.tileID.canonical.z,M.tileID.canonical.x,M.tileID.canonical.y),this.uid=M.uid,this.zoom=M.zoom,this.pixelRatio=M.pixelRatio,this.tileSize=M.tileSize,this.source=M.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=M.showCollisionBoxes,this.collectResourceTiming=!!M.collectResourceTiming,this.returnDependencies=!!M.returnDependencies,this.promoteId=M.promoteId};function K(M,R,F){for(var G=new s.EvaluationParameters(R),J=0,le=M;J<le.length;J+=1)le[J].recalculate(G,F)}function H(M,R){var F=s.getArrayBuffer(M.request,function(G,J,le,ce){G?R(G):J&&R(null,{vectorTile:new s.vectorTile.VectorTile(new s.pbf(J)),rawData:J,cacheControl:le,expires:ce})});return function(){F.cancel(),R()}}W.prototype.parse=function(M,R,F,G,J){var le=this;this.status="parsing",this.data=M,this.collisionBoxArray=new s.CollisionBoxArray;var ce=new s.DictionaryCoder(Object.keys(M.layers).sort()),O=new s.FeatureIndex(this.tileID,this.promoteId);O.bucketLayerIDs=[];var te,me,Ce,Be,Se={},Le={featureIndex:O,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:F},st=R.familiesBySource[this.source];for(var Xe in st){var xe=M.layers[Xe];if(xe){xe.version===1&&s.warnOnce('Vector tile source "'+this.source+'" layer "'+Xe+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Je=ce.encode(Xe),Ue=[],Ve=0;Ve<xe.length;Ve++){var It=xe.feature(Ve),Ye=O.getId(It,Xe);Ue.push({feature:It,id:Ye,index:Ve,sourceLayerIndex:Je})}for(var Ot=0,sr=st[Xe];Ot<sr.length;Ot+=1){var Ct=sr[Ot],Qt=Ct[0];Qt.minzoom&&this.zoom<Math.floor(Qt.minzoom)||Qt.maxzoom&&this.zoom>=Qt.maxzoom||Qt.visibility!=="none"&&(K(Ct,this.zoom,F),(Se[Qt.id]=Qt.createBucket({index:O.bucketLayerIDs.length,layers:Ct,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Je,sourceID:this.source})).populate(Ue,Le,this.tileID.canonical),O.bucketLayerIDs.push(Ct.map(function(rr){return rr.id})))}}}var Mt=s.mapObject(Le.glyphDependencies,function(rr){return Object.keys(rr).map(Number)});Object.keys(Mt).length?G.send("getGlyphs",{uid:this.uid,stacks:Mt},function(rr,Lt){te||(te=rr,me=Lt,mr.call(le))}):me={};var ri=Object.keys(Le.iconDependencies);ri.length?G.send("getImages",{icons:ri,source:this.source,tileID:this.tileID,type:"icons"},function(rr,Lt){te||(te=rr,Ce=Lt,mr.call(le))}):Ce={};var Kt=Object.keys(Le.patternDependencies);function mr(){if(te)return J(te);if(me&&Ce&&Be){var rr=new N(me),Lt=new s.ImageAtlas(Ce,Be);for(var $t in Se){var Yr=Se[$t];Yr instanceof s.SymbolBucket?(K(Yr.layers,this.zoom,F),s.performSymbolLayout(Yr,me,rr.positions,Ce,Lt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Yr.hasPattern&&(Yr instanceof s.LineBucket||Yr instanceof s.FillBucket||Yr instanceof s.FillExtrusionBucket)&&(K(Yr.layers,this.zoom,F),Yr.addFeatures(Le,this.tileID.canonical,Lt.patternPositions))}this.status="done",J(null,{buckets:s.values(Se).filter(function(ao){return!ao.isEmpty()}),featureIndex:O,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:rr.image,imageAtlas:Lt,glyphMap:this.returnDependencies?me:null,iconMap:this.returnDependencies?Ce:null,glyphPositions:this.returnDependencies?rr.positions:null})}}Kt.length?G.send("getImages",{icons:Kt,source:this.source,tileID:this.tileID,type:"patterns"},function(rr,Lt){te||(te=rr,Be=Lt,mr.call(le))}):Be={},mr.call(this)};var pe=function(M,R,F,G){this.actor=M,this.layerIndex=R,this.availableImages=F,this.loadVectorData=G||H,this.loading={},this.loaded={}};pe.prototype.loadTile=function(M,R){var F=this,G=M.uid;this.loading||(this.loading={});var J=!!(M&&M.request&&M.request.collectResourceTiming)&&new s.RequestPerformance(M.request),le=this.loading[G]=new W(M);le.abort=this.loadVectorData(M,function(ce,O){if(delete F.loading[G],ce||!O)return le.status="done",F.loaded[G]=le,R(ce);var te=O.rawData,me={};O.expires&&(me.expires=O.expires),O.cacheControl&&(me.cacheControl=O.cacheControl);var Ce={};if(J){var Be=J.finish();Be&&(Ce.resourceTiming=JSON.parse(JSON.stringify(Be)))}le.vectorTile=O.vectorTile,le.parse(O.vectorTile,F.layerIndex,F.availableImages,F.actor,function(Se,Le){if(Se||!Le)return R(Se);R(null,s.extend({rawTileData:te.slice(0)},Le,me,Ce))}),F.loaded=F.loaded||{},F.loaded[G]=le})},pe.prototype.reloadTile=function(M,R){var F=this,G=this.loaded,J=M.uid,le=this;if(G&&G[J]){var ce=G[J];ce.showCollisionBoxes=M.showCollisionBoxes;var O=function(te,me){var Ce=ce.reloadCallback;Ce&&(delete ce.reloadCallback,ce.parse(ce.vectorTile,le.layerIndex,F.availableImages,le.actor,Ce)),R(te,me)};ce.status==="parsing"?ce.reloadCallback=O:ce.status==="done"&&(ce.vectorTile?ce.parse(ce.vectorTile,this.layerIndex,this.availableImages,this.actor,O):O())}},pe.prototype.abortTile=function(M,R){var F=this.loading,G=M.uid;F&&F[G]&&F[G].abort&&(F[G].abort(),delete F[G]),R()},pe.prototype.removeTile=function(M,R){var F=this.loaded,G=M.uid;F&&F[G]&&delete F[G],R()};var Re=s.window.ImageBitmap,ze=function(){this.loaded={}};function Ge(M,R){if(M.length!==0){Ke(M[0],R);for(var F=1;F<M.length;F++)Ke(M[F],!R)}}function Ke(M,R){for(var F=0,G=0,J=M.length,le=J-1;G<J;le=G++)F+=(M[G][0]-M[le][0])*(M[le][1]+M[G][1]);F>=0!=!!R&&M.reverse()}ze.prototype.loadTile=function(M,R){var F=M.uid,G=M.encoding,J=M.rawImageData,le=Re&&J instanceof Re?this.getImageData(J):J,ce=new s.DEMData(F,le,G);this.loaded=this.loaded||{},this.loaded[F]=ce,R(null,ce)},ze.prototype.getImageData=function(M){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(M.width,M.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=M.width,this.offscreenCanvas.height=M.height,this.offscreenCanvasContext.drawImage(M,0,0,M.width,M.height);var R=this.offscreenCanvasContext.getImageData(-1,-1,M.width+2,M.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new s.RGBAImage({width:R.width,height:R.height},R.data)},ze.prototype.removeTile=function(M){var R=this.loaded,F=M.uid;R&&R[F]&&delete R[F]};var Nt=s.vectorTile.VectorTileFeature.prototype.toGeoJSON,Dt=function(M){this._feature=M,this.extent=s.EXTENT,this.type=M.type,this.properties=M.tags,"id"in M&&!isNaN(M.id)&&(this.id=parseInt(M.id,10))};Dt.prototype.loadGeometry=function(){if(this._feature.type===1){for(var M=[],R=0,F=this._feature.geometry;R<F.length;R+=1){var G=F[R];M.push([new s.Point$1(G[0],G[1])])}return M}for(var J=[],le=0,ce=this._feature.geometry;le<ce.length;le+=1){for(var O=[],te=0,me=ce[le];te<me.length;te+=1){var Ce=me[te];O.push(new s.Point$1(Ce[0],Ce[1]))}J.push(O)}return J},Dt.prototype.toGeoJSON=function(M,R,F){return Nt.call(this,M,R,F)};var mt=function(M){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=M.length,this._features=M};mt.prototype.feature=function(M){return new Dt(this._features[M])};var He=s.vectorTile.VectorTileFeature,Er=hr;function hr(M,R){this.options=R||{},this.features=M,this.length=M.length}function Ht(M,R){this.id=typeof M.id=="number"?M.id:void 0,this.type=M.type,this.rawGeometry=M.type===1?[M.geometry]:M.geometry,this.properties=M.tags,this.extent=R||4096}hr.prototype.feature=function(M){return new Ht(this.features[M],this.options.extent)},Ht.prototype.loadGeometry=function(){var M=this.rawGeometry;this.geometry=[];for(var R=0;R<M.length;R++){for(var F=M[R],G=[],J=0;J<F.length;J++)G.push(new s.Point$1(F[J][0],F[J][1]));this.geometry.push(G)}return this.geometry},Ht.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var M=this.geometry,R=1/0,F=-1/0,G=1/0,J=-1/0,le=0;le<M.length;le++)for(var ce=M[le],O=0;O<ce.length;O++){var te=ce[O];R=Math.min(R,te.x),F=Math.max(F,te.x),G=Math.min(G,te.y),J=Math.max(J,te.y)}return[R,G,F,J]},Ht.prototype.toGeoJSON=He.prototype.toGeoJSON;var Jt=_r,qe=Er;function _r(M){var R=new s.pbf;return function(F,G){for(var J in F.layers)G.writeMessage(3,At,F.layers[J])}(M,R),R.finish()}function At(M,R){var F;R.writeVarintField(15,M.version||1),R.writeStringField(1,M.name||""),R.writeVarintField(5,M.extent||4096);var G={keys:[],values:[],keycache:{},valuecache:{}};for(F=0;F<M.length;F++)G.feature=M.feature(F),R.writeMessage(2,nr,G);var J=G.keys;for(F=0;F<J.length;F++)R.writeStringField(3,J[F]);var le=G.values;for(F=0;F<le.length;F++)R.writeMessage(4,tr,le[F])}function nr(M,R){var F=M.feature;F.id!==void 0&&R.writeVarintField(1,F.id),R.writeMessage(2,tt,M),R.writeVarintField(3,F.type),R.writeMessage(4,Pt,F)}function tt(M,R){var F=M.feature,G=M.keys,J=M.values,le=M.keycache,ce=M.valuecache;for(var O in F.properties){var te=le[O];te===void 0&&(G.push(O),le[O]=te=G.length-1),R.writeVarint(te);var me=F.properties[O],Ce=typeof me;Ce!=="string"&&Ce!=="boolean"&&Ce!=="number"&&(me=JSON.stringify(me));var Be=Ce+":"+me,Se=ce[Be];Se===void 0&&(J.push(me),ce[Be]=Se=J.length-1),R.writeVarint(Se)}}function pr(M,R){return(R<<3)+(7&M)}function Vr(M){return M<<1^M>>31}function Pt(M,R){for(var F=M.loadGeometry(),G=M.type,J=0,le=0,ce=F.length,O=0;O<ce;O++){var te=F[O],me=1;G===1&&(me=te.length),R.writeVarint(pr(1,me));for(var Ce=G===3?te.length-1:te.length,Be=0;Be<Ce;Be++){Be===1&&G!==1&&R.writeVarint(pr(2,Ce-1));var Se=te[Be].x-J,Le=te[Be].y-le;R.writeVarint(Vr(Se)),R.writeVarint(Vr(Le)),J+=Se,le+=Le}G===3&&R.writeVarint(pr(7,1))}}function tr(M,R){var F=typeof M;F==="string"?R.writeStringField(1,M):F==="boolean"?R.writeBooleanField(7,M):F==="number"&&(M%1!=0?R.writeDoubleField(3,M):M<0?R.writeSVarintField(6,M):R.writeVarintField(5,M))}function rt(M,R,F,G){Ze(M,F,G),Ze(R,2*F,2*G),Ze(R,2*F+1,2*G+1)}function Ze(M,R,F){var G=M[R];M[R]=M[F],M[F]=G}function lr(M,R,F,G){var J=M-F,le=R-G;return J*J+le*le}Jt.fromVectorTileJs=_r,Jt.fromGeojsonVt=function(M,R){R=R||{};var F={};for(var G in M)F[G]=new Er(M[G].features,R),F[G].name=G,F[G].version=R.version,F[G].extent=R.extent;return _r({layers:F})},Jt.GeoJSONWrapper=qe;var Tr=function(M){return M[0]},on=function(M){return M[1]},an=function(M,R,F,G,J){R===void 0&&(R=Tr),F===void 0&&(F=on),G===void 0&&(G=64),J===void 0&&(J=Float64Array),this.nodeSize=G,this.points=M;for(var le=M.length<65536?Uint16Array:Uint32Array,ce=this.ids=new le(M.length),O=this.coords=new J(2*M.length),te=0;te<M.length;te++)ce[te]=te,O[2*te]=R(M[te]),O[2*te+1]=F(M[te]);(function me(Ce,Be,Se,Le,st,Xe){if(!(st-Le<=Se)){var xe=Le+st>>1;(function Je(Ue,Ve,It,Ye,Ot,sr){for(;Ot>Ye;){if(Ot-Ye>600){var Ct=Ot-Ye+1,Qt=It-Ye+1,Mt=Math.log(Ct),ri=.5*Math.exp(2*Mt/3),Kt=.5*Math.sqrt(Mt*ri*(Ct-ri)/Ct)*(Qt-Ct/2<0?-1:1);Je(Ue,Ve,It,Math.max(Ye,Math.floor(It-Qt*ri/Ct+Kt)),Math.min(Ot,Math.floor(It+(Ct-Qt)*ri/Ct+Kt)),sr)}var mr=Ve[2*It+sr],rr=Ye,Lt=Ot;for(rt(Ue,Ve,Ye,It),Ve[2*Ot+sr]>mr&&rt(Ue,Ve,Ye,Ot);rr<Lt;){for(rt(Ue,Ve,rr,Lt),rr++,Lt--;Ve[2*rr+sr]<mr;)rr++;for(;Ve[2*Lt+sr]>mr;)Lt--}Ve[2*Ye+sr]===mr?rt(Ue,Ve,Ye,Lt):rt(Ue,Ve,++Lt,Ot),Lt<=It&&(Ye=Lt+1),It<=Lt&&(Ot=Lt-1)}})(Ce,Be,xe,Le,st,Xe%2),me(Ce,Be,Se,Le,xe-1,Xe+1),me(Ce,Be,Se,xe+1,st,Xe+1)}})(ce,O,G,0,ce.length-1,0)};an.prototype.range=function(M,R,F,G){return function(J,le,ce,O,te,me,Ce){for(var Be,Se,Le=[0,J.length-1,0],st=[];Le.length;){var Xe=Le.pop(),xe=Le.pop(),Je=Le.pop();if(xe-Je<=Ce)for(var Ue=Je;Ue<=xe;Ue++)Se=le[2*Ue+1],(Be=le[2*Ue])>=ce&&Be<=te&&Se>=O&&Se<=me&&st.push(J[Ue]);else{var Ve=Math.floor((Je+xe)/2);Se=le[2*Ve+1],(Be=le[2*Ve])>=ce&&Be<=te&&Se>=O&&Se<=me&&st.push(J[Ve]);var It=(Xe+1)%2;(Xe===0?ce<=Be:O<=Se)&&(Le.push(Je),Le.push(Ve-1),Le.push(It)),(Xe===0?te>=Be:me>=Se)&&(Le.push(Ve+1),Le.push(xe),Le.push(It))}}return st}(this.ids,this.coords,M,R,F,G,this.nodeSize)},an.prototype.within=function(M,R,F){return function(G,J,le,ce,O,te){for(var me=[0,G.length-1,0],Ce=[],Be=O*O;me.length;){var Se=me.pop(),Le=me.pop(),st=me.pop();if(Le-st<=te)for(var Xe=st;Xe<=Le;Xe++)lr(J[2*Xe],J[2*Xe+1],le,ce)<=Be&&Ce.push(G[Xe]);else{var xe=Math.floor((st+Le)/2),Je=J[2*xe],Ue=J[2*xe+1];lr(Je,Ue,le,ce)<=Be&&Ce.push(G[xe]);var Ve=(Se+1)%2;(Se===0?le-O<=Je:ce-O<=Ue)&&(me.push(st),me.push(xe-1),me.push(Ve)),(Se===0?le+O>=Je:ce+O>=Ue)&&(me.push(xe+1),me.push(Le),me.push(Ve))}}return Ce}(this.ids,this.coords,M,R,F,this.nodeSize)};var Ni={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(M){return M}},Xt=function(M){this.options=An(Object.create(Ni),M),this.trees=new Array(this.options.maxZoom+1)};function wr(M,R,F,G,J){return{x:M,y:R,zoom:1/0,id:F,parentId:-1,numPoints:G,properties:J}}function Bt(M,R){var F=M.geometry.coordinates,G=F[1];return{x:zn(F[0]),y:Gt(G),zoom:1/0,index:R,parentId:-1}}function Lr(M){return{type:"Feature",id:M.id,properties:kn(M),geometry:{type:"Point",coordinates:[(G=M.x,360*(G-.5)),(R=M.y,F=(180-360*R)*Math.PI/180,360*Math.atan(Math.exp(F))/Math.PI-90)]}};var R,F,G}function kn(M){var R=M.numPoints,F=R>=1e4?Math.round(R/1e3)+"k":R>=1e3?Math.round(R/100)/10+"k":R;return An(An({},M.properties),{cluster:!0,cluster_id:M.id,point_count:R,point_count_abbreviated:F})}function zn(M){return M/360+.5}function Gt(M){var R=Math.sin(M*Math.PI/180),F=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return F<0?0:F>1?1:F}function An(M,R){for(var F in R)M[F]=R[F];return M}function bi(M){return M.x}function Ai(M){return M.y}function Ro(M,R,F,G,J,le){var ce=J-F,O=le-G;if(ce!==0||O!==0){var te=((M-F)*ce+(R-G)*O)/(ce*ce+O*O);te>1?(F=J,G=le):te>0&&(F+=ce*te,G+=O*te)}return(ce=M-F)*ce+(O=R-G)*O}function Gr(M,R,F,G){var J={id:M===void 0?null:M,type:R,geometry:F,tags:G,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(le){var ce=le.geometry,O=le.type;if(O==="Point"||O==="MultiPoint"||O==="LineString")ci(le,ce);else if(O==="Polygon"||O==="MultiLineString")for(var te=0;te<ce.length;te++)ci(le,ce[te]);else if(O==="MultiPolygon")for(te=0;te<ce.length;te++)for(var me=0;me<ce[te].length;me++)ci(le,ce[te][me])}(J),J}function ci(M,R){for(var F=0;F<R.length;F+=3)M.minX=Math.min(M.minX,R[F]),M.minY=Math.min(M.minY,R[F+1]),M.maxX=Math.max(M.maxX,R[F]),M.maxY=Math.max(M.maxY,R[F+1])}function jr(M,R,F,G){if(R.geometry){var J=R.geometry.coordinates,le=R.geometry.type,ce=Math.pow(F.tolerance/((1<<F.maxZoom)*F.extent),2),O=[],te=R.id;if(F.promoteId?te=R.properties[F.promoteId]:F.generateId&&(te=G||0),le==="Point")Pn(J,O);else if(le==="MultiPoint")for(var me=0;me<J.length;me++)Pn(J[me],O);else if(le==="LineString")Xi(J,O,ce,!1);else if(le==="MultiLineString"){if(F.lineMetrics){for(me=0;me<J.length;me++)Xi(J[me],O=[],ce,!1),M.push(Gr(te,"LineString",O,R.properties));return}Wi(J,O,ce,!1)}else if(le==="Polygon")Wi(J,O,ce,!0);else{if(le!=="MultiPolygon"){if(le==="GeometryCollection"){for(me=0;me<R.geometry.geometries.length;me++)jr(M,{id:te,geometry:R.geometry.geometries[me],properties:R.properties},F,G);return}throw new Error("Input data is not a valid GeoJSON object.")}for(me=0;me<J.length;me++){var Ce=[];Wi(J[me],Ce,ce,!0),O.push(Ce)}}M.push(Gr(te,le,O,R.properties))}}function Pn(M,R){R.push(Pi(M[0])),R.push(Ui(M[1])),R.push(0)}function Xi(M,R,F,G){for(var J,le,ce=0,O=0;O<M.length;O++){var te=Pi(M[O][0]),me=Ui(M[O][1]);R.push(te),R.push(me),R.push(0),O>0&&(ce+=G?(J*me-te*le)/2:Math.sqrt(Math.pow(te-J,2)+Math.pow(me-le,2))),J=te,le=me}var Ce=R.length-3;R[2]=1,function Be(Se,Le,st,Xe){for(var xe,Je=Xe,Ue=st-Le>>1,Ve=st-Le,It=Se[Le],Ye=Se[Le+1],Ot=Se[st],sr=Se[st+1],Ct=Le+3;Ct<st;Ct+=3){var Qt=Ro(Se[Ct],Se[Ct+1],It,Ye,Ot,sr);if(Qt>Je)xe=Ct,Je=Qt;else if(Qt===Je){var Mt=Math.abs(Ct-Ue);Mt<Ve&&(xe=Ct,Ve=Mt)}}Je>Xe&&(xe-Le>3&&Be(Se,Le,xe,Xe),Se[xe+2]=Je,st-xe>3&&Be(Se,xe,st,Xe))}(R,0,Ce,F),R[Ce+2]=1,R.size=Math.abs(ce),R.start=0,R.end=R.size}function Wi(M,R,F,G){for(var J=0;J<M.length;J++){var le=[];Xi(M[J],le,F,G),R.push(le)}}function Pi(M){return M/360+.5}function Ui(M){var R=Math.sin(M*Math.PI/180),F=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return F<0?0:F>1?1:F}function hi(M,R,F,G,J,le,ce,O){if(G/=R,le>=(F/=R)&&ce<G)return M;if(ce<F||le>=G)return null;for(var te=[],me=0;me<M.length;me++){var Ce=M[me],Be=Ce.geometry,Se=Ce.type,Le=J===0?Ce.minX:Ce.minY,st=J===0?Ce.maxX:Ce.maxY;if(Le>=F&&st<G)te.push(Ce);else if(!(st<F||Le>=G)){var Xe=[];if(Se==="Point"||Se==="MultiPoint")vo(Be,Xe,F,G,J);else if(Se==="LineString")Jo(Be,Xe,F,G,J,!1,O.lineMetrics);else if(Se==="MultiLineString")ro(Be,Xe,F,G,J,!1);else if(Se==="Polygon")ro(Be,Xe,F,G,J,!0);else if(Se==="MultiPolygon")for(var xe=0;xe<Be.length;xe++){var Je=[];ro(Be[xe],Je,F,G,J,!0),Je.length&&Xe.push(Je)}if(Xe.length){if(O.lineMetrics&&Se==="LineString"){for(xe=0;xe<Xe.length;xe++)te.push(Gr(Ce.id,Se,Xe[xe],Ce.tags));continue}Se!=="LineString"&&Se!=="MultiLineString"||(Xe.length===1?(Se="LineString",Xe=Xe[0]):Se="MultiLineString"),Se!=="Point"&&Se!=="MultiPoint"||(Se=Xe.length===3?"Point":"MultiPoint"),te.push(Gr(Ce.id,Se,Xe,Ce.tags))}}}return te.length?te:null}function vo(M,R,F,G,J){for(var le=0;le<M.length;le+=3){var ce=M[le+J];ce>=F&&ce<=G&&(R.push(M[le]),R.push(M[le+1]),R.push(M[le+2]))}}function Jo(M,R,F,G,J,le,ce){for(var O,te,me=Cn(M),Ce=J===0?Yo:xo,Be=M.start,Se=0;Se<M.length-3;Se+=3){var Le=M[Se],st=M[Se+1],Xe=M[Se+2],xe=M[Se+3],Je=M[Se+4],Ue=J===0?Le:st,Ve=J===0?xe:Je,It=!1;ce&&(O=Math.sqrt(Math.pow(Le-xe,2)+Math.pow(st-Je,2))),Ue<F?Ve>F&&(te=Ce(me,Le,st,xe,Je,F),ce&&(me.start=Be+O*te)):Ue>G?Ve<G&&(te=Ce(me,Le,st,xe,Je,G),ce&&(me.start=Be+O*te)):io(me,Le,st,Xe),Ve<F&&Ue>=F&&(te=Ce(me,Le,st,xe,Je,F),It=!0),Ve>G&&Ue<=G&&(te=Ce(me,Le,st,xe,Je,G),It=!0),!le&&It&&(ce&&(me.end=Be+O*te),R.push(me),me=Cn(M)),ce&&(Be+=O)}var Ye=M.length-3;Le=M[Ye],st=M[Ye+1],Xe=M[Ye+2],(Ue=J===0?Le:st)>=F&&Ue<=G&&io(me,Le,st,Xe),Ye=me.length-3,le&&Ye>=3&&(me[Ye]!==me[0]||me[Ye+1]!==me[1])&&io(me,me[0],me[1],me[2]),me.length&&R.push(me)}function Cn(M){var R=[];return R.size=M.size,R.start=M.start,R.end=M.end,R}function ro(M,R,F,G,J,le){for(var ce=0;ce<M.length;ce++)Jo(M[ce],R,F,G,J,le,!1)}function io(M,R,F,G){M.push(R),M.push(F),M.push(G)}function Yo(M,R,F,G,J,le){var ce=(le-R)/(G-R);return M.push(le),M.push(F+(J-F)*ce),M.push(1),ce}function xo(M,R,F,G,J,le){var ce=(le-F)/(J-F);return M.push(R+(G-R)*ce),M.push(le),M.push(1),ce}function ji(M,R){for(var F=[],G=0;G<M.length;G++){var J,le=M[G],ce=le.type;if(ce==="Point"||ce==="MultiPoint"||ce==="LineString")J=pi(le.geometry,R);else if(ce==="MultiLineString"||ce==="Polygon"){J=[];for(var O=0;O<le.geometry.length;O++)J.push(pi(le.geometry[O],R))}else if(ce==="MultiPolygon")for(J=[],O=0;O<le.geometry.length;O++){for(var te=[],me=0;me<le.geometry[O].length;me++)te.push(pi(le.geometry[O][me],R));J.push(te)}F.push(Gr(le.id,ce,J,le.tags))}return F}function pi(M,R){var F=[];F.size=M.size,M.start!==void 0&&(F.start=M.start,F.end=M.end);for(var G=0;G<M.length;G+=3)F.push(M[G]+R,M[G+1],M[G+2]);return F}function sn(M,R){if(M.transformed)return M;var F,G,J,le=1<<M.z,ce=M.x,O=M.y;for(F=0;F<M.features.length;F++){var te=M.features[F],me=te.geometry,Ce=te.type;if(te.geometry=[],Ce===1)for(G=0;G<me.length;G+=2)te.geometry.push(Bo(me[G],me[G+1],R,le,ce,O));else for(G=0;G<me.length;G++){var Be=[];for(J=0;J<me[G].length;J+=2)Be.push(Bo(me[G][J],me[G][J+1],R,le,ce,O));te.geometry.push(Be)}}return M.transformed=!0,M}function Bo(M,R,F,G,J,le){return[Math.round(F*(M*G-J)),Math.round(F*(R*G-le))]}function qn(M,R,F,G,J){for(var le=R===J.maxZoom?0:J.tolerance/((1<<R)*J.extent),ce={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:F,y:G,z:R,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},O=0;O<M.length;O++){ce.numFeatures++,Pa(ce,M[O],le,J);var te=M[O].minX,me=M[O].minY,Ce=M[O].maxX,Be=M[O].maxY;te<ce.minX&&(ce.minX=te),me<ce.minY&&(ce.minY=me),Ce>ce.maxX&&(ce.maxX=Ce),Be>ce.maxY&&(ce.maxY=Be)}return ce}function Pa(M,R,F,G){var J=R.geometry,le=R.type,ce=[];if(le==="Point"||le==="MultiPoint")for(var O=0;O<J.length;O+=3)ce.push(J[O]),ce.push(J[O+1]),M.numPoints++,M.numSimplified++;else if(le==="LineString")no(ce,J,M,F,!1,!1);else if(le==="MultiLineString"||le==="Polygon")for(O=0;O<J.length;O++)no(ce,J[O],M,F,le==="Polygon",O===0);else if(le==="MultiPolygon")for(var te=0;te<J.length;te++){var me=J[te];for(O=0;O<me.length;O++)no(ce,me[O],M,F,!0,O===0)}if(ce.length){var Ce=R.tags||null;if(le==="LineString"&&G.lineMetrics){for(var Be in Ce={},R.tags)Ce[Be]=R.tags[Be];Ce.mapbox_clip_start=J.start/J.size,Ce.mapbox_clip_end=J.end/J.size}var Se={geometry:ce,type:le==="Polygon"||le==="MultiPolygon"?3:le==="LineString"||le==="MultiLineString"?2:1,tags:Ce};R.id!==null&&(Se.id=R.id),M.features.push(Se)}}function no(M,R,F,G,J,le){var ce=G*G;if(G>0&&R.size<(J?ce:G))F.numPoints+=R.length/3;else{for(var O=[],te=0;te<R.length;te+=3)(G===0||R[te+2]>ce)&&(F.numSimplified++,O.push(R[te]),O.push(R[te+1])),F.numPoints++;J&&function(me,Ce){for(var Be=0,Se=0,Le=me.length,st=Le-2;Se<Le;st=Se,Se+=2)Be+=(me[Se]-me[st])*(me[Se+1]+me[st+1]);if(Be>0===Ce)for(Se=0,Le=me.length;Se<Le/2;Se+=2){var Xe=me[Se],xe=me[Se+1];me[Se]=me[Le-2-Se],me[Se+1]=me[Le-1-Se],me[Le-2-Se]=Xe,me[Le-1-Se]=xe}}(O,le),M.push(O)}}function qi(M,R){var F=(R=this.options=function(J,le){for(var ce in le)J[ce]=le[ce];return J}(Object.create(this.options),R)).debug;if(F&&console.time("preprocess data"),R.maxZoom<0||R.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(R.promoteId&&R.generateId)throw new Error("promoteId and generateId cannot be used together.");var G=function(J,le){var ce=[];if(J.type==="FeatureCollection")for(var O=0;O<J.features.length;O++)jr(ce,J.features[O],le,O);else jr(ce,J.type==="Feature"?J:{geometry:J},le);return ce}(M,R);this.tiles={},this.tileCoords=[],F&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",R.indexMaxZoom,R.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(G=function(J,le){var ce=le.buffer/le.extent,O=J,te=hi(J,1,-1-ce,ce,0,-1,2,le),me=hi(J,1,1-ce,2+ce,0,-1,2,le);return(te||me)&&(O=hi(J,1,-ce,1+ce,0,-1,2,le)||[],te&&(O=ji(te,1).concat(O)),me&&(O=O.concat(ji(me,-1)))),O}(G,R)).length&&this.splitTile(G,0,0,0),F&&(G.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Hi(M,R,F){return 32*((1<<M)*F+R)+M}function bo(M,R){var F=M.tileID.canonical;if(!this._geoJSONIndex)return R(null,null);var G=this._geoJSONIndex.getTile(F.z,F.x,F.y);if(!G)return R(null,null);var J=new mt(G.features),le=Jt(J);le.byteOffset===0&&le.byteLength===le.buffer.byteLength||(le=new Uint8Array(le)),R(null,{vectorTile:J,rawData:le.buffer})}Xt.prototype.load=function(M){var R=this.options,F=R.log,G=R.minZoom,J=R.maxZoom,le=R.nodeSize;F&&console.time("total time");var ce="prepare "+M.length+" points";F&&console.time(ce),this.points=M;for(var O=[],te=0;te<M.length;te++)M[te].geometry&&O.push(Bt(M[te],te));this.trees[J+1]=new an(O,bi,Ai,le,Float32Array),F&&console.timeEnd(ce);for(var me=J;me>=G;me--){var Ce=+Date.now();O=this._cluster(O,me),this.trees[me]=new an(O,bi,Ai,le,Float32Array),F&&console.log("z%d: %d clusters in %dms",me,O.length,+Date.now()-Ce)}return F&&console.timeEnd("total time"),this},Xt.prototype.getClusters=function(M,R){var F=((M[0]+180)%360+360)%360-180,G=Math.max(-90,Math.min(90,M[1])),J=M[2]===180?180:((M[2]+180)%360+360)%360-180,le=Math.max(-90,Math.min(90,M[3]));if(M[2]-M[0]>=360)F=-180,J=180;else if(F>J){var ce=this.getClusters([F,G,180,le],R),O=this.getClusters([-180,G,J,le],R);return ce.concat(O)}for(var te=this.trees[this._limitZoom(R)],me=[],Ce=0,Be=te.range(zn(F),Gt(le),zn(J),Gt(G));Ce<Be.length;Ce+=1){var Se=te.points[Be[Ce]];me.push(Se.numPoints?Lr(Se):this.points[Se.index])}return me},Xt.prototype.getChildren=function(M){var R=this._getOriginId(M),F=this._getOriginZoom(M),G="No cluster with the specified id.",J=this.trees[F];if(!J)throw new Error(G);var le=J.points[R];if(!le)throw new Error(G);for(var ce=this.options.radius/(this.options.extent*Math.pow(2,F-1)),O=[],te=0,me=J.within(le.x,le.y,ce);te<me.length;te+=1){var Ce=J.points[me[te]];Ce.parentId===M&&O.push(Ce.numPoints?Lr(Ce):this.points[Ce.index])}if(O.length===0)throw new Error(G);return O},Xt.prototype.getLeaves=function(M,R,F){var G=[];return this._appendLeaves(G,M,R=R||10,F=F||0,0),G},Xt.prototype.getTile=function(M,R,F){var G=this.trees[this._limitZoom(M)],J=Math.pow(2,M),le=this.options,ce=le.radius/le.extent,O=(F-ce)/J,te=(F+1+ce)/J,me={features:[]};return this._addTileFeatures(G.range((R-ce)/J,O,(R+1+ce)/J,te),G.points,R,F,J,me),R===0&&this._addTileFeatures(G.range(1-ce/J,O,1,te),G.points,J,F,J,me),R===J-1&&this._addTileFeatures(G.range(0,O,ce/J,te),G.points,-1,F,J,me),me.features.length?me:null},Xt.prototype.getClusterExpansionZoom=function(M){for(var R=this._getOriginZoom(M)-1;R<=this.options.maxZoom;){var F=this.getChildren(M);if(R++,F.length!==1)break;M=F[0].properties.cluster_id}return R},Xt.prototype._appendLeaves=function(M,R,F,G,J){for(var le=0,ce=this.getChildren(R);le<ce.length;le+=1){var O=ce[le],te=O.properties;if(te&&te.cluster?J+te.point_count<=G?J+=te.point_count:J=this._appendLeaves(M,te.cluster_id,F,G,J):J<G?J++:M.push(O),M.length===F)break}return J},Xt.prototype._addTileFeatures=function(M,R,F,G,J,le){for(var ce=0,O=M;ce<O.length;ce+=1){var te=R[O[ce]],me=te.numPoints,Ce={type:1,geometry:[[Math.round(this.options.extent*(te.x*J-F)),Math.round(this.options.extent*(te.y*J-G))]],tags:me?kn(te):this.points[te.index].properties},Be=void 0;me?Be=te.id:this.options.generateId?Be=te.index:this.points[te.index].id&&(Be=this.points[te.index].id),Be!==void 0&&(Ce.id=Be),le.features.push(Ce)}},Xt.prototype._limitZoom=function(M){return Math.max(this.options.minZoom,Math.min(+M,this.options.maxZoom+1))},Xt.prototype._cluster=function(M,R){for(var F=[],G=this.options,J=G.reduce,le=G.minPoints,ce=G.radius/(G.extent*Math.pow(2,R)),O=0;O<M.length;O++){var te=M[O];if(!(te.zoom<=R)){te.zoom=R;for(var me=this.trees[R+1],Ce=me.within(te.x,te.y,ce),Be=te.numPoints||1,Se=Be,Le=0,st=Ce;Le<st.length;Le+=1){var Xe=me.points[st[Le]];Xe.zoom>R&&(Se+=Xe.numPoints||1)}if(Se>=le){for(var xe=te.x*Be,Je=te.y*Be,Ue=J&&Be>1?this._map(te,!0):null,Ve=(O<<5)+(R+1)+this.points.length,It=0,Ye=Ce;It<Ye.length;It+=1){var Ot=me.points[Ye[It]];if(!(Ot.zoom<=R)){Ot.zoom=R;var sr=Ot.numPoints||1;xe+=Ot.x*sr,Je+=Ot.y*sr,Ot.parentId=Ve,J&&(Ue||(Ue=this._map(te,!0)),J(Ue,this._map(Ot)))}}te.parentId=Ve,F.push(wr(xe/Se,Je/Se,Ve,Se,Ue))}else if(F.push(te),Se>1)for(var Ct=0,Qt=Ce;Ct<Qt.length;Ct+=1){var Mt=me.points[Qt[Ct]];Mt.zoom<=R||(Mt.zoom=R,F.push(Mt))}}}return F},Xt.prototype._getOriginId=function(M){return M-this.points.length>>5},Xt.prototype._getOriginZoom=function(M){return(M-this.points.length)%32},Xt.prototype._map=function(M,R){if(M.numPoints)return R?An({},M.properties):M.properties;var F=this.points[M.index].properties,G=this.options.map(F);return R&&G===F?An({},G):G},qi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},qi.prototype.splitTile=function(M,R,F,G,J,le,ce){for(var O=[M,R,F,G],te=this.options,me=te.debug;O.length;){G=O.pop(),F=O.pop(),R=O.pop(),M=O.pop();var Ce=1<<R,Be=Hi(R,F,G),Se=this.tiles[Be];if(!Se&&(me>1&&console.time("creation"),Se=this.tiles[Be]=qn(M,R,F,G,te),this.tileCoords.push({z:R,x:F,y:G}),me)){me>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",R,F,G,Se.numFeatures,Se.numPoints,Se.numSimplified),console.timeEnd("creation"));var Le="z"+R;this.stats[Le]=(this.stats[Le]||0)+1,this.total++}if(Se.source=M,J){if(R===te.maxZoom||R===J)continue;var st=1<<J-R;if(F!==Math.floor(le/st)||G!==Math.floor(ce/st))continue}else if(R===te.indexMaxZoom||Se.numPoints<=te.indexMaxPoints)continue;if(Se.source=null,M.length!==0){me>1&&console.time("clipping");var Xe,xe,Je,Ue,Ve,It,Ye=.5*te.buffer/te.extent,Ot=.5-Ye,sr=.5+Ye,Ct=1+Ye;Xe=xe=Je=Ue=null,Ve=hi(M,Ce,F-Ye,F+sr,0,Se.minX,Se.maxX,te),It=hi(M,Ce,F+Ot,F+Ct,0,Se.minX,Se.maxX,te),M=null,Ve&&(Xe=hi(Ve,Ce,G-Ye,G+sr,1,Se.minY,Se.maxY,te),xe=hi(Ve,Ce,G+Ot,G+Ct,1,Se.minY,Se.maxY,te),Ve=null),It&&(Je=hi(It,Ce,G-Ye,G+sr,1,Se.minY,Se.maxY,te),Ue=hi(It,Ce,G+Ot,G+Ct,1,Se.minY,Se.maxY,te),It=null),me>1&&console.timeEnd("clipping"),O.push(Xe||[],R+1,2*F,2*G),O.push(xe||[],R+1,2*F,2*G+1),O.push(Je||[],R+1,2*F+1,2*G),O.push(Ue||[],R+1,2*F+1,2*G+1)}}},qi.prototype.getTile=function(M,R,F){var G=this.options,J=G.extent,le=G.debug;if(M<0||M>24)return null;var ce=1<<M,O=Hi(M,R=(R%ce+ce)%ce,F);if(this.tiles[O])return sn(this.tiles[O],J);le>1&&console.log("drilling down to z%d-%d-%d",M,R,F);for(var te,me=M,Ce=R,Be=F;!te&&me>0;)me--,Ce=Math.floor(Ce/2),Be=Math.floor(Be/2),te=this.tiles[Hi(me,Ce,Be)];return te&&te.source?(le>1&&console.log("found parent tile z%d-%d-%d",me,Ce,Be),le>1&&console.time("drilling down"),this.splitTile(te.source,me,Ce,Be,M,R,F),le>1&&console.timeEnd("drilling down"),this.tiles[O]?sn(this.tiles[O],J):null):null};var oo=function(M){function R(F,G,J,le){M.call(this,F,G,J,bo),le&&(this.loadGeoJSON=le)}return M&&(R.__proto__=M),(R.prototype=Object.create(M&&M.prototype)).constructor=R,R.prototype.loadData=function(F,G){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=G,this._pendingLoadDataParams=F,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},R.prototype._loadData=function(){var F=this;if(this._pendingCallback&&this._pendingLoadDataParams){var G=this._pendingCallback,J=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var le=!!(J&&J.request&&J.request.collectResourceTiming)&&new s.RequestPerformance(J.request);this.loadGeoJSON(J,function(ce,O){if(ce||!O)return G(ce);if(typeof O!="object")return G(new Error("Input data given to '"+J.source+"' is not a valid GeoJSON object."));(function Se(Le,st){var Xe,xe=Le&&Le.type;if(xe==="FeatureCollection")for(Xe=0;Xe<Le.features.length;Xe++)Se(Le.features[Xe],st);else if(xe==="GeometryCollection")for(Xe=0;Xe<Le.geometries.length;Xe++)Se(Le.geometries[Xe],st);else if(xe==="Feature")Se(Le.geometry,st);else if(xe==="Polygon")Ge(Le.coordinates,st);else if(xe==="MultiPolygon")for(Xe=0;Xe<Le.coordinates.length;Xe++)Ge(Le.coordinates[Xe],st);return Le})(O,!0);try{if(J.filter){var te=s.createExpression(J.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(te.result==="error")throw new Error(te.value.map(function(Se){return Se.key+": "+Se.message}).join(", "));var me=O.features.filter(function(Se){return te.value.evaluate({zoom:0},Se)});O={type:"FeatureCollection",features:me}}F._geoJSONIndex=J.cluster?new Xt(function(Se){var Le=Se.superclusterOptions,st=Se.clusterProperties;if(!st||!Le)return Le;for(var Xe={},xe={},Je={accumulated:null,zoom:0},Ue={properties:null},Ve=Object.keys(st),It=0,Ye=Ve;It<Ye.length;It+=1){var Ot=Ye[It],sr=st[Ot],Ct=sr[0],Qt=s.createExpression(sr[1]),Mt=s.createExpression(typeof Ct=="string"?[Ct,["accumulated"],["get",Ot]]:Ct);Xe[Ot]=Qt.value,xe[Ot]=Mt.value}return Le.map=function(ri){Ue.properties=ri;for(var Kt={},mr=0,rr=Ve;mr<rr.length;mr+=1){var Lt=rr[mr];Kt[Lt]=Xe[Lt].evaluate(Je,Ue)}return Kt},Le.reduce=function(ri,Kt){Ue.properties=Kt;for(var mr=0,rr=Ve;mr<rr.length;mr+=1){var Lt=rr[mr];Je.accumulated=ri[Lt],ri[Lt]=xe[Lt].evaluate(Je,Ue)}},Le}(J)).load(O.features):function(Se,Le){return new qi(Se,Le)}(O,J.geojsonVtOptions)}catch(Se){return G(Se)}F.loaded={};var Ce={};if(le){var Be=le.finish();Be&&(Ce.resourceTiming={},Ce.resourceTiming[J.source]=JSON.parse(JSON.stringify(Be)))}G(null,Ce)})}},R.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},R.prototype.reloadTile=function(F,G){var J=this.loaded;return J&&J[F.uid]?M.prototype.reloadTile.call(this,F,G):this.loadTile(F,G)},R.prototype.loadGeoJSON=function(F,G){if(F.request)s.getJSON(F.request,G);else{if(typeof F.data!="string")return G(new Error("Input data given to '"+F.source+"' is not a valid GeoJSON object."));try{return G(null,JSON.parse(F.data))}catch{return G(new Error("Input data given to '"+F.source+"' is not a valid GeoJSON object."))}}},R.prototype.removeSource=function(F,G){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),G()},R.prototype.getClusterExpansionZoom=function(F,G){try{G(null,this._geoJSONIndex.getClusterExpansionZoom(F.clusterId))}catch(J){G(J)}},R.prototype.getClusterChildren=function(F,G){try{G(null,this._geoJSONIndex.getChildren(F.clusterId))}catch(J){G(J)}},R.prototype.getClusterLeaves=function(F,G){try{G(null,this._geoJSONIndex.getLeaves(F.clusterId,F.limit,F.offset))}catch(J){G(J)}},R}(pe),dr=function(M){var R=this;this.self=M,this.actor=new s.Actor(M,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:pe,geojson:oo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(F,G){if(R.workerSourceTypes[F])throw new Error('Worker source with name "'+F+'" already registered.');R.workerSourceTypes[F]=G},this.self.registerRTLTextPlugin=function(F){if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=F.applyArabicShaping,s.plugin.processBidirectionalText=F.processBidirectionalText,s.plugin.processStyledBidirectionalText=F.processStyledBidirectionalText}};return dr.prototype.setReferrer=function(M,R){this.referrer=R},dr.prototype.setImages=function(M,R,F){for(var G in this.availableImages[M]=R,this.workerSources[M]){var J=this.workerSources[M][G];for(var le in J)J[le].availableImages=R}F()},dr.prototype.setLayers=function(M,R,F){this.getLayerIndex(M).replace(R),F()},dr.prototype.updateLayers=function(M,R,F){this.getLayerIndex(M).update(R.layers,R.removedIds),F()},dr.prototype.loadTile=function(M,R,F){this.getWorkerSource(M,R.type,R.source).loadTile(R,F)},dr.prototype.loadDEMTile=function(M,R,F){this.getDEMWorkerSource(M,R.source).loadTile(R,F)},dr.prototype.reloadTile=function(M,R,F){this.getWorkerSource(M,R.type,R.source).reloadTile(R,F)},dr.prototype.abortTile=function(M,R,F){this.getWorkerSource(M,R.type,R.source).abortTile(R,F)},dr.prototype.removeTile=function(M,R,F){this.getWorkerSource(M,R.type,R.source).removeTile(R,F)},dr.prototype.removeDEMTile=function(M,R){this.getDEMWorkerSource(M,R.source).removeTile(R)},dr.prototype.removeSource=function(M,R,F){if(this.workerSources[M]&&this.workerSources[M][R.type]&&this.workerSources[M][R.type][R.source]){var G=this.workerSources[M][R.type][R.source];delete this.workerSources[M][R.type][R.source],G.removeSource!==void 0?G.removeSource(R,F):F()}},dr.prototype.loadWorkerSource=function(M,R,F){try{this.self.importScripts(R.url),F()}catch(G){F(G.toString())}},dr.prototype.syncRTLPluginState=function(M,R,F){try{s.plugin.setState(R);var G=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&G!=null){this.self.importScripts(G);var J=s.plugin.isParsed();F(J?void 0:new Error("RTL Text Plugin failed to import scripts from "+G),J)}}catch(le){F(le.toString())}},dr.prototype.getAvailableImages=function(M){var R=this.availableImages[M];return R||(R=[]),R},dr.prototype.getLayerIndex=function(M){var R=this.layerIndexes[M];return R||(R=this.layerIndexes[M]=new V),R},dr.prototype.getWorkerSource=function(M,R,F){var G=this;return this.workerSources[M]||(this.workerSources[M]={}),this.workerSources[M][R]||(this.workerSources[M][R]={}),this.workerSources[M][R][F]||(this.workerSources[M][R][F]=new this.workerSourceTypes[R]({send:function(J,le,ce){G.actor.send(J,le,ce,M)}},this.getLayerIndex(M),this.getAvailableImages(M))),this.workerSources[M][R][F]},dr.prototype.getDEMWorkerSource=function(M,R){return this.demWorkerSources[M]||(this.demWorkerSources[M]={}),this.demWorkerSources[M][R]||(this.demWorkerSources[M][R]=new ze),this.demWorkerSources[M][R]},dr.prototype.enforceCacheSizeLimit=function(M,R){s.enforceCacheSizeLimit(R)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new dr(self)),dr}),E(["./shared"],function(s){var C=s.createCommonjsModule(function(n){function a(d){return!o(d)}function o(d){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var x,T,z=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(z);try{T=new Worker(L),x=!0}catch{x=!1}return T&&T.terminate(),URL.revokeObjectURL(L),x}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var x=document.createElement("canvas");x.width=x.height=1;var T=x.getContext("2d");if(!T)return!1;var z=T.getImageData(0,0,1,1);return z&&z.width===x.width}()?(u[_=d&&d.failIfMajorPerformanceCaveat]===void 0&&(u[_]=function(x){var T=function(L){var j=document.createElement("canvas"),q=Object.create(a.webGLContextAttributes);return q.failIfMajorPerformanceCaveat=L,j.probablySupportsContext?j.probablySupportsContext("webgl",q)||j.probablySupportsContext("experimental-webgl",q):j.supportsContext?j.supportsContext("webgl",q)||j.supportsContext("experimental-webgl",q):j.getContext("webgl",q)||j.getContext("experimental-webgl",q)}(x);if(!T)return!1;var z=T.createShader(T.VERTEX_SHADER);return!(!z||T.isContextLost())&&(T.shaderSource(z,"void main() {}"),T.compileShader(z),T.getShaderParameter(z,T.COMPILE_STATUS)===!0)}(_)),u[_]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var _}n.exports?n.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=o);var u={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),A={create:function(n,a,o){var u=s.window.document.createElement(n);return a!==void 0&&(u.className=a),o&&o.appendChild(u),u},createNS:function(n,a){return s.window.document.createElementNS(n,a)}},V=s.window.document&&s.window.document.documentElement.style;function N(n){if(!V)return n[0];for(var a=0;a<n.length;a++)if(n[a]in V)return n[a];return n[0]}var W,K=N(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);A.disableDrag=function(){V&&K&&(W=V[K],V[K]="none")},A.enableDrag=function(){V&&K&&(V[K]=W)};var H=N(["transform","WebkitTransform"]);A.setTransform=function(n,a){n.style[H]=a};var pe=!1;try{var Re=Object.defineProperty({},"passive",{get:function(){pe=!0}});s.window.addEventListener("test",Re,Re),s.window.removeEventListener("test",Re,Re)}catch{pe=!1}A.addEventListener=function(n,a,o,u){u===void 0&&(u={}),n.addEventListener(a,o,"passive"in u&&pe?u:u.capture)},A.removeEventListener=function(n,a,o,u){u===void 0&&(u={}),n.removeEventListener(a,o,"passive"in u&&pe?u:u.capture)};var ze=function(n){n.preventDefault(),n.stopPropagation(),s.window.removeEventListener("click",ze,!0)};function Ge(n){var a=n.userImage;return!!(a&&a.render&&a.render())&&(n.data.replace(new Uint8Array(a.data.buffer)),!0)}A.suppressClick=function(){s.window.addEventListener("click",ze,!0),s.window.setTimeout(function(){s.window.removeEventListener("click",ze,!0)},0)},A.mousePos=function(n,a){var o=n.getBoundingClientRect();return new s.Point(a.clientX-o.left-n.clientLeft,a.clientY-o.top-n.clientTop)},A.touchPos=function(n,a){for(var o=n.getBoundingClientRect(),u=[],d=0;d<a.length;d++)u.push(new s.Point(a[d].clientX-o.left-n.clientLeft,a[d].clientY-o.top-n.clientTop));return u},A.mouseButton=function(n){return s.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},A.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var Ke=function(n){function a(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.isLoaded=function(){return this.loaded},a.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var u=0,d=this.requestors;u<d.length;u+=1){var _=d[u];this._notify(_.ids,_.callback)}this.requestors=[]}},a.prototype.getImage=function(o){return this.images[o]},a.prototype.addImage=function(o,u){this._validate(o,u)&&(this.images[o]=u)},a.prototype._validate=function(o,u){var d=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new s.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),d=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new s.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),d=!1),this._validateContent(u.content,u)||(this.fire(new s.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),d=!1),d},a.prototype._validateStretch=function(o,u){if(!o)return!0;for(var d=0,_=0,x=o;_<x.length;_+=1){var T=x[_];if(T[0]<d||T[1]<T[0]||u<T[1])return!1;d=T[1]}return!0},a.prototype._validateContent=function(o,u){return!(o&&(o.length!==4||o[0]<0||u.data.width<o[0]||o[1]<0||u.data.height<o[1]||o[2]<0||u.data.width<o[2]||o[3]<0||u.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},a.prototype.updateImage=function(o,u){u.version=this.images[o].version+1,this.images[o]=u,this.updatedImages[o]=!0},a.prototype.removeImage=function(o){var u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()},a.prototype.listImages=function(){return Object.keys(this.images)},a.prototype.getImages=function(o,u){var d=!0;if(!this.isLoaded())for(var _=0,x=o;_<x.length;_+=1)this.images[x[_]]||(d=!1);this.isLoaded()||d?this._notify(o,u):this.requestors.push({ids:o,callback:u})},a.prototype._notify=function(o,u){for(var d={},_=0,x=o;_<x.length;_+=1){var T=x[_];this.images[T]||this.fire(new s.Event("styleimagemissing",{id:T}));var z=this.images[T];z?d[T]={data:z.data.clone(),pixelRatio:z.pixelRatio,sdf:z.sdf,version:z.version,stretchX:z.stretchX,stretchY:z.stretchY,content:z.content,hasRenderCallback:Boolean(z.userImage&&z.userImage.render)}:s.warnOnce('Image "'+T+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}u(null,d)},a.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},a.prototype.getPattern=function(o){var u=this.patterns[o],d=this.getImage(o);if(!d)return null;if(u&&u.position.version===d.version)return u.position;if(u)u.position.version=d.version;else{var _={w:d.data.width+2,h:d.data.height+2,x:0,y:0},x=new s.ImagePosition(_,d);this.patterns[o]={bin:_,position:x}}return this._updatePatternAtlas(),this.patterns[o].position},a.prototype.bind=function(o){var u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(o,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)},a.prototype._updatePatternAtlas=function(){var o=[];for(var u in this.patterns)o.push(this.patterns[u].bin);var d=s.potpack(o),_=d.w,x=d.h,T=this.atlasImage;for(var z in T.resize({width:_||1,height:x||1}),this.patterns){var L=this.patterns[z].bin,j=L.x+1,q=L.y+1,Z=this.images[z].data,re=Z.width,$=Z.height;s.RGBAImage.copy(Z,T,{x:0,y:0},{x:j,y:q},{width:re,height:$}),s.RGBAImage.copy(Z,T,{x:0,y:$-1},{x:j,y:q-1},{width:re,height:1}),s.RGBAImage.copy(Z,T,{x:0,y:0},{x:j,y:q+$},{width:re,height:1}),s.RGBAImage.copy(Z,T,{x:re-1,y:0},{x:j-1,y:q},{width:1,height:$}),s.RGBAImage.copy(Z,T,{x:0,y:0},{x:j+re,y:q},{width:1,height:$})}this.dirty=!0},a.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},a.prototype.dispatchRenderCallbacks=function(o){for(var u=0,d=o;u<d.length;u+=1){var _=d[u];if(!this.callbackDispatchedThisFrame[_]){this.callbackDispatchedThisFrame[_]=!0;var x=this.images[_];Ge(x)&&this.updateImage(_,x)}}},a}(s.Evented),Nt=He,Dt=He,mt=1e20;function He(n,a,o,u,d,_){this.fontSize=n||24,this.buffer=a===void 0?3:a,this.cutoff=u||.25,this.fontFamily=d||"sans-serif",this.fontWeight=_||"normal",this.radius=o||8;var x=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=x,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.d=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Int16Array(x),this.middle=Math.round(x/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Er(n,a,o,u,d,_,x){for(var T=0;T<a;T++){for(var z=0;z<o;z++)u[z]=n[z*a+T];for(hr(u,d,_,x,o),z=0;z<o;z++)n[z*a+T]=d[z]}for(z=0;z<o;z++){for(T=0;T<a;T++)u[T]=n[z*a+T];for(hr(u,d,_,x,a),T=0;T<a;T++)n[z*a+T]=Math.sqrt(d[T])}}function hr(n,a,o,u,d){o[0]=0,u[0]=-mt,u[1]=+mt;for(var _=1,x=0;_<d;_++){for(var T=(n[_]+_*_-(n[o[x]]+o[x]*o[x]))/(2*_-2*o[x]);T<=u[x];)x--,T=(n[_]+_*_-(n[o[x]]+o[x]*o[x]))/(2*_-2*o[x]);o[++x]=_,u[x]=T,u[x+1]=+mt}for(_=0,x=0;_<d;_++){for(;u[x+1]<_;)x++;a[_]=(_-o[x])*(_-o[x])+n[o[x]]}}He.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),u=0;u<this.size*this.size;u++){var d=a.data[4*u+3]/255;this.gridOuter[u]=d===1?0:d===0?mt:Math.pow(Math.max(0,.5-d),2),this.gridInner[u]=d===1?mt:d===0?0:Math.pow(Math.max(0,d-.5),2)}for(Er(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Er(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),u=0;u<this.size*this.size;u++)o[u]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[u]-this.gridInner[u])/this.radius+this.cutoff))));return o},Nt.default=Dt;var Ht=function(n,a){this.requestManager=n,this.localIdeographFontFamily=a,this.entries={}};Ht.prototype.setURL=function(n){this.url=n},Ht.prototype.getGlyphs=function(n,a){var o=this,u=[];for(var d in n)for(var _=0,x=n[d];_<x.length;_+=1)u.push({stack:d,id:x[_]});s.asyncAll(u,function(T,z){var L=T.stack,j=T.id,q=o.entries[L];q||(q=o.entries[L]={glyphs:{},requests:{},ranges:{}});var Z=q.glyphs[j];if(Z===void 0){if(Z=o._tinySDF(q,L,j))return q.glyphs[j]=Z,void z(null,{stack:L,id:j,glyph:Z});var re=Math.floor(j/256);if(256*re>65535)z(new Error("glyphs > 65535 not supported"));else if(q.ranges[re])z(null,{stack:L,id:j,glyph:Z});else{var $=q.requests[re];$||($=q.requests[re]=[],Ht.loadGlyphRange(L,re,o.url,o.requestManager,function(se,Y){if(Y){for(var oe in Y)o._doesCharSupportLocalGlyph(+oe)||(q.glyphs[+oe]=Y[+oe]);q.ranges[re]=!0}for(var he=0,ge=$;he<ge.length;he+=1)(0,ge[he])(se,Y);delete q.requests[re]})),$.push(function(se,Y){se?z(se):Y&&z(null,{stack:L,id:j,glyph:Y[j]||null})})}}else z(null,{stack:L,id:j,glyph:Z})},function(T,z){if(T)a(T);else if(z){for(var L={},j=0,q=z;j<q.length;j+=1){var Z=q[j],re=Z.stack,$=Z.id,se=Z.glyph;(L[re]||(L[re]={}))[$]=se&&{id:se.id,bitmap:se.bitmap.clone(),metrics:se.metrics}}a(null,L)}})},Ht.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(s.isChar["CJK Unified Ideographs"](n)||s.isChar["Hangul Syllables"](n)||s.isChar.Hiragana(n)||s.isChar.Katakana(n))},Ht.prototype._tinySDF=function(n,a,o){var u=this.localIdeographFontFamily;if(u&&this._doesCharSupportLocalGlyph(o)){var d=n.tinySDF;if(!d){var _="400";/bold/i.test(a)?_="900":/medium/i.test(a)?_="500":/light/i.test(a)&&(_="200"),d=n.tinySDF=new Ht.TinySDF(24,3,8,.25,u,_)}return{id:o,bitmap:new s.AlphaImage({width:30,height:30},d.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ht.loadGlyphRange=function(n,a,o,u,d){var _=256*a,x=_+255,T=u.transformRequest(u.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",_+"-"+x),s.ResourceType.Glyphs);s.getArrayBuffer(T,function(z,L){if(z)d(z);else if(L){for(var j={},q=0,Z=s.parseGlyphPBF(L);q<Z.length;q+=1){var re=Z[q];j[re.id]=re}d(null,j)}})},Ht.TinySDF=Nt;var Jt=function(){this.specification=s.styleSpec.light.position};Jt.prototype.possiblyEvaluate=function(n,a){return s.sphericalToCartesian(n.expression.evaluate(a))},Jt.prototype.interpolate=function(n,a,o){return{x:s.number(n.x,a.x,o),y:s.number(n.y,a.y,o),z:s.number(n.z,a.z,o)}};var qe=new s.Properties({anchor:new s.DataConstantProperty(s.styleSpec.light.anchor),position:new Jt,color:new s.DataConstantProperty(s.styleSpec.light.color),intensity:new s.DataConstantProperty(s.styleSpec.light.intensity)}),_r=function(n){function a(o){n.call(this),this._transitionable=new s.Transitionable(qe),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getLight=function(){return this._transitionable.serialize()},a.prototype.setLight=function(o,u){if(u===void 0&&(u={}),!this._validate(s.validateLight,o,u))for(var d in o){var _=o[d];s.endsWith(d,"-transition")?this._transitionable.setTransition(d.slice(0,-11),_):this._transitionable.setValue(d,_)}},a.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},a.prototype.hasTransition=function(){return this._transitioning.hasTransition()},a.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},a.prototype._validate=function(o,u,d){return(!d||d.validate!==!1)&&s.emitValidationErrors(this,o.call(s.validateStyle,s.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.styleSpec})))},a}(s.Evented),At=function(n,a){this.width=n,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};At.prototype.getDash=function(n,a){var o=n.join(",")+String(a);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,a)),this.dashEntry[o]},At.prototype.getDashRanges=function(n,a,o){var u=[],d=n.length%2==1?-n[n.length-1]*o:0,_=n[0]*o,x=!0;u.push({left:d,right:_,isDash:x,zeroLength:n[0]===0});for(var T=n[0],z=1;z<n.length;z++){var L=n[z];u.push({left:d=T*o,right:_=(T+=L)*o,isDash:x=!x,zeroLength:L===0})}return u},At.prototype.addRoundDash=function(n,a,o){for(var u=a/2,d=-o;d<=o;d++)for(var _=this.width*(this.nextRow+o+d),x=0,T=n[x],z=0;z<this.width;z++){z/T.right>1&&(T=n[++x]);var L=Math.abs(z-T.left),j=Math.abs(z-T.right),q=Math.min(L,j),Z=void 0,re=d/o*(u+1);if(T.isDash){var $=u-Math.abs(re);Z=Math.sqrt(q*q+$*$)}else Z=u-Math.sqrt(q*q+re*re);this.data[_+z]=Math.max(0,Math.min(255,Z+128))}},At.prototype.addRegularDash=function(n){for(var a=n.length-1;a>=0;--a){var o=n[a],u=n[a+1];o.zeroLength?n.splice(a,1):u&&u.isDash===o.isDash&&(u.left=o.left,n.splice(a,1))}var d=n[0],_=n[n.length-1];d.isDash===_.isDash&&(d.left=_.left-this.width,_.right=d.right+this.width);for(var x=this.width*this.nextRow,T=0,z=n[T],L=0;L<this.width;L++){L/z.right>1&&(z=n[++T]);var j=Math.abs(L-z.left),q=Math.abs(L-z.right),Z=Math.min(j,q);this.data[x+L]=Math.max(0,Math.min(255,(z.isDash?Z:-Z)+128))}},At.prototype.addDash=function(n,a){var o=a?7:0,u=2*o+1;if(this.nextRow+u>this.height)return s.warnOnce("LineAtlas out of space"),null;for(var d=0,_=0;_<n.length;_++)d+=n[_];if(d!==0){var x=this.width/d,T=this.getDashRanges(n,this.width,x);a?this.addRoundDash(T,x,o):this.addRegularDash(T)}var z={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:d};return this.nextRow+=u,this.dirty=!0,z},At.prototype.bind=function(n){var a=n.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var nr=function n(a,o){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=s.uniqueId();for(var u=this.workerPool.acquire(this.id),d=0;d<u.length;d++){var _=new n.Actor(u[d],o,this.id);_.name="Worker "+d,this.actors.push(_)}};function tt(n,a,o){var u=function(d,_){if(d)return o(d);if(_){var x=s.pick(s.extend(_,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);_.vector_layers&&(x.vectorLayers=_.vector_layers,x.vectorLayerIds=x.vectorLayers.map(function(T){return T.id})),x.tiles=a.canonicalizeTileset(x,n.url),o(null,x)}};return n.url?s.getJSON(a.transformRequest(a.normalizeSourceURL(n.url),s.ResourceType.Source),u):s.browser.frame(function(){return u(null,n)})}nr.prototype.broadcast=function(n,a,o){s.asyncAll(this.actors,function(u,d){u.send(n,a,d)},o=o||function(){})},nr.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},nr.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},nr.Actor=s.Actor;var pr=function(n,a,o){this.bounds=s.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=a||0,this.maxzoom=o||24};pr.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},pr.prototype.contains=function(n){var a=Math.pow(2,n.z),o=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*a),u=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*a),d=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*a),_=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*a);return n.x>=o&&n.x<d&&n.y>=u&&n.y<_};var Vr=function(n){function a(o,u,d,_){if(n.call(this),this.id=o,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(u,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=tt(this._options,this.map._requestManager,function(u,d){o._tileJSONRequest=null,o._loaded=!0,u?o.fire(new s.ErrorEvent(u)):d&&(s.extend(o,d),d.bounds&&(o.tileBounds=new pr(d.bounds,o.minzoom,o.maxzoom)),s.postTurnstileEvent(d.tiles,o.map._requestManager._customAccessToken),s.postMapLoadEvent(d.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},a.prototype.setTiles=function(o){var u=this;return this.setSourceProperty(function(){u._options.tiles=o}),this},a.prototype.setUrl=function(o){var u=this;return this.setSourceProperty(function(){u.url=o,u._options.url=o}),this},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return s.extend({},this._options)},a.prototype.loadTile=function(o,u){var d=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(d,s.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function x(T,z){return delete o.request,o.aborted?u(null):T&&T.status!==404?u(T):(z&&z.resourceTiming&&(o.resourceTiming=z.resourceTiming),this.map._refreshExpiredTiles&&z&&o.setExpiryData(z),o.loadVectorData(z,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}_.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=u:o.request=o.actor.send("reloadTile",_,x.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",_,x.bind(this)))},a.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},a.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},a.prototype.hasTransition=function(){return!1},a}(s.Evented),Pt=function(n){function a(o,u,d,_){n.call(this),this.id=o,this.dispatcher=d,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},u),s.extend(this,s.pick(u,["url","scheme","tileSize"]))}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=tt(this._options,this.map._requestManager,function(u,d){o._tileJSONRequest=null,o._loaded=!0,u?o.fire(new s.ErrorEvent(u)):d&&(s.extend(o,d),d.bounds&&(o.tileBounds=new pr(d.bounds,o.minzoom,o.maxzoom)),s.postTurnstileEvent(d.tiles),s.postMapLoadEvent(d.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return s.extend({},this._options)},a.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},a.prototype.loadTile=function(o,u){var d=this,_=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=s.getImage(this.map._requestManager.transformRequest(_,s.ResourceType.Tile),function(x,T){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(x)o.state="errored",u(x);else if(T){d.map._refreshExpiredTiles&&o.setExpiryData(T),delete T.cacheControl,delete T.expires;var z=d.map.painter.context,L=z.gl;o.texture=d.map.painter.getTileTexture(T.width),o.texture?o.texture.update(T,{useMipmap:!0}):(o.texture=new s.Texture(z,T,L.RGBA,{useMipmap:!0}),o.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),z.extTextureFilterAnisotropic&&L.texParameterf(L.TEXTURE_2D,z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,z.extTextureFilterAnisotropicMax)),o.state="loaded",s.cacheEntryPossiblyAdded(d.dispatcher),u(null)}})},a.prototype.abortTile=function(o,u){o.request&&(o.request.cancel(),delete o.request),u()},a.prototype.unloadTile=function(o,u){o.texture&&this.map.painter.saveTileTexture(o.texture),u()},a.prototype.hasTransition=function(){return!1},a}(s.Evented),tr=function(n){function a(o,u,d,_){n.call(this,o,u,d,_),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},a.prototype.loadTile=function(o,u){var d=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function _(x,T){x&&(o.state="errored",u(x)),T&&(o.dem=T,o.needsHillshadePrepare=!0,o.state="loaded",u(null))}o.request=s.getImage(this.map._requestManager.transformRequest(d,s.ResourceType.Tile),function(x,T){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(x)o.state="errored",u(x);else if(T){this.map._refreshExpiredTiles&&o.setExpiryData(T),delete T.cacheControl,delete T.expires;var z=s.window.ImageBitmap&&T instanceof s.window.ImageBitmap&&s.offscreenCanvasSupported()?T:s.browser.getImageData(T,1),L={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:z,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",L,_.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},a.prototype._getNeighboringTiles=function(o){var u=o.canonical,d=Math.pow(2,u.z),_=(u.x-1+d)%d,x=u.x===0?o.wrap-1:o.wrap,T=(u.x+1+d)%d,z=u.x+1===d?o.wrap+1:o.wrap,L={};return L[new s.OverscaledTileID(o.overscaledZ,x,u.z,_,u.y).key]={backfilled:!1},L[new s.OverscaledTileID(o.overscaledZ,z,u.z,T,u.y).key]={backfilled:!1},u.y>0&&(L[new s.OverscaledTileID(o.overscaledZ,x,u.z,_,u.y-1).key]={backfilled:!1},L[new s.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},L[new s.OverscaledTileID(o.overscaledZ,z,u.z,T,u.y-1).key]={backfilled:!1}),u.y+1<d&&(L[new s.OverscaledTileID(o.overscaledZ,x,u.z,_,u.y+1).key]={backfilled:!1},L[new s.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},L[new s.OverscaledTileID(o.overscaledZ,z,u.z,T,u.y+1).key]={backfilled:!1}),L},a.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},a}(Pt),rt=function(n){function a(o,u,d,_){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(_),this._data=u.data,this._options=s.extend({},u),this._collectResourceTiming=u.collectResourceTiming,this._resourceTiming=[],u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;var x=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*x,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*x,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?Math.min(u.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:s.EXTENT,radius:(u.clusterRadius||50)*x,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this.fire(new s.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(u){if(u)o.fire(new s.ErrorEvent(u));else{var d={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(d.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new s.Event("data",d))}})},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setData=function(o){var u=this;return this._data=o,this.fire(new s.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(d){if(d)u.fire(new s.ErrorEvent(d));else{var _={dataType:"source",sourceDataType:"content"};u._collectResourceTiming&&u._resourceTiming&&u._resourceTiming.length>0&&(_.resourceTiming=u._resourceTiming,u._resourceTiming=[]),u.fire(new s.Event("data",_))}}),this},a.prototype.getClusterExpansionZoom=function(o,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},u),this},a.prototype.getClusterChildren=function(o,u){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},u),this},a.prototype.getClusterLeaves=function(o,u,d,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:u,offset:d},_),this},a.prototype._updateWorkerData=function(o){var u=this;this._loaded=!1;var d=s.extend({},this.workerOptions),_=this._data;typeof _=="string"?(d.request=this.map._requestManager.transformRequest(s.browser.resolveURL(_),s.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(_),this.actor.send(this.type+".loadData",d,function(x,T){u._removed||T&&T.abandoned||(u._loaded=!0,T&&T.resourceTiming&&T.resourceTiming[u.id]&&(u._resourceTiming=T.resourceTiming[u.id].slice(0)),u.actor.send(u.type+".coalesce",{source:d.source},null),o(x))})},a.prototype.loaded=function(){return this._loaded},a.prototype.loadTile=function(o,u){var d=this,_=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(_,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(x,T){return delete o.request,o.unloadVectorData(),o.aborted?u(null):x?u(x):(o.loadVectorData(T,d.map.painter,_==="reloadTile"),u(null))})},a.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},a.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},a.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},a.prototype.serialize=function(){return s.extend({},this._options,{type:this.type,data:this._data})},a.prototype.hasTransition=function(){return!1},a}(s.Evented),Ze=s.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),lr=function(n){function a(o,u,d,_){n.call(this),this.id=o,this.dispatcher=d,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=u}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(o,u){var d=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),function(_,x){d._loaded=!0,_?d.fire(new s.ErrorEvent(_)):x&&(d.image=x,o&&(d.coordinates=o),u&&u(),d._finishLoading())})},a.prototype.loaded=function(){return this._loaded},a.prototype.updateImage=function(o){var u=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){u.texture=null}),this):this},a.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setCoordinates=function(o){var u=this;this.coordinates=o;var d=o.map(s.MercatorCoordinate.fromLngLat);this.tileID=function(x){for(var T=1/0,z=1/0,L=-1/0,j=-1/0,q=0,Z=x;q<Z.length;q+=1){var re=Z[q];T=Math.min(T,re.x),z=Math.min(z,re.y),L=Math.max(L,re.x),j=Math.max(j,re.y)}var $=Math.max(L-T,j-z),se=Math.max(0,Math.floor(-Math.log($)/Math.LN2)),Y=Math.pow(2,se);return new s.CanonicalTileID(se,Math.floor((T+L)/2*Y),Math.floor((z+j)/2*Y))}(d),this.minzoom=this.maxzoom=this.tileID.z;var _=d.map(function(x){return u.tileID.getTilePoint(x)._round()});return this._boundsArray=new s.StructArrayLayout4i8,this._boundsArray.emplaceBack(_[0].x,_[0].y,0,0),this._boundsArray.emplaceBack(_[1].x,_[1].y,s.EXTENT,0),this._boundsArray.emplaceBack(_[3].x,_[3].y,0,s.EXTENT),this._boundsArray.emplaceBack(_[2].x,_[2].y,s.EXTENT,s.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this},a.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var o=this.map.painter.context,u=o.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ze.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new s.Texture(o,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var _=this.tiles[d];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}},a.prototype.loadTile=function(o,u){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},u(null)):(o.state="errored",u(null))},a.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return!1},a}(s.Evented),Tr=function(n){function a(o,u,d,_){n.call(this,o,u,d,_),this.roundZoom=!0,this.type="video",this.options=u}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1;var u=this.options;this.urls=[];for(var d=0,_=u.urls;d<_.length;d+=1)this.urls.push(this.map._requestManager.transformRequest(_[d],s.ResourceType.Source).url);s.getVideo(this.urls,function(x,T){o._loaded=!0,x?o.fire(new s.ErrorEvent(x)):T&&(o.video=T,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},a.prototype.pause=function(){this.video&&this.video.pause()},a.prototype.play=function(){this.video&&this.video.play()},a.prototype.seek=function(o){if(this.video){var u=this.video.seekable;o<u.start(0)||o>u.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+u.start(0)+" and "+u.end(0)+"-second mark."))):this.video.currentTime=o}},a.prototype.getVideo=function(){return this.video},a.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},a.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var o=this.map.painter.context,u=o.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ze.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(o,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var _=this.tiles[d];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this.video&&!this.video.paused},a}(lr),on=function(n){function a(o,u,d,_){n.call(this,o,u,d,_),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(function(x){return!Array.isArray(x)||x.length!==2||x.some(function(T){return typeof T!="number"})})||this.fire(new s.ErrorEvent(new s.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError("sources."+o,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},a.prototype.getCanvas=function(){return this.canvas},a.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},a.prototype.onRemove=function(){this.pause()},a.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var u=this.map.painter.context,d=u.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,Ze.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(u,this.canvas,d.RGBA,{premultiply:!0}),this.tiles){var x=this.tiles[_];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this._playing},a.prototype._hasInvalidDimensions=function(){for(var o=0,u=[this.canvas.width,this.canvas.height];o<u.length;o+=1){var d=u[o];if(isNaN(d)||d<=0)return!0}return!1},a}(lr),an={vector:Vr,raster:Pt,"raster-dem":tr,geojson:rt,video:Tr,image:lr,canvas:on};function Ni(n,a){var o=s.identity([]);return s.translate(o,o,[1,1,0]),s.scale(o,o,[.5*n.width,.5*n.height,1]),s.multiply(o,o,n.calculatePosMatrix(a.toUnwrapped()))}function Xt(n,a,o,u,d,_){var x=function(se,Y,oe){if(se)for(var he=0,ge=se;he<ge.length;he+=1){var Te=Y[ge[he]];if(Te&&Te.source===oe&&Te.type==="fill-extrusion")return!0}else for(var ve in Y){var Ae=Y[ve];if(Ae.source===oe&&Ae.type==="fill-extrusion")return!0}return!1}(d&&d.layers,a,n.id),T=_.maxPitchScaleFactor(),z=n.tilesIn(u,T,x);z.sort(wr);for(var L=[],j=0,q=z;j<q.length;j+=1){var Z=q[j];L.push({wrappedTileID:Z.tileID.wrapped().key,queryResults:Z.tile.queryRenderedFeatures(a,o,n._state,Z.queryGeometry,Z.cameraQueryGeometry,Z.scale,d,_,T,Ni(n.transform,Z.tileID))})}var re=function(se){for(var Y={},oe={},he=0,ge=se;he<ge.length;he+=1){var Te=ge[he],ve=Te.queryResults,Ae=Te.wrappedTileID,De=oe[Ae]=oe[Ae]||{};for(var Ne in ve)for(var Fe=ve[Ne],nt=De[Ne]=De[Ne]||{},yt=Y[Ne]=Y[Ne]||[],vt=0,_t=Fe;vt<_t.length;vt+=1){var or=_t[vt];nt[or.featureIndex]||(nt[or.featureIndex]=!0,yt.push(or))}}return Y}(L);for(var $ in re)re[$].forEach(function(se){var Y=se.feature,oe=n.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=oe});return re}function wr(n,a){var o=n.tileID,u=a.tileID;return o.overscaledZ-u.overscaledZ||o.canonical.y-u.canonical.y||o.wrap-u.wrap||o.canonical.x-u.canonical.x}var Bt=function(n,a){this.max=n,this.onRemove=a,this.reset()};Bt.prototype.reset=function(){for(var n in this.data)for(var a=0,o=this.data[n];a<o.length;a+=1){var u=o[a];u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value)}return this.data={},this.order=[],this},Bt.prototype.add=function(n,a,o){var u=this,d=n.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);var _={value:a,timeout:void 0};if(o!==void 0&&(_.timeout=setTimeout(function(){u.remove(n,_)},o)),this.data[d].push(_),this.order.push(d),this.order.length>this.max){var x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this},Bt.prototype.has=function(n){return n.wrapped().key in this.data},Bt.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},Bt.prototype._getAndRemoveByKey=function(n){var a=this.data[n].shift();return a.timeout&&clearTimeout(a.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),a.value},Bt.prototype.getByKey=function(n){var a=this.data[n];return a?a[0].value:null},Bt.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},Bt.prototype.remove=function(n,a){if(!this.has(n))return this;var o=n.wrapped().key,u=a===void 0?0:this.data[o].indexOf(a),d=this.data[o][u];return this.data[o].splice(u,1),d.timeout&&clearTimeout(d.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(d.value),this.order.splice(this.order.indexOf(o),1),this},Bt.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},Bt.prototype.filter=function(n){var a=[];for(var o in this.data)for(var u=0,d=this.data[o];u<d.length;u+=1){var _=d[u];n(_.value)||a.push(_)}for(var x=0,T=a;x<T.length;x+=1){var z=T[x];this.remove(z.value.tileID,z)}};var Lr=function(n,a,o){this.context=n;var u=n.gl;this.buffer=u.createBuffer(),this.dynamicDraw=Boolean(o),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer};Lr.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Lr.prototype.updateData=function(n){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},Lr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var kn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},zn=function(n,a,o,u){this.length=a.length,this.attributes=o,this.itemSize=a.bytesPerElement,this.dynamicDraw=u,this.context=n;var d=n.gl;this.buffer=d.createBuffer(),n.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer};zn.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},zn.prototype.updateData=function(n){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,n.arrayBuffer)},zn.prototype.enableAttributes=function(n,a){for(var o=0;o<this.attributes.length;o++){var u=a.attributes[this.attributes[o].name];u!==void 0&&n.enableVertexAttribArray(u)}},zn.prototype.setVertexAttribPointers=function(n,a,o){for(var u=0;u<this.attributes.length;u++){var d=this.attributes[u],_=a.attributes[d.name];_!==void 0&&n.vertexAttribPointer(_,d.components,n[kn[d.type]],!1,this.itemSize,d.offset+this.itemSize*(o||0))}},zn.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Gt=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Gt.prototype.get=function(){return this.current},Gt.prototype.set=function(n){},Gt.prototype.getDefault=function(){return this.default},Gt.prototype.setDefault=function(){this.set(this.default)};var An=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return s.Color.transparent},a.prototype.set=function(o){var u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},a}(Gt),bi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},a}(Gt),Ai=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},a}(Gt),Ro=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},a}(Gt),Gr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},a}(Gt),ci=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},a}(Gt),jr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(o){var u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},a}(Gt),Pn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},a.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},a}(Gt),Xi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}},a}(Gt),Wi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},a}(Gt),Pi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}},a}(Gt),Ui=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},a}(Gt),hi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}},a}(Gt),vo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},a.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},a}(Gt),Jo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return s.Color.transparent},a.prototype.set=function(o){var u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},a}(Gt),Cn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},a}(Gt),ro=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}},a}(Gt),io=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},a}(Gt),Yo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},a}(Gt),xo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},a}(Gt),ji=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},a}(Gt),pi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},a.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},a}(Gt),sn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},a}(Gt),Bo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}},a}(Gt),qn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}},a}(Gt),Pa=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},a}(Gt),no=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){var u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},a}(Gt),qi=function(n){function a(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},a}(Gt),Hi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},a}(Gt),bo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},a}(Gt),oo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},a}(Gt),dr=function(n){function a(o,u){n.call(this,o),this.context=o,this.parent=u}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a}(Gt),M=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},a}(dr),R=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}},a}(dr),F=function(n,a,o,u){this.context=n,this.width=a,this.height=o;var d=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new M(n,d),u&&(this.depthAttachment=new R(n,d))};F.prototype.destroy=function(){var n=this.context.gl,a=this.colorAttachment.get();if(a&&n.deleteTexture(a),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var G=function(n,a,o){this.func=n,this.mask=a,this.range=o};G.ReadOnly=!1,G.ReadWrite=!0,G.disabled=new G(519,G.ReadOnly,[0,1]);var J=function(n,a,o,u,d,_){this.test=n,this.ref=a,this.mask=o,this.fail=u,this.depthFail=d,this.pass=_};J.disabled=new J({func:519,mask:0},0,0,7680,7680,7680);var le=function(n,a,o){this.blendFunction=n,this.blendColor=a,this.mask=o};le.disabled=new le(le.Replace=[1,0],s.Color.transparent,[!1,!1,!1,!1]),le.unblended=new le(le.Replace,s.Color.transparent,[!0,!0,!0,!0]),le.alphaBlended=new le([1,771],s.Color.transparent,[!0,!0,!0,!0]);var ce=function(n,a,o){this.enable=n,this.mode=a,this.frontFace=o};ce.disabled=new ce(!1,1029,2305),ce.backCCW=new ce(!0,1029,2305);var O=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new An(this),this.clearDepth=new bi(this),this.clearStencil=new Ai(this),this.colorMask=new Ro(this),this.depthMask=new Gr(this),this.stencilMask=new ci(this),this.stencilFunc=new jr(this),this.stencilOp=new Pn(this),this.stencilTest=new Xi(this),this.depthRange=new Wi(this),this.depthTest=new Pi(this),this.depthFunc=new Ui(this),this.blend=new hi(this),this.blendFunc=new vo(this),this.blendColor=new Jo(this),this.blendEquation=new Cn(this),this.cullFace=new ro(this),this.cullFaceSide=new io(this),this.frontFace=new Yo(this),this.program=new xo(this),this.activeTexture=new ji(this),this.viewport=new pi(this),this.bindFramebuffer=new sn(this),this.bindRenderbuffer=new Bo(this),this.bindTexture=new qn(this),this.bindVertexBuffer=new Pa(this),this.bindElementBuffer=new no(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new qi(this),this.pixelStoreUnpack=new Hi(this),this.pixelStoreUnpackPremultiplyAlpha=new bo(this),this.pixelStoreUnpackFlipY=new oo(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};O.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},O.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},O.prototype.createIndexBuffer=function(n,a){return new Lr(this,n,a)},O.prototype.createVertexBuffer=function(n,a,o){return new zn(this,n,a,o)},O.prototype.createRenderbuffer=function(n,a,o){var u=this.gl,d=u.createRenderbuffer();return this.bindRenderbuffer.set(d),u.renderbufferStorage(u.RENDERBUFFER,n,a,o),this.bindRenderbuffer.set(null),d},O.prototype.createFramebuffer=function(n,a,o){return new F(this,n,a,o)},O.prototype.clear=function(n){var a=n.color,o=n.depth,u=this.gl,d=0;a&&(d|=u.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(d|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),u.clear(d)},O.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},O.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},O.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},O.prototype.setColorMode=function(n){s.deepEqual(n.blendFunction,le.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},O.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var te=function(n){function a(o,u,d){var _=this;n.call(this),this.id=o,this.dispatcher=d,this.on("data",function(x){x.dataType==="source"&&x.sourceDataType==="metadata"&&(_._sourceLoaded=!0),_._sourceLoaded&&!_._paused&&x.dataType==="source"&&x.sourceDataType==="content"&&(_.reload(),_.transform&&_.update(_.transform))}),this.on("error",function(){_._sourceErrored=!0}),this._source=function(x,T,z,L){var j=new an[T.type](x,T,z,L);if(j.id!==x)throw new Error("Expected Source id to be "+x+" instead of "+j.id);return s.bindAll(["load","abort","unload","serialize","prepare"],j),j}(o,u,d,this),this._tiles={},this._cache=new Bt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new s.SourceFeatureState}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},a.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},a.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var u=this._tiles[o];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0},a.prototype.getSource=function(){return this._source},a.prototype.pause=function(){this._paused=!0},a.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},a.prototype._loadTile=function(o,u){return this._source.loadTile(o,u)},a.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},a.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},a.prototype.serialize=function(){return this._source.serialize()},a.prototype.prepare=function(o){for(var u in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var d=this._tiles[u];d.upload(o),d.prepare(this.map.style.imageManager)}},a.prototype.getIds=function(){return s.values(this._tiles).map(function(o){return o.tileID}).sort(me).map(function(o){return o.key})},a.prototype.getRenderableIds=function(o){var u=this,d=[];for(var _ in this._tiles)this._isIdRenderable(_,o)&&d.push(this._tiles[_]);return o?d.sort(function(x,T){var z=x.tileID,L=T.tileID,j=new s.Point(z.canonical.x,z.canonical.y)._rotate(u.transform.angle),q=new s.Point(L.canonical.x,L.canonical.y)._rotate(u.transform.angle);return z.overscaledZ-L.overscaledZ||q.y-j.y||q.x-j.x}).map(function(x){return x.tileID.key}):d.map(function(x){return x.tileID}).sort(me).map(function(x){return x.key})},a.prototype.hasRenderableParent=function(o){var u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)},a.prototype._isIdRenderable=function(o,u){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())},a.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")},a.prototype._reloadTile=function(o,u){var d=this._tiles[o];d&&(d.state!=="loading"&&(d.state=u),this._loadTile(d,this._tileLoaded.bind(this,d,o,u)))},a.prototype._tileLoaded=function(o,u,d,_){if(_)return o.state="errored",void(_.status!==404?this._source.fire(new s.ErrorEvent(_,{tile:o})):this.update(this.transform));o.timeAdded=s.browser.now(),d==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new s.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},a.prototype._backfillDEM=function(o){for(var u=this.getRenderableIds(),d=0;d<u.length;d++){var _=u[d];if(o.neighboringTiles&&o.neighboringTiles[_]){var x=this.getTileByID(_);T(o,x),T(x,o)}}function T(z,L){z.needsHillshadePrepare=!0;var j=L.tileID.canonical.x-z.tileID.canonical.x,q=L.tileID.canonical.y-z.tileID.canonical.y,Z=Math.pow(2,z.tileID.canonical.z),re=L.tileID.key;j===0&&q===0||Math.abs(q)>1||(Math.abs(j)>1&&(Math.abs(j+Z)===1?j+=Z:Math.abs(j-Z)===1&&(j-=Z)),L.dem&&z.dem&&(z.dem.backfillBorder(L.dem,j,q),z.neighboringTiles&&z.neighboringTiles[re]&&(z.neighboringTiles[re].backfilled=!0)))}},a.prototype.getTile=function(o){return this.getTileByID(o.key)},a.prototype.getTileByID=function(o){return this._tiles[o]},a.prototype._retainLoadedChildren=function(o,u,d,_){for(var x in this._tiles){var T=this._tiles[x];if(!(_[x]||!T.hasData()||T.tileID.overscaledZ<=u||T.tileID.overscaledZ>d)){for(var z=T.tileID;T&&T.tileID.overscaledZ>u+1;){var L=T.tileID.scaledTo(T.tileID.overscaledZ-1);(T=this._tiles[L.key])&&T.hasData()&&(z=L)}for(var j=z;j.overscaledZ>u;)if(o[(j=j.scaledTo(j.overscaledZ-1)).key]){_[z.key]=z;break}}}},a.prototype.findLoadedParent=function(o,u){if(o.key in this._loadedParentTiles){var d=this._loadedParentTiles[o.key];return d&&d.tileID.overscaledZ>=u?d:null}for(var _=o.overscaledZ-1;_>=u;_--){var x=o.scaledTo(_),T=this._getLoadedTile(x);if(T)return T}},a.prototype._getLoadedTile=function(o){var u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(o.wrapped().key)},a.prototype.updateCacheSize=function(o){var u=Math.ceil(o.width/this._source.tileSize)+1,d=Math.ceil(o.height/this._source.tileSize)+1,_=Math.floor(u*d*5),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(x)},a.prototype.handleWrapJump=function(o){var u=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,u){var d={};for(var _ in this._tiles){var x=this._tiles[_];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+u),d[x.tileID.key]=x}for(var T in this._tiles=d,this._timers)clearTimeout(this._timers[T]),delete this._timers[T];for(var z in this._tiles)this._setTileReloadTimer(z,this._tiles[z])}},a.prototype.update=function(o){var u=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var d;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?d=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(De){return new s.OverscaledTileID(De.canonical.z,De.wrap,De.canonical.z,De.canonical.x,De.canonical.y)}):(d=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(d=d.filter(function(De){return u._source.hasTile(De)}))):d=[];var _=o.coveringZoomLevel(this._source),x=Math.max(_-a.maxOverzooming,this._source.minzoom),T=Math.max(_+a.maxUnderzooming,this._source.minzoom),z=this._updateRetainedTiles(d,_);if(Ce(this._source.type)){for(var L={},j={},q=0,Z=Object.keys(z);q<Z.length;q+=1){var re=Z[q],$=z[re],se=this._tiles[re];if(se&&!(se.fadeEndTime&&se.fadeEndTime<=s.browser.now())){var Y=this.findLoadedParent($,x);Y&&(this._addTile(Y.tileID),L[Y.tileID.key]=Y.tileID),j[re]=$}}for(var oe in this._retainLoadedChildren(j,_,T,z),L)z[oe]||(this._coveredTiles[oe]=!0,z[oe]=L[oe])}for(var he in z)this._tiles[he].clearFadeHold();for(var ge=0,Te=s.keysDifference(this._tiles,z);ge<Te.length;ge+=1){var ve=Te[ge],Ae=this._tiles[ve];Ae.hasSymbolBuckets&&!Ae.holdingForFade()?Ae.setHoldDuration(this.map._fadeDuration):Ae.hasSymbolBuckets&&!Ae.symbolFadeFinished()||this._removeTile(ve)}this._updateLoadedParentTileCache()}},a.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},a.prototype._updateRetainedTiles=function(o,u){for(var d={},_={},x=Math.max(u-a.maxOverzooming,this._source.minzoom),T=Math.max(u+a.maxUnderzooming,this._source.minzoom),z={},L=0,j=o;L<j.length;L+=1){var q=j[L],Z=this._addTile(q);d[q.key]=q,Z.hasData()||u<this._source.maxzoom&&(z[q.key]=q)}this._retainLoadedChildren(z,u,T,d);for(var re=0,$=o;re<$.length;re+=1){var se=$[re],Y=this._tiles[se.key];if(!Y.hasData()){if(u+1>this._source.maxzoom){var oe=se.children(this._source.maxzoom)[0],he=this.getTile(oe);if(he&&he.hasData()){d[oe.key]=oe;continue}}else{var ge=se.children(this._source.maxzoom);if(d[ge[0].key]&&d[ge[1].key]&&d[ge[2].key]&&d[ge[3].key])continue}for(var Te=Y.wasRequested(),ve=se.overscaledZ-1;ve>=x;--ve){var Ae=se.scaledTo(ve);if(_[Ae.key]||(_[Ae.key]=!0,!(Y=this.getTile(Ae))&&Te&&(Y=this._addTile(Ae)),Y&&(d[Ae.key]=Ae,Te=Y.wasRequested(),Y.hasData())))break}}}return d},a.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var u=[],d=void 0,_=this._tiles[o].tileID;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){d=this._loadedParentTiles[_.key];break}u.push(_.key);var x=_.scaledTo(_.overscaledZ-1);if(d=this._getLoadedTile(x))break;_=x}for(var T=0,z=u;T<z.length;T+=1)this._loadedParentTiles[z[T]]=d}},a.prototype._addTile=function(o){var u=this._tiles[o.key];if(u)return u;(u=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));var d=Boolean(u);return d||(u=new s.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,o.key,u.state))),u?(u.uses++,this._tiles[o.key]=u,d||this._source.fire(new s.Event("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null},a.prototype._setTileReloadTimer=function(o,u){var d=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var _=u.getExpiryTimeout();_&&(this._timers[o]=setTimeout(function(){d._reloadTile(o,"expired"),delete d._timers[o]},_))},a.prototype._removeTile=function(o){var u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))},a.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},a.prototype.tilesIn=function(o,u,d){var _=this,x=[],T=this.transform;if(!T)return x;for(var z=d?T.getCameraQueryGeometry(o):o,L=o.map(function(ve){return T.pointCoordinate(ve)}),j=z.map(function(ve){return T.pointCoordinate(ve)}),q=this.getIds(),Z=1/0,re=1/0,$=-1/0,se=-1/0,Y=0,oe=j;Y<oe.length;Y+=1){var he=oe[Y];Z=Math.min(Z,he.x),re=Math.min(re,he.y),$=Math.max($,he.x),se=Math.max(se,he.y)}for(var ge=function(ve){var Ae=_._tiles[q[ve]];if(!Ae.holdingForFade()){var De=Ae.tileID,Ne=Math.pow(2,T.zoom-Ae.tileID.overscaledZ),Fe=u*Ae.queryPadding*s.EXTENT/Ae.tileSize/Ne,nt=[De.getTilePoint(new s.MercatorCoordinate(Z,re)),De.getTilePoint(new s.MercatorCoordinate($,se))];if(nt[0].x-Fe<s.EXTENT&&nt[0].y-Fe<s.EXTENT&&nt[1].x+Fe>=0&&nt[1].y+Fe>=0){var yt=L.map(function(_t){return De.getTilePoint(_t)}),vt=j.map(function(_t){return De.getTilePoint(_t)});x.push({tile:Ae,tileID:De,queryGeometry:yt,cameraQueryGeometry:vt,scale:Ne})}}},Te=0;Te<q.length;Te++)ge(Te);return x},a.prototype.getVisibleCoordinates=function(o){for(var u=this,d=this.getRenderableIds(o).map(function(z){return u._tiles[z].tileID}),_=0,x=d;_<x.length;_+=1){var T=x[_];T.posMatrix=this.transform.calculatePosMatrix(T.toUnwrapped())}return d},a.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ce(this._source.type))for(var o in this._tiles){var u=this._tiles[o];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=s.browser.now())return!0}return!1},a.prototype.setFeatureState=function(o,u,d){this._state.updateState(o=o||"_geojsonTileLayer",u,d)},a.prototype.removeFeatureState=function(o,u,d){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,d)},a.prototype.getFeatureState=function(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)},a.prototype.setDependencies=function(o,u,d){var _=this._tiles[o];_&&_.setDependencies(u,d)},a.prototype.reloadTilesForDependencies=function(o,u){for(var d in this._tiles)this._tiles[d].hasDependency(o,u)&&this._reloadTile(d,"reloading");this._cache.filter(function(_){return!_.hasDependency(o,u)})},a}(s.Evented);function me(n,a){var o=Math.abs(2*n.wrap)-+(n.wrap<0),u=Math.abs(2*a.wrap)-+(a.wrap<0);return n.overscaledZ-a.overscaledZ||u-o||a.canonical.y-n.canonical.y||a.canonical.x-n.canonical.x}function Ce(n){return n==="raster"||n==="image"||n==="video"}function Be(){return new s.window.Worker(ss.workerUrl)}te.maxOverzooming=10,te.maxUnderzooming=3;var Se="mapboxgl_preloaded_worker_pool",Le=function(){this.active={}};Le.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<Le.workerCount;)this.workers.push(new Be);return this.active[n]=!0,this.workers.slice()},Le.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},Le.prototype.isPreloaded=function(){return!!this.active[Se]},Le.prototype.numActive=function(){return Object.keys(this.active).length};var st,Xe=Math.floor(s.browser.hardwareConcurrency/2);function xe(){return st||(st=new Le),st}function Je(n,a){var o={};for(var u in n)u!=="ref"&&(o[u]=n[u]);return s.refProperties.forEach(function(d){d in a&&(o[d]=a[d])}),o}function Ue(n){n=n.slice();for(var a=Object.create(null),o=0;o<n.length;o++)a[n[o].id]=n[o];for(var u=0;u<n.length;u++)"ref"in n[u]&&(n[u]=Je(n[u],a[n[u].ref]));return n}Le.workerCount=Math.max(Math.min(Xe,6),1);var Ve={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function It(n,a,o){o.push({command:Ve.addSource,args:[n,a[n]]})}function Ye(n,a,o){a.push({command:Ve.removeSource,args:[n]}),o[n]=!0}function Ot(n,a,o,u){Ye(n,o,u),It(n,a,o)}function sr(n,a,o){var u;for(u in n[o])if(n[o].hasOwnProperty(u)&&u!=="data"&&!s.deepEqual(n[o][u],a[o][u]))return!1;for(u in a[o])if(a[o].hasOwnProperty(u)&&u!=="data"&&!s.deepEqual(n[o][u],a[o][u]))return!1;return!0}function Ct(n,a,o,u,d,_){var x;for(x in a=a||{},n=n||{})n.hasOwnProperty(x)&&(s.deepEqual(n[x],a[x])||o.push({command:_,args:[u,x,a[x],d]}));for(x in a)a.hasOwnProperty(x)&&!n.hasOwnProperty(x)&&(s.deepEqual(n[x],a[x])||o.push({command:_,args:[u,x,a[x],d]}))}function Qt(n){return n.id}function Mt(n,a){return n[a.id]=a,n}var ri=function(n,a){this.reset(n,a)};ri.prototype.reset=function(n,a){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding},ri.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=s.clamp(n,0,1);for(var a=1,o=this._distances[a],u=n*this.paddedLength+this.padding;o<u&&a<this._distances.length;)o=this._distances[++a];var d=a-1,_=this._distances[d],x=o-_,T=x>0?(u-_)/x:0;return this.points[d].mult(1-T).add(this.points[a].mult(T))};var Kt=function(n,a,o){var u=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(a/o);for(var _=0;_<this.xCellCount*this.yCellCount;_++)u.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=a,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0};function mr(n,a,o,u,d){var _=s.create();return a?(s.scale(_,_,[1/d,1/d,1]),o||s.rotateZ(_,_,u.angle)):s.multiply(_,u.labelPlaneMatrix,n),_}function rr(n,a,o,u,d){if(a){var _=s.clone(n);return s.scale(_,_,[d,d,1]),o||s.rotateZ(_,_,-u.angle),_}return u.glCoordMatrix}function Lt(n,a){var o=[n.x,n.y,0,1];Xr(o,o,a);var u=o[3];return{point:new s.Point(o[0]/u,o[1]/u),signedDistanceFromCamera:u}}function $t(n,a){return .5+n/a*.5}function Yr(n,a){var o=n[0]/n[3],u=n[1]/n[3];return o>=-a[0]&&o<=a[0]&&u>=-a[1]&&u<=a[1]}function ao(n,a,o,u,d,_,x,T){var z=u?n.textSizeData:n.iconSizeData,L=s.evaluateSizeForZoom(z,o.transform.zoom),j=[256/o.width*2+1,256/o.height*2+1],q=u?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;q.clear();for(var Z=n.lineVertexArray,re=u?n.text.placedSymbolArray:n.icon.placedSymbolArray,$=o.transform.width/o.transform.height,se=!1,Y=0;Y<re.length;Y++){var oe=re.get(Y);if(oe.hidden||oe.writingMode===s.WritingMode.vertical&&!se)qr(oe.numGlyphs,q);else{se=!1;var he=[oe.anchorX,oe.anchorY,0,1];if(s.transformMat4(he,he,a),Yr(he,j)){var ge=$t(o.transform.cameraToCenterDistance,he[3]),Te=s.evaluateSizeForFeature(z,L,oe),ve=x?Te/ge:Te*ge,Ae=new s.Point(oe.anchorX,oe.anchorY),De=Lt(Ae,d).point,Ne={},Fe=so(oe,ve,!1,T,a,d,_,n.glyphOffsetArray,Z,q,De,Ae,Ne,$);se=Fe.useVertical,(Fe.notEnoughRoom||se||Fe.needsFlipping&&so(oe,ve,!0,T,a,d,_,n.glyphOffsetArray,Z,q,De,Ae,Ne,$).notEnoughRoom)&&qr(oe.numGlyphs,q)}else qr(oe.numGlyphs,q)}}u?n.text.dynamicLayoutVertexBuffer.updateData(q):n.icon.dynamicLayoutVertexBuffer.updateData(q)}function Kr(n,a,o,u,d,_,x,T,z,L,j){var q=T.glyphStartIndex+T.numGlyphs,Z=T.lineStartIndex,re=T.lineStartIndex+T.lineLength,$=a.getoffsetX(T.glyphStartIndex),se=a.getoffsetX(q-1),Y=Pr(n*$,o,u,d,_,x,T.segment,Z,re,z,L,j);if(!Y)return null;var oe=Pr(n*se,o,u,d,_,x,T.segment,Z,re,z,L,j);return oe?{first:Y,last:oe}:null}function wi(n,a,o,u){return n===s.WritingMode.horizontal&&Math.abs(o.y-a.y)>Math.abs(o.x-a.x)*u?{useVertical:!0}:(n===s.WritingMode.vertical?a.y<o.y:a.x>o.x)?{needsFlipping:!0}:null}function so(n,a,o,u,d,_,x,T,z,L,j,q,Z,re){var $,se=a/24,Y=n.lineOffsetX*se,oe=n.lineOffsetY*se;if(n.numGlyphs>1){var he=n.glyphStartIndex+n.numGlyphs,ge=n.lineStartIndex,Te=n.lineStartIndex+n.lineLength,ve=Kr(se,T,Y,oe,o,j,q,n,z,_,Z);if(!ve)return{notEnoughRoom:!0};var Ae=Lt(ve.first.point,x).point,De=Lt(ve.last.point,x).point;if(u&&!o){var Ne=wi(n.writingMode,Ae,De,re);if(Ne)return Ne}$=[ve.first];for(var Fe=n.glyphStartIndex+1;Fe<he-1;Fe++)$.push(Pr(se*T.getoffsetX(Fe),Y,oe,o,j,q,n.segment,ge,Te,z,_,Z));$.push(ve.last)}else{if(u&&!o){var nt=Lt(q,d).point,yt=n.lineStartIndex+n.segment+1,vt=new s.Point(z.getx(yt),z.gety(yt)),_t=Lt(vt,d),or=_t.signedDistanceFromCamera>0?_t.point:Qo(q,vt,nt,1,d),ot=wi(n.writingMode,nt,or,re);if(ot)return ot}var St=Pr(se*T.getoffsetX(n.glyphStartIndex),Y,oe,o,j,q,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,z,_,Z);if(!St)return{notEnoughRoom:!0};$=[St]}for(var Vt=0,Tt=$;Vt<Tt.length;Vt+=1){var kt=Tt[Vt];s.addDynamicAttributes(L,kt.point,kt.angle)}return{}}function Qo(n,a,o,u,d){var _=Lt(n.add(n.sub(a)._unit()),d).point,x=o.sub(_);return o.add(x._mult(u/x.mag()))}function Pr(n,a,o,u,d,_,x,T,z,L,j,q){var Z=u?n-a:n+a,re=Z>0?1:-1,$=0;u&&(re*=-1,$=Math.PI),re<0&&($+=Math.PI);for(var se=re>0?T+x:T+x+1,Y=d,oe=d,he=0,ge=0,Te=Math.abs(Z),ve=[];he+ge<=Te;){if((se+=re)<T||se>=z)return null;if(oe=Y,ve.push(Y),(Y=q[se])===void 0){var Ae=new s.Point(L.getx(se),L.gety(se)),De=Lt(Ae,j);if(De.signedDistanceFromCamera>0)Y=q[se]=De.point;else{var Ne=se-re;Y=Qo(he===0?_:new s.Point(L.getx(Ne),L.gety(Ne)),Ae,oe,Te-he+1,j)}}he+=ge,ge=oe.dist(Y)}var Fe=(Te-he)/ge,nt=Y.sub(oe),yt=nt.mult(Fe)._add(oe);yt._add(nt._unit()._perp()._mult(o*re));var vt=$+Math.atan2(Y.y-oe.y,Y.x-oe.x);return ve.push(yt),{point:yt,angle:vt,path:ve}}Kt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Kt.prototype.insert=function(n,a,o,u,d){this._forEachCell(a,o,u,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(a),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(d)},Kt.prototype.insertCircle=function(n,a,o,u){this._forEachCell(a-u,o-u,a+u,o+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(a),this.circles.push(o),this.circles.push(u)},Kt.prototype._insertBoxCell=function(n,a,o,u,d,_){this.boxCells[d].push(_)},Kt.prototype._insertCircleCell=function(n,a,o,u,d,_){this.circleCells[d].push(_)},Kt.prototype._query=function(n,a,o,u,d,_){if(o<0||n>this.width||u<0||a>this.height)return!d&&[];var x=[];if(n<=0&&a<=0&&this.width<=o&&this.height<=u){if(d)return!0;for(var T=0;T<this.boxKeys.length;T++)x.push({key:this.boxKeys[T],x1:this.bboxes[4*T],y1:this.bboxes[4*T+1],x2:this.bboxes[4*T+2],y2:this.bboxes[4*T+3]});for(var z=0;z<this.circleKeys.length;z++){var L=this.circles[3*z],j=this.circles[3*z+1],q=this.circles[3*z+2];x.push({key:this.circleKeys[z],x1:L-q,y1:j-q,x2:L+q,y2:j+q})}return _?x.filter(_):x}return this._forEachCell(n,a,o,u,this._queryCell,x,{hitTest:d,seenUids:{box:{},circle:{}}},_),d?x.length>0:x},Kt.prototype._queryCircle=function(n,a,o,u,d){var _=n-o,x=n+o,T=a-o,z=a+o;if(x<0||_>this.width||z<0||T>this.height)return!u&&[];var L=[];return this._forEachCell(_,T,x,z,this._queryCellCircle,L,{hitTest:u,circle:{x:n,y:a,radius:o},seenUids:{box:{},circle:{}}},d),u?L.length>0:L},Kt.prototype.query=function(n,a,o,u,d){return this._query(n,a,o,u,!1,d)},Kt.prototype.hitTest=function(n,a,o,u,d){return this._query(n,a,o,u,!0,d)},Kt.prototype.hitTestCircle=function(n,a,o,u){return this._queryCircle(n,a,o,!0,u)},Kt.prototype._queryCell=function(n,a,o,u,d,_,x,T){var z=x.seenUids,L=this.boxCells[d];if(L!==null)for(var j=this.bboxes,q=0,Z=L;q<Z.length;q+=1){var re=Z[q];if(!z.box[re]){z.box[re]=!0;var $=4*re;if(n<=j[$+2]&&a<=j[$+3]&&o>=j[$+0]&&u>=j[$+1]&&(!T||T(this.boxKeys[re]))){if(x.hitTest)return _.push(!0),!0;_.push({key:this.boxKeys[re],x1:j[$],y1:j[$+1],x2:j[$+2],y2:j[$+3]})}}}var se=this.circleCells[d];if(se!==null)for(var Y=this.circles,oe=0,he=se;oe<he.length;oe+=1){var ge=he[oe];if(!z.circle[ge]){z.circle[ge]=!0;var Te=3*ge;if(this._circleAndRectCollide(Y[Te],Y[Te+1],Y[Te+2],n,a,o,u)&&(!T||T(this.circleKeys[ge]))){if(x.hitTest)return _.push(!0),!0;var ve=Y[Te],Ae=Y[Te+1],De=Y[Te+2];_.push({key:this.circleKeys[ge],x1:ve-De,y1:Ae-De,x2:ve+De,y2:Ae+De})}}}},Kt.prototype._queryCellCircle=function(n,a,o,u,d,_,x,T){var z=x.circle,L=x.seenUids,j=this.boxCells[d];if(j!==null)for(var q=this.bboxes,Z=0,re=j;Z<re.length;Z+=1){var $=re[Z];if(!L.box[$]){L.box[$]=!0;var se=4*$;if(this._circleAndRectCollide(z.x,z.y,z.radius,q[se+0],q[se+1],q[se+2],q[se+3])&&(!T||T(this.boxKeys[$])))return _.push(!0),!0}}var Y=this.circleCells[d];if(Y!==null)for(var oe=this.circles,he=0,ge=Y;he<ge.length;he+=1){var Te=ge[he];if(!L.circle[Te]){L.circle[Te]=!0;var ve=3*Te;if(this._circlesCollide(oe[ve],oe[ve+1],oe[ve+2],z.x,z.y,z.radius)&&(!T||T(this.circleKeys[Te])))return _.push(!0),!0}}},Kt.prototype._forEachCell=function(n,a,o,u,d,_,x,T){for(var z=this._convertToXCellCoord(n),L=this._convertToYCellCoord(a),j=this._convertToXCellCoord(o),q=this._convertToYCellCoord(u),Z=z;Z<=j;Z++)for(var re=L;re<=q;re++)if(d.call(this,n,a,o,u,this.xCellCount*re+Z,_,x,T))return},Kt.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},Kt.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},Kt.prototype._circlesCollide=function(n,a,o,u,d,_){var x=u-n,T=d-a,z=o+_;return z*z>x*x+T*T},Kt.prototype._circleAndRectCollide=function(n,a,o,u,d,_,x){var T=(_-u)/2,z=Math.abs(n-(u+T));if(z>T+o)return!1;var L=(x-d)/2,j=Math.abs(a-(d+L));if(j>L+o)return!1;if(z<=T||j<=L)return!0;var q=z-T,Z=j-L;return q*q+Z*Z<=o*o};var mn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function qr(n,a){for(var o=0;o<n;o++){var u=a.length;a.resize(u+4),a.float32.set(mn,3*u)}}function Xr(n,a,o){var u=a[0],d=a[1];return n[0]=o[0]*u+o[4]*d+o[12],n[1]=o[1]*u+o[5]*d+o[13],n[3]=o[3]*u+o[7]*d+o[15],n}var fi=function(n,a,o){a===void 0&&(a=new Kt(n.width+200,n.height+200,25)),o===void 0&&(o=new Kt(n.width+200,n.height+200,25)),this.transform=n,this.grid=a,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function yr(n,a,o){return a*(s.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}fi.prototype.placeCollisionBox=function(n,a,o,u,d){var _=this.projectAndGetPerspectiveRatio(u,n.anchorPointX,n.anchorPointY),x=o*_.perspectiveRatio,T=n.x1*x+_.point.x,z=n.y1*x+_.point.y,L=n.x2*x+_.point.x,j=n.y2*x+_.point.y;return!this.isInsideGrid(T,z,L,j)||!a&&this.grid.hitTest(T,z,L,j,d)?{box:[],offscreen:!1}:{box:[T,z,L,j],offscreen:this.isOffscreen(T,z,L,j)}},fi.prototype.placeCollisionCircles=function(n,a,o,u,d,_,x,T,z,L,j,q,Z){var re=[],$=new s.Point(a.anchorX,a.anchorY),se=Lt($,_),Y=$t(this.transform.cameraToCenterDistance,se.signedDistanceFromCamera),oe=(L?d/Y:d*Y)/s.ONE_EM,he=Lt($,x).point,ge=Kr(oe,u,a.lineOffsetX*oe,a.lineOffsetY*oe,!1,he,$,a,o,x,{}),Te=!1,ve=!1,Ae=!0;if(ge){for(var De=.5*q*Y+Z,Ne=new s.Point(-100,-100),Fe=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),nt=new ri,yt=ge.first,vt=ge.last,_t=[],or=yt.path.length-1;or>=1;or--)_t.push(yt.path[or]);for(var ot=1;ot<vt.path.length;ot++)_t.push(vt.path[ot]);var St=2.5*De;if(T){var Vt=_t.map(function(Po){return Lt(Po,T)});_t=Vt.some(function(Po){return Po.signedDistanceFromCamera<=0})?[]:Vt.map(function(Po){return Po.point})}var Tt=[];if(_t.length>0){for(var kt=_t[0].clone(),Rt=_t[0].clone(),Et=1;Et<_t.length;Et++)kt.x=Math.min(kt.x,_t[Et].x),kt.y=Math.min(kt.y,_t[Et].y),Rt.x=Math.max(Rt.x,_t[Et].x),Rt.y=Math.max(Rt.y,_t[Et].y);Tt=kt.x>=Ne.x&&Rt.x<=Fe.x&&kt.y>=Ne.y&&Rt.y<=Fe.y?[_t]:Rt.x<Ne.x||kt.x>Fe.x||Rt.y<Ne.y||kt.y>Fe.y?[]:s.clipLine([_t],Ne.x,Ne.y,Fe.x,Fe.y)}for(var xt=0,Ri=Tt;xt<Ri.length;xt+=1){var Wr;nt.reset(Ri[xt],.25*De),Wr=nt.length<=.5*De?1:Math.ceil(nt.paddedLength/St)+1;for(var wn=0;wn<Wr;wn++){var Gi=wn/Math.max(Wr-1,1),Hr=nt.lerp(Gi),ui=Hr.x+100,$i=Hr.y+100;re.push(ui,$i,De,0);var Sn=ui-De,ba=$i-De,$n=ui+De,Go=$i+De;if(Ae=Ae&&this.isOffscreen(Sn,ba,$n,Go),ve=ve||this.isInsideGrid(Sn,ba,$n,Go),!n&&this.grid.hitTestCircle(ui,$i,De,j)&&(Te=!0,!z))return{circles:[],offscreen:!1,collisionDetected:Te}}}}return{circles:!z&&Te||!ve?[]:re,offscreen:Ae,collisionDetected:Te}},fi.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var a=[],o=1/0,u=1/0,d=-1/0,_=-1/0,x=0,T=n;x<T.length;x+=1){var z=T[x],L=new s.Point(z.x+100,z.y+100);o=Math.min(o,L.x),u=Math.min(u,L.y),d=Math.max(d,L.x),_=Math.max(_,L.y),a.push(L)}for(var j={},q={},Z=0,re=this.grid.query(o,u,d,_).concat(this.ignoredGrid.query(o,u,d,_));Z<re.length;Z+=1){var $=re[Z],se=$.key;if(j[se.bucketInstanceId]===void 0&&(j[se.bucketInstanceId]={}),!j[se.bucketInstanceId][se.featureIndex]){var Y=[new s.Point($.x1,$.y1),new s.Point($.x2,$.y1),new s.Point($.x2,$.y2),new s.Point($.x1,$.y2)];s.polygonIntersectsPolygon(a,Y)&&(j[se.bucketInstanceId][se.featureIndex]=!0,q[se.bucketInstanceId]===void 0&&(q[se.bucketInstanceId]=[]),q[se.bucketInstanceId].push(se.featureIndex))}}return q},fi.prototype.insertCollisionBox=function(n,a,o,u,d){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:u,collisionGroupID:d},n[0],n[1],n[2],n[3])},fi.prototype.insertCollisionCircles=function(n,a,o,u,d){for(var _=a?this.ignoredGrid:this.grid,x={bucketInstanceId:o,featureIndex:u,collisionGroupID:d},T=0;T<n.length;T+=4)_.insertCircle(x,n[T],n[T+1],n[T+2])},fi.prototype.projectAndGetPerspectiveRatio=function(n,a,o){var u=[a,o,0,1];return Xr(u,u,n),{point:new s.Point((u[0]/u[3]+1)/2*this.transform.width+100,(-u[1]/u[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/u[3]*.5}},fi.prototype.isOffscreen=function(n,a,o,u){return o<100||n>=this.screenRightBoundary||u<100||a>this.screenBottomBoundary},fi.prototype.isInsideGrid=function(n,a,o,u){return o>=0&&n<this.gridRightBoundary&&u>=0&&a<this.gridBottomBoundary},fi.prototype.getViewportMatrix=function(){var n=s.identity([]);return s.translate(n,n,[-100,-100,0]),n};var yn=function(n,a,o,u){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?a:-a))):u&&o?1:0,this.placed=o};yn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var ln=function(n,a,o,u,d){this.text=new yn(n?n.text:null,a,o,d),this.icon=new yn(n?n.icon:null,a,u,d)};ln.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ha=function(n,a,o){this.text=n,this.icon=a,this.skipFade=o},Ft=function(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]},Ji=function(n,a,o,u,d){this.bucketInstanceId=n,this.featureIndex=a,this.sourceLayerIndex=o,this.bucketIndex=u,this.tileID=d},Rr=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function Nr(n,a,o,u,d){var _=s.getAnchorAlignment(n),x=-(_.horizontalAlign-.5)*a,T=-(_.verticalAlign-.5)*o,z=s.evaluateVariableOffset(n,u);return new s.Point(x+z[0]*d,T+z[1]*d)}function Zn(n,a,o,u,d,_){var x=n.x1,T=n.x2,z=n.y1,L=n.y2,j=n.anchorPointX,q=n.anchorPointY,Z=new s.Point(a,o);return u&&Z._rotate(d?_:-_),{x1:x+Z.x,y1:z+Z.y,x2:T+Z.x,y2:L+Z.y,anchorPointX:j,anchorPointY:q}}Rr.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var a=++this.maxGroupID;this.collisionGroups[n]={ID:a,predicate:function(o){return o.collisionGroupID===a}}}return this.collisionGroups[n]};var Qr=function(n,a,o,u){this.transform=n.clone(),this.collisionIndex=new fi(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=a,this.retainedQueryData={},this.collisionGroups=new Rr(o),this.collisionCircleArrays={},this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}};function sa(n,a,o,u,d){n.emplaceBack(a?1:0,o?1:0,u||0,d||0),n.emplaceBack(a?1:0,o?1:0,u||0,d||0),n.emplaceBack(a?1:0,o?1:0,u||0,d||0),n.emplaceBack(a?1:0,o?1:0,u||0,d||0)}Qr.prototype.getBucketParts=function(n,a,o,u){var d=o.getBucket(a),_=o.latestFeatureIndex;if(d&&_&&a.id===d.layerIds[0]){var x=o.collisionBoxArray,T=d.layers[0].layout,z=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),L=o.tileSize/s.EXTENT,j=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),q=T.get("text-pitch-alignment")==="map",Z=T.get("text-rotation-alignment")==="map",re=yr(o,1,this.transform.zoom),$=mr(j,q,Z,this.transform,re),se=null;if(q){var Y=rr(j,q,Z,this.transform,re);se=s.multiply([],this.transform.labelPlaneMatrix,Y)}this.retainedQueryData[d.bucketInstanceId]=new Ji(d.bucketInstanceId,_,d.sourceLayerIndex,d.index,o.tileID);var oe={bucket:d,layout:T,posMatrix:j,textLabelPlaneMatrix:$,labelToScreenMatrix:se,scale:z,textPixelRatio:L,holdingForFade:o.holdingForFade(),collisionBoxArray:x,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(u)for(var he=0,ge=d.sortKeyRanges;he<ge.length;he+=1){var Te=ge[he];n.push({sortKey:Te.sortKey,symbolInstanceStart:Te.symbolInstanceStart,symbolInstanceEnd:Te.symbolInstanceEnd,parameters:oe})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:oe})}},Qr.prototype.attemptAnchorPlacement=function(n,a,o,u,d,_,x,T,z,L,j,q,Z,re,$){var se,Y=[q.textOffset0,q.textOffset1],oe=Nr(n,o,u,Y,d),he=this.collisionIndex.placeCollisionBox(Zn(a,oe.x,oe.y,_,x,this.transform.angle),j,T,z,L.predicate);if(!$||this.collisionIndex.placeCollisionBox(Zn($,oe.x,oe.y,_,x,this.transform.angle),j,T,z,L.predicate).box.length!==0)return he.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[q.crossTileID]&&this.prevPlacement.placements[q.crossTileID]&&this.prevPlacement.placements[q.crossTileID].text&&(se=this.prevPlacement.variableOffsets[q.crossTileID].anchor),this.variableOffsets[q.crossTileID]={textOffset:Y,width:o,height:u,anchor:n,textBoxScale:d,prevAnchor:se},this.markUsedJustification(Z,n,q,re),Z.allowVerticalPlacement&&(this.markUsedOrientation(Z,re,q),this.placedOrientations[q.crossTileID]=re),{shift:oe,placedGlyphBoxes:he}):void 0},Qr.prototype.placeLayerBucketPart=function(n,a,o){var u=this,d=n.parameters,_=d.bucket,x=d.layout,T=d.posMatrix,z=d.textLabelPlaneMatrix,L=d.labelToScreenMatrix,j=d.textPixelRatio,q=d.holdingForFade,Z=d.collisionBoxArray,re=d.partiallyEvaluatedTextSize,$=d.collisionGroup,se=x.get("text-optional"),Y=x.get("icon-optional"),oe=x.get("text-allow-overlap"),he=x.get("icon-allow-overlap"),ge=x.get("text-rotation-alignment")==="map",Te=x.get("text-pitch-alignment")==="map",ve=x.get("icon-text-fit")!=="none",Ae=x.get("symbol-z-order")==="viewport-y",De=oe&&(he||!_.hasIconData()||Y),Ne=he&&(oe||!_.hasTextData()||se);!_.collisionArrays&&Z&&_.deserializeCollisionBoxes(Z);var Fe=function(ot,St){if(!a[ot.crossTileID])if(q)u.placements[ot.crossTileID]=new Ha(!1,!1,!1);else{var Vt,Tt=!1,kt=!1,Rt=!0,Et=null,xt={box:null,offscreen:null},Ri={box:null,offscreen:null},Wr=null,wn=null,Gi=0,Hr=0,ui=0;St.textFeatureIndex?Gi=St.textFeatureIndex:ot.useRuntimeCollisionCircles&&(Gi=ot.featureIndex),St.verticalTextFeatureIndex&&(Hr=St.verticalTextFeatureIndex);var $i=St.textBox;if($i){var Sn=function(ur){var Mo=s.WritingMode.horizontal;if(_.allowVerticalPlacement&&!ur&&u.prevPlacement){var Un=u.prevPlacement.placedOrientations[ot.crossTileID];Un&&(u.placedOrientations[ot.crossTileID]=Un,u.markUsedOrientation(_,Mo=Un,ot))}return Mo},ba=function(ur,Mo){if(_.allowVerticalPlacement&&ot.numVerticalGlyphVertices>0&&St.verticalTextBox)for(var Un=0,cs=_.writingModes;Un<cs.length&&(cs[Un]===s.WritingMode.vertical?(xt=Mo(),Ri=xt):xt=ur(),!(xt&&xt.box&&xt.box.length));Un+=1);else xt=ur()};if(x.get("text-variable-anchor")){var $n=x.get("text-variable-anchor");if(u.prevPlacement&&u.prevPlacement.variableOffsets[ot.crossTileID]){var Go=u.prevPlacement.variableOffsets[ot.crossTileID];$n.indexOf(Go.anchor)>0&&($n=$n.filter(function(ur){return ur!==Go.anchor})).unshift(Go.anchor)}var Po=function(ur,Mo,Un){for(var cs=ur.x2-ur.x1,Zs=ur.y2-ur.y1,ml=ot.textBoxScale,iu=ve&&!he?Mo:null,yl={box:[],offscreen:!1},nu=oe?2*$n.length:$n.length,ks=0;ks<nu;++ks){var gl=u.attemptAnchorPlacement($n[ks%$n.length],ur,cs,Zs,ml,ge,Te,j,T,$,ks>=$n.length,ot,_,Un,iu);if(gl&&(yl=gl.placedGlyphBoxes)&&yl.box&&yl.box.length){Tt=!0,Et=gl.shift;break}}return yl};ba(function(){return Po($i,St.iconBox,s.WritingMode.horizontal)},function(){var ur=St.verticalTextBox;return _.allowVerticalPlacement&&!(xt&&xt.box&&xt.box.length)&&ot.numVerticalGlyphVertices>0&&ur?Po(ur,St.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null}}),xt&&(Tt=xt.box,Rt=xt.offscreen);var js=Sn(xt&&xt.box);if(!Tt&&u.prevPlacement){var ls=u.prevPlacement.variableOffsets[ot.crossTileID];ls&&(u.variableOffsets[ot.crossTileID]=ls,u.markUsedJustification(_,ls.anchor,ot,js))}}else{var wa=function(ur,Mo){var Un=u.collisionIndex.placeCollisionBox(ur,oe,j,T,$.predicate);return Un&&Un.box&&Un.box.length&&(u.markUsedOrientation(_,Mo,ot),u.placedOrientations[ot.crossTileID]=Mo),Un};ba(function(){return wa($i,s.WritingMode.horizontal)},function(){var ur=St.verticalTextBox;return _.allowVerticalPlacement&&ot.numVerticalGlyphVertices>0&&ur?wa(ur,s.WritingMode.vertical):{box:null,offscreen:null}}),Sn(xt&&xt.box&&xt.box.length)}}if(Tt=(Vt=xt)&&Vt.box&&Vt.box.length>0,Rt=Vt&&Vt.offscreen,ot.useRuntimeCollisionCircles){var na=_.text.placedSymbolArray.get(ot.centerJustifiedTextSymbolIndex),qs=s.evaluateSizeForFeature(_.textSizeData,re,na),Ko=x.get("text-padding");Wr=u.collisionIndex.placeCollisionCircles(oe,na,_.lineVertexArray,_.glyphOffsetArray,qs,T,z,L,o,Te,$.predicate,ot.collisionCircleDiameter,Ko),Tt=oe||Wr.circles.length>0&&!Wr.collisionDetected,Rt=Rt&&Wr.offscreen}if(St.iconFeatureIndex&&(ui=St.iconFeatureIndex),St.iconBox){var dl=function(ur){var Mo=ve&&Et?Zn(ur,Et.x,Et.y,ge,Te,u.transform.angle):ur;return u.collisionIndex.placeCollisionBox(Mo,he,j,T,$.predicate)};kt=Ri&&Ri.box&&Ri.box.length&&St.verticalIconBox?(wn=dl(St.verticalIconBox)).box.length>0:(wn=dl(St.iconBox)).box.length>0,Rt=Rt&&wn.offscreen}var oa=se||ot.numHorizontalGlyphVertices===0&&ot.numVerticalGlyphVertices===0,Bi=Y||ot.numIconVertices===0;if(oa||Bi?Bi?oa||(kt=kt&&Tt):Tt=kt&&Tt:kt=Tt=kt&&Tt,Tt&&Vt&&Vt.box&&u.collisionIndex.insertCollisionBox(Vt.box,x.get("text-ignore-placement"),_.bucketInstanceId,Ri&&Ri.box&&Hr?Hr:Gi,$.ID),kt&&wn&&u.collisionIndex.insertCollisionBox(wn.box,x.get("icon-ignore-placement"),_.bucketInstanceId,ui,$.ID),Wr&&(Tt&&u.collisionIndex.insertCollisionCircles(Wr.circles,x.get("text-ignore-placement"),_.bucketInstanceId,Gi,$.ID),o)){var Sa=_.bucketInstanceId,Co=u.collisionCircleArrays[Sa];Co===void 0&&(Co=u.collisionCircleArrays[Sa]=new Ft);for(var us=0;us<Wr.circles.length;us+=4)Co.circles.push(Wr.circles[us+0]),Co.circles.push(Wr.circles[us+1]),Co.circles.push(Wr.circles[us+2]),Co.circles.push(Wr.collisionDetected?1:0)}u.placements[ot.crossTileID]=new Ha(Tt||De,kt||Ne,Rt||_.justReloaded),a[ot.crossTileID]=!0}};if(Ae)for(var nt=_.getSortedSymbolIndexes(this.transform.angle),yt=nt.length-1;yt>=0;--yt){var vt=nt[yt];Fe(_.symbolInstances.get(vt),_.collisionArrays[vt])}else for(var _t=n.symbolInstanceStart;_t<n.symbolInstanceEnd;_t++)Fe(_.symbolInstances.get(_t),_.collisionArrays[_t]);if(o&&_.bucketInstanceId in this.collisionCircleArrays){var or=this.collisionCircleArrays[_.bucketInstanceId];s.invert(or.invProjMatrix,T),or.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1},Qr.prototype.markUsedJustification=function(n,a,o,u){var d;d=u===s.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[s.getAnchorJustification(a)];for(var _=0,x=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];_<x.length;_+=1){var T=x[_];T>=0&&(n.text.placedSymbolArray.get(T).crossTileID=d>=0&&T!==d?0:o.crossTileID)}},Qr.prototype.markUsedOrientation=function(n,a,o){for(var u=a===s.WritingMode.horizontal||a===s.WritingMode.horizontalOnly?a:0,d=a===s.WritingMode.vertical?a:0,_=0,x=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];_<x.length;_+=1)n.text.placedSymbolArray.get(x[_]).placedOrientation=u;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=d)},Qr.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,o=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var u=a?a.symbolFadeChange(n):1,d=a?a.opacities:{},_=a?a.variableOffsets:{},x=a?a.placedOrientations:{};for(var T in this.placements){var z=this.placements[T],L=d[T];L?(this.opacities[T]=new ln(L,u,z.text,z.icon),o=o||z.text!==L.text.placed||z.icon!==L.icon.placed):(this.opacities[T]=new ln(null,u,z.text,z.icon,z.skipFade),o=o||z.text||z.icon)}for(var j in d){var q=d[j];if(!this.opacities[j]){var Z=new ln(q,u,!1,!1);Z.isHidden()||(this.opacities[j]=Z,o=o||q.text.placed||q.icon.placed)}}for(var re in _)this.variableOffsets[re]||!this.opacities[re]||this.opacities[re].isHidden()||(this.variableOffsets[re]=_[re]);for(var $ in x)this.placedOrientations[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.placedOrientations[$]=x[$]);o?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:n)},Qr.prototype.updateLayerOpacities=function(n,a){for(var o={},u=0,d=a;u<d.length;u+=1){var _=d[u],x=_.getBucket(n);x&&_.latestFeatureIndex&&n.id===x.layerIds[0]&&this.updateBucketOpacities(x,o,_.collisionBoxArray)}},Qr.prototype.updateBucketOpacities=function(n,a,o){var u=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var d=n.layers[0].layout,_=new ln(null,0,!1,!1,!0),x=d.get("text-allow-overlap"),T=d.get("icon-allow-overlap"),z=d.get("text-variable-anchor"),L=d.get("text-rotation-alignment")==="map",j=d.get("text-pitch-alignment")==="map",q=d.get("icon-text-fit")!=="none",Z=new ln(null,0,x&&(T||!n.hasIconData()||d.get("icon-optional")),T&&(x||!n.hasTextData()||d.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var re=function(oe,he,ge){for(var Te=0;Te<he/4;Te++)oe.opacityVertexArray.emplaceBack(ge)},$=function(oe){var he=n.symbolInstances.get(oe),ge=he.numHorizontalGlyphVertices,Te=he.numVerticalGlyphVertices,ve=he.crossTileID,Ae=u.opacities[ve];a[ve]?Ae=_:Ae||(u.opacities[ve]=Ae=Z),a[ve]=!0;var De=he.numIconVertices>0,Ne=u.placedOrientations[he.crossTileID],Fe=Ne===s.WritingMode.vertical,nt=Ne===s.WritingMode.horizontal||Ne===s.WritingMode.horizontalOnly;if(ge>0||Te>0){var yt=Ds(Ae.text);re(n.text,ge,Fe?gn:yt),re(n.text,Te,nt?gn:yt);var vt=Ae.text.isHidden();[he.rightJustifiedTextSymbolIndex,he.centerJustifiedTextSymbolIndex,he.leftJustifiedTextSymbolIndex].forEach(function(xt){xt>=0&&(n.text.placedSymbolArray.get(xt).hidden=vt||Fe?1:0)}),he.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(he.verticalPlacedTextSymbolIndex).hidden=vt||nt?1:0);var _t=u.variableOffsets[he.crossTileID];_t&&u.markUsedJustification(n,_t.anchor,he,Ne);var or=u.placedOrientations[he.crossTileID];or&&(u.markUsedJustification(n,"left",he,or),u.markUsedOrientation(n,or,he))}if(De){var ot=Ds(Ae.icon),St=!(q&&he.verticalPlacedIconSymbolIndex&&Fe);he.placedIconSymbolIndex>=0&&(re(n.icon,he.numIconVertices,St?ot:gn),n.icon.placedSymbolArray.get(he.placedIconSymbolIndex).hidden=Ae.icon.isHidden()),he.verticalPlacedIconSymbolIndex>=0&&(re(n.icon,he.numVerticalIconVertices,St?gn:ot),n.icon.placedSymbolArray.get(he.verticalPlacedIconSymbolIndex).hidden=Ae.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Vt=n.collisionArrays[oe];if(Vt){var Tt=new s.Point(0,0);if(Vt.textBox||Vt.verticalTextBox){var kt=!0;if(z){var Rt=u.variableOffsets[ve];Rt?(Tt=Nr(Rt.anchor,Rt.width,Rt.height,Rt.textOffset,Rt.textBoxScale),L&&Tt._rotate(j?u.transform.angle:-u.transform.angle)):kt=!1}Vt.textBox&&sa(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!kt||Fe,Tt.x,Tt.y),Vt.verticalTextBox&&sa(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!kt||nt,Tt.x,Tt.y)}var Et=Boolean(!nt&&Vt.verticalIconBox);Vt.iconBox&&sa(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,Et,q?Tt.x:0,q?Tt.y:0),Vt.verticalIconBox&&sa(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,!Et,q?Tt.x:0,q?Tt.y:0)}}},se=0;se<n.symbolInstances.length;se++)$(se);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var Y=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Y.invProjMatrix,n.placementViewportMatrix=Y.viewportMatrix,n.collisionCircleArray=Y.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},Qr.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Qr.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},Qr.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},Qr.prototype.stillRecent=function(n,a){var o=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*o>n},Qr.prototype.setStale=function(){this.stale=!0};var fs=Math.pow(2,25),Ca=Math.pow(2,24),Oo=Math.pow(2,17),el=Math.pow(2,16),Ja=Math.pow(2,9),la=Math.pow(2,8),wo=Math.pow(2,1);function Ds(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var a=n.placed?1:0,o=Math.floor(127*n.opacity);return o*fs+a*Ca+o*Oo+a*el+o*Ja+a*la+o*wo+a}var gn=0,Mn=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Mn.prototype.continuePlacement=function(n,a,o,u,d){for(var _=this._bucketParts;this._currentTileIndex<n.length;)if(a.getBucketParts(_,u,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,_.sort(function(x,T){return x.sortKey-T.sortKey}));this._currentPartIndex<_.length;)if(a.placeLayerBucketPart(_[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,d())return!0;return!1};var Gn=function(n,a,o,u,d,_,x){this.placement=new Qr(n,d,_,x),this._currentPlacementIndex=a.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=u,this._done=!1};Gn.prototype.isDone=function(){return this._done},Gn.prototype.continuePlacement=function(n,a,o){for(var u=this,d=s.browser.now(),_=function(){var z=s.browser.now()-d;return!u._forceFullPlacement&&z>2};this._currentPlacementIndex>=0;){var x=a[n[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=T)&&(!x.maxzoom||x.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new Mn(x)),this._inProgressLayer.continuePlacement(o[x.source],this.placement,this._showCollisionBoxes,x,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Gn.prototype.commit=function(n){return this.placement.commit(n),this.placement};var Ls=512/s.EXTENT/2,lo=function(n,a,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var u=0;u<a.length;u++){var d=a.get(u),_=d.key;this.indexedSymbolInstances[_]||(this.indexedSymbolInstances[_]=[]),this.indexedSymbolInstances[_].push({crossTileID:d.crossTileID,coord:this.getScaledCoordinates(d,n)})}};lo.prototype.getScaledCoordinates=function(n,a){var o=Ls/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*s.EXTENT+n.anchorX)*o),y:Math.floor((a.canonical.y*s.EXTENT+n.anchorY)*o)}},lo.prototype.findMatches=function(n,a,o){for(var u=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),d=0;d<n.length;d++){var _=n.get(d);if(!_.crossTileID){var x=this.indexedSymbolInstances[_.key];if(x)for(var T=this.getScaledCoordinates(_,a),z=0,L=x;z<L.length;z+=1){var j=L[z];if(Math.abs(j.coord.x-T.x)<=u&&Math.abs(j.coord.y-T.y)<=u&&!o[j.crossTileID]){o[j.crossTileID]=!0,_.crossTileID=j.crossTileID;break}}}}};var uo=function(){this.maxCrossTileID=0};uo.prototype.generate=function(){return++this.maxCrossTileID};var Fo=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Fo.prototype.handleWrapJump=function(n){var a=Math.round((n-this.lng)/360);if(a!==0)for(var o in this.indexes){var u=this.indexes[o],d={};for(var _ in u){var x=u[_];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+a),d[x.tileID.key]=x}this.indexes[o]=d}this.lng=n},Fo.prototype.addBucket=function(n,a,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var u=0;u<a.symbolInstances.length;u++)a.symbolInstances.get(u).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var d=this.usedCrossTileIDs[n.overscaledZ];for(var _ in this.indexes){var x=this.indexes[_];if(Number(_)>n.overscaledZ)for(var T in x){var z=x[T];z.tileID.isChildOf(n)&&z.findMatches(a.symbolInstances,n,d)}else{var L=x[n.scaledTo(Number(_)).key];L&&L.findMatches(a.symbolInstances,n,d)}}for(var j=0;j<a.symbolInstances.length;j++){var q=a.symbolInstances.get(j);q.crossTileID||(q.crossTileID=o.generate(),d[q.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new lo(n,a.symbolInstances,a.bucketInstanceId),!0},Fo.prototype.removeBucketCrossTileIDs=function(n,a){for(var o in a.indexedSymbolInstances)for(var u=0,d=a.indexedSymbolInstances[o];u<d.length;u+=1)delete this.usedCrossTileIDs[n][d[u].crossTileID]},Fo.prototype.removeStaleBuckets=function(n){var a=!1;for(var o in this.indexes){var u=this.indexes[o];for(var d in u)n[u[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,u[d]),delete u[d],a=!0)}return a};var de=function(){this.layerIndexes={},this.crossTileIDs=new uo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};de.prototype.addLayer=function(n,a,o){var u=this.layerIndexes[n.id];u===void 0&&(u=this.layerIndexes[n.id]=new Fo);var d=!1,_={};u.handleWrapJump(o);for(var x=0,T=a;x<T.length;x+=1){var z=T[x],L=z.getBucket(n);L&&n.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(z.tileID,L,this.crossTileIDs)&&(d=!0),_[L.bucketInstanceId]=!0)}return u.removeStaleBuckets(_)&&(d=!0),d},de.prototype.pruneUnusedLayers=function(n){var a={};for(var o in n.forEach(function(u){a[u]=!0}),this.layerIndexes)a[o]||delete this.layerIndexes[o]};var Si=function(n,a){return s.emitValidationErrors(n,a&&a.filter(function(o){return o.identifier!=="source.canvas"}))},Ci=s.pick(Ve,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Br=s.pick(Ve,["setCenter","setZoom","setBearing","setPitch"]),_n=function(){var n={},a=s.styleSpec.$version;for(var o in s.styleSpec.$root){var u,d=s.styleSpec.$root[o];d.required&&(u=o==="version"?a:d.type==="array"?[]:{})!=null&&(n[o]=u)}return n}(),Mi=function(n){function a(o,u){var d=this;u===void 0&&(u={}),n.call(this),this.map=o,this.dispatcher=new nr(xe(),this),this.imageManager=new Ke,this.imageManager.setEventedParent(this),this.glyphManager=new Ht(o._requestManager,u.localIdeographFontFamily),this.lineAtlas=new At(256,512),this.crossTileSymbolIndex=new de,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());var _=this;this._rtlTextPluginCallback=a.registerForPluginStateChange(function(x){_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},function(T,z){if(s.triggerPluginCompletionEvent(T),z&&z.every(function(j){return j}))for(var L in _.sourceCaches)_.sourceCaches[L].reload()})}),this.on("data",function(x){if(x.dataType==="source"&&x.sourceDataType==="metadata"){var T=d.sourceCaches[x.sourceId];if(T){var z=T.getSource();if(z&&z.vectorLayerIds)for(var L in d._layers){var j=d._layers[L];j.source===z.id&&d._validateLayer(j)}}}})}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.loadURL=function(o,u){var d=this;u===void 0&&(u={}),this.fire(new s.Event("dataloading",{dataType:"style"}));var _=typeof u.validate=="boolean"?u.validate:!s.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,u.accessToken);var x=this.map._requestManager.transformRequest(o,s.ResourceType.Style);this._request=s.getJSON(x,function(T,z){d._request=null,T?d.fire(new s.ErrorEvent(T)):z&&d._load(z,_)})},a.prototype.loadJSON=function(o,u){var d=this;u===void 0&&(u={}),this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.browser.frame(function(){d._request=null,d._load(o,u.validate!==!1)})},a.prototype.loadEmpty=function(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(_n,!1)},a.prototype._load=function(o,u){if(!u||!Si(this,s.validateStyle(o))){for(var d in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(d,o.sources[d],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var _=Ue(this.stylesheet.layers);this._order=_.map(function(L){return L.id}),this._layers={},this._serializedLayers={};for(var x=0,T=_;x<T.length;x+=1){var z=T[x];(z=s.createStyleLayer(z)).setEventedParent(this,{layer:{id:z.id}}),this._layers[z.id]=z,this._serializedLayers[z.id]=z.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new _r(this.stylesheet.light),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}},a.prototype._loadSprite=function(o){var u=this;this._spriteRequest=function(d,_,x){var T,z,L,j=s.browser.devicePixelRatio>1?"@2x":"",q=s.getJSON(_.transformRequest(_.normalizeSpriteURL(d,j,".json"),s.ResourceType.SpriteJSON),function($,se){q=null,L||(L=$,T=se,re())}),Z=s.getImage(_.transformRequest(_.normalizeSpriteURL(d,j,".png"),s.ResourceType.SpriteImage),function($,se){Z=null,L||(L=$,z=se,re())});function re(){if(L)x(L);else if(T&&z){var $=s.browser.getImageData(z),se={};for(var Y in T){var oe=T[Y],he=oe.width,ge=oe.height,Te=oe.x,ve=oe.y,Ae=oe.sdf,De=oe.pixelRatio,Ne=oe.stretchX,Fe=oe.stretchY,nt=oe.content,yt=new s.RGBAImage({width:he,height:ge});s.RGBAImage.copy($,yt,{x:Te,y:ve},{x:0,y:0},{width:he,height:ge}),se[Y]={data:yt,pixelRatio:De,sdf:Ae,stretchX:Ne,stretchY:Fe,content:nt}}x(null,se)}}return{cancel:function(){q&&(q.cancel(),q=null),Z&&(Z.cancel(),Z=null)}}}(o,this.map._requestManager,function(d,_){if(u._spriteRequest=null,d)u.fire(new s.ErrorEvent(d));else if(_)for(var x in _)u.imageManager.addImage(x,_[x]);u.imageManager.setLoaded(!0),u._availableImages=u.imageManager.listImages(),u.dispatcher.broadcast("setImages",u._availableImages),u.fire(new s.Event("data",{dataType:"style"}))})},a.prototype._validateLayer=function(o){var u=this.sourceCaches[o.source];if(u){var d=o.sourceLayer;if(d){var _=u.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(d)===-1)&&this.fire(new s.ErrorEvent(new Error('Source layer "'+d+'" does not exist on source "'+_.id+'" as specified by style layer "'+o.id+'"')))}}},a.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},a.prototype._serializeLayers=function(o){for(var u=[],d=0,_=o;d<_.length;d+=1){var x=this._layers[_[d]];x.type!=="custom"&&u.push(x.serialize())}return u},a.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var u in this._layers)if(this._layers[u].hasTransition())return!0;return!1},a.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},a.prototype.update=function(o){if(this._loaded){var u=this._changed;if(this._changed){var d=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);for(var x in(d.length||_.length)&&this._updateWorkerLayers(d,_),this._updatedSources){var T=this._updatedSources[x];T==="reload"?this._reloadSource(x):T==="clear"&&this._clearSource(x)}for(var z in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[z].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var L={};for(var j in this.sourceCaches){var q=this.sourceCaches[j];L[j]=q.used,q.used=!1}for(var Z=0,re=this._order;Z<re.length;Z+=1){var $=this._layers[re[Z]];$.recalculate(o,this._availableImages),!$.isHidden(o.zoom)&&$.source&&(this.sourceCaches[$.source].used=!0)}for(var se in L){var Y=this.sourceCaches[se];L[se]!==Y.used&&Y.fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:se}))}this.light.recalculate(o),this.z=o.zoom,u&&this.fire(new s.Event("data",{dataType:"style"}))}},a.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},a.prototype._updateWorkerLayers=function(o,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:u})},a.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},a.prototype.setState=function(o){var u=this;if(this._checkLoaded(),Si(this,s.validateStyle(o)))return!1;(o=s.clone$1(o)).layers=Ue(o.layers);var d=function(x,T){if(!x)return[{command:Ve.setStyle,args:[T]}];var z=[];try{if(!s.deepEqual(x.version,T.version))return[{command:Ve.setStyle,args:[T]}];s.deepEqual(x.center,T.center)||z.push({command:Ve.setCenter,args:[T.center]}),s.deepEqual(x.zoom,T.zoom)||z.push({command:Ve.setZoom,args:[T.zoom]}),s.deepEqual(x.bearing,T.bearing)||z.push({command:Ve.setBearing,args:[T.bearing]}),s.deepEqual(x.pitch,T.pitch)||z.push({command:Ve.setPitch,args:[T.pitch]}),s.deepEqual(x.sprite,T.sprite)||z.push({command:Ve.setSprite,args:[T.sprite]}),s.deepEqual(x.glyphs,T.glyphs)||z.push({command:Ve.setGlyphs,args:[T.glyphs]}),s.deepEqual(x.transition,T.transition)||z.push({command:Ve.setTransition,args:[T.transition]}),s.deepEqual(x.light,T.light)||z.push({command:Ve.setLight,args:[T.light]});var L={},j=[];(function(Z,re,$,se){var Y;for(Y in re=re||{},Z=Z||{})Z.hasOwnProperty(Y)&&(re.hasOwnProperty(Y)||Ye(Y,$,se));for(Y in re)re.hasOwnProperty(Y)&&(Z.hasOwnProperty(Y)?s.deepEqual(Z[Y],re[Y])||(Z[Y].type==="geojson"&&re[Y].type==="geojson"&&sr(Z,re,Y)?$.push({command:Ve.setGeoJSONSourceData,args:[Y,re[Y].data]}):Ot(Y,re,$,se)):It(Y,re,$))})(x.sources,T.sources,j,L);var q=[];x.layers&&x.layers.forEach(function(Z){L[Z.source]?z.push({command:Ve.removeLayer,args:[Z.id]}):q.push(Z)}),z=z.concat(j),function(Z,re,$){re=re||[];var se,Y,oe,he,ge,Te,ve,Ae=(Z=Z||[]).map(Qt),De=re.map(Qt),Ne=Z.reduce(Mt,{}),Fe=re.reduce(Mt,{}),nt=Ae.slice(),yt=Object.create(null);for(se=0,Y=0;se<Ae.length;se++)Fe.hasOwnProperty(oe=Ae[se])?Y++:($.push({command:Ve.removeLayer,args:[oe]}),nt.splice(nt.indexOf(oe,Y),1));for(se=0,Y=0;se<De.length;se++)nt[nt.length-1-se]!==(oe=De[De.length-1-se])&&(Ne.hasOwnProperty(oe)?($.push({command:Ve.removeLayer,args:[oe]}),nt.splice(nt.lastIndexOf(oe,nt.length-Y),1)):Y++,$.push({command:Ve.addLayer,args:[Fe[oe],Te=nt[nt.length-se]]}),nt.splice(nt.length-se,0,oe),yt[oe]=!0);for(se=0;se<De.length;se++)if(he=Ne[oe=De[se]],ge=Fe[oe],!yt[oe]&&!s.deepEqual(he,ge))if(s.deepEqual(he.source,ge.source)&&s.deepEqual(he["source-layer"],ge["source-layer"])&&s.deepEqual(he.type,ge.type)){for(ve in Ct(he.layout,ge.layout,$,oe,null,Ve.setLayoutProperty),Ct(he.paint,ge.paint,$,oe,null,Ve.setPaintProperty),s.deepEqual(he.filter,ge.filter)||$.push({command:Ve.setFilter,args:[oe,ge.filter]}),s.deepEqual(he.minzoom,ge.minzoom)&&s.deepEqual(he.maxzoom,ge.maxzoom)||$.push({command:Ve.setLayerZoomRange,args:[oe,ge.minzoom,ge.maxzoom]}),he)he.hasOwnProperty(ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?Ct(he[ve],ge[ve],$,oe,ve.slice(6),Ve.setPaintProperty):s.deepEqual(he[ve],ge[ve])||$.push({command:Ve.setLayerProperty,args:[oe,ve,ge[ve]]}));for(ve in ge)ge.hasOwnProperty(ve)&&!he.hasOwnProperty(ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?Ct(he[ve],ge[ve],$,oe,ve.slice(6),Ve.setPaintProperty):s.deepEqual(he[ve],ge[ve])||$.push({command:Ve.setLayerProperty,args:[oe,ve,ge[ve]]}))}else $.push({command:Ve.removeLayer,args:[oe]}),Te=nt[nt.lastIndexOf(oe)+1],$.push({command:Ve.addLayer,args:[ge,Te]})}(q,T.layers,z)}catch(Z){console.warn("Unable to compute style diff:",Z),z=[{command:Ve.setStyle,args:[T]}]}return z}(this.serialize(),o).filter(function(x){return!(x.command in Br)});if(d.length===0)return!1;var _=d.filter(function(x){return!(x.command in Ci)});if(_.length>0)throw new Error("Unimplemented: "+_.map(function(x){return x.command}).join(", ")+".");return d.forEach(function(x){x.command!=="setTransition"&&u[x.command].apply(u,x.args)}),this.stylesheet=o,!0},a.prototype.addImage=function(o,u){if(this.getImage(o))return this.fire(new s.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,u),this._afterImageUpdated(o)},a.prototype.updateImage=function(o,u){this.imageManager.updateImage(o,u)},a.prototype.getImage=function(o){return this.imageManager.getImage(o)},a.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new s.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},a.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))},a.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},a.prototype.addSource=function(o,u,d){var _=this;if(d===void 0&&(d={}),this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(u).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(s.validateStyle.source,"sources."+o,u,null,d))){this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);var x=this.sourceCaches[o]=new te(o,u,this.dispatcher);x.style=this,x.setEventedParent(this,function(){return{isSourceLoaded:_.loaded(),source:x.serialize(),sourceId:o}}),x.onAdd(this.map),this._changed=!0}},a.prototype.removeSource=function(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(var u in this._layers)if(this._layers[u].source===o)return this.fire(new s.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+u+'" is using it.')));var d=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],d.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),d.setEventedParent(null),d.clearTiles(),d.onRemove&&d.onRemove(this.map),this._changed=!0},a.prototype.setGeoJSONSourceData=function(o,u){this._checkLoaded(),this.sourceCaches[o].getSource().setData(u),this._changed=!0},a.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},a.prototype.addLayer=function(o,u,d){d===void 0&&(d={}),this._checkLoaded();var _=o.id;if(this.getLayer(_))this.fire(new s.ErrorEvent(new Error('Layer with id "'+_+'" already exists on this map')));else{var x;if(o.type==="custom"){if(Si(this,s.validateCustomStyleLayer(o)))return;x=s.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(_,o.source),o=s.clone$1(o),o=s.extend(o,{source:_})),this._validate(s.validateStyle.layer,"layers."+_,o,{arrayIndex:-1},d))return;x=s.createStyleLayer(o),this._validateLayer(x),x.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[x.id]=x.serialize()}var T=u?this._order.indexOf(u):this._order.length;if(u&&T===-1)this.fire(new s.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.')));else{if(this._order.splice(T,0,_),this._layerOrderChanged=!0,this._layers[_]=x,this._removedLayers[_]&&x.source&&x.type!=="custom"){var z=this._removedLayers[_];delete this._removedLayers[_],z.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}},a.prototype.moveLayer=function(o,u){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==u){var d=this._order.indexOf(o);this._order.splice(d,1);var _=u?this._order.indexOf(u):this._order.length;u&&_===-1?this.fire(new s.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.'))):(this._order.splice(_,0,o),this._layerOrderChanged=!0)}}else this.fire(new s.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},a.prototype.removeLayer=function(o){this._checkLoaded();var u=this._layers[o];if(u){u.setEventedParent(null);var d=this._order.indexOf(o);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map)}else this.fire(new s.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},a.prototype.getLayer=function(o){return this._layers[o]},a.prototype.hasLayer=function(o){return o in this._layers},a.prototype.setLayerZoomRange=function(o,u,d){this._checkLoaded();var _=this.getLayer(o);_?_.minzoom===u&&_.maxzoom===d||(u!=null&&(_.minzoom=u),d!=null&&(_.maxzoom=d),this._updateLayer(_)):this.fire(new s.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},a.prototype.setFilter=function(o,u,d){d===void 0&&(d={}),this._checkLoaded();var _=this.getLayer(o);if(_){if(!s.deepEqual(_.filter,u))return u==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(s.validateStyle.filter,"layers."+_.id+".filter",u,null,d)||(_.filter=s.clone$1(u),this._updateLayer(_)))}else this.fire(new s.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},a.prototype.getFilter=function(o){return s.clone$1(this.getLayer(o).filter)},a.prototype.setLayoutProperty=function(o,u,d,_){_===void 0&&(_={}),this._checkLoaded();var x=this.getLayer(o);x?s.deepEqual(x.getLayoutProperty(u),d)||(x.setLayoutProperty(u,d,_),this._updateLayer(x)):this.fire(new s.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getLayoutProperty=function(o,u){var d=this.getLayer(o);if(d)return d.getLayoutProperty(u);this.fire(new s.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},a.prototype.setPaintProperty=function(o,u,d,_){_===void 0&&(_={}),this._checkLoaded();var x=this.getLayer(o);x?s.deepEqual(x.getPaintProperty(u),d)||(x.setPaintProperty(u,d,_)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new s.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getPaintProperty=function(o,u){return this.getLayer(o).getPaintProperty(u)},a.prototype.setFeatureState=function(o,u){this._checkLoaded();var d=o.source,_=o.sourceLayer,x=this.sourceCaches[d];if(x!==void 0){var T=x.getSource().type;T==="geojson"&&_?this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):T!=="vector"||_?(o.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),x.setFeatureState(_,o.id,u)):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},a.prototype.removeFeatureState=function(o,u){this._checkLoaded();var d=o.source,_=this.sourceCaches[d];if(_!==void 0){var x=_.getSource().type,T=x==="vector"?o.sourceLayer:void 0;x!=="vector"||T?u&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(T,o.id,u):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},a.prototype.getFeatureState=function(o){this._checkLoaded();var u=o.source,d=o.sourceLayer,_=this.sourceCaches[u];if(_!==void 0){if(_.getSource().type!=="vector"||d)return o.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),_.getFeatureState(d,o.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+u+"' does not exist in the map's style.")))},a.prototype.getTransition=function(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},a.prototype.serialize=function(){return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:s.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return o!==void 0})},a.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},a.prototype._flattenAndSortRenderedFeatures=function(o){for(var u=this,d=function(Ne){return u._layers[Ne].type==="fill-extrusion"},_={},x=[],T=this._order.length-1;T>=0;T--){var z=this._order[T];if(d(z)){_[z]=T;for(var L=0,j=o;L<j.length;L+=1){var q=j[L][z];if(q)for(var Z=0,re=q;Z<re.length;Z+=1)x.push(re[Z])}}}x.sort(function(Ne,Fe){return Fe.intersectionZ-Ne.intersectionZ});for(var $=[],se=this._order.length-1;se>=0;se--){var Y=this._order[se];if(d(Y))for(var oe=x.length-1;oe>=0;oe--){var he=x[oe].feature;if(_[he.layer.id]<se)break;$.push(he),x.pop()}else for(var ge=0,Te=o;ge<Te.length;ge+=1){var ve=Te[ge][Y];if(ve)for(var Ae=0,De=ve;Ae<De.length;Ae+=1)$.push(De[Ae].feature)}}return $},a.prototype.queryRenderedFeatures=function(o,u,d){u&&u.filter&&this._validate(s.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);var _={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var x=0,T=u.layers;x<T.length;x+=1){var z=T[x],L=this._layers[z];if(!L)return this.fire(new s.ErrorEvent(new Error("The layer '"+z+"' does not exist in the map's style and cannot be queried for features."))),[];_[L.source]=!0}}var j=[];for(var q in u.availableImages=this._availableImages,this.sourceCaches)u.layers&&!_[q]||j.push(Xt(this.sourceCaches[q],this._layers,this._serializedLayers,o,u,d));return this.placement&&j.push(function(Z,re,$,se,Y,oe,he){for(var ge={},Te=oe.queryRenderedSymbols(se),ve=[],Ae=0,De=Object.keys(Te).map(Number);Ae<De.length;Ae+=1)ve.push(he[De[Ae]]);ve.sort(wr);for(var Ne=function(){var _t=nt[Fe],or=_t.featureIndex.lookupSymbolFeatures(Te[_t.bucketInstanceId],re,_t.bucketIndex,_t.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,Z);for(var ot in or){var St=ge[ot]=ge[ot]||[],Vt=or[ot];Vt.sort(function(Rt,Et){var xt=_t.featureSortOrder;if(xt){var Ri=xt.indexOf(Rt.featureIndex);return xt.indexOf(Et.featureIndex)-Ri}return Et.featureIndex-Rt.featureIndex});for(var Tt=0,kt=Vt;Tt<kt.length;Tt+=1)St.push(kt[Tt])}},Fe=0,nt=ve;Fe<nt.length;Fe+=1)Ne();var yt=function(_t){ge[_t].forEach(function(or){var ot=or.feature,St=$[Z[_t].source].getFeatureState(ot.layer["source-layer"],ot.id);ot.source=ot.layer.source,ot.layer["source-layer"]&&(ot.sourceLayer=ot.layer["source-layer"]),ot.state=St})};for(var vt in ge)yt(vt);return ge}(this._layers,this._serializedLayers,this.sourceCaches,o,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(j)},a.prototype.querySourceFeatures=function(o,u){u&&u.filter&&this._validate(s.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);var d=this.sourceCaches[o];return d?function(_,x){for(var T=_.getRenderableIds().map(function(re){return _.getTileByID(re)}),z=[],L={},j=0;j<T.length;j++){var q=T[j],Z=q.tileID.canonical.key;L[Z]||(L[Z]=!0,q.querySourceFeatures(z,x))}return z}(d,u):[]},a.prototype.addSourceType=function(o,u,d){return a.getSourceType(o)?d(new Error('A source type called "'+o+'" already exists.')):(a.setSourceType(o,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:u.workerSourceURL},d):d(null,null))},a.prototype.getLight=function(){return this.light.getLight()},a.prototype.setLight=function(o,u){u===void 0&&(u={}),this._checkLoaded();var d=this.light.getLight(),_=!1;for(var x in o)if(!s.deepEqual(o[x],d[x])){_=!0;break}if(_){var T={now:s.browser.now(),transition:s.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,u),this.light.updateTransitions(T)}},a.prototype._validate=function(o,u,d,_,x){return x===void 0&&(x={}),(!x||x.validate!==!1)&&Si(this,o.call(s.validateStyle,s.extend({key:u,style:this.serialize(),value:d,styleSpec:s.styleSpec},_)))},a.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var u in this.sourceCaches)this.sourceCaches[u].clearTiles(),this.sourceCaches[u].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},a.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},a.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},a.prototype._updateSources=function(o){for(var u in this.sourceCaches)this.sourceCaches[u].update(o)},a.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},a.prototype._updatePlacement=function(o,u,d,_,x){x===void 0&&(x=!1);for(var T=!1,z=!1,L={},j=0,q=this._order;j<q.length;j+=1){var Z=this._layers[q[j]];if(Z.type==="symbol"){if(!L[Z.source]){var re=this.sourceCaches[Z.source];L[Z.source]=re.getRenderableIds(!0).map(function(he){return re.getTileByID(he)}).sort(function(he,ge){return ge.tileID.overscaledZ-he.tileID.overscaledZ||(he.tileID.isLessThan(ge.tileID)?-1:1)})}var $=this.crossTileSymbolIndex.addLayer(Z,L[Z.source],o.center.lng);T=T||$}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.browser.now(),o.zoom))&&(this.pauseablePlacement=new Gn(o,this._order,x,u,d,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.browser.now()),z=!0),T&&this.pauseablePlacement.placement.setStale()),z||T)for(var se=0,Y=this._order;se<Y.length;se+=1){var oe=this._layers[Y[se]];oe.type==="symbol"&&this.placement.updateLayerOpacities(oe,L[oe.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.browser.now())},a.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},a.prototype.getImages=function(o,u,d){this.imageManager.getImages(u.icons,d),this._updateTilesForChangedImages();var _=this.sourceCaches[u.source];_&&_.setDependencies(u.tileID.key,u.type,u.icons)},a.prototype.getGlyphs=function(o,u,d){this.glyphManager.getGlyphs(u.stacks,d)},a.prototype.getResource=function(o,u,d){return s.makeRequest(u,d)},a}(s.Evented);Mi.getSourceType=function(n){return an[n]},Mi.setSourceType=function(n,a){an[n]=a},Mi.registerForPluginStateChange=s.registerForPluginStateChange;var ii=s.createLayout([{name:"a_pos",type:"Int16",components:2}]),Kn=Cr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),So=Cr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ma=Cr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Jl=Cr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Da=Cr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Yl=Cr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),tl=Cr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),La=Cr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),ds=Cr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Tl=Cr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Ql=Cr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Vo=Cr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ms=Cr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Ya=Cr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),ni=Cr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),rl=Cr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),co=Cr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),No=Cr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ua=Cr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ra=Cr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),ca=Cr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Dn=Cr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),un=Cr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Ln=Cr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Il=Cr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Qa=Cr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Cr(n,a){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=a.match(/attribute ([\w]+) ([\w]+)/g),d=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=_?_.concat(d):d,T={};return{fragmentSource:n=n.replace(o,function(z,L,j,q,Z){return T[Z]=!0,L==="define"?`
#ifndef HAS_UNIFORM_u_`+Z+`
varying `+j+" "+q+" "+Z+`;
#else
uniform `+j+" "+q+" u_"+Z+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Z+`
    `+j+" "+q+" "+Z+" = u_"+Z+`;
#endif
`}),vertexSource:a=a.replace(o,function(z,L,j,q,Z){var re=q==="float"?"vec2":"vec4",$=Z.match(/color/)?"color":re;return T[Z]?L==="define"?`
#ifndef HAS_UNIFORM_u_`+Z+`
uniform lowp float u_`+Z+`_t;
attribute `+j+" "+re+" a_"+Z+`;
varying `+j+" "+q+" "+Z+`;
#else
uniform `+j+" "+q+" u_"+Z+`;
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Z+`
    `+Z+" = a_"+Z+`;
#else
    `+j+" "+q+" "+Z+" = u_"+Z+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Z+`
    `+Z+" = unpack_mix_"+$+"(a_"+Z+", u_"+Z+`_t);
#else
    `+j+" "+q+" "+Z+" = u_"+Z+`;
#endif
`:L==="define"?`
#ifndef HAS_UNIFORM_u_`+Z+`
uniform lowp float u_`+Z+`_t;
attribute `+j+" "+re+" a_"+Z+`;
#else
uniform `+j+" "+q+" u_"+Z+`;
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Z+`
    `+j+" "+q+" "+Z+" = a_"+Z+`;
#else
    `+j+" "+q+" "+Z+" = u_"+Z+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Z+`
    `+j+" "+q+" "+Z+" = unpack_mix_"+$+"(a_"+Z+", u_"+Z+`_t);
#else
    `+j+" "+q+" "+Z+" = u_"+Z+`;
#endif
`}),staticAttributes:u,staticUniforms:x}}var $l=Object.freeze({__proto__:null,prelude:Kn,background:So,backgroundPattern:Ma,circle:Jl,clippingMask:Da,heatmap:Yl,heatmapTexture:tl,collisionBox:La,collisionCircle:ds,debug:Tl,fill:Ql,fillOutline:Vo,fillOutlinePattern:ms,fillPattern:Ya,fillExtrusion:ni,fillExtrusionPattern:rl,hillshadePrepare:co,hillshade:No,line:ua,lineGradient:Ra,linePattern:ca,lineSDF:Dn,raster:un,symbolIcon:Ln,symbolSDF:Il,symbolTextAndIcon:Qa}),ha=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function ys(n){for(var a=[],o=0;o<n.length;o++)if(n[o]!==null){var u=n[o].split(" ");a.push(u.pop())}return a}ha.prototype.bind=function(n,a,o,u,d,_,x,T){this.context=n;for(var z=this.boundPaintVertexBuffers.length!==u.length,L=0;!z&&L<u.length;L++)this.boundPaintVertexBuffers[L]!==u[L]&&(z=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===o&&!z&&this.boundIndexBuffer===d&&this.boundVertexOffset===_&&this.boundDynamicVertexBuffer===x&&this.boundDynamicVertexBuffer2===T?(n.bindVertexArrayOES.set(this.vao),x&&x.bind(),d&&d.dynamicDraw&&d.bind(),T&&T.bind()):this.freshBind(a,o,u,d,_,x,T)},ha.prototype.freshBind=function(n,a,o,u,d,_,x){var T,z=n.numAttributes,L=this.context,j=L.gl;if(L.extVertexArrayObject)this.vao&&this.destroy(),this.vao=L.extVertexArrayObject.createVertexArrayOES(),L.bindVertexArrayOES.set(this.vao),T=0,this.boundProgram=n,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=u,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=_,this.boundDynamicVertexBuffer2=x;else{T=L.currentNumAttributes||0;for(var q=z;q<T;q++)j.disableVertexAttribArray(q)}a.enableAttributes(j,n);for(var Z=0,re=o;Z<re.length;Z+=1)re[Z].enableAttributes(j,n);_&&_.enableAttributes(j,n),x&&x.enableAttributes(j,n),a.bind(),a.setVertexAttribPointers(j,n,d);for(var $=0,se=o;$<se.length;$+=1){var Y=se[$];Y.bind(),Y.setVertexAttribPointers(j,n,d)}_&&(_.bind(),_.setVertexAttribPointers(j,n,d)),u&&u.bind(),x&&(x.bind(),x.setVertexAttribPointers(j,n,d)),L.currentNumAttributes=z},ha.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var kl=function(n,a,o,u,d,_){var x=n.gl;this.program=x.createProgram();for(var T=ys(o.staticAttributes),z=u?u.getBinderAttributes():[],L=T.concat(z),j=o.staticUniforms?ys(o.staticUniforms):[],q=u?u.getBinderUniforms():[],Z=[],re=0,$=j.concat(q);re<$.length;re+=1){var se=$[re];Z.indexOf(se)<0&&Z.push(se)}var Y=u?u.defines():[];_&&Y.push("#define OVERDRAW_INSPECTOR;");var oe=Y.concat(Kn.fragmentSource,o.fragmentSource).join(`
`),he=Y.concat(Kn.vertexSource,o.vertexSource).join(`
`),ge=x.createShader(x.FRAGMENT_SHADER);if(x.isContextLost())this.failedToCreate=!0;else{x.shaderSource(ge,oe),x.compileShader(ge),x.attachShader(this.program,ge);var Te=x.createShader(x.VERTEX_SHADER);if(x.isContextLost())this.failedToCreate=!0;else{x.shaderSource(Te,he),x.compileShader(Te),x.attachShader(this.program,Te),this.attributes={};var ve={};this.numAttributes=L.length;for(var Ae=0;Ae<this.numAttributes;Ae++)L[Ae]&&(x.bindAttribLocation(this.program,Ae,L[Ae]),this.attributes[L[Ae]]=Ae);x.linkProgram(this.program),x.deleteShader(Te),x.deleteShader(ge);for(var De=0;De<Z.length;De++){var Ne=Z[De];if(Ne&&!ve[Ne]){var Fe=x.getUniformLocation(this.program,Ne);Fe&&(ve[Ne]=Fe)}}this.fixedUniforms=d(n,ve),this.binderUniforms=u?u.getUniforms(n,ve):[]}}};function zl(n,a,o){var u=1/yr(o,1,a.transform.tileZoom),d=Math.pow(2,o.tileID.overscaledZ),_=o.tileSize*Math.pow(2,a.transform.tileZoom)/d,x=_*(o.tileID.canonical.x+o.tileID.wrap*d),T=_*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[u,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[x>>16,T>>16],u_pixel_coord_lower:[65535&x,65535&T]}}kl.prototype.draw=function(n,a,o,u,d,_,x,T,z,L,j,q,Z,re,$,se){var Y,oe=n.gl;if(!this.failedToCreate){for(var he in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(u),n.setColorMode(d),n.setCullFace(_),this.fixedUniforms)this.fixedUniforms[he].set(x[he]);re&&re.setUniforms(n,this.binderUniforms,q,{zoom:Z});for(var ge=(Y={},Y[oe.LINES]=2,Y[oe.TRIANGLES]=3,Y[oe.LINE_STRIP]=1,Y)[a],Te=0,ve=j.get();Te<ve.length;Te+=1){var Ae=ve[Te],De=Ae.vaos||(Ae.vaos={});(De[T]||(De[T]=new ha)).bind(n,this,z,re?re.getPaintVertexBuffers():[],L,Ae.vertexOffset,$,se),oe.drawElements(a,Ae.primitiveLength*ge,oe.UNSIGNED_SHORT,Ae.primitiveOffset*ge*2)}}};var Ba=function(n,a,o,u){var d=a.style.light,_=d.properties.get("position"),x=[_.x,_.y,_.z],T=s.create$1();d.properties.get("anchor")==="viewport"&&s.fromRotation(T,-a.transform.angle),s.transformMat3(x,x,T);var z=d.properties.get("color");return{u_matrix:n,u_lightpos:x,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[z.r,z.g,z.b],u_vertical_gradient:+o,u_opacity:u}},Oa=function(n,a,o,u,d,_,x){return s.extend(Ba(n,a,o,u),zl(_,a,x),{u_height_factor:-Math.pow(2,d.overscaledZ)/x.tileSize/8})},vn=function(n){return{u_matrix:n}},cn=function(n,a,o,u){return s.extend(vn(n),zl(o,a,u))},pa=function(n,a){return{u_matrix:n,u_world:a}},Al=function(n,a,o,u,d){return s.extend(cn(n,a,o,u),{u_world:d})},Fa=function(n,a,o,u){var d,_,x=n.transform;if(u.paint.get("circle-pitch-alignment")==="map"){var T=yr(o,1,x.zoom);d=!0,_=[T,T]}else d=!1,_=x.pixelsToGLUnits;return{u_camera_to_center_distance:x.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(a.posMatrix,o,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:s.browser.devicePixelRatio,u_extrude_scale:_}},gs=function(n,a,o){var u=yr(o,1,a.zoom),d=Math.pow(2,a.zoom-o.tileID.overscaledZ),_=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:a.cameraToCenterDistance,u_pixels_to_tile_units:u,u_extrude_scale:[a.pixelsToGLUnits[0]/(u*d),a.pixelsToGLUnits[1]/(u*d)],u_overscale_factor:_}},Pl=function(n,a,o){return{u_matrix:n,u_inv_matrix:a,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},Eo=function(n,a,o){return o===void 0&&(o=1),{u_matrix:n,u_color:a,u_overlay:0,u_overlay_scale:o}},Uo=function(n){return{u_matrix:n}},Cl=function(n,a,o,u){return{u_matrix:n,u_extrude_scale:yr(a,1,o),u_intensity:u}},_s=function(n,a,o){var u=n.transform;return{u_matrix:To(n,a,o),u_ratio:1/yr(a,1,u.zoom),u_device_pixel_ratio:s.browser.devicePixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},gr=function(n,a,o,u){return s.extend(_s(n,a,o),{u_image:0,u_image_height:u})},$o=function(n,a,o,u){var d=n.transform,_=Xn(a,d);return{u_matrix:To(n,a,o),u_texsize:a.imageAtlasTexture.size,u_ratio:1/yr(a,1,d.zoom),u_device_pixel_ratio:s.browser.devicePixelRatio,u_image:0,u_scale:[_,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},eu=function(n,a,o,u,d){var _=n.lineAtlas,x=Xn(a,n.transform),T=o.layout.get("line-cap")==="round",z=_.getDash(u.from,T),L=_.getDash(u.to,T),j=z.width*d.fromScale,q=L.width*d.toScale;return s.extend(_s(n,a,o),{u_patternscale_a:[x/j,-z.height/2],u_patternscale_b:[x/q,-L.height/2],u_sdfgamma:_.width/(256*Math.min(j,q)*s.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:L.y,u_mix:d.t})};function Xn(n,a){return 1/yr(n,1,a.tileZoom)}function To(n,a,o){return n.translatePosMatrix(a.tileID.posMatrix,a,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var Va=function(n,a,o,u,d){return{u_matrix:n,u_tl_parent:a,u_scale_parent:o,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(x=d.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(_=d.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:Ml(d.paint.get("raster-hue-rotate"))};var _,x};function Ml(n){n*=Math.PI/180;var a=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*a-o+1)/3,(Math.sqrt(3)*a-o+1)/3]}var fa,Rs=function(n,a,o,u,d,_,x,T,z,L){var j=d.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:j.cameraToCenterDistance,u_pitch:j.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:j.width/j.height,u_fade_change:d.options.fadeDuration?d.symbolFadeChange:1,u_matrix:_,u_label_plane_matrix:x,u_coord_matrix:T,u_is_text:+z,u_pitch_with_map:+u,u_texsize:L,u_texture:0}},vs=function(n,a,o,u,d,_,x,T,z,L,j){var q=d.transform;return s.extend(Rs(n,a,o,u,d,_,x,T,z,L),{u_gamma_scale:u?Math.cos(q._pitch)*q.cameraToCenterDistance:1,u_device_pixel_ratio:s.browser.devicePixelRatio,u_is_halo:+j})},da=function(n,a,o,u,d,_,x,T,z,L){return s.extend(vs(n,a,o,u,d,_,x,T,!0,z,!0),{u_texsize_icon:L,u_texture_icon:1})},ma=function(n,a,o){return{u_matrix:n,u_opacity:a,u_color:o}},$a=function(n,a,o,u,d,_){return s.extend(function(x,T,z,L){var j=z.imageManager.getPattern(x.from.toString()),q=z.imageManager.getPattern(x.to.toString()),Z=z.imageManager.getPixelSize(),re=Z.width,$=Z.height,se=Math.pow(2,L.tileID.overscaledZ),Y=L.tileSize*Math.pow(2,z.transform.tileZoom)/se,oe=Y*(L.tileID.canonical.x+L.tileID.wrap*se),he=Y*L.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:q.tl,u_pattern_br_b:q.br,u_texsize:[re,$],u_mix:T.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:q.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/yr(L,1,z.transform.tileZoom),u_pixel_coord_upper:[oe>>16,he>>16],u_pixel_coord_lower:[65535&oe,65535&he]}}(u,_,o,d),{u_matrix:n,u_opacity:a})},Dl={fillExtrusion:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_lightpos:new s.Uniform3f(n,a.u_lightpos),u_lightintensity:new s.Uniform1f(n,a.u_lightintensity),u_lightcolor:new s.Uniform3f(n,a.u_lightcolor),u_vertical_gradient:new s.Uniform1f(n,a.u_vertical_gradient),u_opacity:new s.Uniform1f(n,a.u_opacity)}},fillExtrusionPattern:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_lightpos:new s.Uniform3f(n,a.u_lightpos),u_lightintensity:new s.Uniform1f(n,a.u_lightintensity),u_lightcolor:new s.Uniform3f(n,a.u_lightcolor),u_vertical_gradient:new s.Uniform1f(n,a.u_vertical_gradient),u_height_factor:new s.Uniform1f(n,a.u_height_factor),u_image:new s.Uniform1i(n,a.u_image),u_texsize:new s.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new s.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new s.Uniform3f(n,a.u_scale),u_fade:new s.Uniform1f(n,a.u_fade),u_opacity:new s.Uniform1f(n,a.u_opacity)}},fill:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix)}},fillPattern:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_image:new s.Uniform1i(n,a.u_image),u_texsize:new s.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new s.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new s.Uniform3f(n,a.u_scale),u_fade:new s.Uniform1f(n,a.u_fade)}},fillOutline:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_world:new s.Uniform2f(n,a.u_world)}},fillOutlinePattern:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_world:new s.Uniform2f(n,a.u_world),u_image:new s.Uniform1i(n,a.u_image),u_texsize:new s.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new s.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new s.Uniform3f(n,a.u_scale),u_fade:new s.Uniform1f(n,a.u_fade)}},circle:function(n,a){return{u_camera_to_center_distance:new s.Uniform1f(n,a.u_camera_to_center_distance),u_scale_with_map:new s.Uniform1i(n,a.u_scale_with_map),u_pitch_with_map:new s.Uniform1i(n,a.u_pitch_with_map),u_extrude_scale:new s.Uniform2f(n,a.u_extrude_scale),u_device_pixel_ratio:new s.Uniform1f(n,a.u_device_pixel_ratio),u_matrix:new s.UniformMatrix4f(n,a.u_matrix)}},collisionBox:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_camera_to_center_distance:new s.Uniform1f(n,a.u_camera_to_center_distance),u_pixels_to_tile_units:new s.Uniform1f(n,a.u_pixels_to_tile_units),u_extrude_scale:new s.Uniform2f(n,a.u_extrude_scale),u_overscale_factor:new s.Uniform1f(n,a.u_overscale_factor)}},collisionCircle:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_inv_matrix:new s.UniformMatrix4f(n,a.u_inv_matrix),u_camera_to_center_distance:new s.Uniform1f(n,a.u_camera_to_center_distance),u_viewport_size:new s.Uniform2f(n,a.u_viewport_size)}},debug:function(n,a){return{u_color:new s.UniformColor(n,a.u_color),u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_overlay:new s.Uniform1i(n,a.u_overlay),u_overlay_scale:new s.Uniform1f(n,a.u_overlay_scale)}},clippingMask:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix)}},heatmap:function(n,a){return{u_extrude_scale:new s.Uniform1f(n,a.u_extrude_scale),u_intensity:new s.Uniform1f(n,a.u_intensity),u_matrix:new s.UniformMatrix4f(n,a.u_matrix)}},heatmapTexture:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_world:new s.Uniform2f(n,a.u_world),u_image:new s.Uniform1i(n,a.u_image),u_color_ramp:new s.Uniform1i(n,a.u_color_ramp),u_opacity:new s.Uniform1f(n,a.u_opacity)}},hillshade:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_image:new s.Uniform1i(n,a.u_image),u_latrange:new s.Uniform2f(n,a.u_latrange),u_light:new s.Uniform2f(n,a.u_light),u_shadow:new s.UniformColor(n,a.u_shadow),u_highlight:new s.UniformColor(n,a.u_highlight),u_accent:new s.UniformColor(n,a.u_accent)}},hillshadePrepare:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_image:new s.Uniform1i(n,a.u_image),u_dimension:new s.Uniform2f(n,a.u_dimension),u_zoom:new s.Uniform1f(n,a.u_zoom),u_unpack:new s.Uniform4f(n,a.u_unpack)}},line:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_ratio:new s.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new s.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(n,a.u_units_to_pixels)}},lineGradient:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_ratio:new s.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new s.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(n,a.u_units_to_pixels),u_image:new s.Uniform1i(n,a.u_image),u_image_height:new s.Uniform1f(n,a.u_image_height)}},linePattern:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_texsize:new s.Uniform2f(n,a.u_texsize),u_ratio:new s.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new s.Uniform1f(n,a.u_device_pixel_ratio),u_image:new s.Uniform1i(n,a.u_image),u_units_to_pixels:new s.Uniform2f(n,a.u_units_to_pixels),u_scale:new s.Uniform3f(n,a.u_scale),u_fade:new s.Uniform1f(n,a.u_fade)}},lineSDF:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_ratio:new s.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new s.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(n,a.u_units_to_pixels),u_patternscale_a:new s.Uniform2f(n,a.u_patternscale_a),u_patternscale_b:new s.Uniform2f(n,a.u_patternscale_b),u_sdfgamma:new s.Uniform1f(n,a.u_sdfgamma),u_image:new s.Uniform1i(n,a.u_image),u_tex_y_a:new s.Uniform1f(n,a.u_tex_y_a),u_tex_y_b:new s.Uniform1f(n,a.u_tex_y_b),u_mix:new s.Uniform1f(n,a.u_mix)}},raster:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_tl_parent:new s.Uniform2f(n,a.u_tl_parent),u_scale_parent:new s.Uniform1f(n,a.u_scale_parent),u_buffer_scale:new s.Uniform1f(n,a.u_buffer_scale),u_fade_t:new s.Uniform1f(n,a.u_fade_t),u_opacity:new s.Uniform1f(n,a.u_opacity),u_image0:new s.Uniform1i(n,a.u_image0),u_image1:new s.Uniform1i(n,a.u_image1),u_brightness_low:new s.Uniform1f(n,a.u_brightness_low),u_brightness_high:new s.Uniform1f(n,a.u_brightness_high),u_saturation_factor:new s.Uniform1f(n,a.u_saturation_factor),u_contrast_factor:new s.Uniform1f(n,a.u_contrast_factor),u_spin_weights:new s.Uniform3f(n,a.u_spin_weights)}},symbolIcon:function(n,a){return{u_is_size_zoom_constant:new s.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new s.Uniform1f(n,a.u_size_t),u_size:new s.Uniform1f(n,a.u_size),u_camera_to_center_distance:new s.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new s.Uniform1f(n,a.u_pitch),u_rotate_symbol:new s.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new s.Uniform1f(n,a.u_fade_change),u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new s.Uniform1i(n,a.u_is_text),u_pitch_with_map:new s.Uniform1i(n,a.u_pitch_with_map),u_texsize:new s.Uniform2f(n,a.u_texsize),u_texture:new s.Uniform1i(n,a.u_texture)}},symbolSDF:function(n,a){return{u_is_size_zoom_constant:new s.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new s.Uniform1f(n,a.u_size_t),u_size:new s.Uniform1f(n,a.u_size),u_camera_to_center_distance:new s.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new s.Uniform1f(n,a.u_pitch),u_rotate_symbol:new s.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new s.Uniform1f(n,a.u_fade_change),u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new s.Uniform1i(n,a.u_is_text),u_pitch_with_map:new s.Uniform1i(n,a.u_pitch_with_map),u_texsize:new s.Uniform2f(n,a.u_texsize),u_texture:new s.Uniform1i(n,a.u_texture),u_gamma_scale:new s.Uniform1f(n,a.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(n,a.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(n,a.u_is_halo)}},symbolTextAndIcon:function(n,a){return{u_is_size_zoom_constant:new s.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new s.Uniform1f(n,a.u_size_t),u_size:new s.Uniform1f(n,a.u_size),u_camera_to_center_distance:new s.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new s.Uniform1f(n,a.u_pitch),u_rotate_symbol:new s.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new s.Uniform1f(n,a.u_fade_change),u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new s.Uniform1i(n,a.u_is_text),u_pitch_with_map:new s.Uniform1i(n,a.u_pitch_with_map),u_texsize:new s.Uniform2f(n,a.u_texsize),u_texsize_icon:new s.Uniform2f(n,a.u_texsize_icon),u_texture:new s.Uniform1i(n,a.u_texture),u_texture_icon:new s.Uniform1i(n,a.u_texture_icon),u_gamma_scale:new s.Uniform1f(n,a.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(n,a.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(n,a.u_is_halo)}},background:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_opacity:new s.Uniform1f(n,a.u_opacity),u_color:new s.UniformColor(n,a.u_color)}},backgroundPattern:function(n,a){return{u_matrix:new s.UniformMatrix4f(n,a.u_matrix),u_opacity:new s.Uniform1f(n,a.u_opacity),u_image:new s.Uniform1i(n,a.u_image),u_pattern_tl_a:new s.Uniform2f(n,a.u_pattern_tl_a),u_pattern_br_a:new s.Uniform2f(n,a.u_pattern_br_a),u_pattern_tl_b:new s.Uniform2f(n,a.u_pattern_tl_b),u_pattern_br_b:new s.Uniform2f(n,a.u_pattern_br_b),u_texsize:new s.Uniform2f(n,a.u_texsize),u_mix:new s.Uniform1f(n,a.u_mix),u_pattern_size_a:new s.Uniform2f(n,a.u_pattern_size_a),u_pattern_size_b:new s.Uniform2f(n,a.u_pattern_size_b),u_scale_a:new s.Uniform1f(n,a.u_scale_a),u_scale_b:new s.Uniform1f(n,a.u_scale_b),u_pixel_coord_upper:new s.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(n,a.u_pixel_coord_lower),u_tile_units_to_pixels:new s.Uniform1f(n,a.u_tile_units_to_pixels)}}};function Io(n,a,o,u,d,_,x){for(var T=n.context,z=T.gl,L=n.useProgram("collisionBox"),j=[],q=0,Z=0,re=0;re<u.length;re++){var $=u[re],se=a.getTile($),Y=se.getBucket(o);if(Y){var oe=$.posMatrix;d[0]===0&&d[1]===0||(oe=n.translatePosMatrix($.posMatrix,se,d,_));var he=x?Y.textCollisionBox:Y.iconCollisionBox,ge=Y.collisionCircleArray;if(ge.length>0){var Te=s.create(),ve=oe;s.mul(Te,Y.placementInvProjMatrix,n.transform.glCoordMatrix),s.mul(Te,Te,Y.placementViewportMatrix),j.push({circleArray:ge,circleOffset:Z,transform:ve,invTransform:Te}),Z=q+=ge.length/4}he&&L.draw(T,z.LINES,G.disabled,J.disabled,n.colorModeForRenderPass(),ce.disabled,gs(oe,n.transform,se),o.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,null,n.transform.zoom,null,null,he.collisionVertexBuffer)}}if(x&&j.length){var Ae=n.useProgram("collisionCircle"),De=new s.StructArrayLayout2f1f2i16;De.resize(4*q),De._trim();for(var Ne=0,Fe=0,nt=j;Fe<nt.length;Fe+=1)for(var yt=nt[Fe],vt=0;vt<yt.circleArray.length/4;vt++){var _t=4*vt,or=yt.circleArray[_t+0],ot=yt.circleArray[_t+1],St=yt.circleArray[_t+2],Vt=yt.circleArray[_t+3];De.emplace(Ne++,or,ot,St,Vt,0),De.emplace(Ne++,or,ot,St,Vt,1),De.emplace(Ne++,or,ot,St,Vt,2),De.emplace(Ne++,or,ot,St,Vt,3)}(!fa||fa.length<2*q)&&(fa=function(Wr){var wn=2*Wr,Gi=new s.StructArrayLayout3ui6;Gi.resize(wn),Gi._trim();for(var Hr=0;Hr<wn;Hr++){var ui=6*Hr;Gi.uint16[ui+0]=4*Hr+0,Gi.uint16[ui+1]=4*Hr+1,Gi.uint16[ui+2]=4*Hr+2,Gi.uint16[ui+3]=4*Hr+2,Gi.uint16[ui+4]=4*Hr+3,Gi.uint16[ui+5]=4*Hr+0}return Gi}(q));for(var Tt=T.createIndexBuffer(fa,!0),kt=T.createVertexBuffer(De,s.collisionCircleLayout.members,!0),Rt=0,Et=j;Rt<Et.length;Rt+=1){var xt=Et[Rt],Ri=Pl(xt.transform,xt.invTransform,n.transform);Ae.draw(T,z.TRIANGLES,G.disabled,J.disabled,n.colorModeForRenderPass(),ce.disabled,Ri,o.id,kt,Tt,s.SegmentVector.simpleSegment(0,2*xt.circleOffset,xt.circleArray.length,xt.circleArray.length/2),null,n.transform.zoom,null,null,null)}kt.destroy(),Tt.destroy()}}var ko=s.identity(new Float32Array(16));function es(n,a,o,u,d,_){var x=s.getAnchorAlignment(n),T=-(x.horizontalAlign-.5)*a,z=-(x.verticalAlign-.5)*o,L=s.evaluateVariableOffset(n,u);return new s.Point((T/d+L[0])*_,(z/d+L[1])*_)}function ts(n,a,o,u,d,_,x,T,z,L,j){var q=n.text.placedSymbolArray,Z=n.text.dynamicLayoutVertexArray,re=n.icon.dynamicLayoutVertexArray,$={};Z.clear();for(var se=0;se<q.length;se++){var Y=q.get(se),oe=Y.hidden||!Y.crossTileID||n.allowVerticalPlacement&&!Y.placedOrientation?null:u[Y.crossTileID];if(oe){var he=new s.Point(Y.anchorX,Y.anchorY),ge=Lt(he,o?T:x),Te=$t(_.cameraToCenterDistance,ge.signedDistanceFromCamera),ve=d.evaluateSizeForFeature(n.textSizeData,L,Y)*Te/s.ONE_EM;o&&(ve*=n.tilePixelRatio/z);for(var Ae=es(oe.anchor,oe.width,oe.height,oe.textOffset,oe.textBoxScale,ve),De=o?Lt(he.add(Ae),x).point:ge.point.add(a?Ae.rotate(-_.angle):Ae),Ne=n.allowVerticalPlacement&&Y.placedOrientation===s.WritingMode.vertical?Math.PI/2:0,Fe=0;Fe<Y.numGlyphs;Fe++)s.addDynamicAttributes(Z,De,Ne);j&&Y.associatedIconIndex>=0&&($[Y.associatedIconIndex]={shiftedAnchor:De,angle:Ne})}else qr(Y.numGlyphs,Z)}if(j){re.clear();for(var nt=n.icon.placedSymbolArray,yt=0;yt<nt.length;yt++){var vt=nt.get(yt);if(vt.hidden)qr(vt.numGlyphs,re);else{var _t=$[yt];if(_t)for(var or=0;or<vt.numGlyphs;or++)s.addDynamicAttributes(re,_t.shiftedAnchor,_t.angle);else qr(vt.numGlyphs,re)}}n.icon.dynamicLayoutVertexBuffer.updateData(re)}n.text.dynamicLayoutVertexBuffer.updateData(Z)}function Ll(n,a,o){return o.iconsInText&&a?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function zo(n,a,o,u,d,_,x,T,z,L,j,q){for(var Z=n.context,re=Z.gl,$=n.transform,se=T==="map",Y=z==="map",oe=se&&o.layout.get("symbol-placement")!=="point",he=se&&!Y&&!oe,ge=o.layout.get("symbol-sort-key").constantOr(1)!==void 0,Te=!1,ve=n.depthModeForSublayer(0,G.ReadOnly),Ae=o.layout.get("text-variable-anchor"),De=[],Ne=0,Fe=u;Ne<Fe.length;Ne+=1){var nt=Fe[Ne],yt=a.getTile(nt),vt=yt.getBucket(o);if(vt){var _t=d?vt.text:vt.icon;if(_t&&_t.segments.get().length){var or=_t.programConfigurations.get(o.id),ot=d||vt.sdfIcons,St=d?vt.textSizeData:vt.iconSizeData,Vt=Y||$.pitch!==0,Tt=n.useProgram(Ll(ot,d,vt),or),kt=s.evaluateSizeForZoom(St,$.zoom),Rt=void 0,Et=[0,0],xt=void 0,Ri=void 0,Wr=null,wn=void 0;if(d)xt=yt.glyphAtlasTexture,Ri=re.LINEAR,Rt=yt.glyphAtlasTexture.size,vt.iconsInText&&(Et=yt.imageAtlasTexture.size,Wr=yt.imageAtlasTexture,wn=Vt||n.options.rotating||n.options.zooming||St.kind==="composite"||St.kind==="camera"?re.LINEAR:re.NEAREST);else{var Gi=o.layout.get("icon-size").constantOr(0)!==1||vt.iconsNeedLinear;xt=yt.imageAtlasTexture,Ri=ot||n.options.rotating||n.options.zooming||Gi||Vt?re.LINEAR:re.NEAREST,Rt=yt.imageAtlasTexture.size}var Hr=yr(yt,1,n.transform.zoom),ui=mr(nt.posMatrix,Y,se,n.transform,Hr),$i=rr(nt.posMatrix,Y,se,n.transform,Hr),Sn=Ae&&vt.hasTextData(),ba=o.layout.get("icon-text-fit")!=="none"&&Sn&&vt.hasIconData();oe&&ao(vt,nt.posMatrix,n,d,ui,$i,Y,L);var $n=n.translatePosMatrix(nt.posMatrix,yt,_,x),Go=oe||d&&Ae||ba?ko:ui,Po=n.translatePosMatrix($i,yt,_,x,!0),js=ot&&o.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0,ls={program:Tt,buffers:_t,uniformValues:ot?vt.iconsInText?da(St.kind,kt,he,Y,n,$n,Go,Po,Rt,Et):vs(St.kind,kt,he,Y,n,$n,Go,Po,d,Rt,!0):Rs(St.kind,kt,he,Y,n,$n,Go,Po,d,Rt),atlasTexture:xt,atlasTextureIcon:Wr,atlasInterpolation:Ri,atlasInterpolationIcon:wn,isSDF:ot,hasHalo:js};if(ge&&vt.canOverlap){Te=!0;for(var wa=0,na=_t.segments.get();wa<na.length;wa+=1){var qs=na[wa];De.push({segments:new s.SegmentVector([qs]),sortKey:qs.sortKey,state:ls})}}else De.push({segments:_t.segments,sortKey:0,state:ls})}}}Te&&De.sort(function(Co,us){return Co.sortKey-us.sortKey});for(var Ko=0,dl=De;Ko<dl.length;Ko+=1){var oa=dl[Ko],Bi=oa.state;if(Z.activeTexture.set(re.TEXTURE0),Bi.atlasTexture.bind(Bi.atlasInterpolation,re.CLAMP_TO_EDGE),Bi.atlasTextureIcon&&(Z.activeTexture.set(re.TEXTURE1),Bi.atlasTextureIcon&&Bi.atlasTextureIcon.bind(Bi.atlasInterpolationIcon,re.CLAMP_TO_EDGE)),Bi.isSDF){var Sa=Bi.uniformValues;Bi.hasHalo&&(Sa.u_is_halo=1,Na(Bi.buffers,oa.segments,o,n,Bi.program,ve,j,q,Sa)),Sa.u_is_halo=0}Na(Bi.buffers,oa.segments,o,n,Bi.program,ve,j,q,Bi.uniformValues)}}function Na(n,a,o,u,d,_,x,T,z){var L=u.context;d.draw(L,L.gl.TRIANGLES,_,x,T,ce.disabled,z,o.id,n.layoutVertexBuffer,n.indexBuffer,a,o.paint,u.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function xs(n,a,o,u,d,_,x){var T,z,L,j,q,Z=n.context.gl,re=o.paint.get("fill-pattern"),$=re&&re.constantOr(1),se=o.getCrossfadeParameters();x?(z=$&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",T=Z.LINES):(z=$?"fillPattern":"fill",T=Z.TRIANGLES);for(var Y=0,oe=u;Y<oe.length;Y+=1){var he=oe[Y],ge=a.getTile(he);if(!$||ge.patternsLoaded()){var Te=ge.getBucket(o);if(Te){var ve=Te.programConfigurations.get(o.id),Ae=n.useProgram(z,ve);$&&(n.context.activeTexture.set(Z.TEXTURE0),ge.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),ve.updatePaintBuffers(se));var De=re.constantOr(null);if(De&&ge.imageAtlas){var Ne=ge.imageAtlas,Fe=Ne.patternPositions[De.to.toString()],nt=Ne.patternPositions[De.from.toString()];Fe&&nt&&ve.setConstantPatternPositions(Fe,nt)}var yt=n.translatePosMatrix(he.posMatrix,ge,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(x){j=Te.indexBuffer2,q=Te.segments2;var vt=[Z.drawingBufferWidth,Z.drawingBufferHeight];L=z==="fillOutlinePattern"&&$?Al(yt,n,se,ge,vt):pa(yt,vt)}else j=Te.indexBuffer,q=Te.segments,L=$?cn(yt,n,se,ge):vn(yt);Ae.draw(n.context,T,d,n.stencilModeForClipping(he),_,ce.disabled,L,o.id,Te.layoutVertexBuffer,j,q,o.paint,n.transform.zoom,ve)}}}}function il(n,a,o,u,d,_,x){for(var T=n.context,z=T.gl,L=o.paint.get("fill-extrusion-pattern"),j=L.constantOr(1),q=o.getCrossfadeParameters(),Z=o.paint.get("fill-extrusion-opacity"),re=0,$=u;re<$.length;re+=1){var se=$[re],Y=a.getTile(se),oe=Y.getBucket(o);if(oe){var he=oe.programConfigurations.get(o.id),ge=n.useProgram(j?"fillExtrusionPattern":"fillExtrusion",he);j&&(n.context.activeTexture.set(z.TEXTURE0),Y.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),he.updatePaintBuffers(q));var Te=L.constantOr(null);if(Te&&Y.imageAtlas){var ve=Y.imageAtlas,Ae=ve.patternPositions[Te.to.toString()],De=ve.patternPositions[Te.from.toString()];Ae&&De&&he.setConstantPatternPositions(Ae,De)}var Ne=n.translatePosMatrix(se.posMatrix,Y,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Fe=o.paint.get("fill-extrusion-vertical-gradient"),nt=j?Oa(Ne,n,Fe,Z,se,q,Y):Ba(Ne,n,Fe,Z);ge.draw(T,T.gl.TRIANGLES,d,_,x,ce.backCCW,nt,o.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,o.paint,n.transform.zoom,he)}}}function Bs(n,a,o,u,d,_){var x=n.context,T=x.gl,z=a.fbo;if(z){var L=n.useProgram("hillshade");x.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,z.colorAttachment.get());var j=function(q,Z,re){var $=re.paint.get("hillshade-shadow-color"),se=re.paint.get("hillshade-highlight-color"),Y=re.paint.get("hillshade-accent-color"),oe=re.paint.get("hillshade-illumination-direction")*(Math.PI/180);re.paint.get("hillshade-illumination-anchor")==="viewport"&&(oe-=q.transform.angle);var he,ge,Te,ve=!q.options.moving;return{u_matrix:q.transform.calculatePosMatrix(Z.tileID.toUnwrapped(),ve),u_image:0,u_latrange:(he=Z.tileID,ge=Math.pow(2,he.canonical.z),Te=he.canonical.y,[new s.MercatorCoordinate(0,Te/ge).toLngLat().lat,new s.MercatorCoordinate(0,(Te+1)/ge).toLngLat().lat]),u_light:[re.paint.get("hillshade-exaggeration"),oe],u_shadow:$,u_highlight:se,u_accent:Y}}(n,a,o);L.draw(x,T.TRIANGLES,u,d,_,ce.disabled,j,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function ya(n,a,o,u,d,_){var x=n.context,T=x.gl,z=a.dem;if(z&&z.data){var L=z.dim,j=z.stride,q=z.getPixels();if(x.activeTexture.set(T.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||n.getTileTexture(j),a.demTexture){var Z=a.demTexture;Z.update(q,{premultiply:!1}),Z.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else a.demTexture=new s.Texture(x,q,T.RGBA,{premultiply:!1}),a.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);x.activeTexture.set(T.TEXTURE0);var re=a.fbo;if(!re){var $=new s.Texture(x,{width:L,height:L,data:null},T.RGBA);$.bind(T.LINEAR,T.CLAMP_TO_EDGE),(re=a.fbo=x.createFramebuffer(L,L,!0)).colorAttachment.set($.texture)}x.bindFramebuffer.set(re.framebuffer),x.viewport.set([0,0,L,L]),n.useProgram("hillshadePrepare").draw(x,T.TRIANGLES,u,d,_,ce.disabled,function(se,Y){var oe=Y.stride,he=s.create();return s.ortho(he,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(he,he,[0,-s.EXTENT,0]),{u_matrix:he,u_image:1,u_dimension:[oe,oe],u_zoom:se.overscaledZ,u_unpack:Y.getUnpackVector()}}(a.tileID,z),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function Wn(n,a,o,u,d){var _=u.paint.get("raster-fade-duration");if(_>0){var x=s.browser.now(),T=(x-n.timeAdded)/_,z=a?(x-a.timeAdded)/_:-1,L=o.getSource(),j=d.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),q=!a||Math.abs(a.tileID.overscaledZ-j)>Math.abs(n.tileID.overscaledZ-j),Z=q&&n.refreshedUponExpiration?1:s.clamp(q?T:1-z,0,1);return n.refreshedUponExpiration&&T>=1&&(n.refreshedUponExpiration=!1),a?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}var ea=new s.Color(1,0,0,1),Rl=new s.Color(0,1,0,1),rs=new s.Color(0,0,1,1),Bl=new s.Color(1,0,1,1),nl=new s.Color(0,1,1,1);function Ua(n,a,o,u){bs(n,0,a+o/2,n.transform.width,o,u)}function is(n,a,o,u){bs(n,a-o/2,0,o,n.transform.height,u)}function bs(n,a,o,u,d,_){var x=n.context,T=x.gl;T.enable(T.SCISSOR_TEST),T.scissor(a*s.browser.devicePixelRatio,o*s.browser.devicePixelRatio,u*s.browser.devicePixelRatio,d*s.browser.devicePixelRatio),x.clear({color:_}),T.disable(T.SCISSOR_TEST)}function Ol(n,a,o){var u=n.context,d=u.gl,_=o.posMatrix,x=n.useProgram("debug"),T=G.disabled,z=J.disabled,L=n.colorModeForRenderPass();u.activeTexture.set(d.TEXTURE0),n.emptyTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE),x.draw(u,d.LINE_STRIP,T,z,L,ce.disabled,Eo(_,s.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var j=a.getTileByID(o.key).latestRawTileData,q=Math.floor((j&&j.byteLength||0)/1024),Z=a.getTile(o).tileSize,re=512/Math.min(Z,512)*(o.overscaledZ/n.transform.zoom)*.5,$=o.canonical.toString();o.overscaledZ!==o.canonical.z&&($+=" => "+o.overscaledZ),function(se,Y){se.initDebugOverlayCanvas();var oe=se.debugOverlayCanvas,he=se.context.gl,ge=se.debugOverlayCanvas.getContext("2d");ge.clearRect(0,0,oe.width,oe.height),ge.shadowColor="white",ge.shadowBlur=2,ge.lineWidth=1.5,ge.strokeStyle="white",ge.textBaseline="top",ge.font="bold 36px Open Sans, sans-serif",ge.fillText(Y,5,5),ge.strokeText(Y,5,5),se.debugOverlayTexture.update(oe),se.debugOverlayTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE)}(n,$+" "+q+"kb"),x.draw(u,d.TRIANGLES,T,z,le.alphaBlended,ce.disabled,Eo(_,s.Color.transparent,re),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var ho={symbol:function(n,a,o,u,d){if(n.renderPass==="translucent"){var _=J.disabled,x=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(T,z,L,j,q,Z,re){for(var $=z.transform,se=q==="map",Y=Z==="map",oe=0,he=T;oe<he.length;oe+=1){var ge=he[oe],Te=j.getTile(ge),ve=Te.getBucket(L);if(ve&&ve.text&&ve.text.segments.get().length){var Ae=s.evaluateSizeForZoom(ve.textSizeData,$.zoom),De=yr(Te,1,z.transform.zoom),Ne=mr(ge.posMatrix,Y,se,z.transform,De),Fe=L.layout.get("icon-text-fit")!=="none"&&ve.hasIconData();if(Ae){var nt=Math.pow(2,$.zoom-Te.tileID.overscaledZ);ts(ve,se,Y,re,s.symbolSize,$,Ne,ge.posMatrix,nt,Ae,Fe)}}}}(u,n,o,a,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),d),o.paint.get("icon-opacity").constantOr(1)!==0&&zo(n,a,o,u,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),_,x),o.paint.get("text-opacity").constantOr(1)!==0&&zo(n,a,o,u,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),_,x),a.map.showCollisionBoxes&&(Io(n,a,o,u,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Io(n,a,o,u,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,a,o,u){if(n.renderPass==="translucent"){var d=o.paint.get("circle-opacity"),_=o.paint.get("circle-stroke-width"),x=o.paint.get("circle-stroke-opacity"),T=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(d.constantOr(1)!==0||_.constantOr(1)!==0&&x.constantOr(1)!==0){for(var z=n.context,L=z.gl,j=n.depthModeForSublayer(0,G.ReadOnly),q=J.disabled,Z=n.colorModeForRenderPass(),re=[],$=0;$<u.length;$++){var se=u[$],Y=a.getTile(se),oe=Y.getBucket(o);if(oe){var he=oe.programConfigurations.get(o.id),ge={programConfiguration:he,program:n.useProgram("circle",he),layoutVertexBuffer:oe.layoutVertexBuffer,indexBuffer:oe.indexBuffer,uniformValues:Fa(n,se,Y,o)};if(T)for(var Te=0,ve=oe.segments.get();Te<ve.length;Te+=1){var Ae=ve[Te];re.push({segments:new s.SegmentVector([Ae]),sortKey:Ae.sortKey,state:ge})}else re.push({segments:oe.segments,sortKey:0,state:ge})}}T&&re.sort(function(yt,vt){return yt.sortKey-vt.sortKey});for(var De=0,Ne=re;De<Ne.length;De+=1){var Fe=Ne[De],nt=Fe.state;nt.program.draw(z,L.TRIANGLES,j,q,Z,ce.disabled,nt.uniformValues,o.id,nt.layoutVertexBuffer,nt.indexBuffer,Fe.segments,o.paint,n.transform.zoom,nt.programConfiguration)}}}},heatmap:function(n,a,o,u){if(o.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var d=n.context,_=d.gl,x=J.disabled,T=new le([_.ONE,_.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(re,$,se){var Y=re.gl;re.activeTexture.set(Y.TEXTURE1),re.viewport.set([0,0,$.width/4,$.height/4]);var oe=se.heatmapFbo;if(oe)Y.bindTexture(Y.TEXTURE_2D,oe.colorAttachment.get()),re.bindFramebuffer.set(oe.framebuffer);else{var he=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,he),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),oe=se.heatmapFbo=re.createFramebuffer($.width/4,$.height/4,!1),function(ge,Te,ve,Ae){var De=ge.gl;De.texImage2D(De.TEXTURE_2D,0,De.RGBA,Te.width/4,Te.height/4,0,De.RGBA,ge.extRenderToTextureHalfFloat?ge.extTextureHalfFloat.HALF_FLOAT_OES:De.UNSIGNED_BYTE,null),Ae.colorAttachment.set(ve)}(re,$,he,oe)}})(d,n,o),d.clear({color:s.Color.transparent});for(var z=0;z<u.length;z++){var L=u[z];if(!a.hasRenderableParent(L)){var j=a.getTile(L),q=j.getBucket(o);if(q){var Z=q.programConfigurations.get(o.id);n.useProgram("heatmap",Z).draw(d,_.TRIANGLES,G.disabled,x,T,ce.disabled,Cl(L.posMatrix,j,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,q.layoutVertexBuffer,q.indexBuffer,q.segments,o.paint,n.transform.zoom,Z)}}}d.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(re,$){var se=re.context,Y=se.gl,oe=$.heatmapFbo;if(oe){se.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,oe.colorAttachment.get()),se.activeTexture.set(Y.TEXTURE1);var he=$.colorRampTexture;he||(he=$.colorRampTexture=new s.Texture(se,$.colorRamp,Y.RGBA)),he.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),re.useProgram("heatmapTexture").draw(se,Y.TRIANGLES,G.disabled,J.disabled,re.colorModeForRenderPass(),ce.disabled,function(ge,Te,ve,Ae){var De=s.create();s.ortho(De,0,ge.width,ge.height,0,0,1);var Ne=ge.context.gl;return{u_matrix:De,u_world:[Ne.drawingBufferWidth,Ne.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Te.paint.get("heatmap-opacity")}}(re,$),$.id,re.viewportBuffer,re.quadTriangleIndexBuffer,re.viewportSegments,$.paint,re.transform.zoom)}}(n,o))},line:function(n,a,o,u){if(n.renderPass==="translucent"){var d=o.paint.get("line-opacity"),_=o.paint.get("line-width");if(d.constantOr(1)!==0&&_.constantOr(1)!==0)for(var x=n.depthModeForSublayer(0,G.ReadOnly),T=n.colorModeForRenderPass(),z=o.paint.get("line-dasharray"),L=o.paint.get("line-pattern"),j=L.constantOr(1),q=o.paint.get("line-gradient"),Z=o.getCrossfadeParameters(),re=j?"linePattern":z?"lineSDF":q?"lineGradient":"line",$=n.context,se=$.gl,Y=!0,oe=0,he=u;oe<he.length;oe+=1){var ge=he[oe],Te=a.getTile(ge);if(!j||Te.patternsLoaded()){var ve=Te.getBucket(o);if(ve){var Ae=ve.programConfigurations.get(o.id),De=n.context.program.get(),Ne=n.useProgram(re,Ae),Fe=Y||Ne.program!==De,nt=L.constantOr(null);if(nt&&Te.imageAtlas){var yt=Te.imageAtlas,vt=yt.patternPositions[nt.to.toString()],_t=yt.patternPositions[nt.from.toString()];vt&&_t&&Ae.setConstantPatternPositions(vt,_t)}var or=j?$o(n,Te,o,Z):z?eu(n,Te,o,z,Z):q?gr(n,Te,o,ve.lineClipsArray.length):_s(n,Te,o);if(j)$.activeTexture.set(se.TEXTURE0),Te.imageAtlasTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE),Ae.updatePaintBuffers(Z);else if(z&&(Fe||n.lineAtlas.dirty))$.activeTexture.set(se.TEXTURE0),n.lineAtlas.bind($);else if(q){var ot=ve.gradients[o.id],St=ot.texture;if(o.gradientVersion!==ot.version){var Vt=256;if(o.stepInterpolant){var Tt=a.getSource().maxzoom,kt=ge.canonical.z===Tt?Math.ceil(1<<n.transform.maxZoom-ge.canonical.z):1;Vt=s.clamp(s.nextPowerOfTwo(ve.maxLineLength/s.EXTENT*1024*kt),256,$.maxTextureSize)}ot.gradient=s.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Vt,image:ot.gradient||void 0,clips:ve.lineClipsArray}),ot.texture?ot.texture.update(ot.gradient):ot.texture=new s.Texture($,ot.gradient,se.RGBA),ot.version=o.gradientVersion,St=ot.texture}$.activeTexture.set(se.TEXTURE0),St.bind(o.stepInterpolant?se.NEAREST:se.LINEAR,se.CLAMP_TO_EDGE)}Ne.draw($,se.TRIANGLES,x,n.stencilModeForClipping(ge),T,ce.disabled,or,o.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,o.paint,n.transform.zoom,Ae,ve.layoutVertexBuffer2),Y=!1}}}}},fill:function(n,a,o,u){var d=o.paint.get("fill-color"),_=o.paint.get("fill-opacity");if(_.constantOr(1)!==0){var x=n.colorModeForRenderPass(),T=o.paint.get("fill-pattern"),z=n.opaquePassEnabledForLayer()&&!T.constantOr(1)&&d.constantOr(s.Color.transparent).a===1&&_.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===z){var L=n.depthModeForSublayer(1,n.renderPass==="opaque"?G.ReadWrite:G.ReadOnly);xs(n,a,o,u,L,x,!1)}if(n.renderPass==="translucent"&&o.paint.get("fill-antialias")){var j=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,G.ReadOnly);xs(n,a,o,u,j,x,!0)}}},"fill-extrusion":function(n,a,o,u){var d=o.paint.get("fill-extrusion-opacity");if(d!==0&&n.renderPass==="translucent"){var _=new G(n.context.gl.LEQUAL,G.ReadWrite,n.depthRangeFor3D);if(d!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))il(n,a,o,u,_,J.disabled,le.disabled),il(n,a,o,u,_,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var x=n.colorModeForRenderPass();il(n,a,o,u,_,J.disabled,x)}}},hillshade:function(n,a,o,u){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var d=n.context,_=n.depthModeForSublayer(0,G.ReadOnly),x=n.colorModeForRenderPass(),T=n.renderPass==="translucent"?n.stencilConfigForOverlap(u):[{},u],z=T[0],L=0,j=T[1];L<j.length;L+=1){var q=j[L],Z=a.getTile(q);Z.needsHillshadePrepare&&n.renderPass==="offscreen"?ya(n,Z,o,_,J.disabled,x):n.renderPass==="translucent"&&Bs(n,Z,o,_,z[q.overscaledZ],x)}d.viewport.set([0,0,n.width,n.height])}},raster:function(n,a,o,u){if(n.renderPass==="translucent"&&o.paint.get("raster-opacity")!==0&&u.length)for(var d=n.context,_=d.gl,x=a.getSource(),T=n.useProgram("raster"),z=n.colorModeForRenderPass(),L=x instanceof lr?[{},u]:n.stencilConfigForOverlap(u),j=L[0],q=L[1],Z=q[q.length-1].overscaledZ,re=!n.options.moving,$=0,se=q;$<se.length;$+=1){var Y=se[$],oe=n.depthModeForSublayer(Y.overscaledZ-Z,o.paint.get("raster-opacity")===1?G.ReadWrite:G.ReadOnly,_.LESS),he=a.getTile(Y),ge=n.transform.calculatePosMatrix(Y.toUnwrapped(),re);he.registerFadeDuration(o.paint.get("raster-fade-duration"));var Te=a.findLoadedParent(Y,0),ve=Wn(he,Te,a,o,n.transform),Ae=void 0,De=void 0,Ne=o.paint.get("raster-resampling")==="nearest"?_.NEAREST:_.LINEAR;d.activeTexture.set(_.TEXTURE0),he.texture.bind(Ne,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST),d.activeTexture.set(_.TEXTURE1),Te?(Te.texture.bind(Ne,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST),Ae=Math.pow(2,Te.tileID.overscaledZ-he.tileID.overscaledZ),De=[he.tileID.canonical.x*Ae%1,he.tileID.canonical.y*Ae%1]):he.texture.bind(Ne,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST);var Fe=Va(ge,De||[0,0],Ae||1,ve,o);x instanceof lr?T.draw(d,_.TRIANGLES,oe,J.disabled,z,ce.disabled,Fe,o.id,x.boundsBuffer,n.quadTriangleIndexBuffer,x.boundsSegments):T.draw(d,_.TRIANGLES,oe,j[Y.overscaledZ],z,ce.disabled,Fe,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,a,o){var u=o.paint.get("background-color"),d=o.paint.get("background-opacity");if(d!==0){var _=n.context,x=_.gl,T=n.transform,z=T.tileSize,L=o.paint.get("background-pattern");if(!n.isPatternMissing(L)){var j=!L&&u.a===1&&d===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===j){var q=J.disabled,Z=n.depthModeForSublayer(0,j==="opaque"?G.ReadWrite:G.ReadOnly),re=n.colorModeForRenderPass(),$=n.useProgram(L?"backgroundPattern":"background"),se=T.coveringTiles({tileSize:z});L&&(_.activeTexture.set(x.TEXTURE0),n.imageManager.bind(n.context));for(var Y=o.getCrossfadeParameters(),oe=0,he=se;oe<he.length;oe+=1){var ge=he[oe],Te=n.transform.calculatePosMatrix(ge.toUnwrapped()),ve=L?$a(Te,d,n,L,{tileID:ge,tileSize:z},Y):ma(Te,d,u);$.draw(_,x.TRIANGLES,Z,q,re,ce.disabled,ve,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,a,o){for(var u=0;u<o.length;u++)Ol(n,a,o[u])},custom:function(n,a,o){var u=n.context,d=o.implementation;if(n.renderPass==="offscreen"){var _=d.prerender;_&&(n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),_.call(d,u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),u.setStencilMode(J.disabled);var x=d.renderingMode==="3d"?new G(n.context.gl.LEQUAL,G.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,G.ReadOnly);u.setDepthMode(x),d.render(u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState(),u.bindFramebuffer.set(null)}}},Sr=function(n,a){this.context=new O(n),this.transform=a,this._tileTextures={},this.setup(),this.numSublayers=te.maxUnderzooming+te.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new de,this.gpuTimers={}};Sr.prototype.resize=function(n,a){if(this.width=n*s.browser.devicePixelRatio,this.height=a*s.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,u=this.style._order;o<u.length;o+=1)this.style._layers[u[o]].resize()},Sr.prototype.setup=function(){var n=this.context,a=new s.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(s.EXTENT,0),a.emplaceBack(0,s.EXTENT),a.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(a,ii.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);var o=new s.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(s.EXTENT,0),o.emplaceBack(0,s.EXTENT),o.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=n.createVertexBuffer(o,ii.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);var u=new s.StructArrayLayout4i8;u.emplaceBack(0,0,0,0),u.emplaceBack(s.EXTENT,0,s.EXTENT,0),u.emplaceBack(0,s.EXTENT,0,s.EXTENT),u.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(u,Ze.members),this.rasterBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);var d=new s.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(d,ii.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);var _=new s.StructArrayLayout1ui2;_.emplaceBack(0),_.emplaceBack(1),_.emplaceBack(3),_.emplaceBack(2),_.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(_);var x=new s.StructArrayLayout3ui6;x.emplaceBack(0,1,2),x.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(x),this.emptyTexture=new s.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var T=this.context.gl;this.stencilClearMode=new J({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO)},Sr.prototype.clearStencil=function(){var n=this.context,a=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=s.create();s.ortho(o,0,this.width,this.height,0,0,1),s.scale(o,o,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,a.TRIANGLES,G.disabled,this.stencilClearMode,le.disabled,ce.disabled,Uo(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Sr.prototype._renderTileClippingMasks=function(n,a){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&a&&a.length){this.currentStencilSource=n.source;var o=this.context,u=o.gl;this.nextStencilID+a.length>256&&this.clearStencil(),o.setColorMode(le.disabled),o.setDepthMode(G.disabled);var d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var _=0,x=a;_<x.length;_+=1){var T=x[_],z=this._tileClippingMaskIDs[T.key]=this.nextStencilID++;d.draw(o,u.TRIANGLES,G.disabled,new J({func:u.ALWAYS,mask:0},z,255,u.KEEP,u.KEEP,u.REPLACE),le.disabled,ce.disabled,Uo(T.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Sr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,a=this.context.gl;return new J({func:a.NOTEQUAL,mask:255},n,255,a.KEEP,a.KEEP,a.REPLACE)},Sr.prototype.stencilModeForClipping=function(n){var a=this.context.gl;return new J({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,a.KEEP,a.KEEP,a.REPLACE)},Sr.prototype.stencilConfigForOverlap=function(n){var a,o=this.context.gl,u=n.sort(function(z,L){return L.overscaledZ-z.overscaledZ}),d=u[u.length-1].overscaledZ,_=u[0].overscaledZ-d+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();for(var x={},T=0;T<_;T++)x[T+d]=new J({func:o.GEQUAL,mask:255},T+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=_,[x,u]}return[(a={},a[d]=J.disabled,a),u]},Sr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new le([n.CONSTANT_COLOR,n.ONE],new s.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?le.unblended:le.alphaBlended},Sr.prototype.depthModeForSublayer=function(n,a,o){if(!this.opaquePassEnabledForLayer())return G.disabled;var u=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new G(o||this.context.gl.LEQUAL,a,[u,u])},Sr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Sr.prototype.render=function(n,a){var o=this;this.style=n,this.options=a,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(s.browser.now()),this.imageManager.beginFrame();var u=this.style._order,d=this.style.sourceCaches;for(var _ in d){var x=d[_];x.used&&x.prepare(this.context)}var T,z,L={},j={},q={};for(var Z in d){var re=d[Z];L[Z]=re.getVisibleCoordinates(),j[Z]=L[Z].slice().reverse(),q[Z]=re.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var $=0;$<u.length;$++)if(this.style._layers[u[$]].is3D()){this.opaquePassCutoff=$;break}this.renderPass="offscreen";for(var se=0,Y=u;se<Y.length;se+=1){var oe=this.style._layers[Y[se]];if(oe.hasOffscreenPass()&&!oe.isHidden(this.transform.zoom)){var he=j[oe.source];(oe.type==="custom"||he.length)&&this.renderLayer(this,d[oe.source],oe,he)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){var ge=this.style._layers[u[this.currentLayer]],Te=d[ge.source],ve=L[ge.source];this._renderTileClippingMasks(ge,ve),this.renderLayer(this,Te,ge,ve)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){var Ae=this.style._layers[u[this.currentLayer]],De=d[Ae.source],Ne=(Ae.type==="symbol"?q:j)[Ae.source];this._renderTileClippingMasks(Ae,L[Ae.source]),this.renderLayer(this,De,Ae,Ne)}this.options.showTileBoundaries&&(s.values(this.style._layers).forEach(function(Fe){Fe.source&&!Fe.isHidden(o.transform.zoom)&&(Fe.source!==(z&&z.id)&&(z=o.style.sourceCaches[Fe.source]),(!T||T.getSource().maxzoom<z.getSource().maxzoom)&&(T=z))}),T&&ho.debug(this,T,T.getVisibleCoordinates())),this.options.showPadding&&function(Fe){var nt=Fe.transform.padding;Ua(Fe,Fe.transform.height-(nt.top||0),3,ea),Ua(Fe,nt.bottom||0,3,Rl),is(Fe,nt.left||0,3,rs),is(Fe,Fe.transform.width-(nt.right||0),3,Bl);var yt=Fe.transform.centerPoint;(function(vt,_t,or,ot){bs(vt,_t-1,or-10,2,20,ot),bs(vt,_t-10,or-1,20,2,ot)})(Fe,yt.x,Fe.transform.height-yt.y,nl)}(this),this.context.setDefault()},Sr.prototype.renderLayer=function(n,a,o,u){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="custom"||u.length)&&(this.id=o.id,this.gpuTimingStart(o),ho[o.type](n,a,o,u,this.style.placement.variableOffsets),this.gpuTimingEnd())},Sr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var a=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),o.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,o.query)}},Sr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Sr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Sr.prototype.queryGpuTimers=function(n){var a={};for(var o in n){var u=n[o],d=this.context.extTimerQuery,_=d.getQueryObjectEXT(u.query,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(u.query),a[o]=_}return a},Sr.prototype.translatePosMatrix=function(n,a,o,u,d){if(!o[0]&&!o[1])return n;var _=d?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(_){var x=Math.sin(_),T=Math.cos(_);o=[o[0]*T-o[1]*x,o[0]*x+o[1]*T]}var z=[d?o[0]:yr(a,o[0],this.transform.zoom),d?o[1]:yr(a,o[1],this.transform.zoom),0],L=new Float32Array(16);return s.translate(L,n,z),L},Sr.prototype.saveTileTexture=function(n){var a=this._tileTextures[n.size[0]];a?a.push(n):this._tileTextures[n.size[0]]=[n]},Sr.prototype.getTileTexture=function(n){var a=this._tileTextures[n];return a&&a.length>0?a.pop():null},Sr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var a=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!a||!o},Sr.prototype.useProgram=function(n,a){this.cache=this.cache||{};var o=""+n+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new kl(this.context,n,$l[n],a,Dl[n],this._showOverdrawInspector)),this.cache[o]},Sr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Sr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Sr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Sr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Os=function(n,a){this.points=n,this.planes=a};Os.fromInvProjectionMatrix=function(n,a,o){var u=Math.pow(2,o),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(x){return s.transformMat4([],x,n)}).map(function(x){return s.scale$1([],x,1/x[3]/a*u)}),_=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(x){var T=s.sub([],d[x[0]],d[x[1]]),z=s.sub([],d[x[2]],d[x[1]]),L=s.normalize([],s.cross([],T,z)),j=-s.dot(L,d[x[1]]);return L.concat(j)});return new Os(d,_)};var Rn=function(n,a){this.min=n,this.max=a,this.center=s.scale$2([],s.add([],this.min,this.max),.5)};Rn.prototype.quadrant=function(n){for(var a=[n%2==0,n<2],o=s.clone$2(this.min),u=s.clone$2(this.max),d=0;d<a.length;d++)o[d]=a[d]?this.min[d]:this.center[d],u[d]=a[d]?this.center[d]:this.max[d];return u[2]=this.max[2],new Rn(o,u)},Rn.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},Rn.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},Rn.prototype.intersects=function(n){for(var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,u=0;u<n.planes.length;u++){for(var d=n.planes[u],_=0,x=0;x<a.length;x++)_+=s.dot$1(d,a[x])>=0;if(_===0)return 0;_!==a.length&&(o=!1)}if(o)return 2;for(var T=0;T<3;T++){for(var z=Number.MAX_VALUE,L=-Number.MAX_VALUE,j=0;j<n.points.length;j++){var q=n.points[j][T]-this.min[T];z=Math.min(z,q),L=Math.max(L,q)}if(L<0||z>this.max[T]-this.min[T])return 0}return 1};var Yi=function(n,a,o,u){if(n===void 0&&(n=0),a===void 0&&(a=0),o===void 0&&(o=0),u===void 0&&(u=0),isNaN(n)||n<0||isNaN(a)||a<0||isNaN(o)||o<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=a,this.left=o,this.right=u};Yi.prototype.interpolate=function(n,a,o){return a.top!=null&&n.top!=null&&(this.top=s.number(n.top,a.top,o)),a.bottom!=null&&n.bottom!=null&&(this.bottom=s.number(n.bottom,a.bottom,o)),a.left!=null&&n.left!=null&&(this.left=s.number(n.left,a.left,o)),a.right!=null&&n.right!=null&&(this.right=s.number(n.right,a.right,o)),this},Yi.prototype.getCenter=function(n,a){var o=s.clamp((this.left+n-this.right)/2,0,n),u=s.clamp((this.top+a-this.bottom)/2,0,a);return new s.Point(o,u)},Yi.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},Yi.prototype.clone=function(){return new Yi(this.top,this.bottom,this.left,this.right)},Yi.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ut=function(n,a,o,u,d){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=d===void 0||d,this._minZoom=n||0,this._maxZoom=a||22,this._minPitch=o==null?0:o,this._maxPitch=u==null?60:u,this.setMaxBounds(),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Yi,this._posMatrixCache={},this._alignedPosMatrixCache={}},Mr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ut.prototype.clone=function(){var n=new Ut(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},Mr.minZoom.get=function(){return this._minZoom},Mr.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},Mr.maxZoom.get=function(){return this._maxZoom},Mr.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},Mr.minPitch.get=function(){return this._minPitch},Mr.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},Mr.maxPitch.get=function(){return this._maxPitch},Mr.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},Mr.renderWorldCopies.get=function(){return this._renderWorldCopies},Mr.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},Mr.worldSize.get=function(){return this.tileSize*this.scale},Mr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Mr.size.get=function(){return new s.Point(this.width,this.height)},Mr.bearing.get=function(){return-this.angle/Math.PI*180},Mr.bearing.set=function(n){var a=-s.wrap(n,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=s.create$2(),s.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Mr.pitch.get=function(){return this._pitch/Math.PI*180},Mr.pitch.set=function(n){var a=s.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())},Mr.fov.get=function(){return this._fov/Math.PI*180},Mr.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},Mr.zoom.get=function(){return this._zoom},Mr.zoom.set=function(n){var a=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},Mr.center.get=function(){return this._center},Mr.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},Mr.padding.get=function(){return this._edgeInsets.toJSON()},Mr.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},Mr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ut.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},Ut.prototype.interpolatePadding=function(n,a,o){this._unmodified=!1,this._edgeInsets.interpolate(n,a,o),this._constrain(),this._calcMatrices()},Ut.prototype.coveringZoomLevel=function(n){var a=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,a)},Ut.prototype.getVisibleUnwrappedCoordinates=function(n){var a=[new s.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new s.Point(0,0)),u=this.pointCoordinate(new s.Point(this.width,0)),d=this.pointCoordinate(new s.Point(this.width,this.height)),_=this.pointCoordinate(new s.Point(0,this.height)),x=Math.floor(Math.min(o.x,u.x,d.x,_.x)),T=Math.floor(Math.max(o.x,u.x,d.x,_.x)),z=x-1;z<=T+1;z++)z!==0&&a.push(new s.UnwrappedTileID(z,n));return a},Ut.prototype.coveringTiles=function(n){var a=this.coveringZoomLevel(n),o=a;if(n.minzoom!==void 0&&a<n.minzoom)return[];n.maxzoom!==void 0&&a>n.maxzoom&&(a=n.maxzoom);var u=s.MercatorCoordinate.fromLngLat(this.center),d=Math.pow(2,a),_=[d*u.x,d*u.y,0],x=Os.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),T=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(T=a);var z=function(Fe){return{aabb:new Rn([Fe*d,0,0],[(Fe+1)*d,d,0]),zoom:0,x:0,y:0,wrap:Fe,fullyVisible:!1}},L=[],j=[],q=a,Z=n.reparseOverscaled?o:a;if(this._renderWorldCopies)for(var re=1;re<=3;re++)L.push(z(-re)),L.push(z(re));for(L.push(z(0));L.length>0;){var $=L.pop(),se=$.x,Y=$.y,oe=$.fullyVisible;if(!oe){var he=$.aabb.intersects(x);if(he===0)continue;oe=he===2}var ge=$.aabb.distanceX(_),Te=$.aabb.distanceY(_),ve=Math.max(Math.abs(ge),Math.abs(Te));if($.zoom===q||ve>3+(1<<q-$.zoom)-2&&$.zoom>=T)j.push({tileID:new s.OverscaledTileID($.zoom===q?Z:$.zoom,$.wrap,$.zoom,se,Y),distanceSq:s.sqrLen([_[0]-.5-se,_[1]-.5-Y])});else for(var Ae=0;Ae<4;Ae++){var De=(se<<1)+Ae%2,Ne=(Y<<1)+(Ae>>1);L.push({aabb:$.aabb.quadrant(Ae),zoom:$.zoom+1,x:De,y:Ne,wrap:$.wrap,fullyVisible:oe})}}return j.sort(function(Fe,nt){return Fe.distanceSq-nt.distanceSq}).map(function(Fe){return Fe.tileID})},Ut.prototype.resize=function(n,a){this.width=n,this.height=a,this.pixelsToGLUnits=[2/n,-2/a],this._constrain(),this._calcMatrices()},Mr.unmodified.get=function(){return this._unmodified},Ut.prototype.zoomScale=function(n){return Math.pow(2,n)},Ut.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},Ut.prototype.project=function(n){var a=s.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new s.Point(s.mercatorXfromLng(n.lng)*this.worldSize,s.mercatorYfromLat(a)*this.worldSize)},Ut.prototype.unproject=function(n){return new s.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},Mr.point.get=function(){return this.project(this.center)},Ut.prototype.setLocationAtPoint=function(n,a){var o=this.pointCoordinate(a),u=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(n),_=new s.MercatorCoordinate(d.x-(o.x-u.x),d.y-(o.y-u.y));this.center=this.coordinateLocation(_),this._renderWorldCopies&&(this.center=this.center.wrap())},Ut.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},Ut.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},Ut.prototype.locationCoordinate=function(n){return s.MercatorCoordinate.fromLngLat(n)},Ut.prototype.coordinateLocation=function(n){return n.toLngLat()},Ut.prototype.pointCoordinate=function(n){var a=[n.x,n.y,0,1],o=[n.x,n.y,1,1];s.transformMat4(a,a,this.pixelMatrixInverse),s.transformMat4(o,o,this.pixelMatrixInverse);var u=a[3],d=o[3],_=a[1]/u,x=o[1]/d,T=a[2]/u,z=o[2]/d,L=T===z?0:(0-T)/(z-T);return new s.MercatorCoordinate(s.number(a[0]/u,o[0]/d,L)/this.worldSize,s.number(_,x,L)/this.worldSize)},Ut.prototype.coordinatePoint=function(n){var a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return s.transformMat4(a,a,this.pixelMatrix),new s.Point(a[0]/a[3],a[1]/a[3])},Ut.prototype.getBounds=function(){return new s.LngLatBounds().extend(this.pointLocation(new s.Point(0,0))).extend(this.pointLocation(new s.Point(this.width,0))).extend(this.pointLocation(new s.Point(this.width,this.height))).extend(this.pointLocation(new s.Point(0,this.height)))},Ut.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new s.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Ut.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ut.prototype.calculatePosMatrix=function(n,a){a===void 0&&(a=!1);var o=n.key,u=a?this._alignedPosMatrixCache:this._posMatrixCache;if(u[o])return u[o];var d=n.canonical,_=this.worldSize/this.zoomScale(d.z),x=d.x+Math.pow(2,d.z)*n.wrap,T=s.identity(new Float64Array(16));return s.translate(T,T,[x*_,d.y*_,0]),s.scale(T,T,[_/s.EXTENT,_/s.EXTENT,1]),s.multiply(T,a?this.alignedProjMatrix:this.projMatrix,T),u[o]=new Float32Array(T),u[o]},Ut.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ut.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,a,o,u,d=-90,_=90,x=-180,T=180,z=this.size,L=this._unmodified;if(this.latRange){var j=this.latRange;d=s.mercatorYfromLat(j[1])*this.worldSize,n=(_=s.mercatorYfromLat(j[0])*this.worldSize)-d<z.y?z.y/(_-d):0}if(this.lngRange){var q=this.lngRange;x=s.mercatorXfromLng(q[0])*this.worldSize,a=(T=s.mercatorXfromLng(q[1])*this.worldSize)-x<z.x?z.x/(T-x):0}var Z=this.point,re=Math.max(a||0,n||0);if(re)return this.center=this.unproject(new s.Point(a?(T+x)/2:Z.x,n?(_+d)/2:Z.y)),this.zoom+=this.scaleZoom(re),this._unmodified=L,void(this._constraining=!1);if(this.latRange){var $=Z.y,se=z.y/2;$-se<d&&(u=d+se),$+se>_&&(u=_-se)}if(this.lngRange){var Y=Z.x,oe=z.x/2;Y-oe<x&&(o=x+oe),Y+oe>T&&(o=T-oe)}o===void 0&&u===void 0||(this.center=this.unproject(new s.Point(o!==void 0?o:Z.x,u!==void 0?u:Z.y))),this._unmodified=L,this._constraining=!1}},Ut.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),u=Math.sin(o)*this.cameraToCenterDistance/Math.sin(s.clamp(Math.PI-a-o,.01,Math.PI-.01)),d=this.point,_=d.x,x=d.y,T=1.01*(Math.cos(Math.PI/2-this._pitch)*u+this.cameraToCenterDistance),z=this.height/50,L=new Float64Array(16);s.perspective(L,this._fov,this.width/this.height,z,T),L[8]=2*-n.x/this.width,L[9]=2*n.y/this.height,s.scale(L,L,[1,-1,1]),s.translate(L,L,[0,0,-this.cameraToCenterDistance]),s.rotateX(L,L,this._pitch),s.rotateZ(L,L,this.angle),s.translate(L,L,[-_,-x,0]),this.mercatorMatrix=s.scale([],L,[this.worldSize,this.worldSize,this.worldSize]),s.scale(L,L,[1,1,s.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=L,this.invProjMatrix=s.invert([],this.projMatrix);var j=this.width%2/2,q=this.height%2/2,Z=Math.cos(this.angle),re=Math.sin(this.angle),$=_-Math.round(_)+Z*j+re*q,se=x-Math.round(x)+Z*q+re*j,Y=new Float64Array(L);if(s.translate(Y,Y,[$>.5?$-1:$,se>.5?se-1:se,0]),this.alignedProjMatrix=Y,L=s.create(),s.scale(L,L,[this.width/2,-this.height/2,1]),s.translate(L,L,[1,-1,0]),this.labelPlaneMatrix=L,L=s.create(),s.scale(L,L,[1,-1,1]),s.translate(L,L,[-1,-1,0]),s.scale(L,L,[2/this.width,2/this.height,1]),this.glCoordMatrix=L,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(L=s.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=L,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ut.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new s.Point(0,0)),a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return s.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance},Ut.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,n))},Ut.prototype.getCameraQueryGeometry=function(n){var a=this.getCameraPoint();if(n.length===1)return[n[0],a];for(var o=a.x,u=a.y,d=a.x,_=a.y,x=0,T=n;x<T.length;x+=1){var z=T[x];o=Math.min(o,z.x),u=Math.min(u,z.y),d=Math.max(d,z.x),_=Math.max(_,z.y)}return[new s.Point(o,u),new s.Point(d,u),new s.Point(d,_),new s.Point(o,_),new s.Point(o,u)]},Object.defineProperties(Ut.prototype,Mr);var Qi=function(n){var a,o,u,d;this._hashName=n&&encodeURIComponent(n),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(a=this._updateHashUnthrottled.bind(this),o=!1,u=null,d=function(){u=null,o&&(a(),u=setTimeout(d,300),o=!1)},function(){return o=!0,u||d(),u})};Qi.prototype.addTo=function(n){return this._map=n,s.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Qi.prototype.remove=function(){return s.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Qi.prototype.getHashString=function(n){var a=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,u=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,u),_=Math.round(a.lng*d)/d,x=Math.round(a.lat*d)/d,T=this._map.getBearing(),z=this._map.getPitch(),L="";if(L+=n?"/"+_+"/"+x+"/"+o:o+"/"+x+"/"+_,(T||z)&&(L+="/"+Math.round(10*T)/10),z&&(L+="/"+Math.round(z)),this._hashName){var j=this._hashName,q=!1,Z=s.window.location.hash.slice(1).split("&").map(function(re){var $=re.split("=")[0];return $===j?(q=!0,$+"="+L):re}).filter(function(re){return re});return q||Z.push(j+"="+L),"#"+Z.join("&")}return"#"+L},Qi.prototype._getCurrentHash=function(){var n,a=this,o=s.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(u){return u.split("=")}).forEach(function(u){u[0]===a._hashName&&(n=u)}),(n&&n[1]||"").split("/")):o.split("/")},Qi.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:a,pitch:+(n[4]||0)}),!0}return!1},Qi.prototype._updateHashUnthrottled=function(){var n=s.window.location.href.replace(/(#.+)?$/,this.getHashString());try{s.window.history.replaceState(s.window.history.state,null,n)}catch{}};var ol={linearity:.3,easing:s.bezier(0,0,.3,1)},ns=s.extend({deceleration:2500,maxSpeed:1400},ol),ta=s.extend({deceleration:20,maxSpeed:1400},ol),Fs=s.extend({deceleration:1e3,maxSpeed:360},ol),tu=s.extend({deceleration:1e3,maxSpeed:90},ol),ws=function(n){this._map=n,this.clear()};function jo(n,a){(!n.duration||n.duration<a.duration)&&(n.duration=a.duration,n.easing=a.easing)}function ra(n,a,o){var u=o.maxSpeed,d=o.linearity,_=o.deceleration,x=s.clamp(n*d/(a/1e3),-u,u),T=Math.abs(x)/(_*d);return{easing:o.easing,duration:1e3*T,amount:x*(T/2)}}ws.prototype.clear=function(){this._inertiaBuffer=[]},ws.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.browser.now(),settings:n})},ws.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,a=s.browser.now();n.length>0&&a-n[0].time>160;)n.shift()},ws.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var a={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0},o=0,u=this._inertiaBuffer;o<u.length;o+=1){var d=u[o].settings;a.zoom+=d.zoomDelta||0,a.bearing+=d.bearingDelta||0,a.pitch+=d.pitchDelta||0,d.panDelta&&a.pan._add(d.panDelta),d.around&&(a.around=d.around),d.pinchAround&&(a.pinchAround=d.pinchAround)}var _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(a.pan.mag()){var T=ra(a.pan.mag(),_,s.extend({},ns,n||{}));x.offset=a.pan.mult(T.amount/a.pan.mag()),x.center=this._map.transform.center,jo(x,T)}if(a.zoom){var z=ra(a.zoom,_,ta);x.zoom=this._map.transform.zoom+z.amount,jo(x,z)}if(a.bearing){var L=ra(a.bearing,_,Fs);x.bearing=this._map.transform.bearing+s.clamp(L.amount,-179,179),jo(x,L)}if(a.pitch){var j=ra(a.pitch,_,tu);x.pitch=this._map.transform.pitch+j.amount,jo(x,j)}if(x.zoom||x.bearing){var q=a.pinchAround===void 0?a.around:a.pinchAround;x.around=q?this._map.unproject(q):this._map.getCenter()}return this.clear(),s.extend(x,{noMoveStart:!0})}};var Or=function(n){function a(u,d,_,x){x===void 0&&(x={});var T=A.mousePos(d.getCanvasContainer(),_),z=d.unproject(T);n.call(this,u,s.extend({point:T,lngLat:z,originalEvent:_},x)),this._defaultPrevented=!1,this.target=d}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(s.Event),Bn=function(n){function a(u,d,_){var x=u==="touchend"?_.changedTouches:_.touches,T=A.touchPos(d.getCanvasContainer(),x),z=T.map(function(q){return d.unproject(q)}),L=T.reduce(function(q,Z,re,$){return q.add(Z.div($.length))},new s.Point(0,0)),j=d.unproject(L);n.call(this,u,{points:T,point:L,lngLats:z,lngLat:j,originalEvent:_}),this._defaultPrevented=!1}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(s.Event),ga=function(n){function a(u,d,_){n.call(this,u,{originalEvent:_}),this._defaultPrevented=!1}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(s.Event),oi=function(n,a){this._map=n,this._clickTolerance=a.clickTolerance};oi.prototype.reset=function(){delete this._mousedownPos},oi.prototype.wheel=function(n){return this._firePreventable(new ga(n.type,this._map,n))},oi.prototype.mousedown=function(n,a){return this._mousedownPos=a,this._firePreventable(new Or(n.type,this._map,n))},oi.prototype.mouseup=function(n){this._map.fire(new Or(n.type,this._map,n))},oi.prototype.click=function(n,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Or(n.type,this._map,n))},oi.prototype.dblclick=function(n){return this._firePreventable(new Or(n.type,this._map,n))},oi.prototype.mouseover=function(n){this._map.fire(new Or(n.type,this._map,n))},oi.prototype.mouseout=function(n){this._map.fire(new Or(n.type,this._map,n))},oi.prototype.touchstart=function(n){return this._firePreventable(new Bn(n.type,this._map,n))},oi.prototype.touchmove=function(n){this._map.fire(new Bn(n.type,this._map,n))},oi.prototype.touchend=function(n){this._map.fire(new Bn(n.type,this._map,n))},oi.prototype.touchcancel=function(n){this._map.fire(new Bn(n.type,this._map,n))},oi.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},oi.prototype.isEnabled=function(){return!0},oi.prototype.isActive=function(){return!1},oi.prototype.enable=function(){},oi.prototype.disable=function(){};var Qe=function(n){this._map=n};Qe.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Qe.prototype.mousemove=function(n){this._map.fire(new Or(n.type,this._map,n))},Qe.prototype.mousedown=function(){this._delayContextMenu=!0},Qe.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Or("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Qe.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Or(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},Qe.prototype.isEnabled=function(){return!0},Qe.prototype.isActive=function(){return!1},Qe.prototype.enable=function(){},Qe.prototype.disable=function(){};var po=function(n,a){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=a.clickTolerance||1};function Vs(n,a){for(var o={},u=0;u<n.length;u++)o[n[u].identifier]=a[u];return o}po.prototype.isEnabled=function(){return!!this._enabled},po.prototype.isActive=function(){return!!this._active},po.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},po.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},po.prototype.mousedown=function(n,a){this.isEnabled()&&n.shiftKey&&n.button===0&&(A.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)},po.prototype.mousemoveWindow=function(n,a){if(this._active){var o=a;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var u=this._startPos;this._lastPos=o,this._box||(this._box=A.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var d=Math.min(u.x,o.x),_=Math.max(u.x,o.x),x=Math.min(u.y,o.y),T=Math.max(u.y,o.y);A.setTransform(this._box,"translate("+d+"px,"+x+"px)"),this._box.style.width=_-d+"px",this._box.style.height=T-x+"px"}}},po.prototype.mouseupWindow=function(n,a){var o=this;if(this._active&&n.button===0){var u=this._startPos,d=a;if(this.reset(),A.suppressClick(),u.x!==d.x||u.y!==d.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(_){return _.fitScreenCoordinates(u,d,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},po.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},po.prototype.blur=function(){this.reset()},po.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(A.remove(this._box),this._box=null),A.enableDrag(),delete this._startPos,delete this._lastPos},po.prototype._fireEvent=function(n,a){return this._map.fire(new s.Event(n,{originalEvent:a}))};var qo=function(n){this.reset(),this.numTouches=n.numTouches};qo.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},qo.prototype.touchstart=function(n,a,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(u){for(var d=new s.Point(0,0),_=0,x=u;_<x.length;_+=1)d._add(x[_]);return d.div(u.length)}(a),this.touches=Vs(o,a)))},qo.prototype.touchmove=function(n,a,o){if(!this.aborted&&this.centroid){var u=Vs(o,a);for(var d in this.touches){var _=u[d];(!_||_.dist(this.touches[d])>30)&&(this.aborted=!0)}}},qo.prototype.touchend=function(n,a,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){var u=!this.aborted&&this.centroid;if(this.reset(),u)return u}};var On=function(n){this.singleTap=new qo(n),this.numTaps=n.numTaps,this.reset()};On.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},On.prototype.touchstart=function(n,a,o){this.singleTap.touchstart(n,a,o)},On.prototype.touchmove=function(n,a,o){this.singleTap.touchmove(n,a,o)},On.prototype.touchend=function(n,a,o){var u=this.singleTap.touchend(n,a,o);if(u){var d=n.timeStamp-this.lastTime<500,_=!this.lastTap||this.lastTap.dist(u)<30;if(d&&_||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}};var Fn=function(){this._zoomIn=new On({numTouches:1,numTaps:2}),this._zoomOut=new On({numTouches:2,numTaps:1}),this.reset()};Fn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Fn.prototype.touchstart=function(n,a,o){this._zoomIn.touchstart(n,a,o),this._zoomOut.touchstart(n,a,o)},Fn.prototype.touchmove=function(n,a,o){this._zoomIn.touchmove(n,a,o),this._zoomOut.touchmove(n,a,o)},Fn.prototype.touchend=function(n,a,o){var u=this,d=this._zoomIn.touchend(n,a,o),_=this._zoomOut.touchend(n,a,o);return d?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(x){return x.easeTo({duration:300,zoom:x.getZoom()+1,around:x.unproject(d)},{originalEvent:n})}}):_?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(x){return x.easeTo({duration:300,zoom:x.getZoom()-1,around:x.unproject(_)},{originalEvent:n})}}):void 0},Fn.prototype.touchcancel=function(){this.reset()},Fn.prototype.enable=function(){this._enabled=!0},Fn.prototype.disable=function(){this._enabled=!1,this.reset()},Fn.prototype.isEnabled=function(){return this._enabled},Fn.prototype.isActive=function(){return this._active};var al={0:1,2:2},je=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};je.prototype.blur=function(){this.reset()},je.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},je.prototype._correctButton=function(n,a){return!1},je.prototype._move=function(n,a){return{}},je.prototype.mousedown=function(n,a){if(!this._lastPoint){var o=A.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=a,this._eventButton=o)}},je.prototype.mousemoveWindow=function(n,a){var o=this._lastPoint;if(o){if(n.preventDefault(),function(u,d){var _=al[d];return u.buttons===void 0||(u.buttons&_)!==_}(n,this._eventButton))this.reset();else if(this._moved||!(a.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(o,a)}},je.prototype.mouseupWindow=function(n){this._lastPoint&&A.mouseButton(n)===this._eventButton&&(this._moved&&A.suppressClick(),this.reset())},je.prototype.enable=function(){this._enabled=!0},je.prototype.disable=function(){this._enabled=!1,this.reset()},je.prototype.isEnabled=function(){return this._enabled},je.prototype.isActive=function(){return this._active};var _a=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.mousedown=function(o,u){n.prototype.mousedown.call(this,o,u),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(o,u){return u===0&&!o.ctrlKey},a.prototype._move=function(o,u){return{around:u,panDelta:u.sub(o)}},a}(je),sl=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype._correctButton=function(o,u){return u===0&&o.ctrlKey||u===2},a.prototype._move=function(o,u){var d=.8*(u.x-o.x);if(d)return this._active=!0,{bearingDelta:d}},a.prototype.contextmenu=function(o){o.preventDefault()},a}(je),Ei=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype._correctButton=function(o,u){return u===0&&o.ctrlKey||u===2},a.prototype._move=function(o,u){var d=-.5*(u.y-o.y);if(d)return this._active=!0,{pitchDelta:d}},a.prototype.contextmenu=function(o){o.preventDefault()},a}(je),fo=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};fo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)},fo.prototype.touchstart=function(n,a,o){return this._calculateTransform(n,a,o)},fo.prototype.touchmove=function(n,a,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,a,o)},fo.prototype.touchend=function(n,a,o){this._calculateTransform(n,a,o),this._active&&o.length<this._minTouches&&this.reset()},fo.prototype.touchcancel=function(){this.reset()},fo.prototype._calculateTransform=function(n,a,o){o.length>0&&(this._active=!0);var u=Vs(o,a),d=new s.Point(0,0),_=new s.Point(0,0),x=0;for(var T in u){var z=u[T],L=this._touches[T];L&&(d._add(z),_._add(z.sub(L)),x++,u[T]=z)}if(this._touches=u,!(x<this._minTouches)&&_.mag()){var j=_.div(x);if(this._sum._add(j),!(this._sum.mag()<this._clickTolerance))return{around:d.div(x),panDelta:j}}},fo.prototype.enable=function(){this._enabled=!0},fo.prototype.disable=function(){this._enabled=!1,this.reset()},fo.prototype.isEnabled=function(){return this._enabled},fo.prototype.isActive=function(){return this._active};var Hn=function(){this.reset()};function ll(n,a,o){for(var u=0;u<n.length;u++)if(n[u].identifier===o)return a[u]}function Ss(n,a){return Math.log(n/a)/Math.LN2}Hn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Hn.prototype._start=function(n){},Hn.prototype._move=function(n,a,o){return{}},Hn.prototype.touchstart=function(n,a,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([a[0],a[1]]))},Hn.prototype.touchmove=function(n,a,o){if(this._firstTwoTouches){n.preventDefault();var u=this._firstTwoTouches,d=u[1],_=ll(o,a,u[0]),x=ll(o,a,d);if(_&&x){var T=this._aroundCenter?null:_.add(x).div(2);return this._move([_,x],T,n)}}},Hn.prototype.touchend=function(n,a,o){if(this._firstTwoTouches){var u=this._firstTwoTouches,d=u[1],_=ll(o,a,u[0]),x=ll(o,a,d);_&&x||(this._active&&A.suppressClick(),this.reset())}},Hn.prototype.touchcancel=function(){this.reset()},Hn.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},Hn.prototype.disable=function(){this._enabled=!1,this.reset()},Hn.prototype.isEnabled=function(){return this._enabled},Hn.prototype.isActive=function(){return this._active};var ai=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},a.prototype._move=function(o,u){var d=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Ss(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ss(this._distance,d),pinchAround:u}},a}(Hn);function si(n,a){return 180*n.angleWith(a)/Math.PI}var xn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},a.prototype._move=function(o,u){var d=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:si(this._vector,d),pinchAround:u}},a.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var u=25/(Math.PI*this._minDiameter)*360,d=si(o,this._startVector);return Math.abs(d)<u},a}(Hn);function ul(n){return Math.abs(n.y)>Math.abs(n.x)}var Fl=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(o){this._lastPoints=o,ul(o[0].sub(o[1]))&&(this._valid=!1)},a.prototype._move=function(o,u,d){var _=o[0].sub(this._lastPoints[0]),x=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(_,x,d.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(_.y+x.y)/2*-.5}},a.prototype.gestureBeginsVertically=function(o,u,d){if(this._valid!==void 0)return this._valid;var _=o.mag()>=2,x=u.mag()>=2;if(_||x){if(!_||!x)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;var T=o.y>0==u.y>0;return ul(o)&&ul(u)&&T}},a}(Hn),Vl={panStep:100,bearingStep:15,pitchStep:10},mo=function(){var n=Vl;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function di(n){return n*(2-n)}mo.prototype.blur=function(){this.reset()},mo.prototype.reset=function(){this._active=!1},mo.prototype.keydown=function(n){var a=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,u=0,d=0,_=0,x=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?u=-1:(n.preventDefault(),_=-1);break;case 39:n.shiftKey?u=1:(n.preventDefault(),_=1);break;case 38:n.shiftKey?d=1:(n.preventDefault(),x=-1);break;case 40:n.shiftKey?d=-1:(n.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(u=0,d=0),{cameraAnimation:function(T){var z=T.getZoom();T.easeTo({duration:300,easeId:"keyboardHandler",easing:di,zoom:o?Math.round(z)+o*(n.shiftKey?2:1):z,bearing:T.getBearing()+u*a._bearingStep,pitch:T.getPitch()+d*a._pitchStep,offset:[-_*a._panStep,-x*a._panStep],center:T.getCenter()},{originalEvent:n})}}}},mo.prototype.enable=function(){this._enabled=!0},mo.prototype.disable=function(){this._enabled=!1,this.reset()},mo.prototype.isEnabled=function(){return this._enabled},mo.prototype.isActive=function(){return this._active},mo.prototype.disableRotation=function(){this._rotationDisabled=!0},mo.prototype.enableRotation=function(){this._rotationDisabled=!1};var Yt=function(n,a){this._map=n,this._el=n.getCanvasContainer(),this._handler=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,s.bindAll(["_onTimeout"],this)};Yt.prototype.setZoomRate=function(n){this._defaultZoomRate=n},Yt.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},Yt.prototype.isEnabled=function(){return!!this._enabled},Yt.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Yt.prototype.isZooming=function(){return!!this._zooming},Yt.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},Yt.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Yt.prototype.wheel=function(n){if(this.isEnabled()){var a=n.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=s.browser.now(),u=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,a!==0&&a%4.000244140625==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(u*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),n.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=n,this._delta-=a,this._active||this._start(n)),n.preventDefault()}},Yt.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},Yt.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=A.mousePos(this._el,n);this._around=s.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Yt.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var a=this._map.transform;if(this._delta!==0){var o=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,u=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&u!==0&&(u=1/u);var d=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(d*u))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var _,x=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,T=this._startZoom,z=this._easing,L=!1;if(this._type==="wheel"&&T&&z){var j=Math.min((s.browser.now()-this._lastWheelEventTime)/200,1),q=z(j);_=s.number(T,x,q),j<1?this._frameId||(this._frameId=!0):L=!0}else _=x,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!L,zoomDelta:_-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Yt.prototype._smoothOutEasing=function(n){var a=s.ease;if(this._prevEase){var o=this._prevEase,u=(s.browser.now()-o.start)/o.duration,d=o.easing(u+.01)-o.easing(u),_=.27/Math.sqrt(d*d+1e-4)*.01,x=Math.sqrt(.0729-_*_);a=s.bezier(_,x,.25,1)}return this._prevEase={start:s.browser.now(),duration:n,easing:a},a},Yt.prototype.blur=function(){this.reset()},Yt.prototype.reset=function(){this._active=!1};var Ao=function(n,a){this._clickZoom=n,this._tapZoom=a};Ao.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ao.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ao.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ao.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Ti=function(){this.reset()};Ti.prototype.reset=function(){this._active=!1},Ti.prototype.blur=function(){this.reset()},Ti.prototype.dblclick=function(n,a){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(a)},{originalEvent:n})}}},Ti.prototype.enable=function(){this._enabled=!0},Ti.prototype.disable=function(){this._enabled=!1,this.reset()},Ti.prototype.isEnabled=function(){return this._enabled},Ti.prototype.isActive=function(){return this._active};var ye=function(){this._tap=new On({numTouches:1,numTaps:1}),this.reset()};ye.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ye.prototype.touchstart=function(n,a,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=a[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,a,o))},ye.prototype.touchmove=function(n,a,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var u=a[0],d=u.y-this._swipePoint.y;return this._swipePoint=u,n.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(n,a,o)},ye.prototype.touchend=function(n,a,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(n,a,o)&&(this._tapTime=n.timeStamp)},ye.prototype.touchcancel=function(){this.reset()},ye.prototype.enable=function(){this._enabled=!0},ye.prototype.disable=function(){this._enabled=!1,this.reset()},ye.prototype.isEnabled=function(){return this._enabled},ye.prototype.isActive=function(){return this._active};var ut=function(n,a,o){this._el=n,this._mousePan=a,this._touchPan=o};ut.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},ut.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},ut.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ut.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var bn=function(n,a,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=a,this._mousePitch=o};bn.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},bn.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},bn.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},bn.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Di=function(n,a,o,u){this._el=n,this._touchZoom=a,this._touchRotate=o,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0};Di.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Di.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Di.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Di.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Di.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Di.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Li=function(n){return n.zoom||n.drag||n.pitch||n.rotate},ia=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a}(s.Event);function ct(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var lt=function(n,a){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ws(n),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a),s.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[s.window,"blur",void 0]];for(var u=0,d=this._listeners;u<d.length;u+=1){var _=d[u],x=_[0];A.addEventListener(x,_[1],x===s.window.document?this.handleWindowEvent:this.handleEvent,_[2])}};lt.prototype.destroy=function(){for(var n=0,a=this._listeners;n<a.length;n+=1){var o=a[n],u=o[0];A.removeEventListener(u,o[1],u===s.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},lt.prototype._addDefaultHandlers=function(n){var a=this._map,o=a.getCanvasContainer();this._add("mapEvent",new oi(a,n));var u=a.boxZoom=new po(a,n);this._add("boxZoom",u);var d=new Fn,_=new Ti;a.doubleClickZoom=new Ao(_,d),this._add("tapZoom",d),this._add("clickZoom",_);var x=new ye;this._add("tapDragZoom",x);var T=a.touchPitch=new Fl;this._add("touchPitch",T);var z=new sl(n),L=new Ei(n);a.dragRotate=new bn(n,z,L),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]);var j=new _a(n),q=new fo(n);a.dragPan=new ut(o,j,q),this._add("mousePan",j),this._add("touchPan",q,["touchZoom","touchRotate"]);var Z=new xn,re=new ai;a.touchZoomRotate=new Di(o,re,Z,x),this._add("touchRotate",Z,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]);var $=a.scrollZoom=new Yt(a,this);this._add("scrollZoom",$,["mousePan"]);var se=a.keyboard=new mo;this._add("keyboard",se),this._add("blockableMapEvent",new Qe(a));for(var Y=0,oe=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Y<oe.length;Y+=1){var he=oe[Y];n.interactive&&n[he]&&a[he].enable(n[he])}},lt.prototype._add=function(n,a,o){this._handlers.push({handlerName:n,handler:a,allowed:o}),this._handlersById[n]=a},lt.prototype.stop=function(n){if(!this._updatingCamera){for(var a=0,o=this._handlers;a<o.length;a+=1)o[a].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},lt.prototype.isActive=function(){for(var n=0,a=this._handlers;n<a.length;n+=1)if(a[n].handler.isActive())return!0;return!1},lt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},lt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},lt.prototype.isMoving=function(){return Boolean(Li(this._eventsInProgress))||this.isZooming()},lt.prototype._blockedByActive=function(n,a,o){for(var u in n)if(u!==o&&(!a||a.indexOf(u)<0))return!0;return!1},lt.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},lt.prototype._getMapTouches=function(n){for(var a=[],o=0,u=n;o<u.length;o+=1){var d=u[o];this._el.contains(d.target)&&a.push(d)}return a},lt.prototype.handleEvent=function(n,a){this._updatingCamera=!0;for(var o=n.type==="renderFrame"?void 0:n,u={needsRenderFrame:!1},d={},_={},x=n.touches?this._getMapTouches(n.touches):void 0,T=x?A.touchPos(this._el,x):A.mousePos(this._el,n),z=0,L=this._handlers;z<L.length;z+=1){var j=L[z],q=j.handlerName,Z=j.handler,re=j.allowed;if(Z.isEnabled()){var $=void 0;this._blockedByActive(_,re,q)?Z.reset():Z[a||n.type]&&($=Z[a||n.type](n,T,x),this.mergeHandlerResult(u,d,$,q,o),$&&$.needsRenderFrame&&this._triggerRenderFrame()),($||Z.isActive())&&(_[q]=Z)}}var se={};for(var Y in this._previousActiveHandlers)_[Y]||(se[Y]=o);this._previousActiveHandlers=_,(Object.keys(se).length||ct(u))&&(this._changes.push([u,d,se]),this._triggerRenderFrame()),(Object.keys(_).length||ct(u))&&this._map._stop(!0),this._updatingCamera=!1;var oe=u.cameraAnimation;oe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],oe(this._map))},lt.prototype.mergeHandlerResult=function(n,a,o,u,d){if(o){s.extend(n,o);var _={handlerName:u,originalEvent:o.originalEvent||d};o.zoomDelta!==void 0&&(a.zoom=_),o.panDelta!==void 0&&(a.drag=_),o.pitchDelta!==void 0&&(a.pitch=_),o.bearingDelta!==void 0&&(a.rotate=_)}},lt.prototype._applyChanges=function(){for(var n={},a={},o={},u=0,d=this._changes;u<d.length;u+=1){var _=d[u],x=_[0],T=_[1],z=_[2];x.panDelta&&(n.panDelta=(n.panDelta||new s.Point(0,0))._add(x.panDelta)),x.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(n.around=x.around),x.pinchAround!==void 0&&(n.pinchAround=x.pinchAround),x.noInertia&&(n.noInertia=x.noInertia),s.extend(a,T),s.extend(o,z)}this._updateMapTransform(n,a,o),this._changes=[]},lt.prototype._updateMapTransform=function(n,a,o){var u=this._map,d=u.transform;if(!ct(n))return this._fireEvents(a,o,!0);var _=n.panDelta,x=n.zoomDelta,T=n.bearingDelta,z=n.pitchDelta,L=n.around,j=n.pinchAround;j!==void 0&&(L=j),u._stop(!0),L=L||u.transform.centerPoint;var q=d.pointLocation(_?L.sub(_):L);T&&(d.bearing+=T),z&&(d.pitch+=z),x&&(d.zoom+=x),d.setLocationAtPoint(q,L),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(a,o,!0)},lt.prototype._fireEvents=function(n,a,o){var u=this,d=Li(this._eventsInProgress),_=Li(n),x={};for(var T in n)this._eventsInProgress[T]||(x[T+"start"]=n[T].originalEvent),this._eventsInProgress[T]=n[T];for(var z in!d&&_&&this._fireEvent("movestart",_.originalEvent),x)this._fireEvent(z,x[z]);for(var L in _&&this._fireEvent("move",_.originalEvent),n)this._fireEvent(L,n[L].originalEvent);var j,q={};for(var Z in this._eventsInProgress){var re=this._eventsInProgress[Z],$=re.handlerName,se=re.originalEvent;this._handlersById[$].isActive()||(delete this._eventsInProgress[Z],q[Z+"end"]=j=a[$]||se)}for(var Y in q)this._fireEvent(Y,q[Y]);var oe=Li(this._eventsInProgress);if(o&&(d||_)&&!oe){this._updatingCamera=!0;var he=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ge=function(Te){return Te!==0&&-u._bearingSnap<Te&&Te<u._bearingSnap};he?(ge(he.bearing||this._map.getBearing())&&(he.bearing=0),this._map.easeTo(he,{originalEvent:j})):(this._map.fire(new s.Event("moveend",{originalEvent:j})),ge(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},lt.prototype._fireEvent=function(n,a){this._map.fire(new s.Event(n,a?{originalEvent:a}:{}))},lt.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(a){delete n._frameId,n.handleEvent(new ia("renderFrame",{timeStamp:a})),n._applyChanges()})},lt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var va=function(n){function a(o,u){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=u.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getCenter=function(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)},a.prototype.setCenter=function(o,u){return this.jumpTo({center:o},u)},a.prototype.panBy=function(o,u,d){return o=s.Point.convert(o).mult(-1),this.panTo(this.transform.center,s.extend({offset:o},u),d)},a.prototype.panTo=function(o,u,d){return this.easeTo(s.extend({center:o},u),d)},a.prototype.getZoom=function(){return this.transform.zoom},a.prototype.setZoom=function(o,u){return this.jumpTo({zoom:o},u),this},a.prototype.zoomTo=function(o,u,d){return this.easeTo(s.extend({zoom:o},u),d)},a.prototype.zoomIn=function(o,u){return this.zoomTo(this.getZoom()+1,o,u),this},a.prototype.zoomOut=function(o,u){return this.zoomTo(this.getZoom()-1,o,u),this},a.prototype.getBearing=function(){return this.transform.bearing},a.prototype.setBearing=function(o,u){return this.jumpTo({bearing:o},u),this},a.prototype.getPadding=function(){return this.transform.padding},a.prototype.setPadding=function(o,u){return this.jumpTo({padding:o},u),this},a.prototype.rotateTo=function(o,u,d){return this.easeTo(s.extend({bearing:o},u),d)},a.prototype.resetNorth=function(o,u){return this.rotateTo(0,s.extend({duration:1e3},o),u),this},a.prototype.resetNorthPitch=function(o,u){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},o),u),this},a.prototype.snapToNorth=function(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this},a.prototype.getPitch=function(){return this.transform.pitch},a.prototype.setPitch=function(o,u){return this.jumpTo({pitch:o},u),this},a.prototype.cameraForBounds=function(o,u){o=s.LngLatBounds.convert(o);var d=u&&u.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),d,u)},a.prototype._cameraForBoxAndBearing=function(o,u,d,_){var x={top:0,bottom:0,right:0,left:0};if(typeof(_=s.extend({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){var T=_.padding;_.padding={top:T,bottom:T,right:T,left:T}}_.padding=s.extend(x,_.padding);var z=this.transform,L=z.padding,j=z.project(s.LngLat.convert(o)),q=z.project(s.LngLat.convert(u)),Z=j.rotate(-d*Math.PI/180),re=q.rotate(-d*Math.PI/180),$=new s.Point(Math.max(Z.x,re.x),Math.max(Z.y,re.y)),se=new s.Point(Math.min(Z.x,re.x),Math.min(Z.y,re.y)),Y=$.sub(se),oe=(z.width-(L.left+L.right+_.padding.left+_.padding.right))/Y.x,he=(z.height-(L.top+L.bottom+_.padding.top+_.padding.bottom))/Y.y;if(!(he<0||oe<0)){var ge=Math.min(z.scaleZoom(z.scale*Math.min(oe,he)),_.maxZoom),Te=typeof _.offset.x=="number"?new s.Point(_.offset.x,_.offset.y):s.Point.convert(_.offset),ve=new s.Point((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(d*Math.PI/180),Ae=Te.add(ve).mult(z.scale/z.zoomScale(ge));return{center:z.unproject(j.add(q).div(2).sub(Ae)),zoom:ge,bearing:d}}s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},a.prototype.fitBounds=function(o,u,d){return this._fitInternal(this.cameraForBounds(o,u),u,d)},a.prototype.fitScreenCoordinates=function(o,u,d,_,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(s.Point.convert(o)),this.transform.pointLocation(s.Point.convert(u)),d,_),_,x)},a.prototype._fitInternal=function(o,u,d){return o?(delete(u=s.extend(o,u)).padding,u.linear?this.easeTo(u,d):this.flyTo(u,d)):this},a.prototype.jumpTo=function(o,u){this.stop();var d=this.transform,_=!1,x=!1,T=!1;return"zoom"in o&&d.zoom!==+o.zoom&&(_=!0,d.zoom=+o.zoom),o.center!==void 0&&(d.center=s.LngLat.convert(o.center)),"bearing"in o&&d.bearing!==+o.bearing&&(x=!0,d.bearing=+o.bearing),"pitch"in o&&d.pitch!==+o.pitch&&(T=!0,d.pitch=+o.pitch),o.padding==null||d.isPaddingEqual(o.padding)||(d.padding=o.padding),this.fire(new s.Event("movestart",u)).fire(new s.Event("move",u)),_&&this.fire(new s.Event("zoomstart",u)).fire(new s.Event("zoom",u)).fire(new s.Event("zoomend",u)),x&&this.fire(new s.Event("rotatestart",u)).fire(new s.Event("rotate",u)).fire(new s.Event("rotateend",u)),T&&this.fire(new s.Event("pitchstart",u)).fire(new s.Event("pitch",u)).fire(new s.Event("pitchend",u)),this.fire(new s.Event("moveend",u))},a.prototype.easeTo=function(o,u){var d=this;this._stop(!1,o.easeId),((o=s.extend({offset:[0,0],duration:500,easing:s.ease},o)).animate===!1||!o.essential&&s.browser.prefersReducedMotion)&&(o.duration=0);var _=this.transform,x=this.getZoom(),T=this.getBearing(),z=this.getPitch(),L=this.getPadding(),j="zoom"in o?+o.zoom:x,q="bearing"in o?this._normalizeBearing(o.bearing,T):T,Z="pitch"in o?+o.pitch:z,re="padding"in o?o.padding:_.padding,$=s.Point.convert(o.offset),se=_.centerPoint.add($),Y=_.pointLocation(se),oe=s.LngLat.convert(o.center||Y);this._normalizeCenter(oe);var he,ge,Te=_.project(Y),ve=_.project(oe).sub(Te),Ae=_.zoomScale(j-x);o.around&&(he=s.LngLat.convert(o.around),ge=_.locationPoint(he));var De={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||j!==x,this._rotating=this._rotating||T!==q,this._pitching=this._pitching||Z!==z,this._padding=!_.isPaddingEqual(re),this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,De),this._ease(function(Ne){if(d._zooming&&(_.zoom=s.number(x,j,Ne)),d._rotating&&(_.bearing=s.number(T,q,Ne)),d._pitching&&(_.pitch=s.number(z,Z,Ne)),d._padding&&(_.interpolatePadding(L,re,Ne),se=_.centerPoint.add($)),he)_.setLocationAtPoint(he,ge);else{var Fe=_.zoomScale(_.zoom-x),nt=j>x?Math.min(2,Ae):Math.max(.5,Ae),yt=Math.pow(nt,1-Ne),vt=_.unproject(Te.add(ve.mult(Ne*yt)).mult(Fe));_.setLocationAtPoint(_.renderWorldCopies?vt.wrap():vt,se)}d._fireMoveEvents(u)},function(Ne){d._afterEase(u,Ne)},o),this},a.prototype._prepareEase=function(o,u,d){d===void 0&&(d={}),this._moving=!0,u||d.moving||this.fire(new s.Event("movestart",o)),this._zooming&&!d.zooming&&this.fire(new s.Event("zoomstart",o)),this._rotating&&!d.rotating&&this.fire(new s.Event("rotatestart",o)),this._pitching&&!d.pitching&&this.fire(new s.Event("pitchstart",o))},a.prototype._fireMoveEvents=function(o){this.fire(new s.Event("move",o)),this._zooming&&this.fire(new s.Event("zoom",o)),this._rotating&&this.fire(new s.Event("rotate",o)),this._pitching&&this.fire(new s.Event("pitch",o))},a.prototype._afterEase=function(o,u){if(!this._easeId||!u||this._easeId!==u){delete this._easeId;var d=this._zooming,_=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new s.Event("zoomend",o)),_&&this.fire(new s.Event("rotateend",o)),x&&this.fire(new s.Event("pitchend",o)),this.fire(new s.Event("moveend",o))}},a.prototype.flyTo=function(o,u){var d=this;if(!o.essential&&s.browser.prefersReducedMotion){var _=s.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(_,u)}this.stop(),o=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},o);var x=this.transform,T=this.getZoom(),z=this.getBearing(),L=this.getPitch(),j=this.getPadding(),q="zoom"in o?s.clamp(+o.zoom,x.minZoom,x.maxZoom):T,Z="bearing"in o?this._normalizeBearing(o.bearing,z):z,re="pitch"in o?+o.pitch:L,$="padding"in o?o.padding:x.padding,se=x.zoomScale(q-T),Y=s.Point.convert(o.offset),oe=x.centerPoint.add(Y),he=x.pointLocation(oe),ge=s.LngLat.convert(o.center||he);this._normalizeCenter(ge);var Te=x.project(he),ve=x.project(ge).sub(Te),Ae=o.curve,De=Math.max(x.width,x.height),Ne=De/se,Fe=ve.mag();if("minZoom"in o){var nt=s.clamp(Math.min(o.minZoom,T,q),x.minZoom,x.maxZoom),yt=De/x.zoomScale(nt-T);Ae=Math.sqrt(yt/Fe*2)}var vt=Ae*Ae;function _t(Et){var xt=(Ne*Ne-De*De+(Et?-1:1)*vt*vt*Fe*Fe)/(2*(Et?Ne:De)*vt*Fe);return Math.log(Math.sqrt(xt*xt+1)-xt)}function or(Et){return(Math.exp(Et)-Math.exp(-Et))/2}function ot(Et){return(Math.exp(Et)+Math.exp(-Et))/2}var St=_t(0),Vt=function(Et){return ot(St)/ot(St+Ae*Et)},Tt=function(Et){return De*((ot(St)*(or(xt=St+Ae*Et)/ot(xt))-or(St))/vt)/Fe;var xt},kt=(_t(1)-St)/Ae;if(Math.abs(Fe)<1e-6||!isFinite(kt)){if(Math.abs(De-Ne)<1e-6)return this.easeTo(o,u);var Rt=Ne<De?-1:1;kt=Math.abs(Math.log(Ne/De))/Ae,Tt=function(){return 0},Vt=function(Et){return Math.exp(Rt*Ae*Et)}}return o.duration="duration"in o?+o.duration:1e3*kt/("screenSpeed"in o?+o.screenSpeed/Ae:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=z!==Z,this._pitching=re!==L,this._padding=!x.isPaddingEqual($),this._prepareEase(u,!1),this._ease(function(Et){var xt=Et*kt,Ri=1/Vt(xt);x.zoom=Et===1?q:T+x.scaleZoom(Ri),d._rotating&&(x.bearing=s.number(z,Z,Et)),d._pitching&&(x.pitch=s.number(L,re,Et)),d._padding&&(x.interpolatePadding(j,$,Et),oe=x.centerPoint.add(Y));var Wr=Et===1?ge:x.unproject(Te.add(ve.mult(Tt(xt))).mult(Ri));x.setLocationAtPoint(x.renderWorldCopies?Wr.wrap():Wr,oe),d._fireMoveEvents(u)},function(){return d._afterEase(u)},o),this},a.prototype.isEasing=function(){return!!this._easeFrameId},a.prototype.stop=function(){return this._stop()},a.prototype._stop=function(o,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,u)}if(!o){var _=this.handlers;_&&_.stop(!1)}return this},a.prototype._ease=function(o,u,d){d.animate===!1||d.duration===0?(o(1),u()):(this._easeStart=s.browser.now(),this._easeOptions=d,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},a.prototype._renderFrameCallback=function(){var o=Math.min((s.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},a.prototype._normalizeBearing=function(o,u){o=s.wrap(o,-180,180);var d=Math.abs(o-u);return Math.abs(o-360-u)<d&&(o-=360),Math.abs(o+360-u)<d&&(o+=360),o},a.prototype._normalizeCenter=function(o){var u=this.transform;if(u.renderWorldCopies&&!u.lngRange){var d=o.lng-u.center.lng;o.lng+=d>180?-360:d<-180?360:0}},a}(s.Evented),Ii=function(n){n===void 0&&(n={}),this.options=n,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Ii.prototype.getDefaultPosition=function(){return"bottom-right"},Ii.prototype.onAdd=function(n){var a=this.options&&this.options.compact;return this._map=n,this._container=A.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=A.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),a===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ii.prototype.onRemove=function(){A.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ii.prototype._setElementTitle=function(n,a){var o=this._map._getUIString("AttributionControl."+a);n.title=o,n.setAttribute("aria-label",o)},Ii.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Ii.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(n){var o=a.reduce(function(u,d,_){return d.value&&(u+=d.key+"="+d.value+(_<a.length-1?"&":"")),u},"?");n.href=s.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},Ii.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Ii.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(T){return typeof T!="string"?"":T})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}var o=this._map.style.sourceCaches;for(var u in o){var d=o[u];if(d.used){var _=d.getSource();_.attribution&&n.indexOf(_.attribution)<0&&n.push(_.attribution)}}n.sort(function(T,z){return T.length-z.length});var x=(n=n.filter(function(T,z){for(var L=z+1;L<n.length;L++)if(n[L].indexOf(T)>=0)return!1;return!0})).join(" | ");x!==this._attribHTML&&(this._attribHTML=x,n.length?(this._innerContainer.innerHTML=x,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Ii.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var mi=function(){s.bindAll(["_updateLogo"],this),s.bindAll(["_updateCompact"],this)};mi.prototype.onAdd=function(n){this._map=n,this._container=A.create("div","mapboxgl-ctrl");var a=A.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},mi.prototype.onRemove=function(){A.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},mi.prototype.getDefaultPosition=function(){return"bottom-left"},mi.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},mi.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var a in n)if(n[a].getSource().mapbox_logo)return!0;return!1}},mi.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var a=n[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}};var li=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};li.prototype.add=function(n){var a=++this._id;return this._queue.push({callback:n,id:a,cancelled:!1}),a},li.prototype.remove=function(n){for(var a=this._currentlyRunning,o=0,u=a?this._queue.concat(a):this._queue;o<u.length;o+=1){var d=u[o];if(d.id===n)return void(d.cancelled=!0)}},li.prototype.run=function(n){n===void 0&&(n=0);var a=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,u=a;o<u.length;o+=1){var d=u[o];if(!d.cancelled&&(d.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},li.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Vn={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},os=s.window.HTMLImageElement,cl=s.window.HTMLElement,vr=s.window.ImageBitmap,Zi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Es=function(n){function a(u){var d=this;if((u=s.extend({},Zi,u)).minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var _=new Ut(u.minZoom,u.maxZoom,u.minPitch,u.maxPitch,u.renderWorldCopies);if(n.call(this,_,u),this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._failIfMajorPerformanceCaveat=u.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=u.preserveDrawingBuffer,this._antialias=u.antialias,this._trackResize=u.trackResize,this._bearingSnap=u.bearingSnap,this._refreshExpiredTiles=u.refreshExpiredTiles,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=u.collectResourceTiming,this._renderTaskQueue=new li,this._controls=[],this._mapId=s.uniqueId(),this._locale=s.extend({},Vn,u.locale),this._clickTolerance=u.clickTolerance,this._requestManager=new s.RequestManager(u.transformRequest,u.accessToken),typeof u.container=="string"){if(this._container=s.window.document.getElementById(u.container),!this._container)throw new Error("Container '"+u.container+"' not found.")}else{if(!(u.container instanceof cl))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return d._update(!1)}),this.on("moveend",function(){return d._update(!1)}),this.on("zoom",function(){return d._update(!0)}),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new lt(this,u),this._hash=u.hash&&new Qi(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,s.extend({},u.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=u.localIdeographFontFamily,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new Ii({customAttribution:u.customAttribution})),this.addControl(new mi,u.logoPosition),this.on("style.load",function(){d.transform.unmodified&&d.jumpTo(d.style.stylesheet)}),this.on("data",function(x){d._update(x.dataType==="style"),d.fire(new s.Event(x.dataType+"data",x))}),this.on("dataloading",function(x){d.fire(new s.Event(x.dataType+"dataloading",x))})}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(u,d){if(d===void 0&&(d=u.getDefaultPosition?u.getDefaultPosition():"top-right"),!u||!u.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var _=u.onAdd(this);this._controls.push(u);var x=this._controlPositions[d];return d.indexOf("bottom")!==-1?x.insertBefore(_,x.firstChild):x.appendChild(_),this},a.prototype.removeControl=function(u){if(!u||!u.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var d=this._controls.indexOf(u);return d>-1&&this._controls.splice(d,1),u.onRemove(this),this},a.prototype.hasControl=function(u){return this._controls.indexOf(u)>-1},a.prototype.resize=function(u){var d=this._containerDimensions(),_=d[0],x=d[1];if(_===this.transform.width&&x===this.transform.height)return this;this._resizeCanvas(_,x),this.transform.resize(_,x),this.painter.resize(_,x);var T=!this._moving;return T&&this.fire(new s.Event("movestart",u)).fire(new s.Event("move",u)),this.fire(new s.Event("resize",u)),T&&this.fire(new s.Event("moveend",u)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(u){return this.transform.setMaxBounds(s.LngLatBounds.convert(u)),this._update()},a.prototype.setMinZoom=function(u){if((u=u==null?-2:u)>=-2&&u<=this.transform.maxZoom)return this.transform.minZoom=u,this._update(),this.getZoom()<u&&this.setZoom(u),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(u){if((u=u==null?22:u)>=this.transform.minZoom)return this.transform.maxZoom=u,this._update(),this.getZoom()>u&&this.setZoom(u),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(u){if((u=u==null?0:u)<0)throw new Error("minPitch must be greater than or equal to 0");if(u>=0&&u<=this.transform.maxPitch)return this.transform.minPitch=u,this._update(),this.getPitch()<u&&this.setPitch(u),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(u){if((u=u==null?60:u)>60)throw new Error("maxPitch must be less than or equal to 60");if(u>=this.transform.minPitch)return this.transform.maxPitch=u,this._update(),this.getPitch()>u&&this.setPitch(u),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(u){return this.transform.renderWorldCopies=u,this._update()},a.prototype.project=function(u){return this.transform.locationPoint(s.LngLat.convert(u))},a.prototype.unproject=function(u){return this.transform.pointLocation(s.Point.convert(u))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(u,d,_){var x,T=this;if(u==="mouseenter"||u==="mouseover"){var z=!1;return{layer:d,listener:_,delegates:{mousemove:function(j){var q=T.getLayer(d)?T.queryRenderedFeatures(j.point,{layers:[d]}):[];q.length?z||(z=!0,_.call(T,new Or(u,T,j.originalEvent,{features:q}))):z=!1},mouseout:function(){z=!1}}}}if(u==="mouseleave"||u==="mouseout"){var L=!1;return{layer:d,listener:_,delegates:{mousemove:function(j){(T.getLayer(d)?T.queryRenderedFeatures(j.point,{layers:[d]}):[]).length?L=!0:L&&(L=!1,_.call(T,new Or(u,T,j.originalEvent)))},mouseout:function(j){L&&(L=!1,_.call(T,new Or(u,T,j.originalEvent)))}}}}return{layer:d,listener:_,delegates:(x={},x[u]=function(j){var q=T.getLayer(d)?T.queryRenderedFeatures(j.point,{layers:[d]}):[];q.length&&(j.features=q,_.call(T,j),delete j.features)},x)}},a.prototype.on=function(u,d,_){if(_===void 0)return n.prototype.on.call(this,u,d);var x=this._createDelegatedListener(u,d,_);for(var T in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[u]=this._delegatedListeners[u]||[],this._delegatedListeners[u].push(x),x.delegates)this.on(T,x.delegates[T]);return this},a.prototype.once=function(u,d,_){if(_===void 0)return n.prototype.once.call(this,u,d);var x=this._createDelegatedListener(u,d,_);for(var T in x.delegates)this.once(T,x.delegates[T]);return this},a.prototype.off=function(u,d,_){var x=this;return _===void 0?n.prototype.off.call(this,u,d):(this._delegatedListeners&&this._delegatedListeners[u]&&function(T){for(var z=T[u],L=0;L<z.length;L++){var j=z[L];if(j.layer===d&&j.listener===_){for(var q in j.delegates)x.off(q,j.delegates[q]);return z.splice(L,1),x}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(u,d){if(!this.style)return[];var _;if(d!==void 0||u===void 0||u instanceof s.Point||Array.isArray(u)||(d=u,u=void 0),d=d||{},(u=u||[[0,0],[this.transform.width,this.transform.height]])instanceof s.Point||typeof u[0]=="number")_=[s.Point.convert(u)];else{var x=s.Point.convert(u[0]),T=s.Point.convert(u[1]);_=[x,new s.Point(T.x,x.y),T,new s.Point(x.x,T.y),x]}return this.style.queryRenderedFeatures(_,d,this.transform)},a.prototype.querySourceFeatures=function(u,d){return this.style.querySourceFeatures(u,d)},a.prototype.setStyle=function(u,d){return(d=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},d)).diff!==!1&&d.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&u?(this._diffStyle(u,d),this):(this._localIdeographFontFamily=d.localIdeographFontFamily,this._updateStyle(u,d))},a.prototype._getUIString=function(u){var d=this._locale[u];if(d==null)throw new Error("Missing UI string '"+u+"'");return d},a.prototype._updateStyle=function(u,d){return this.style&&(this.style.setEventedParent(null),this.style._remove()),u?(this.style=new Mi(this,d||{}),this.style.setEventedParent(this,{style:this.style}),typeof u=="string"?this.style.loadURL(u):this.style.loadJSON(u),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Mi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(u,d){var _=this;if(typeof u=="string"){var x=this._requestManager.normalizeStyleURL(u),T=this._requestManager.transformRequest(x,s.ResourceType.Style);s.getJSON(T,function(z,L){z?_.fire(new s.ErrorEvent(z)):L&&_._updateDiff(L,d)})}else typeof u=="object"&&this._updateDiff(u,d)},a.prototype._updateDiff=function(u,d){try{this.style.setState(u)&&this._update(!0)}catch(_){s.warnOnce("Unable to perform style diff: "+(_.message||_.error||_)+".  Rebuilding the style from scratch."),this._updateStyle(u,d)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():s.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(u,d){return this._lazyInitEmptyStyle(),this.style.addSource(u,d),this._update(!0)},a.prototype.isSourceLoaded=function(u){var d=this.style&&this.style.sourceCaches[u];if(d!==void 0)return d.loaded();this.fire(new s.ErrorEvent(new Error("There is no source with ID '"+u+"'")))},a.prototype.areTilesLoaded=function(){var u=this.style&&this.style.sourceCaches;for(var d in u){var _=u[d]._tiles;for(var x in _){var T=_[x];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0},a.prototype.addSourceType=function(u,d,_){return this._lazyInitEmptyStyle(),this.style.addSourceType(u,d,_)},a.prototype.removeSource=function(u){return this.style.removeSource(u),this._update(!0)},a.prototype.getSource=function(u){return this.style.getSource(u)},a.prototype.addImage=function(u,d,_){_===void 0&&(_={});var x=_.pixelRatio;x===void 0&&(x=1);var T=_.sdf;T===void 0&&(T=!1);var z=_.stretchX,L=_.stretchY,j=_.content;if(this._lazyInitEmptyStyle(),d instanceof os||vr&&d instanceof vr){var q=s.browser.getImageData(d);this.style.addImage(u,{data:new s.RGBAImage({width:q.width,height:q.height},q.data),pixelRatio:x,stretchX:z,stretchY:L,content:j,sdf:T,version:0})}else{if(d.width===void 0||d.height===void 0)return this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Z=d;this.style.addImage(u,{data:new s.RGBAImage({width:d.width,height:d.height},new Uint8Array(d.data)),pixelRatio:x,stretchX:z,stretchY:L,content:j,sdf:T,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,u)}},a.prototype.updateImage=function(u,d){var _=this.style.getImage(u);if(!_)return this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var x=d instanceof os||vr&&d instanceof vr?s.browser.getImageData(d):d,T=x.width,z=x.height,L=x.data;return T===void 0||z===void 0?this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):T!==_.data.width||z!==_.data.height?this.fire(new s.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(_.data.replace(L,!(d instanceof os||vr&&d instanceof vr)),void this.style.updateImage(u,_))},a.prototype.hasImage=function(u){return u?!!this.style.getImage(u):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(u){this.style.removeImage(u)},a.prototype.loadImage=function(u,d){s.getImage(this._requestManager.transformRequest(u,s.ResourceType.Image),d)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(u,d){return this._lazyInitEmptyStyle(),this.style.addLayer(u,d),this._update(!0)},a.prototype.moveLayer=function(u,d){return this.style.moveLayer(u,d),this._update(!0)},a.prototype.removeLayer=function(u){return this.style.removeLayer(u),this._update(!0)},a.prototype.getLayer=function(u){return this.style.getLayer(u)},a.prototype.setLayerZoomRange=function(u,d,_){return this.style.setLayerZoomRange(u,d,_),this._update(!0)},a.prototype.setFilter=function(u,d,_){return _===void 0&&(_={}),this.style.setFilter(u,d,_),this._update(!0)},a.prototype.getFilter=function(u){return this.style.getFilter(u)},a.prototype.setPaintProperty=function(u,d,_,x){return x===void 0&&(x={}),this.style.setPaintProperty(u,d,_,x),this._update(!0)},a.prototype.getPaintProperty=function(u,d){return this.style.getPaintProperty(u,d)},a.prototype.setLayoutProperty=function(u,d,_,x){return x===void 0&&(x={}),this.style.setLayoutProperty(u,d,_,x),this._update(!0)},a.prototype.getLayoutProperty=function(u,d){return this.style.getLayoutProperty(u,d)},a.prototype.setLight=function(u,d){return d===void 0&&(d={}),this._lazyInitEmptyStyle(),this.style.setLight(u,d),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(u,d){return this.style.setFeatureState(u,d),this._update()},a.prototype.removeFeatureState=function(u,d){return this.style.removeFeatureState(u,d),this._update()},a.prototype.getFeatureState=function(u){return this.style.getFeatureState(u)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var u=0,d=0;return this._container&&(u=this._container.clientWidth||400,d=this._container.clientHeight||300),[u,d]},a.prototype._detectMissingCSS=function(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var u=this._container;u.classList.add("mapboxgl-map"),(this._missingCSSCanary=A.create("div","mapboxgl-canary",u)).style.visibility="hidden",this._detectMissingCSS();var d=this._canvasContainer=A.create("div","mapboxgl-canvas-container",u);this._interactive&&d.classList.add("mapboxgl-interactive"),this._canvas=A.create("canvas","mapboxgl-canvas",d),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var _=this._containerDimensions();this._resizeCanvas(_[0],_[1]);var x=this._controlContainer=A.create("div","mapboxgl-control-container",u),T=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(z){T[z]=A.create("div","mapboxgl-ctrl-"+z,x)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},a.prototype._resizeCanvas=function(u,d){var _=s.browser.devicePixelRatio||1;this._canvas.width=_*u,this._canvas.height=_*d,this._canvas.style.width=u+"px",this._canvas.style.height=d+"px"},a.prototype._setupPainter=function(){var u=s.extend({},C.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),d=this._canvas.getContext("webgl",u)||this._canvas.getContext("experimental-webgl",u);d?(this.painter=new Sr(d,this.transform),s.webpSupported.testSupport(d)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(u){u.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:u}))},a.prototype._contextRestored=function(u){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:u}))},a.prototype._onMapScroll=function(u){if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(u){return this.style?(this._styleDirty=this._styleDirty||u,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(u){return this._update(),this._renderTaskQueue.add(u)},a.prototype._cancelRenderFrame=function(u){this._renderTaskQueue.remove(u)},a.prototype._render=function(u){var d,_=this,x=0,T=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(d=T.createQueryEXT(),T.beginQueryEXT(T.TIME_ELAPSED_EXT,d),x=s.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(u),!this._removed){var z=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var L=this.transform.zoom,j=s.browser.now();this.style.zoomHistory.update(L,j);var q=new s.EvaluationParameters(L,{now:j,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Z=q.crossFadingFactor();Z===1&&Z===this._crossFadingFactor||(z=!0,this._crossFadingFactor=Z),this.style.update(q)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&(this.style.hasTransitions()||z)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var re=s.browser.now()-x;T.endQueryEXT(T.TIME_ELAPSED_EXT,d),setTimeout(function(){var Y=T.getQueryObjectEXT(d,T.QUERY_RESULT_EXT)/1e6;T.deleteQueryEXT(d),_.fire(new s.Event("gpu-timing-frame",{cpuTime:re,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){var $=this.painter.collectGpuTimers();setTimeout(function(){var Y=_.painter.queryGpuTimers($);_.fire(new s.Event("gpu-timing-layer",{layerTimes:Y}))},50)}var se=this._sourcesDirty||this._styleDirty||this._placementDirty;return se||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.Event("idle")),!this._loaded||this._fullyLoaded||se||(this._fullyLoaded=!0),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var u=0,d=this._controls;u<d.length;u+=1)d[u].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1));var _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),Zo(this._canvasContainer),Zo(this._controlContainer),Zo(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new s.Event("remove"))},a.prototype.triggerRepaint=function(){var u=this;this.style&&!this._frame&&(this._frame=s.browser.frame(function(d){u._frame=null,u._render(d)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(u){this._trackResize&&this.resize({originalEvent:u})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(u){this._showTileBoundaries!==u&&(this._showTileBoundaries=u,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(u){this._showPadding!==u&&(this._showPadding=u,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(u){this._showCollisionBoxes!==u&&(this._showCollisionBoxes=u,u?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(u){this._showOverdrawInspector!==u&&(this._showOverdrawInspector=u,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(u){this._repaint!==u&&(this._repaint=u,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(u){this._vertices=u,this._update()},a.prototype._setCacheLimits=function(u,d){s.setCacheLimits(u,d)},o.version.get=function(){return s.version},Object.defineProperties(a.prototype,o),a}(va);function Zo(n){n.parentNode&&n.parentNode.removeChild(n)}var Nl={showCompass:!0,showZoom:!0,visualizePitch:!1},Jn=function(n){var a=this;this.options=s.extend({},Nl,n),this._container=A.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return a._map.zoomIn({},{originalEvent:o})}),A.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return a._map.zoomOut({},{originalEvent:o})}),A.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){a.options.visualizePitch?a._map.resetNorthPitch({},{originalEvent:o}):a._map.resetNorth({},{originalEvent:o})}),this._compassIcon=A.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Jn.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),a=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},Jn.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Jn.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Yn(this._map,this._compass,this.options.visualizePitch)),this._container},Jn.prototype.onRemove=function(){A.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Jn.prototype._createButton=function(n,a){var o=A.create("button",n,this._container);return o.type="button",o.addEventListener("click",a),o},Jn.prototype._setButtonTitle=function(n,a){var o=this._map._getUIString("NavigationControl."+a);n.title=o,n.setAttribute("aria-label",o)};var Yn=function(n,a,o){o===void 0&&(o=!1),this._clickTolerance=10,this.element=a,this.mouseRotate=new sl({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new Ei({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),A.addEventListener(a,"mousedown",this.mousedown),A.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),A.addEventListener(a,"touchmove",this.touchmove),A.addEventListener(a,"touchend",this.touchend),A.addEventListener(a,"touchcancel",this.reset)};function as(n,a,o){if(n=new s.LngLat(n.lng,n.lat),a){var u=new s.LngLat(n.lng-360,n.lat),d=new s.LngLat(n.lng+360,n.lat),_=o.locationPoint(n).distSqr(a);o.locationPoint(u).distSqr(a)<_?n=u:o.locationPoint(d).distSqr(a)<_&&(n=d)}for(;Math.abs(n.lng-o.center.lng)>180;){var x=o.locationPoint(n);if(x.x>=0&&x.y>=0&&x.x<=o.width&&x.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}Yn.prototype.down=function(n,a){this.mouseRotate.mousedown(n,a),this.mousePitch&&this.mousePitch.mousedown(n,a),A.disableDrag()},Yn.prototype.move=function(n,a){var o=this.map,u=this.mouseRotate.mousemoveWindow(n,a);if(u&&u.bearingDelta&&o.setBearing(o.getBearing()+u.bearingDelta),this.mousePitch){var d=this.mousePitch.mousemoveWindow(n,a);d&&d.pitchDelta&&o.setPitch(o.getPitch()+d.pitchDelta)}},Yn.prototype.off=function(){var n=this.element;A.removeEventListener(n,"mousedown",this.mousedown),A.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),A.removeEventListener(n,"touchmove",this.touchmove),A.removeEventListener(n,"touchend",this.touchend),A.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},Yn.prototype.offTemp=function(){A.enableDrag(),A.removeEventListener(s.window,"mousemove",this.mousemove),A.removeEventListener(s.window,"mouseup",this.mouseup)},Yn.prototype.mousedown=function(n){this.down(s.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),A.mousePos(this.element,n)),A.addEventListener(s.window,"mousemove",this.mousemove),A.addEventListener(s.window,"mouseup",this.mouseup)},Yn.prototype.mousemove=function(n){this.move(n,A.mousePos(this.element,n))},Yn.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},Yn.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=A.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},Yn.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=A.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},Yn.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Yn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var xa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function hl(n,a,o){var u=n.classList;for(var d in xa)u.remove("mapboxgl-"+o+"-anchor-"+d);u.add("mapboxgl-"+o+"-anchor-"+a)}var Ts,Ns=function(n){function a(o,u){if(n.call(this),(o instanceof s.window.HTMLElement||u)&&(o=s.extend({element:o},u)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=s.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=A.create("div"),this._element.setAttribute("aria-label","Map marker");var d=A.createNS("http://www.w3.org/2000/svg","svg");d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height","41px"),d.setAttributeNS(null,"width","27px"),d.setAttributeNS(null,"viewBox","0 0 27 41");var _=A.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");var x=A.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");var T=A.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");for(var z=0,L=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];z<L.length;z+=1){var j=L[z],q=A.createNS("http://www.w3.org/2000/svg","ellipse");q.setAttributeNS(null,"opacity","0.04"),q.setAttributeNS(null,"cx","10.5"),q.setAttributeNS(null,"cy","5.80029008"),q.setAttributeNS(null,"rx",j.rx),q.setAttributeNS(null,"ry",j.ry),T.appendChild(q)}var Z=A.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"fill",this._color);var re=A.createNS("http://www.w3.org/2000/svg","path");re.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Z.appendChild(re);var $=A.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");var se=A.createNS("http://www.w3.org/2000/svg","path");se.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(se);var Y=A.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");var oe=A.createNS("http://www.w3.org/2000/svg","g");oe.setAttributeNS(null,"transform","translate(8.0, 8.0)");var he=A.createNS("http://www.w3.org/2000/svg","circle");he.setAttributeNS(null,"fill","#000000"),he.setAttributeNS(null,"opacity","0.25"),he.setAttributeNS(null,"cx","5.5"),he.setAttributeNS(null,"cy","5.5"),he.setAttributeNS(null,"r","5.4999962");var ge=A.createNS("http://www.w3.org/2000/svg","circle");ge.setAttributeNS(null,"fill","#FFFFFF"),ge.setAttributeNS(null,"cx","5.5"),ge.setAttributeNS(null,"cy","5.5"),ge.setAttributeNS(null,"r","5.4999962"),oe.appendChild(he),oe.appendChild(ge),x.appendChild(T),x.appendChild(Z),x.appendChild($),x.appendChild(Y),x.appendChild(oe),d.appendChild(x),d.setAttributeNS(null,"height",41*this._scale+"px"),d.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(d),this._offset=s.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Te){Te.preventDefault()}),this._element.addEventListener("mousedown",function(Te){Te.preventDefault()}),hl(this._element,this._anchor,"marker"),this._popup=null}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),A.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(o){return this._lngLat=s.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var u=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(24.6+u)],"bottom-right":[-u,-1*(24.6+u)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(o){var u=o.code,d=o.charCode||o.keyCode;u!=="Space"&&u!=="Enter"&&d!==32&&d!==13||this.togglePopup()},a.prototype._onMapClick=function(o){var u=o.originalEvent.target,d=this._element;this._popup&&(u===d||d.contains(u))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},a.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=as(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var u="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?u="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(u="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var d="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?d="rotateX(0deg)":this._pitchAlignment==="map"&&(d="rotateX("+this._map.getPitch()+"deg)"),o&&o.type!=="moveend"||(this._pos=this._pos.round()),A.setTransform(this._element,xa[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+d+" "+u)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(o){return this._offset=s.Point.convert(o),this._update(),this},a.prototype._onMove=function(o){if(!this._isDragging){var u=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag")))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(s.Evented),ja={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Is=0,qa=!1,ru=function(n){function a(o){n.call(this),this.options=s.extend({},ja,o),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.onAdd=function(o){var u;return this._map=o,this._container=A.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),u=this._setupUI,Ts!==void 0?u(Ts):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(function(d){u(Ts=d.state!=="denied")}):u(Ts=!!s.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),A.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Is=0,qa=!1},a.prototype._isOutOfMapMaxBounds=function(o){var u=this._map.getMaxBounds(),d=o.coords;return u&&(d.longitude<u.getWest()||d.longitude>u.getEast()||d.latitude<u.getSouth()||d.latitude>u.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",o)),this._finish()}},a.prototype._updateCamera=function(o){var u=new s.LngLat(o.coords.longitude,o.coords.latitude),d=o.coords.accuracy,_=this._map.getBearing(),x=s.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(d),x,{geolocateSource:!0})},a.prototype._updateMarker=function(o){if(o){var u=new s.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,u=this._map.unproject([0,o]),d=this._map.unproject([1,o]),_=u.distanceTo(d),x=Math.ceil(2*this._accuracy/_);this._circleElement.style.width=x+"px",this._circleElement.style.height=x+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&qa)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",o)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(o){var u=this;if(this._container.addEventListener("contextmenu",function(x){return x.preventDefault()}),this._geolocateButton=A.create("button","mapboxgl-ctrl-geolocate",this._container),A.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",o===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{var _=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=_,this._geolocateButton.setAttribute("aria-label",_)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ns(this._dotElement),this._circleElement=A.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ns({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(x){x.geolocateSource||u._watchState!=="ACTIVE_LOCK"||x.originalEvent&&x.originalEvent.type==="resize"||(u._watchState="BACKGROUND",u._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),u._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),u.fire(new s.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Is--,qa=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Is>1?(o={maximumAge:6e5,timeout:0},qa=!0):(o=this.options.positionOptions,qa=!1),this._geolocationWatchID=s.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else s.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(s.Evented),Za={maxWidth:100,unit:"metric"},Ga=function(n){this.options=s.extend({},Za,n),s.bindAll(["_onMove","setUnit"],this)};function pl(n,a,o){var u=o&&o.maxWidth||100,d=n._container.clientHeight/2,_=n.unproject([0,d]),x=n.unproject([u,d]),T=_.distanceTo(x);if(o&&o.unit==="imperial"){var z=3.2808*T;z>5280?Qn(a,u,z/5280,n._getUIString("ScaleControl.Miles")):Qn(a,u,z,n._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Qn(a,u,T/1852,n._getUIString("ScaleControl.NauticalMiles")):T>=1e3?Qn(a,u,T/1e3,n._getUIString("ScaleControl.Kilometers")):Qn(a,u,T,n._getUIString("ScaleControl.Meters"))}function Qn(n,a,o,u){var d,_,x,T=(d=o,(_=Math.pow(10,(""+Math.floor(d)).length-1))*(x=(x=d/_)>=10?10:x>=5?5:x>=3?3:x>=2?2:x>=1?1:function(z){var L=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*L)/L}(x)));n.style.width=a*(T/o)+"px",n.innerHTML=T+"&nbsp;"+u}Ga.prototype.getDefaultPosition=function(){return"bottom-left"},Ga.prototype._onMove=function(){pl(this._map,this._container,this.options)},Ga.prototype.onAdd=function(n){return this._map=n,this._container=A.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ga.prototype.onRemove=function(){A.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ga.prototype.setUnit=function(n){this.options.unit=n,pl(this._map,this._container,this.options)};var Nn=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof s.window.HTMLElement?this._container=n.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in s.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in s.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in s.window.document&&(this._fullscreenchange="MSFullscreenChange")};Nn.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=A.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Nn.prototype.onRemove=function(){A.remove(this._controlContainer),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Nn.prototype._checkFullscreenSupport=function(){return!!(s.window.document.fullscreenEnabled||s.window.document.mozFullScreenEnabled||s.window.document.msFullscreenEnabled||s.window.document.webkitFullscreenEnabled)},Nn.prototype._setupUI=function(){var n=this._fullscreenButton=A.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);A.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Nn.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},Nn.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Nn.prototype._isFullscreen=function(){return this._fullscreen},Nn.prototype._changeIcon=function(){(s.window.document.fullscreenElement||s.window.document.mozFullScreenElement||s.window.document.webkitFullscreenElement||s.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Nn.prototype._onClickFullscreen=function(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.mozCancelFullScreen?s.window.document.mozCancelFullScreen():s.window.document.msExitFullscreen?s.window.document.msExitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var fl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Us=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Ul=function(n){function a(o){n.call(this),this.options=s.extend(Object.create(fl),o),s.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new s.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&A.remove(this._content),this._container&&(A.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new s.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(o){return this._lngLat=s.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(o){return this.setDOMContent(s.window.document.createTextNode(o))},a.prototype.setHTML=function(o){var u,d=s.window.document.createDocumentFragment(),_=s.window.document.createElement("body");for(_.innerHTML=o;u=_.firstChild;)d.appendChild(u);return this.setDOMContent(d)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},a.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=A.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},a.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},a.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},a.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},a.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},a.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=A.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(o){this._update(o.point)},a.prototype._onMouseMove=function(o){this._update(o.point)},a.prototype._onDrag=function(o){this._update(o.point)},a.prototype._update=function(o){var u=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=A.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=A.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(q){return u._container.classList.add(q)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=as(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var d=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),_=this.options.anchor,x=function q(Z){if(Z){if(typeof Z=="number"){var re=Math.round(Math.sqrt(.5*Math.pow(Z,2)));return{center:new s.Point(0,0),top:new s.Point(0,Z),"top-left":new s.Point(re,re),"top-right":new s.Point(-re,re),bottom:new s.Point(0,-Z),"bottom-left":new s.Point(re,-re),"bottom-right":new s.Point(-re,-re),left:new s.Point(Z,0),right:new s.Point(-Z,0)}}if(Z instanceof s.Point||Array.isArray(Z)){var $=s.Point.convert(Z);return{center:$,top:$,"top-left":$,"top-right":$,bottom:$,"bottom-left":$,"bottom-right":$,left:$,right:$}}return{center:s.Point.convert(Z.center||[0,0]),top:s.Point.convert(Z.top||[0,0]),"top-left":s.Point.convert(Z["top-left"]||[0,0]),"top-right":s.Point.convert(Z["top-right"]||[0,0]),bottom:s.Point.convert(Z.bottom||[0,0]),"bottom-left":s.Point.convert(Z["bottom-left"]||[0,0]),"bottom-right":s.Point.convert(Z["bottom-right"]||[0,0]),left:s.Point.convert(Z.left||[0,0]),right:s.Point.convert(Z.right||[0,0])}}return q(new s.Point(0,0))}(this.options.offset);if(!_){var T,z=this._container.offsetWidth,L=this._container.offsetHeight;T=d.y+x.bottom.y<L?["top"]:d.y>this._map.transform.height-L?["bottom"]:[],d.x<z/2?T.push("left"):d.x>this._map.transform.width-z/2&&T.push("right"),_=T.length===0?"bottom":T.join("-")}var j=d.add(x[_]).round();A.setTransform(this._container,xa[_]+" translate("+j.x+"px,"+j.y+"px)"),hl(this._container,_,"popup")}},a.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(Us);o&&o.focus()}},a.prototype._onClose=function(){this.remove()},a}(s.Evented),ss={version:s.version,supported:C,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:Es,NavigationControl:Jn,GeolocateControl:ru,AttributionControl:Ii,ScaleControl:Ga,FullscreenControl:Nn,Popup:Ul,Marker:Ns,Style:Mi,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,Evented:s.Evented,config:s.config,prewarm:function(){xe().acquire(Se)},clearPrewarmedResources:function(){var n=st;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(Se),st=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(n){s.config.ACCESS_TOKEN=n},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(n){s.config.API_URL=n},get workerCount(){return Le.workerCount},set workerCount(n){Le.workerCount=n},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){s.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){s.clearTileCache(n)},workerUrl:""};return ss}),S})})(Tc);const w0=Tc.exports;function pm(c){let p;const m=c[15].default,v=Ic(m,c,c[14],null);return{c(){v&&v.c()},l(S){v&&v.l(S)},m(S,E){v&&v.m(S,E),p=!0},p(S,E){v&&v.p&&(!p||E&16384)&&kc(v,m,S,S[14],p?Ac(m,S[14],E,null):zc(S[14]),null)},i(S){p||(Zt(v,S),p=!0)},o(S){ir(v,S),p=!1},d(S){v&&v.d(S)}}}function S0(c){let p,m,v,S=c[0]&&pm(c);return{c(){p=Ie("div"),S&&S.c(),this.h()},l(E){p=ke(E,"DIV",{class:!0,id:!0});var s=we(p);S&&S.l(s),s.forEach(ae),this.h()},h(){X(p,"class","absolute top-0 bg-grey4 w-full h-full svelte-a65d1y"),X(p,"id",c[1]),Mh(()=>c[16].call(p))},m(E,s){dt(E,p,s),S&&S.m(p,null),m=Dh(p,c[16].bind(p)),c[17](p),v=!0},p(E,[s]){E[0]?S?(S.p(E,s),s&1&&Zt(S,1)):(S=pm(E),S.c(),Zt(S,1),S.m(p,null)):S&&(mu(),ir(S,1,1,()=>{S=null}),yu()),(!v||s&2)&&X(p,"id",E[1])},i(E){v||(Zt(S),v=!0)},o(E){ir(S),v=!1},d(E){E&&ae(p),S&&S.d(),m(),c[17](null)}}}function E0(c,p,m){let{$$slots:v={},$$scope:S}=p,{map:E}=p,{id:s="map"}=p,{location:C={bounds:[[-8.1775,54.02275],[-5.43279,55.31298]]}}=p,{style:A="https://raw.githubusercontent.com/nisra-explore/map_tiles/main/basemap_styles/style-omt.json"}=p,{interactive:V=!0}=p,{minzoom:N=0}=p,{maxzoom:W=14}=p,{zoom:K=null}=p,{scrollzoom:H=!0}=p,{geolocate:pe=!0}=p,{zoomcontrol:Re=!0}=p,{options:ze={}}=p,Ge,Ke;Am("map",{getMap:()=>E}),C.bounds?ze={...ze,bounds:C.bounds}:C.lon&&C.lat&&(ze={...ze,center:[C.lon,C.lat]},C.zoom&&(ze.zoom=C.zoom)),zm(()=>{const He=document.createElement("link");return He.rel="stylesheet",He.href="https://unpkg.com/mapbox-gl@1.13.0/dist/mapbox-gl.css",He.onload=()=>{m(0,E=new Tc.exports.Map({container:Ge,style:A,minZoom:N,maxZoom:W,interactive:V,...ze})),Re&&E.addControl(new Tc.exports.NavigationControl({showCompass:!1})),H||E.scrollZoom.disable(),pe&&E.addControl(new Tc.exports.GeolocateControl),E.on("load",()=>{m(4,K=E.getZoom())}),E.on("zoom",()=>{m(4,K=E.getZoom())})},document.head.appendChild(He),()=>{E.remove(),He.parentNode.removeChild(He)}});function Nt(){let He=document.getElementsByClassName("mapboxgl-canvas");He[0]&&(He[0].style.width="100%",E.resize())}function Dt(){Ke=this.clientWidth,m(2,Ke)}function mt(He){El[He?"unshift":"push"](()=>{Ge=He,m(3,Ge)})}return c.$$set=He=>{"map"in He&&m(0,E=He.map),"id"in He&&m(1,s=He.id),"location"in He&&m(6,C=He.location),"style"in He&&m(7,A=He.style),"interactive"in He&&m(8,V=He.interactive),"minzoom"in He&&m(9,N=He.minzoom),"maxzoom"in He&&m(10,W=He.maxzoom),"zoom"in He&&m(4,K=He.zoom),"scrollzoom"in He&&m(11,H=He.scrollzoom),"geolocate"in He&&m(12,pe=He.geolocate),"zoomcontrol"in He&&m(13,Re=He.zoomcontrol),"options"in He&&m(5,ze=He.options),"$$scope"in He&&m(14,S=He.$$scope)},c.$$.update=()=>{c.$$.dirty&4&&Ke&&Nt()},[E,s,Ke,Ge,K,ze,C,A,V,N,W,H,pe,Re,S,v,Dt,mt]}class T0 extends Ka{constructor(p){super(),Xa(this,p,E0,S0,Wa,{map:0,id:1,location:6,style:7,interactive:8,minzoom:9,maxzoom:10,zoom:4,scrollzoom:11,geolocate:12,zoomcontrol:13,options:5})}}function fm(c){let p;const m=c[11].default,v=Ic(m,c,c[10],null);return{c(){v&&v.c()},l(S){v&&v.l(S)},m(S,E){v&&v.m(S,E),p=!0},p(S,E){v&&v.p&&(!p||E&1024)&&kc(v,m,S,S[10],p?Ac(m,S[10],E,null):zc(S[10]),null)},i(S){p||(Zt(v,S),p=!0)},o(S){ir(v,S),p=!1},d(S){v&&v.d(S)}}}function I0(c){let p,m,v=c[0]&&fm(c);return{c(){v&&v.c(),p=dn()},l(S){v&&v.l(S),p=dn()},m(S,E){v&&v.m(S,E),dt(S,p,E),m=!0},p(S,[E]){S[0]?v?(v.p(S,E),E&1&&Zt(v,1)):(v=fm(S),v.c(),Zt(v,1),v.m(p.parentNode,p)):v&&(mu(),ir(v,1,1,()=>{v=null}),yu())},i(S){m||(Zt(v),m=!0)},o(S){ir(v),m=!1},d(S){v&&v.d(S),S&&ae(p)}}}function k0(c,p,m){let{$$slots:v={},$$scope:S}=p,{id:E}=p,{type:s}=p,{url:C=null}=p,{props:A={}}=p,{data:V=null}=p,{layer:N=null}=p,{promoteId:W=null}=p,{minzoom:K=null}=p,{maxzoom:H=null}=p,pe=!1;const{getMap:Re}=Dc("map"),ze=Re();ze.getSource(E)&&ze.removeSource(E);function Ge(){ze.isSourceLoaded(E)?(m(0,pe=!0),console.log(E+" loaded!")):setTimeout(()=>{console.log("..."),Ge()},500)}function Ke(){ze.isStyleLoaded(E)?(Nt(),document.querySelector("#map canvas")&&document.querySelector("#map canvas").tabIndex=="0"&&(document.querySelector("#map canvas").tabIndex="-1")):setTimeout(()=>{console.log("..."),Ke()},500)}K&&(A.minzoom=K),H&&(A.maxzoom=H),N&&W?(A.promoteId={},A.promoteId[N]=W):W&&(A.promoteId=W);function Nt(){console.log(E+" map source loading..."),s=="geojson"?V?(ze.addSource(E,{type:s,data:V,...A}),Ge()):C&&(ze.addSource(E,{type:s,data:C,...A}),Ge()):s=="vector"&&(ze.addSource(E,{type:s,tiles:[C],...A}),Ge())}Ke();function Dt(){ze.getSource(E).setData(V)}return c.$$set=mt=>{"id"in mt&&m(2,E=mt.id),"type"in mt&&m(3,s=mt.type),"url"in mt&&m(4,C=mt.url),"props"in mt&&m(1,A=mt.props),"data"in mt&&m(5,V=mt.data),"layer"in mt&&m(6,N=mt.layer),"promoteId"in mt&&m(7,W=mt.promoteId),"minzoom"in mt&&m(8,K=mt.minzoom),"maxzoom"in mt&&m(9,H=mt.maxzoom),"$$scope"in mt&&m(10,S=mt.$$scope)},c.$$.update=()=>{c.$$.dirty&33&&pe&&V&&Dt()},[pe,A,E,s,C,V,N,W,K,H,S,v]}class Qm extends Ka{constructor(p){super(),Xa(this,p,k0,I0,Wa,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9})}}function z0(c,p,m){const{Popup:v}=w0,S=Pm(),E=new v({closeButton:!1,closeOnClick:!1});let{id:s}=p,{source:C}=p,{sourceLayer:A=null}=p,{type:V}=p,{filter:N=null}=p,{layout:W={}}=p,{paint:K={}}=p,{data:H=null}=p,{code:pe=null}=p,{name:Re="name"}=p,{colorCode:ze=null}=p,{click:Ge=!1}=p,{ignoreClick:Ke=!1}=p,{clickCenter:Nt=!1}=p,{selected:Dt=null}=p,{hover:mt=!1}=p,{hovered:He=null}=p,{highlight:Er=!1}=p,{highlightKey:hr="highlighted"}=p,{highlighted:Ht=[]}=p,{order:Jt=null}=p,{maxzoom:qe=null}=p,{minzoom:_r=null}=p,{isChild:At=!1}=p;const{getMap:nr}=Dc("map"),tt=nr();let pr=null,Vr=null,Pt=[];tt.getLayer(s)&&tt.removeLayer(s);let tr={id:s,type:V,source:C,paint:K,layout:W};N&&(tr.filter=N),A&&(tr["source-layer"]=A),qe&&(tr.maxzoom=qe),_r&&(tr.minzoom=_r),tt.addLayer(tr,Jt);function rt(){console.log("updating colors..."),H.forEach(Ze=>{tt.setFeatureState({source:C,sourceLayer:A,id:Ze[pe]},{color:Ze[ze]})})}return Ge&&tt.on("click",s,Ze=>{if(Ze.features.length>0&&!Ke){let lr=Ze.features[0].id;if(At&&Ht.includes(lr)||!At&&Dt!=lr){if(m(0,Dt=lr),S("select",{code:Dt}),pr&&tt.setFeatureState({source:C,sourceLayer:A,id:pr},{selected:!1}),tt.setFeatureState({source:C,sourceLayer:A,id:Dt},{selected:!0}),Nt){let Tr=centroid(Ze.features[0].toJSON().geometry);tt.flyTo({center:Tr.geometry.coordinates})}m(24,pr=Dt)}}}),mt&&(tt.on("mousemove",s,Ze=>{if(Ze.features.length>0){let lr=Ze.features[0].id;He&&tt.setFeatureState({source:C,sourceLayer:A,id:He},{hovered:!1}),At&&Ht.includes(lr)||!At&&Dt!=lr?(m(1,He=m(25,Vr=lr)),tt.setFeatureState({source:C,sourceLayer:A,id:He},{hovered:!0}),tt.getCanvas().style.cursor="pointer",E.setLngLat(Ze.lngLat).setHTML(`<strong>${Ze.features[0].properties[Re]?Ze.features[0].properties[Re]:Ze.features[0].properties[pe]}</strong>`).addTo(tt)):E.remove()}}),tt.on("mouseleave",s,Ze=>{He&&tt.setFeatureState({source:C,sourceLayer:A,id:He},{hovered:!1}),m(1,He=m(25,Vr=null)),tt.getCanvas().style.cursor="",E.remove()})),c.$$set=Ze=>{"id"in Ze&&m(2,s=Ze.id),"source"in Ze&&m(3,C=Ze.source),"sourceLayer"in Ze&&m(4,A=Ze.sourceLayer),"type"in Ze&&m(5,V=Ze.type),"filter"in Ze&&m(6,N=Ze.filter),"layout"in Ze&&m(7,W=Ze.layout),"paint"in Ze&&m(8,K=Ze.paint),"data"in Ze&&m(9,H=Ze.data),"code"in Ze&&m(10,pe=Ze.code),"name"in Ze&&m(11,Re=Ze.name),"colorCode"in Ze&&m(12,ze=Ze.colorCode),"click"in Ze&&m(13,Ge=Ze.click),"ignoreClick"in Ze&&m(14,Ke=Ze.ignoreClick),"clickCenter"in Ze&&m(15,Nt=Ze.clickCenter),"selected"in Ze&&m(0,Dt=Ze.selected),"hover"in Ze&&m(16,mt=Ze.hover),"hovered"in Ze&&m(1,He=Ze.hovered),"highlight"in Ze&&m(17,Er=Ze.highlight),"highlightKey"in Ze&&m(18,hr=Ze.highlightKey),"highlighted"in Ze&&m(19,Ht=Ze.highlighted),"order"in Ze&&m(20,Jt=Ze.order),"maxzoom"in Ze&&m(21,qe=Ze.maxzoom),"minzoom"in Ze&&m(22,_r=Ze.minzoom),"isChild"in Ze&&m(23,At=Ze.isChild)},c.$$.update=()=>{c.$$.dirty[0]&4096&&ze&&rt(),c.$$.dirty[0]&68026392&&Er&&Ht!=Pt&&(Pt[0]&&Pt.forEach(Ze=>{let lr={};lr[hr]=!1,tt.setFeatureState({source:C,sourceLayer:A,id:Ze},lr)}),m(26,Pt=Ht),Ht[0]&&Ht.forEach(Ze=>{let lr={};lr[hr]=!0,tt.setFeatureState({source:C,sourceLayer:A,id:Ze},lr)})),c.$$.dirty[0]&16777241&&Dt!=pr&&(pr&&tt.setFeatureState({source:C,sourceLayer:A,id:pr},{selected:!1}),Dt&&tt.setFeatureState({source:C,sourceLayer:A,id:Dt},{selected:!0}),m(24,pr=Dt)),c.$$.dirty[0]&33619994&&mt&&He!=Vr&&(Vr&&tt.setFeatureState({source:C,sourceLayer:A,id:Vr},{hovered:!1}),He&&tt.setFeatureState({source:C,sourceLayer:A,id:He},{hovered:!0}),m(25,Vr=He))},[Dt,He,s,C,A,V,N,W,K,H,pe,Re,ze,Ge,Ke,Nt,mt,Er,hr,Ht,Jt,qe,_r,At,pr,Vr,Pt]}class Wu extends Ka{constructor(p){super(),Xa(this,p,z0,null,Wa,{id:2,source:3,sourceLayer:4,type:5,filter:6,layout:7,paint:8,data:9,code:10,name:11,colorCode:12,click:13,ignoreClick:14,clickCenter:15,selected:0,hover:16,hovered:1,highlight:17,highlightKey:18,highlighted:19,order:20,maxzoom:21,minzoom:22,isChild:23},null,[-1,-1])}}function dm(c,p,m){const v=c.slice();return v[31]=p[m],v[33]=m,v}function mm(c,p,m){const v=c.slice();return v[34]=p[m],v[33]=m,v}function ym(c,p,m){const v=c.slice();return v[36]=p[m],v}function gm(c,p,m){const v=c.slice();return v[36]=p[m],v}function _m(c,p,m){const v=c.slice();return v[34]=p[m],v[33]=m,v}function vm(c){let p,m,v,S,E,s,C=" &gt; ",A,V,N,W,K,H=c[1].name+"",pe,Re,ze,Ge,Ke,Nt,Dt,mt,He,Er,hr,Ht,Jt,qe,_r,At,nr,tt,pr,Vr,Pt,tr,rt,Ze,lr,Tr,on,an,Ni,Xt,wr,Bt,Lr,kn,zn,Gt,An=c[1].name+"",bi,Ai,Ro,Gr,ci,jr,Pn,Xi,Wi=" &#x24D8; ",Pi,Ui,hi,vo,Jo,Cn,ro=c[1].data.births.value[2020].toLocaleString()+"",io,Yo,xo,ji,pi,sn,Bo,qn,Pa=" &#x24D8; ",no,qi,Hi,bo,oo,dr,M=c[1].data.deaths.value[2020].toLocaleString()+"",R,F,G,J,le,ce,O,te,me=c[1].name+"",Ce,Be,Se,Le,st,Xe,xe,Je,Ue,Ve,It,Ye,Ot=c[1].name+"",sr,Ct,Qt,Mt,ri,Kt,mr,rr=(c[1].children[0]?fu[c[1].children[0].type].pl:"Areas")+"",Lt,$t,Yr=c[1].name+"",ao,Kr,wi,so,Qo,Pr,mn,qr,Xr,fi,yr=c[1].name+"",yn,ln,Ha,Ft,Ji,Rr,Nr,Zn,Qr,sa=" &#x24D8; ",fs,Ca,Oo,el,Ja,la,wo,Ds,gn,Mn,Gn,Ls,lo,uo=" &#x24D8; ",Fo,de,Si,Ci,Br,_n,Mi,ii,Kn,So,Ma,Jl,Da,Yl=" &#x24D8; ",tl,La,ds,Tl,Ql,Vo,ms,Ya,ni,rl,co,No=c[1].name+"",ua,Ra,ca,Dn,un,Ln,Il,Qa,Cr=" &#x24D8; ",$l,ha,ys,kl,zl,Ba,Oa,vn,cn,pa,Al,Fa,gs=" &#x24D8; ",Pl,Eo,Uo,Cl,_s,gr,$o,eu,Xn,To,Va,Ml,fa,Rs=" &#x24D8; ",vs,da,ma,$a,Dl,Io,ko,es,ts,Ll,zo,Na=c[1].name+"",xs,il,Bs,ya,Wn,ea,Rl,rs,Bl=" &#x24D8; ",nl,Ua,is,bs,Ol,ho,Sr,Os,Rn,Yi,Ut,Mr,Qi,ol=" &#x24D8; ",ns,ta,Fs,tu,ws,jo,ra,Or,Bn,ga,oi,Qe,po=" &#x24D8; ",Vs,qo,On,Fn,al,je,_a,sl,Ei,fo,Hn;function ll(ye,ut){return ye[1].parents[0]?P0:A0}let Ss=ll(c),ai=Ss(c),si=c[1].type!="ew"&&bm(c);nr=new b0({props:{options:c[0],group:"typestr",search:!0}}),nr.$on("select",c[14]);let xn=c[1].type!="ew"&&wm(c);function ul(ye){c[24](ye)}let Fl={location:{bounds:c[1].bounds},options:{fitBoundsOptions:{padding:20}},style:Rg,$$slots:{default:[D0]},$$scope:{ctx:c}};c[6]!==void 0&&(Fl.map=c[6]),xe=new T0({props:Fl}),El.push(()=>Mg(xe,"map",ul));function Vl(ye,ut){return ye[1].parents[0]?R0:L0}let mo=Vl(c),di=mo(c);function Yt(ye,ut){return ye[1].children[0]?O0:B0}let Ao=Yt(c),Ti=Ao(c);return wo=new wc({props:{data:c[1]&&c[12](["births","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null}}),Mi=new wc({props:{data:c[1]&&c[12](["birth_month","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),Vo=new Ah({props:{data:c[1]&&c[12](["place_of_death","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),Ba=new Ah({props:{data:c[1]&&c[12](["cause_of_death","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),$o=new wc({props:{data:c[1]&&c[12](["age_at_death","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),Io=new Ah({props:{data:c[1]&&c[12](["place_of_death","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),Sr=new wc({props:{data:c[1]&&c[12](["marriage_month","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),jo=new Ah({props:{data:c[1]&&c[12](["place_of_marriage","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),_a=new wc({props:{data:c[1]&&c[12](["ave_age_at_marriage","perc","2020"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),{c(){p=Ie("div"),m=Ie("div"),v=Ie("span"),S=Ie("a"),E=$e("Home"),s=new Op(!1),A=pt(),ai.c(),V=pt(),N=Ie("br"),W=pt(),K=Ie("span"),pe=$e(H),Re=pt(),ze=Ie("div"),Ge=$e(`Click for:\r
		\r
					`),Ke=Ie("button"),Nt=$e("No comparison"),Dt=pt(),si&&si.c(),mt=pt(),He=Ie("button"),Er=$e("Same area 2010"),hr=pt(),Ht=Ie("div"),Jt=Ie("div"),qe=Ie("b"),_r=$e("Search for your Local Government District:"),At=pt(),gi(nr.$$.fragment),tt=pt(),pr=Ie("script"),Vr=$e(`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input")\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]'\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),Pt=pt(),tr=Ie("div"),rt=Ie("button"),Ze=$e("Print / PDF"),lr=pt(),Tr=Ie("button"),on=$e("Menu"),an=pt(),Ni=Ie("button"),Xt=$e("Share"),wr=pt(),Bt=Ie("div"),Lr=Ie("div"),kn=Ie("h3"),zn=$e("Overview"),Gt=$e(`\r
					The population of `),bi=$e(An),Ai=$e(` was 25,000 in 2020.  \r
					`),xn&&xn.c(),Ro=pt(),Gr=Ie("div"),ci=Ie("div"),jr=Ie("div"),Pn=$e("Births "),Xi=Ie("span"),Pi=pt(),Ui=Ie("div"),hi=Ie("div"),vo=$e("words....."),Jo=pt(),Cn=Ie("span"),io=$e(ro),Yo=Ie("br"),xo=pt(),ji=Ie("div"),pi=Ie("div"),sn=Ie("div"),Bo=$e("Deaths "),qn=Ie("span"),no=pt(),qi=Ie("div"),Hi=Ie("div"),bo=$e("words...."),oo=pt(),dr=Ie("span"),R=$e(M),F=Ie("br"),G=pt(),J=Ie("div"),le=Ie("div"),ce=Ie("h3"),O=$e("You are currently viewing: "),te=Ie("span"),Ce=$e(me),Be=pt(),Se=Ie("br"),Le=$e("View other area statistics by clicking on the map below or using the menu on the right."),st=pt(),Xe=Ie("div"),gi(xe.$$.fragment),Ue=pt(),Ve=Ie("div"),It=Ie("span"),Ye=$e("Parents of "),sr=$e(Ot),Ct=Ie("br"),Qt=pt(),Mt=Ie("span"),di.c(),ri=pt(),Kt=Ie("div"),mr=Ie("span"),Lt=$e(rr),$t=$e(" within "),ao=$e(Yr),Kr=Ie("br"),wi=pt(),so=Ie("span"),Ti.c(),Pr=pt(),mn=Ie("div"),qr=Ie("h2"),Xr=$e("Births "),fi=Ie("span"),yn=$e(yr),ln=$e(" 2020"),Ha=pt(),Ft=Ie("div"),Ji=Ie("div"),Rr=Ie("div"),Nr=Ie("div"),Zn=$e("Births by sex "),Qr=Ie("span"),fs=pt(),Ca=Ie("div"),Oo=Ie("div"),el=$e("words about births"),Ja=pt(),la=Ie("div"),gi(wo.$$.fragment),Ds=pt(),gn=Ie("div"),Mn=Ie("div"),Gn=Ie("div"),Ls=$e("Births by month "),lo=Ie("span"),Fo=pt(),de=Ie("div"),Si=Ie("div"),Ci=$e("words about birth months"),Br=pt(),_n=Ie("div"),gi(Mi.$$.fragment),ii=pt(),Kn=Ie("div"),So=Ie("div"),Ma=Ie("div"),Jl=$e("Places of birth "),Da=Ie("span"),tl=pt(),La=Ie("div"),ds=Ie("div"),Tl=$e("words about place of birth"),Ql=pt(),gi(Vo.$$.fragment),ms=pt(),Ya=Ie("div"),ni=Ie("h2"),rl=$e("Deaths "),co=Ie("span"),ua=$e(No),Ra=$e(" 2020"),ca=pt(),Dn=Ie("div"),un=Ie("div"),Ln=Ie("div"),Il=$e("Cause of death "),Qa=Ie("span"),$l=pt(),ha=Ie("div"),ys=Ie("div"),kl=$e("words about cause of death"),zl=pt(),gi(Ba.$$.fragment),Oa=pt(),vn=Ie("div"),cn=Ie("div"),pa=Ie("div"),Al=$e("Age at death (years) "),Fa=Ie("span"),Pl=pt(),Eo=Ie("div"),Uo=Ie("div"),Cl=$e("words for age at death"),_s=pt(),gr=Ie("div"),gi($o.$$.fragment),eu=pt(),Xn=Ie("div"),To=Ie("div"),Va=Ie("div"),Ml=$e("Place of death "),fa=Ie("span"),vs=pt(),da=Ie("div"),ma=Ie("div"),$a=$e("words for place of death"),Dl=pt(),gi(Io.$$.fragment),ko=pt(),es=Ie("div"),ts=Ie("h2"),Ll=$e("Marriages "),zo=Ie("span"),xs=$e(Na),il=$e(" 2020"),Bs=pt(),ya=Ie("div"),Wn=Ie("div"),ea=Ie("div"),Rl=$e("Marriages by month "),rs=Ie("span"),nl=pt(),Ua=Ie("div"),is=Ie("div"),bs=$e("words about marriage months"),Ol=pt(),ho=Ie("div"),gi(Sr.$$.fragment),Os=pt(),Rn=Ie("div"),Yi=Ie("div"),Ut=Ie("div"),Mr=$e("Place of marriage "),Qi=Ie("span"),ns=pt(),ta=Ie("div"),Fs=Ie("div"),tu=$e("words for place of marriage"),ws=pt(),gi(jo.$$.fragment),ra=pt(),Or=Ie("div"),Bn=Ie("div"),ga=Ie("div"),oi=$e("Average age at marriage (years) "),Qe=Ie("span"),Vs=pt(),qo=Ie("div"),On=Ie("div"),Fn=$e("words for age at marriage"),al=pt(),je=Ie("div"),gi(_a.$$.fragment),this.h()},l(ye){p=ke(ye,"DIV",{class:!0});var ut=we(p);m=ke(ut,"DIV",{});var bn=we(m);v=ke(bn,"SPAN",{class:!0});var Di=we(v);S=ke(Di,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var Li=we(S);E=et(Li,"Home"),Li.forEach(ae),s=Fp(Di,!1),A=ft(Di),ai.l(Di),V=ft(Di),Di.forEach(ae),N=ke(bn,"BR",{}),W=ft(bn),K=ke(bn,"SPAN",{class:!0});var ia=we(K);pe=et(ia,H),ia.forEach(ae),Re=ft(bn),ze=ke(bn,"DIV",{class:!0,style:!0});var ct=we(ze);Ge=et(ct,`Click for:\r
		\r
					`),Ke=ke(ct,"BUTTON",{class:!0});var lt=we(Ke);Nt=et(lt,"No comparison"),lt.forEach(ae),Dt=ft(ct),si&&si.l(ct),mt=ft(ct),He=ke(ct,"BUTTON",{class:!0});var va=we(He);Er=et(va,"Same area 2010"),va.forEach(ae),ct.forEach(ae),bn.forEach(ae),hr=ft(ut),Ht=ke(ut,"DIV",{});var Ii=we(Ht);Jt=ke(Ii,"DIV",{style:!0,class:!0});var mi=we(Jt);qe=ke(mi,"B",{});var li=we(qe);_r=et(li,"Search for your Local Government District:"),li.forEach(ae),At=ft(mi),_i(nr.$$.fragment,mi),tt=ft(mi),pr=ke(mi,"SCRIPT",{});var Vn=we(pr);Vr=et(Vn,`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input")\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]'\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),Vn.forEach(ae),Pt=ft(mi),tr=ke(mi,"DIV",{width:!0});var os=we(tr);rt=ke(os,"BUTTON",{class:!0,style:!0,title:!0,onclick:!0});var cl=we(rt);Ze=et(cl,"Print / PDF"),cl.forEach(ae),lr=ft(os),Tr=ke(os,"BUTTON",{class:!0,style:!0,alt:!0,onclick:!0});var vr=we(Tr);on=et(vr,"Menu"),vr.forEach(ae),an=ft(os),Ni=ke(os,"BUTTON",{class:!0,style:!0,type:!0,alt:!0});var Zi=we(Ni);Xt=et(Zi,"Share"),Zi.forEach(ae),os.forEach(ae),mi.forEach(ae),Ii.forEach(ae),ut.forEach(ae),wr=ft(ye),Bt=ke(ye,"DIV",{id:!0,class:!0});var Es=we(Bt);Lr=ke(Es,"DIV",{class:!0,style:!0});var Zo=we(Lr);kn=ke(Zo,"H3",{style:!0,class:!0});var Nl=we(kn);zn=et(Nl,"Overview"),Nl.forEach(ae),Gt=et(Zo,`\r
					The population of `),bi=et(Zo,An),Ai=et(Zo,` was 25,000 in 2020.  \r
					`),xn&&xn.l(Zo),Zo.forEach(ae),Ro=ft(Es),Gr=ke(Es,"DIV",{class:!0});var Jn=we(Gr);ci=ke(Jn,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Yn=we(ci);jr=ke(Yn,"DIV",{class:!0,style:!0});var as=we(jr);Pn=et(as,"Births "),Xi=ke(as,"SPAN",{style:!0});var xa=we(Xi);xa.forEach(ae),as.forEach(ae),Yn.forEach(ae),Pi=ft(Jn),Ui=ke(Jn,"DIV",{class:!0,id:!0});var hl=we(Ui);hi=ke(hl,"DIV",{class:!0});var Ts=we(hi);vo=et(Ts,"words....."),Ts.forEach(ae),hl.forEach(ae),Jo=ft(Jn),Cn=ke(Jn,"SPAN",{class:!0,style:!0});var Ns=we(Cn);io=et(Ns,ro),Ns.forEach(ae),Yo=ke(Jn,"BR",{}),Jn.forEach(ae),xo=ft(Es),ji=ke(Es,"DIV",{class:!0});var ja=we(ji);pi=ke(ja,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Is=we(pi);sn=ke(Is,"DIV",{class:!0,style:!0});var qa=we(sn);Bo=et(qa,"Deaths "),qn=ke(qa,"SPAN",{style:!0});var ru=we(qn);ru.forEach(ae),qa.forEach(ae),Is.forEach(ae),no=ft(ja),qi=ke(ja,"DIV",{class:!0,id:!0});var Za=we(qi);Hi=ke(Za,"DIV",{class:!0});var Ga=we(Hi);bo=et(Ga,"words...."),Ga.forEach(ae),Za.forEach(ae),oo=ft(ja),dr=ke(ja,"SPAN",{class:!0,style:!0});var pl=we(dr);R=et(pl,M),pl.forEach(ae),F=ke(ja,"BR",{}),ja.forEach(ae),Es.forEach(ae),G=ft(ye),J=ke(ye,"DIV",{class:!0});var Qn=we(J);le=ke(Qn,"DIV",{style:!0});var Nn=we(le);ce=ke(Nn,"H3",{class:!0});var fl=we(ce);O=et(fl,"You are currently viewing: "),te=ke(fl,"SPAN",{style:!0});var Us=we(te);Ce=et(Us,me),Us.forEach(ae),fl.forEach(ae),Be=ft(Nn),Se=ke(Nn,"BR",{}),Le=et(Nn,"View other area statistics by clicking on the map below or using the menu on the right."),Nn.forEach(ae),st=ft(Qn),Xe=ke(Qn,"DIV",{id:!0,style:!0,class:!0});var Ul=we(Xe);_i(xe.$$.fragment,Ul),Ul.forEach(ae),Ue=ft(Qn),Ve=ke(Qn,"DIV",{});var ss=we(Ve);It=ke(ss,"SPAN",{class:!0});var n=we(It);Ye=et(n,"Parents of "),sr=et(n,Ot),n.forEach(ae),Ct=ke(ss,"BR",{}),Qt=ft(ss),Mt=ke(ss,"SPAN",{class:!0});var a=we(Mt);di.l(a),a.forEach(ae),ss.forEach(ae),ri=ft(Qn),Kt=ke(Qn,"DIV",{});var o=we(Kt);mr=ke(o,"SPAN",{class:!0});var u=we(mr);Lt=et(u,rr),$t=et(u," within "),ao=et(u,Yr),u.forEach(ae),Kr=ke(o,"BR",{}),wi=ft(o),so=ke(o,"SPAN",{class:!0});var d=we(so);Ti.l(d),d.forEach(ae),o.forEach(ae),Qn.forEach(ae),Pr=ft(ye),mn=ke(ye,"DIV",{style:!0});var _=we(mn);qr=ke(_,"H2",{class:!0});var x=we(qr);Xr=et(x,"Births "),fi=ke(x,"SPAN",{class:!0});var T=we(fi);yn=et(T,yr),ln=et(T," 2020"),T.forEach(ae),x.forEach(ae),_.forEach(ae),Ha=ft(ye),Ft=ke(ye,"DIV",{class:!0});var z=we(Ft);Ji=ke(z,"DIV",{class:!0});var L=we(Ji);Rr=ke(L,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var j=we(Rr);Nr=ke(j,"DIV",{class:!0,style:!0});var q=we(Nr);Zn=et(q,"Births by sex "),Qr=ke(q,"SPAN",{style:!0});var Z=we(Qr);Z.forEach(ae),q.forEach(ae),j.forEach(ae),fs=ft(L),Ca=ke(L,"DIV",{class:!0,id:!0});var re=we(Ca);Oo=ke(re,"DIV",{class:!0});var $=we(Oo);el=et($,"words about births"),$.forEach(ae),re.forEach(ae),Ja=ft(L),la=ke(L,"DIV",{class:!0,style:!0});var se=we(la);_i(wo.$$.fragment,se),se.forEach(ae),L.forEach(ae),Ds=ft(z),gn=ke(z,"DIV",{class:!0});var Y=we(gn);Mn=ke(Y,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var oe=we(Mn);Gn=ke(oe,"DIV",{class:!0,style:!0});var he=we(Gn);Ls=et(he,"Births by month "),lo=ke(he,"SPAN",{style:!0});var ge=we(lo);ge.forEach(ae),he.forEach(ae),oe.forEach(ae),Fo=ft(Y),de=ke(Y,"DIV",{class:!0,id:!0});var Te=we(de);Si=ke(Te,"DIV",{class:!0});var ve=we(Si);Ci=et(ve,"words about birth months"),ve.forEach(ae),Te.forEach(ae),Br=ft(Y),_n=ke(Y,"DIV",{class:!0,style:!0});var Ae=we(_n);_i(Mi.$$.fragment,Ae),Ae.forEach(ae),Y.forEach(ae),ii=ft(z),Kn=ke(z,"DIV",{class:!0});var De=we(Kn);So=ke(De,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Ne=we(So);Ma=ke(Ne,"DIV",{class:!0,style:!0});var Fe=we(Ma);Jl=et(Fe,"Places of birth "),Da=ke(Fe,"SPAN",{style:!0});var nt=we(Da);nt.forEach(ae),Fe.forEach(ae),Ne.forEach(ae),tl=ft(De),La=ke(De,"DIV",{class:!0,id:!0});var yt=we(La);ds=ke(yt,"DIV",{class:!0});var vt=we(ds);Tl=et(vt,"words about place of birth"),vt.forEach(ae),yt.forEach(ae),Ql=ft(De),_i(Vo.$$.fragment,De),De.forEach(ae),ms=ft(z),Ya=ke(z,"DIV",{style:!0});var _t=we(Ya);ni=ke(_t,"H2",{class:!0});var or=we(ni);rl=et(or,"Deaths "),co=ke(or,"SPAN",{class:!0});var ot=we(co);ua=et(ot,No),Ra=et(ot," 2020"),ot.forEach(ae),or.forEach(ae),_t.forEach(ae),ca=ft(z),Dn=ke(z,"DIV",{class:!0});var St=we(Dn);un=ke(St,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Vt=we(un);Ln=ke(Vt,"DIV",{class:!0,style:!0});var Tt=we(Ln);Il=et(Tt,"Cause of death "),Qa=ke(Tt,"SPAN",{style:!0});var kt=we(Qa);kt.forEach(ae),Tt.forEach(ae),Vt.forEach(ae),$l=ft(St),ha=ke(St,"DIV",{class:!0,id:!0});var Rt=we(ha);ys=ke(Rt,"DIV",{class:!0});var Et=we(ys);kl=et(Et,"words about cause of death"),Et.forEach(ae),Rt.forEach(ae),zl=ft(St),_i(Ba.$$.fragment,St),St.forEach(ae),Oa=ft(z),vn=ke(z,"DIV",{class:!0});var xt=we(vn);cn=ke(xt,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Ri=we(cn);pa=ke(Ri,"DIV",{class:!0,style:!0});var Wr=we(pa);Al=et(Wr,"Age at death (years) "),Fa=ke(Wr,"SPAN",{style:!0});var wn=we(Fa);wn.forEach(ae),Wr.forEach(ae),Ri.forEach(ae),Pl=ft(xt),Eo=ke(xt,"DIV",{class:!0,id:!0});var Gi=we(Eo);Uo=ke(Gi,"DIV",{class:!0});var Hr=we(Uo);Cl=et(Hr,"words for age at death"),Hr.forEach(ae),Gi.forEach(ae),_s=ft(xt),gr=ke(xt,"DIV",{class:!0,style:!0});var ui=we(gr);_i($o.$$.fragment,ui),ui.forEach(ae),xt.forEach(ae),eu=ft(z),Xn=ke(z,"DIV",{class:!0});var $i=we(Xn);To=ke($i,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Sn=we(To);Va=ke(Sn,"DIV",{class:!0,style:!0});var ba=we(Va);Ml=et(ba,"Place of death "),fa=ke(ba,"SPAN",{style:!0});var $n=we(fa);$n.forEach(ae),ba.forEach(ae),Sn.forEach(ae),vs=ft($i),da=ke($i,"DIV",{class:!0,id:!0});var Go=we(da);ma=ke(Go,"DIV",{class:!0});var Po=we(ma);$a=et(Po,"words for place of death"),Po.forEach(ae),Go.forEach(ae),Dl=ft($i),_i(Io.$$.fragment,$i),$i.forEach(ae),ko=ft(z),es=ke(z,"DIV",{style:!0});var js=we(es);ts=ke(js,"H2",{class:!0});var ls=we(ts);Ll=et(ls,"Marriages "),zo=ke(ls,"SPAN",{class:!0});var wa=we(zo);xs=et(wa,Na),il=et(wa," 2020"),wa.forEach(ae),ls.forEach(ae),js.forEach(ae),Bs=ft(z),ya=ke(z,"DIV",{class:!0});var na=we(ya);Wn=ke(na,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var qs=we(Wn);ea=ke(qs,"DIV",{class:!0,style:!0});var Ko=we(ea);Rl=et(Ko,"Marriages by month "),rs=ke(Ko,"SPAN",{style:!0});var dl=we(rs);dl.forEach(ae),Ko.forEach(ae),qs.forEach(ae),nl=ft(na),Ua=ke(na,"DIV",{class:!0,id:!0});var oa=we(Ua);is=ke(oa,"DIV",{class:!0});var Bi=we(is);bs=et(Bi,"words about marriage months"),Bi.forEach(ae),oa.forEach(ae),Ol=ft(na),ho=ke(na,"DIV",{class:!0,style:!0});var Sa=we(ho);_i(Sr.$$.fragment,Sa),Sa.forEach(ae),na.forEach(ae),Os=ft(z),Rn=ke(z,"DIV",{class:!0});var Co=we(Rn);Yi=ke(Co,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var us=we(Yi);Ut=ke(us,"DIV",{class:!0,style:!0});var ur=we(Ut);Mr=et(ur,"Place of marriage "),Qi=ke(ur,"SPAN",{style:!0});var Mo=we(Qi);Mo.forEach(ae),ur.forEach(ae),us.forEach(ae),ns=ft(Co),ta=ke(Co,"DIV",{class:!0,id:!0});var Un=we(ta);Fs=ke(Un,"DIV",{class:!0});var cs=we(Fs);tu=et(cs,"words for place of marriage"),cs.forEach(ae),Un.forEach(ae),ws=ft(Co),_i(jo.$$.fragment,Co),Co.forEach(ae),ra=ft(z),Or=ke(z,"DIV",{class:!0});var Zs=we(Or);Bn=ke(Zs,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ml=we(Bn);ga=ke(ml,"DIV",{class:!0,style:!0});var iu=we(ga);oi=et(iu,"Average age at marriage (years) "),Qe=ke(iu,"SPAN",{style:!0});var yl=we(Qe);yl.forEach(ae),iu.forEach(ae),ml.forEach(ae),Vs=ft(Zs),qo=ke(Zs,"DIV",{class:!0,id:!0});var nu=we(qo);On=ke(nu,"DIV",{class:!0});var ks=we(On);Fn=et(ks,"words for age at marriage"),ks.forEach(ae),nu.forEach(ae),al=ft(Zs),je=ke(Zs,"DIV",{class:!0,style:!0});var gl=we(je);_i(_a.$$.fragment,gl),gl.forEach(ae),Zs.forEach(ae),z.forEach(ae),this.h()},h(){X(S,"href",$s+"/"),X(S,"sveltekit:noscroll",""),X(S,"class","svelte-1dy7mjs"),s.a=A,X(v,"class","text-small"),X(K,"class","text-big title svelte-1dy7mjs"),X(Ke,"class","btn svelte-1dy7mjs"),fn(Ke,"btn-active",c[9]),X(He,"class","btn svelte-1dy7mjs"),fn(He,"btn-active",c[4]&!c[9]&!c[10]),X(ze,"class","text-bold"),Me(ze,"font-size","0.85em"),X(rt,"class","btn svelte-1dy7mjs"),Me(rt,"width","33%"),X(rt,"title","Click to print this page to pdf or printer"),X(rt,"onclick","window.print();return false;"),X(Tr,"class","btn svelte-1dy7mjs"),Me(Tr,"width","33%"),X(Tr,"alt","Return to the landing page"),X(Tr,"onclick","window.location.href='"+$s+"';"),X(Ni,"class","btn svelte-1dy7mjs"),Me(Ni,"width","30%"),X(Ni,"type","share"),X(Ni,"alt","Share this page"),X(tr,"width","100%"),Me(Jt,"width","350px"),Me(Jt,"padding-top","5px"),X(Jt,"class","svelte-1dy7mjs"),fn(Jt,"float-right",c[5]>1),X(p,"class","grid mtl svelte-1dy7mjs"),Me(kn,"margin","0 0 10px 0"),Me(kn,"line-height","1.78"),X(kn,"class","svelte-1dy7mjs"),X(Lr,"class","div-grey-box svelte-1dy7mjs"),Me(Lr,"line-height","1.3"),Me(Xi,"color","gray"),Me(Xi,"font-size","14pt"),X(jr,"class","blocktitle"),Me(jr,"margin","0"),Me(jr,"width","100%"),X(ci,"class","row"),Me(ci,"display","flex"),Me(ci,"cursor","pointer"),X(ci,"data-bs-toggle","collapse"),X(ci,"data-bs-target","#pop-info"),X(ci,"aria-expanded","false"),X(ci,"aria-controls","pop-info"),X(hi,"class","card card-body svelte-1dy7mjs"),X(Ui,"class","collapse svelte-1dy7mjs"),X(Ui,"id","pop-info"),X(Cn,"class","text-big"),Me(Cn,"font-size","2.8em"),X(Gr,"class","div-grey-box svelte-1dy7mjs"),Me(qn,"color","gray"),Me(qn,"font-size","14pt"),X(sn,"class","blocktitle"),Me(sn,"margin","0"),Me(sn,"width","100%"),X(pi,"class","row"),Me(pi,"display","flex"),Me(pi,"cursor","pointer"),X(pi,"data-bs-toggle","collapse"),X(pi,"data-bs-target","#pop-info2"),X(pi,"aria-expanded","false"),X(pi,"aria-controls","pop-info2"),X(Hi,"class","card card-body svelte-1dy7mjs"),X(qi,"class","collapse svelte-1dy7mjs"),X(qi,"id","pop-info2"),X(dr,"class","text-big"),Me(dr,"font-size","2.8em"),X(ji,"class","div-grey-box svelte-1dy7mjs"),X(Bt,"id","grid"),X(Bt,"class","grid mt svelte-1dy7mjs"),Me(te,"color","#93328E"),X(ce,"class","svelte-1dy7mjs"),Me(le,"grid-column","span "+c[5]),X(Xe,"id","map"),Me(Xe,"padding-right","45px"),Me(Xe,"grid-column","span "+(c[5]==2?2:c[5]&&c[5]>2?c[5]-1:1)),X(Xe,"class","svelte-1dy7mjs"),X(It,"class","text-bold"),X(Mt,"class","text-small"),X(mr,"class","text-bold"),X(so,"class","text-small"),X(J,"class","grid mt svelte-1dy7mjs"),Mh(()=>c[25].call(J)),X(fi,"class","title-inset muted svelte-1dy7mjs"),X(qr,"class","svelte-1dy7mjs"),Me(mn,"grid-column","span "+c[5]),Me(Qr,"color","gray"),Me(Qr,"font-size","14pt"),X(Nr,"class","blocktitle"),Me(Nr,"margin","0"),Me(Nr,"width","100%"),X(Rr,"class","row"),Me(Rr,"display","flex"),Me(Rr,"cursor","pointer"),X(Rr,"data-bs-toggle","collapse"),X(Rr,"data-bs-target","#births-info"),X(Rr,"aria-expanded","false"),X(Rr,"aria-controls","births-info"),X(Oo,"class","card card-body svelte-1dy7mjs"),X(Ca,"class","collapse svelte-1dy7mjs"),X(Ca,"id","births-info"),X(la,"class","chart svelte-1dy7mjs"),Me(la,"height","100px"),Me(la,"padding-bottom","5px"),X(Ji,"class","div-grey-box svelte-1dy7mjs"),Me(lo,"color","gray"),Me(lo,"font-size","14pt"),X(Gn,"class","blocktitle"),Me(Gn,"margin","0"),Me(Gn,"width","100%"),X(Mn,"class","row"),Me(Mn,"display","flex"),Me(Mn,"cursor","pointer"),X(Mn,"data-bs-toggle","collapse"),X(Mn,"data-bs-target","#birthmonth-info"),X(Mn,"aria-expanded","false"),X(Mn,"aria-controls","birthmonth-info"),X(Si,"class","card card-body svelte-1dy7mjs"),X(de,"class","collapse svelte-1dy7mjs"),X(de,"id","birthmonth-info"),X(_n,"class","chart svelte-1dy7mjs"),Me(_n,"height","100px"),Me(_n,"padding-bottom","5px"),X(gn,"class","div-grey-box svelte-1dy7mjs"),Me(Da,"color","gray"),Me(Da,"font-size","14pt"),X(Ma,"class","blocktitle"),Me(Ma,"margin","0"),Me(Ma,"width","100%"),X(So,"class","row"),Me(So,"display","flex"),Me(So,"cursor","pointer"),X(So,"data-bs-toggle","collapse"),X(So,"data-bs-target","#birthplace-info"),X(So,"aria-expanded","false"),X(So,"aria-controls","birthplace-info"),X(ds,"class","card card-body svelte-1dy7mjs"),X(La,"class","collapse svelte-1dy7mjs"),X(La,"id","birthplace-info"),X(Kn,"class","div-grey-box svelte-1dy7mjs"),X(co,"class","title-inset muted svelte-1dy7mjs"),X(ni,"class","svelte-1dy7mjs"),Me(Ya,"grid-column","span "+c[5]),Me(Qa,"color","gray"),Me(Qa,"font-size","14pt"),X(Ln,"class","blocktitle"),Me(Ln,"margin","0"),Me(Ln,"width","100%"),X(un,"class","row"),Me(un,"display","flex"),Me(un,"cursor","pointer"),X(un,"data-bs-toggle","collapse"),X(un,"data-bs-target","#causeofdeath-info"),X(un,"aria-expanded","false"),X(un,"aria-controls","causeofdeath-info"),X(ys,"class","card card-body svelte-1dy7mjs"),X(ha,"class","collapse svelte-1dy7mjs"),X(ha,"id","causeofdeath-info"),X(Dn,"class","div-grey-box svelte-1dy7mjs"),Me(Fa,"color","gray"),Me(Fa,"font-size","14pt"),X(pa,"class","blocktitle"),Me(pa,"margin","0"),Me(pa,"width","100%"),X(cn,"class","row"),Me(cn,"display","flex"),Me(cn,"cursor","pointer"),X(cn,"data-bs-toggle","collapse"),X(cn,"data-bs-target","#ageatdeath-info"),X(cn,"aria-expanded","false"),X(cn,"aria-controls","ageatdeath-info"),X(Uo,"class","card card-body svelte-1dy7mjs"),X(Eo,"class","collapse svelte-1dy7mjs"),X(Eo,"id","ageatdeath-info"),X(gr,"class","chart svelte-1dy7mjs"),Me(gr,"height","100px"),Me(gr,"padding-bottom","5px"),X(vn,"class","div-grey-box svelte-1dy7mjs"),Me(fa,"color","gray"),Me(fa,"font-size","14pt"),X(Va,"class","blocktitle"),Me(Va,"margin","0"),Me(Va,"width","100%"),X(To,"class","row"),Me(To,"display","flex"),Me(To,"cursor","pointer"),X(To,"data-bs-toggle","collapse"),X(To,"data-bs-target","#placeofdeath-info"),X(To,"aria-expanded","false"),X(To,"aria-controls","placeofdeath-info"),X(ma,"class","card card-body svelte-1dy7mjs"),X(da,"class","collapse svelte-1dy7mjs"),X(da,"id","placeofdeath-info"),X(Xn,"class","div-grey-box svelte-1dy7mjs"),X(zo,"class","title-inset muted svelte-1dy7mjs"),X(ts,"class","svelte-1dy7mjs"),Me(es,"grid-column","span "+c[5]),Me(rs,"color","gray"),Me(rs,"font-size","14pt"),X(ea,"class","blocktitle"),Me(ea,"margin","0"),Me(ea,"width","100%"),X(Wn,"class","row"),Me(Wn,"display","flex"),Me(Wn,"cursor","pointer"),X(Wn,"data-bs-toggle","collapse"),X(Wn,"data-bs-target","#marriagemonth-info"),X(Wn,"aria-expanded","false"),X(Wn,"aria-controls","marriagemonth-info"),X(is,"class","card card-body svelte-1dy7mjs"),X(Ua,"class","collapse svelte-1dy7mjs"),X(Ua,"id","marriagemonth-info"),X(ho,"class","chart svelte-1dy7mjs"),Me(ho,"height","100px"),Me(ho,"padding-bottom","5px"),X(ya,"class","div-grey-box svelte-1dy7mjs"),Me(Qi,"color","gray"),Me(Qi,"font-size","14pt"),X(Ut,"class","blocktitle"),Me(Ut,"margin","0"),Me(Ut,"width","100%"),X(Yi,"class","row"),Me(Yi,"display","flex"),Me(Yi,"cursor","pointer"),X(Yi,"data-bs-toggle","collapse"),X(Yi,"data-bs-target","#placeofmarriage-info"),X(Yi,"aria-expanded","false"),X(Yi,"aria-controls","placeofmarriage-info"),X(Fs,"class","card card-body svelte-1dy7mjs"),X(ta,"class","collapse svelte-1dy7mjs"),X(ta,"id","placeofmarriage-info"),X(Rn,"class","div-grey-box svelte-1dy7mjs"),Me(Qe,"color","gray"),Me(Qe,"font-size","14pt"),X(ga,"class","blocktitle"),Me(ga,"margin","0"),Me(ga,"width","100%"),X(Bn,"class","row"),Me(Bn,"display","flex"),Me(Bn,"cursor","pointer"),X(Bn,"data-bs-toggle","collapse"),X(Bn,"data-bs-target","#ageatmarriage-info"),X(Bn,"aria-expanded","false"),X(Bn,"aria-controls","ageatmarriage-info"),X(On,"class","card card-body svelte-1dy7mjs"),X(qo,"class","collapse svelte-1dy7mjs"),X(qo,"id","ageatmarriage-info"),X(je,"class","chart svelte-1dy7mjs"),Me(je,"height","100px"),Me(je,"padding-bottom","5px"),X(Or,"class","div-grey-box svelte-1dy7mjs"),X(Ft,"class","grid mt svelte-1dy7mjs"),Mh(()=>c[26].call(Ft))},m(ye,ut){dt(ye,p,ut),ie(p,m),ie(m,v),ie(v,S),ie(S,E),s.m(C,v),ie(v,A),ai.m(v,null),ie(v,V),ie(m,N),ie(m,W),ie(m,K),ie(K,pe),ie(m,Re),ie(m,ze),ie(ze,Ge),ie(ze,Ke),ie(Ke,Nt),ie(ze,Dt),si&&si.m(ze,null),ie(ze,mt),ie(ze,He),ie(He,Er),ie(p,hr),ie(p,Ht),ie(Ht,Jt),ie(Jt,qe),ie(qe,_r),ie(Jt,At),vi(nr,Jt,null),ie(Jt,tt),ie(Jt,pr),ie(pr,Vr),ie(Jt,Pt),ie(Jt,tr),ie(tr,rt),ie(rt,Ze),ie(tr,lr),ie(tr,Tr),ie(Tr,on),ie(tr,an),ie(tr,Ni),ie(Ni,Xt),dt(ye,wr,ut),dt(ye,Bt,ut),ie(Bt,Lr),ie(Lr,kn),ie(kn,zn),ie(Lr,Gt),ie(Lr,bi),ie(Lr,Ai),xn&&xn.m(Lr,null),ie(Bt,Ro),ie(Bt,Gr),ie(Gr,ci),ie(ci,jr),ie(jr,Pn),ie(jr,Xi),Xi.innerHTML=Wi,ie(Gr,Pi),ie(Gr,Ui),ie(Ui,hi),ie(hi,vo),ie(Gr,Jo),ie(Gr,Cn),ie(Cn,io),ie(Gr,Yo),ie(Bt,xo),ie(Bt,ji),ie(ji,pi),ie(pi,sn),ie(sn,Bo),ie(sn,qn),qn.innerHTML=Pa,ie(ji,no),ie(ji,qi),ie(qi,Hi),ie(Hi,bo),ie(ji,oo),ie(ji,dr),ie(dr,R),ie(ji,F),dt(ye,G,ut),dt(ye,J,ut),ie(J,le),ie(le,ce),ie(ce,O),ie(ce,te),ie(te,Ce),ie(le,Be),ie(le,Se),ie(le,Le),ie(J,st),ie(J,Xe),vi(xe,Xe,null),ie(J,Ue),ie(J,Ve),ie(Ve,It),ie(It,Ye),ie(It,sr),ie(Ve,Ct),ie(Ve,Qt),ie(Ve,Mt),di.m(Mt,null),ie(J,ri),ie(J,Kt),ie(Kt,mr),ie(mr,Lt),ie(mr,$t),ie(mr,ao),ie(Kt,Kr),ie(Kt,wi),ie(Kt,so),Ti.m(so,null),Qo=Dh(J,c[25].bind(J)),dt(ye,Pr,ut),dt(ye,mn,ut),ie(mn,qr),ie(qr,Xr),ie(qr,fi),ie(fi,yn),ie(fi,ln),dt(ye,Ha,ut),dt(ye,Ft,ut),ie(Ft,Ji),ie(Ji,Rr),ie(Rr,Nr),ie(Nr,Zn),ie(Nr,Qr),Qr.innerHTML=sa,ie(Ji,fs),ie(Ji,Ca),ie(Ca,Oo),ie(Oo,el),ie(Ji,Ja),ie(Ji,la),vi(wo,la,null),ie(Ft,Ds),ie(Ft,gn),ie(gn,Mn),ie(Mn,Gn),ie(Gn,Ls),ie(Gn,lo),lo.innerHTML=uo,ie(gn,Fo),ie(gn,de),ie(de,Si),ie(Si,Ci),ie(gn,Br),ie(gn,_n),vi(Mi,_n,null),ie(Ft,ii),ie(Ft,Kn),ie(Kn,So),ie(So,Ma),ie(Ma,Jl),ie(Ma,Da),Da.innerHTML=Yl,ie(Kn,tl),ie(Kn,La),ie(La,ds),ie(ds,Tl),ie(Kn,Ql),vi(Vo,Kn,null),ie(Ft,ms),ie(Ft,Ya),ie(Ya,ni),ie(ni,rl),ie(ni,co),ie(co,ua),ie(co,Ra),ie(Ft,ca),ie(Ft,Dn),ie(Dn,un),ie(un,Ln),ie(Ln,Il),ie(Ln,Qa),Qa.innerHTML=Cr,ie(Dn,$l),ie(Dn,ha),ie(ha,ys),ie(ys,kl),ie(Dn,zl),vi(Ba,Dn,null),ie(Ft,Oa),ie(Ft,vn),ie(vn,cn),ie(cn,pa),ie(pa,Al),ie(pa,Fa),Fa.innerHTML=gs,ie(vn,Pl),ie(vn,Eo),ie(Eo,Uo),ie(Uo,Cl),ie(vn,_s),ie(vn,gr),vi($o,gr,null),ie(Ft,eu),ie(Ft,Xn),ie(Xn,To),ie(To,Va),ie(Va,Ml),ie(Va,fa),fa.innerHTML=Rs,ie(Xn,vs),ie(Xn,da),ie(da,ma),ie(ma,$a),ie(Xn,Dl),vi(Io,Xn,null),ie(Ft,ko),ie(Ft,es),ie(es,ts),ie(ts,Ll),ie(ts,zo),ie(zo,xs),ie(zo,il),ie(Ft,Bs),ie(Ft,ya),ie(ya,Wn),ie(Wn,ea),ie(ea,Rl),ie(ea,rs),rs.innerHTML=Bl,ie(ya,nl),ie(ya,Ua),ie(Ua,is),ie(is,bs),ie(ya,Ol),ie(ya,ho),vi(Sr,ho,null),ie(Ft,Os),ie(Ft,Rn),ie(Rn,Yi),ie(Yi,Ut),ie(Ut,Mr),ie(Ut,Qi),Qi.innerHTML=ol,ie(Rn,ns),ie(Rn,ta),ie(ta,Fs),ie(Fs,tu),ie(Rn,ws),vi(jo,Rn,null),ie(Ft,ra),ie(Ft,Or),ie(Or,Bn),ie(Bn,ga),ie(ga,oi),ie(ga,Qe),Qe.innerHTML=po,ie(Or,Vs),ie(Or,qo),ie(qo,On),ie(On,Fn),ie(Or,al),ie(Or,je),vi(_a,je,null),sl=Dh(Ft,c[26].bind(Ft)),Ei=!0,fo||(Hn=[jn(Ke,"click",c[15]),jn(Ke,"click",c[16]),jn(Ke,"click",c[17]),jn(He,"click",c[21]),jn(He,"click",c[22]),jn(He,"click",c[23])],fo=!0)},p(ye,ut){Ss===(Ss=ll(ye))&&ai?ai.p(ye,ut):(ai.d(1),ai=Ss(ye),ai&&(ai.c(),ai.m(v,V))),(!Ei||ut[0]&2)&&H!==(H=ye[1].name+"")&&Ar(pe,H),ut[0]&512&&fn(Ke,"btn-active",ye[9]),ye[1].type!="ew"?si?si.p(ye,ut):(si=bm(ye),si.c(),si.m(ze,mt)):si&&(si.d(1),si=null),ut[0]&1552&&fn(He,"btn-active",ye[4]&!ye[9]&!ye[10]);const bn={};ut[0]&1&&(bn.options=ye[0]),nr.$set(bn),ut[0]&32&&fn(Jt,"float-right",ye[5]>1),(!Ei||ut[0]&2)&&An!==(An=ye[1].name+"")&&Ar(bi,An),ye[1].type!="ew"?xn?xn.p(ye,ut):(xn=wm(ye),xn.c(),xn.m(Lr,null)):xn&&(xn.d(1),xn=null),(!Ei||ut[0]&2)&&ro!==(ro=ye[1].data.births.value[2020].toLocaleString()+"")&&Ar(io,ro),(!Ei||ut[0]&2)&&M!==(M=ye[1].data.deaths.value[2020].toLocaleString()+"")&&Ar(R,M),(!Ei||ut[0]&2)&&me!==(me=ye[1].name+"")&&Ar(Ce,me),(!Ei||ut[0]&32)&&Me(le,"grid-column","span "+ye[5]);const Di={};ut[0]&2&&(Di.location={bounds:ye[1].bounds}),ut[0]&384|ut[1]&2048&&(Di.$$scope={dirty:ut,ctx:ye}),!Je&&ut[0]&64&&(Je=!0,Di.map=ye[6],Dg(()=>Je=!1)),xe.$set(Di),(!Ei||ut[0]&32)&&Me(Xe,"grid-column","span "+(ye[5]==2?2:ye[5]&&ye[5]>2?ye[5]-1:1)),(!Ei||ut[0]&2)&&Ot!==(Ot=ye[1].name+"")&&Ar(sr,Ot),mo===(mo=Vl(ye))&&di?di.p(ye,ut):(di.d(1),di=mo(ye),di&&(di.c(),di.m(Mt,null))),(!Ei||ut[0]&2)&&rr!==(rr=(ye[1].children[0]?fu[ye[1].children[0].type].pl:"Areas")+"")&&Ar(Lt,rr),(!Ei||ut[0]&2)&&Yr!==(Yr=ye[1].name+"")&&Ar(ao,Yr),Ao===(Ao=Yt(ye))&&Ti?Ti.p(ye,ut):(Ti.d(1),Ti=Ao(ye),Ti&&(Ti.c(),Ti.m(so,null))),(!Ei||ut[0]&2)&&yr!==(yr=ye[1].name+"")&&Ar(yn,yr),(!Ei||ut[0]&32)&&Me(mn,"grid-column","span "+ye[5]);const Li={};ut[0]&2&&(Li.data=ye[1]&&ye[12](["births","perc","2020"])),ut[0]&530&&(Li.zKey=ye[9]?null:ye[4]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),wo.$set(Li);const ia={};ut[0]&2&&(ia.data=ye[1]&&ye[12](["birth_month","perc","2020"])),ut[0]&530&&(ia.zKey=ye[9]?null:ye[4]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ut[0]&2048&&(ia.label=ye[11]),Mi.$set(ia);const ct={};ut[0]&2&&(ct.data=ye[1]&&ye[12](["place_of_death","perc","2020"])),ut[0]&530&&(ct.zKey=ye[9]?null:ye[4]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ut[0]&2048&&(ct.label=ye[11]),Vo.$set(ct),(!Ei||ut[0]&2)&&No!==(No=ye[1].name+"")&&Ar(ua,No),(!Ei||ut[0]&32)&&Me(Ya,"grid-column","span "+ye[5]);const lt={};ut[0]&2&&(lt.data=ye[1]&&ye[12](["cause_of_death","perc","2020"])),ut[0]&530&&(lt.zKey=ye[9]?null:ye[4]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ut[0]&2048&&(lt.label=ye[11]),Ba.$set(lt);const va={};ut[0]&2&&(va.data=ye[1]&&ye[12](["age_at_death","perc","2020"])),ut[0]&530&&(va.zKey=ye[9]?null:ye[4]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ut[0]&2048&&(va.label=ye[11]),$o.$set(va);const Ii={};ut[0]&2&&(Ii.data=ye[1]&&ye[12](["place_of_death","perc","2020"])),ut[0]&530&&(Ii.zKey=ye[9]?null:ye[4]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ut[0]&2048&&(Ii.label=ye[11]),Io.$set(Ii),(!Ei||ut[0]&2)&&Na!==(Na=ye[1].name+"")&&Ar(xs,Na),(!Ei||ut[0]&32)&&Me(es,"grid-column","span "+ye[5]);const mi={};ut[0]&2&&(mi.data=ye[1]&&ye[12](["marriage_month","perc","2020"])),ut[0]&530&&(mi.zKey=ye[9]?null:ye[4]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ut[0]&2048&&(mi.label=ye[11]),Sr.$set(mi);const li={};ut[0]&2&&(li.data=ye[1]&&ye[12](["place_of_marriage","perc","2020"])),ut[0]&530&&(li.zKey=ye[9]?null:ye[4]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ut[0]&2048&&(li.label=ye[11]),jo.$set(li);const Vn={};ut[0]&2&&(Vn.data=ye[1]&&ye[12](["ave_age_at_marriage","perc","2020"])),ut[0]&530&&(Vn.zKey=ye[9]?null:ye[4]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ut[0]&2048&&(Vn.label=ye[11]),_a.$set(Vn)},i(ye){Ei||(Zt(nr.$$.fragment,ye),Zt(xe.$$.fragment,ye),Zt(wo.$$.fragment,ye),Zt(Mi.$$.fragment,ye),Zt(Vo.$$.fragment,ye),Zt(Ba.$$.fragment,ye),Zt($o.$$.fragment,ye),Zt(Io.$$.fragment,ye),Zt(Sr.$$.fragment,ye),Zt(jo.$$.fragment,ye),Zt(_a.$$.fragment,ye),Ei=!0)},o(ye){ir(nr.$$.fragment,ye),ir(xe.$$.fragment,ye),ir(wo.$$.fragment,ye),ir(Mi.$$.fragment,ye),ir(Vo.$$.fragment,ye),ir(Ba.$$.fragment,ye),ir($o.$$.fragment,ye),ir(Io.$$.fragment,ye),ir(Sr.$$.fragment,ye),ir(jo.$$.fragment,ye),ir(_a.$$.fragment,ye),Ei=!1},d(ye){ye&&ae(p),ai.d(),si&&si.d(),xi(nr),ye&&ae(wr),ye&&ae(Bt),xn&&xn.d(),ye&&ae(G),ye&&ae(J),xi(xe),di.d(),Ti.d(),Qo(),ye&&ae(Pr),ye&&ae(mn),ye&&ae(Ha),ye&&ae(Ft),xi(wo),xi(Mi),xi(Vo),xi(Ba),xi($o),xi(Io),xi(Sr),xi(jo),xi(_a),sl(),fo=!1,gu(Hn)}}}function A0(c){let p=c[1].name+"",m;return{c(){m=$e(p)},l(v){m=et(v,p)},m(v,S){dt(v,m,S)},p(v,S){S[0]&2&&p!==(p=v[1].name+"")&&Ar(m,p)},d(v){v&&ae(m)}}}function P0(c){let p,m=c[1].name+"",v,S=[...c[1].parents].reverse(),E=[];for(let s=0;s<S.length;s+=1)E[s]=xm(_m(c,S,s));return{c(){for(let s=0;s<E.length;s+=1)E[s].c();p=pt(),v=$e(m)},l(s){for(let C=0;C<E.length;C+=1)E[C].l(s);p=ft(s),v=et(s,m)},m(s,C){for(let A=0;A<E.length;A+=1)E[A].m(s,C);dt(s,p,C),dt(s,v,C)},p(s,C){if(C[0]&2){S=[...s[1].parents].reverse();let A;for(A=0;A<S.length;A+=1){const V=_m(s,S,A);E[A]?E[A].p(V,C):(E[A]=xm(V),E[A].c(),E[A].m(p.parentNode,p))}for(;A<E.length;A+=1)E[A].d(1);E.length=S.length}C[0]&2&&m!==(m=s[1].name+"")&&Ar(v,m)},d(s){Ms(E,s),s&&ae(p),s&&ae(v)}}}function xm(c){let p,m=c[34].name+"",v,S,E,s=" &gt; ",C;return{c(){p=Ie("a"),v=$e(m),E=new Op(!1),C=dn(),this.h()},l(A){p=ke(A,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var V=we(p);v=et(V,m),V.forEach(ae),E=Fp(A,!1),C=dn(),this.h()},h(){X(p,"href",S=$s+"/"+c[34].code+"/"),X(p,"sveltekit:noscroll",""),X(p,"class","svelte-1dy7mjs"),E.a=C},m(A,V){dt(A,p,V),ie(p,v),E.m(s,A,V),dt(A,C,V)},p(A,V){V[0]&2&&m!==(m=A[34].name+"")&&Ar(v,m),V[0]&2&&S!==(S=$s+"/"+A[34].code+"/")&&X(p,"href",S)},d(A){A&&ae(p),A&&ae(C),A&&E.d()}}}function bm(c){let p,m,v,S;return{c(){p=Ie("button"),m=$e("NI 2020"),this.h()},l(E){p=ke(E,"BUTTON",{class:!0});var s=we(p);m=et(s,"NI 2020"),s.forEach(ae),this.h()},h(){X(p,"class","btn svelte-1dy7mjs"),fn(p,"btn-active",c[10]&!c[9]&!c[4])},m(E,s){dt(E,p,s),ie(p,m),v||(S=[jn(p,"click",c[18]),jn(p,"click",c[19]),jn(p,"click",c[20])],v=!0)},p(E,s){s[0]&1552&&fn(p,"btn-active",E[10]&!E[9]&!E[4])},d(E){E&&ae(p),v=!1,gu(S)}}}function wm(c){let p=c[1].name+"",m,v,S=fu[c[1].type].name.toLowerCase()+"",E,s;return{c(){m=$e(p),v=$e(" is a "),E=$e(S),s=$e(".")},l(C){m=et(C,p),v=et(C," is a "),E=et(C,S),s=et(C,".")},m(C,A){dt(C,m,A),dt(C,v,A),dt(C,E,A),dt(C,s,A)},p(C,A){A[0]&2&&p!==(p=C[1].name+"")&&Ar(m,p),A[0]&2&&S!==(S=fu[C[1].type].name.toLowerCase()+"")&&Ar(E,S)},d(C){C&&ae(m),C&&ae(v),C&&ae(E),C&&ae(s)}}}function C0(c){let p,m,v,S,E,s;const C=[za[c[36]],{id:c[36]+"-fill"},{type:"fill"},{isChild:c[8][c[36]]},{click:!0},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{hover:!0},{hovered:c[7].hovered},{layout:{visibility:c[7].type==c[36]||c[7].childType==c[36]?"visible":"none"}},{paint:c[7].type==c[36]?zr["fill-self"]:c[7].childType==c[36]?zr["fill-child"]:zr.fill}];let A={};for(let H=0;H<C.length;H+=1)A=Xl(A,C[H]);p=new Wu({props:A}),p.$on("select",c[13]);const V=[za[c[36]],{id:c[36]+"-bounds"},{type:"line"},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{layout:{visibility:c[7].type==c[36]||c[7].childType==c[36]?"visible":"none"}},{paint:c[7].type==c[36]?zr["line-active"]:c[7].childType==c[36]?zr["line-child"]:zr.line}];let N={};for(let H=0;H<V.length;H+=1)N=Xl(N,V[H]);v=new Wu({props:N});const W=[za[c[36]],{id:c[36]+"-self"},{type:"line"},{selected:c[7].selected},{layout:{visibility:c[7].type==c[36]?"visible":"none"}},{paint:c[7].type==c[36]?zr["line-self"]:zr.line}];let K={};for(let H=0;H<W.length;H+=1)K=Xl(K,W[H]);return E=new Wu({props:K}),{c(){gi(p.$$.fragment),m=pt(),gi(v.$$.fragment),S=pt(),gi(E.$$.fragment)},l(H){_i(p.$$.fragment,H),m=ft(H),_i(v.$$.fragment,H),S=ft(H),_i(E.$$.fragment,H)},m(H,pe){vi(p,H,pe),dt(H,m,pe),vi(v,H,pe),dt(H,S,pe),vi(E,H,pe),s=!0},p(H,pe){const Re=pe[0]&384?Wl(C,[pe&0&&Hl(za[H[36]]),C[1],C[2],pe[0]&256&&{isChild:H[8][H[36]]},C[4],pe[0]&128&&{selected:H[7].selected},C[6],pe[0]&128&&{highlighted:H[7].highlighted},C[8],pe[0]&128&&{hovered:H[7].hovered},pe[0]&128&&{layout:{visibility:H[7].type==H[36]||H[7].childType==H[36]?"visible":"none"}},pe[0]&128&&{paint:H[7].type==H[36]?zr["fill-self"]:H[7].childType==H[36]?zr["fill-child"]:zr.fill}]):{};p.$set(Re);const ze=pe[0]&128?Wl(V,[pe&0&&Hl(za[H[36]]),V[1],V[2],pe[0]&128&&{selected:H[7].selected},V[4],pe[0]&128&&{highlighted:H[7].highlighted},pe[0]&128&&{layout:{visibility:H[7].type==H[36]||H[7].childType==H[36]?"visible":"none"}},pe[0]&128&&{paint:H[7].type==H[36]?zr["line-active"]:H[7].childType==H[36]?zr["line-child"]:zr.line}]):{};v.$set(ze);const Ge=pe[0]&128?Wl(W,[pe&0&&Hl(za[H[36]]),W[1],W[2],pe[0]&128&&{selected:H[7].selected},pe[0]&128&&{layout:{visibility:H[7].type==H[36]?"visible":"none"}},pe[0]&128&&{paint:H[7].type==H[36]?zr["line-self"]:zr.line}]):{};E.$set(Ge)},i(H){s||(Zt(p.$$.fragment,H),Zt(v.$$.fragment,H),Zt(E.$$.fragment,H),s=!0)},o(H){ir(p.$$.fragment,H),ir(v.$$.fragment,H),ir(E.$$.fragment,H),s=!1},d(H){xi(p,H),H&&ae(m),xi(v,H),H&&ae(S),xi(E,H)}}}function Sm(c){let p,m;const v=[Rh[c[36]]];let S={$$slots:{default:[C0]},$$scope:{ctx:c}};for(let E=0;E<v.length;E+=1)S=Xl(S,v[E]);return p=new Qm({props:S}),{c(){gi(p.$$.fragment)},l(E){_i(p.$$.fragment,E)},m(E,s){vi(p,E,s),m=!0},p(E,s){const C=s&0?Wl(v,[Hl(Rh[E[36]])]):{};s[0]&384|s[1]&2048&&(C.$$scope={dirty:s,ctx:E}),p.$set(C)},i(E){m||(Zt(p.$$.fragment,E),m=!0)},o(E){ir(p.$$.fragment,E),m=!1},d(E){xi(p,E)}}}function Em(c){let p,m,v,S,E,s;const C=[za[c[36]],{id:c[36]+"-fill"},{type:"fill"},{isChild:c[8][c[36]]},{click:!0},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{hover:!0},{hovered:c[7].hovered},{layout:{visibility:c[7].type==c[36]||c[7].childType==c[36]?"visible":"none"}},{paint:c[7].type==c[36]?zr["fill-self"]:c[7].childType==c[36]?zr["fill-child"]:zr.fill}];let A={};for(let H=0;H<C.length;H+=1)A=Xl(A,C[H]);p=new Wu({props:A}),p.$on("select",c[13]);const V=[za[c[36]],{id:c[36]+"-bounds"},{type:"line"},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{layout:{visibility:c[7].type==c[36]||c[7].childType==c[36]?"visible":"none"}},{paint:c[7].type==c[36]?zr["line-active"]:c[7].childType==c[36]?zr["line-child"]:zr.line}];let N={};for(let H=0;H<V.length;H+=1)N=Xl(N,V[H]);v=new Wu({props:N});const W=[za[c[36]],{id:c[36]+"-self"},{type:"line"},{selected:c[7].selected},{layout:{visibility:c[7].type==c[36]?"visible":"none"}},{paint:c[7].type==c[36]?zr["line-self"]:zr.line}];let K={};for(let H=0;H<W.length;H+=1)K=Xl(K,W[H]);return E=new Wu({props:K}),{c(){gi(p.$$.fragment),m=pt(),gi(v.$$.fragment),S=pt(),gi(E.$$.fragment)},l(H){_i(p.$$.fragment,H),m=ft(H),_i(v.$$.fragment,H),S=ft(H),_i(E.$$.fragment,H)},m(H,pe){vi(p,H,pe),dt(H,m,pe),vi(v,H,pe),dt(H,S,pe),vi(E,H,pe),s=!0},p(H,pe){const Re=pe[0]&384?Wl(C,[pe&0&&Hl(za[H[36]]),C[1],C[2],pe[0]&256&&{isChild:H[8][H[36]]},C[4],pe[0]&128&&{selected:H[7].selected},C[6],pe[0]&128&&{highlighted:H[7].highlighted},C[8],pe[0]&128&&{hovered:H[7].hovered},pe[0]&128&&{layout:{visibility:H[7].type==H[36]||H[7].childType==H[36]?"visible":"none"}},pe[0]&128&&{paint:H[7].type==H[36]?zr["fill-self"]:H[7].childType==H[36]?zr["fill-child"]:zr.fill}]):{};p.$set(Re);const ze=pe[0]&128?Wl(V,[pe&0&&Hl(za[H[36]]),V[1],V[2],pe[0]&128&&{selected:H[7].selected},V[4],pe[0]&128&&{highlighted:H[7].highlighted},pe[0]&128&&{layout:{visibility:H[7].type==H[36]||H[7].childType==H[36]?"visible":"none"}},pe[0]&128&&{paint:H[7].type==H[36]?zr["line-active"]:H[7].childType==H[36]?zr["line-child"]:zr.line}]):{};v.$set(ze);const Ge=pe[0]&128?Wl(W,[pe&0&&Hl(za[H[36]]),W[1],W[2],pe[0]&128&&{selected:H[7].selected},pe[0]&128&&{layout:{visibility:H[7].type==H[36]?"visible":"none"}},pe[0]&128&&{paint:H[7].type==H[36]?zr["line-self"]:zr.line}]):{};E.$set(Ge)},i(H){s||(Zt(p.$$.fragment,H),Zt(v.$$.fragment,H),Zt(E.$$.fragment,H),s=!0)},o(H){ir(p.$$.fragment,H),ir(v.$$.fragment,H),ir(E.$$.fragment,H),s=!1},d(H){xi(p,H),H&&ae(m),xi(v,H),H&&ae(S),xi(E,H)}}}function M0(c){let p,m,v=["lgd"],S=[];for(let s=0;s<1;s+=1)S[s]=Em(ym(c,v,s));const E=s=>ir(S[s],1,1,()=>{S[s]=null});return{c(){for(let s=0;s<1;s+=1)S[s].c();p=dn()},l(s){for(let C=0;C<1;C+=1)S[C].l(s);p=dn()},m(s,C){for(let A=0;A<1;A+=1)S[A].m(s,C);dt(s,p,C),m=!0},p(s,C){if(C[0]&8576){v=["lgd"];let A;for(A=0;A<1;A+=1){const V=ym(s,v,A);S[A]?(S[A].p(V,C),Zt(S[A],1)):(S[A]=Em(V),S[A].c(),Zt(S[A],1),S[A].m(p.parentNode,p))}for(mu(),A=1;A<1;A+=1)E(A);yu()}},i(s){if(!m){for(let C=0;C<1;C+=1)Zt(S[C]);m=!0}},o(s){S=S.filter(Boolean);for(let C=0;C<1;C+=1)ir(S[C]);m=!1},d(s){Ms(S,s),s&&ae(p)}}}function D0(c){let p,m,v,S=["ward","dea"],E=[];for(let V=0;V<2;V+=1)E[V]=Sm(gm(c,S,V));const s=V=>ir(E[V],1,1,()=>{E[V]=null}),C=[Rh.lgd];let A={$$slots:{default:[M0]},$$scope:{ctx:c}};for(let V=0;V<C.length;V+=1)A=Xl(A,C[V]);return m=new Qm({props:A}),{c(){for(let V=0;V<2;V+=1)E[V].c();p=pt(),gi(m.$$.fragment)},l(V){for(let N=0;N<2;N+=1)E[N].l(V);p=ft(V),_i(m.$$.fragment,V)},m(V,N){for(let W=0;W<2;W+=1)E[W].m(V,N);dt(V,p,N),vi(m,V,N),v=!0},p(V,N){if(N[0]&8576){S=["ward","dea"];let K;for(K=0;K<2;K+=1){const H=gm(V,S,K);E[K]?(E[K].p(H,N),Zt(E[K],1)):(E[K]=Sm(H),E[K].c(),Zt(E[K],1),E[K].m(p.parentNode,p))}for(mu(),K=2;K<2;K+=1)s(K);yu()}const W=N&0?Wl(C,[Hl(Rh.lgd)]):{};N[0]&384|N[1]&2048&&(W.$$scope={dirty:N,ctx:V}),m.$set(W)},i(V){if(!v){for(let N=0;N<2;N+=1)Zt(E[N]);Zt(m.$$.fragment,V),v=!0}},o(V){E=E.filter(Boolean);for(let N=0;N<2;N+=1)ir(E[N]);ir(m.$$.fragment,V),v=!1},d(V){Ms(E,V),V&&ae(p),xi(m,V)}}}function L0(c){let p,m,v=c[1].name+"",S;return{c(){p=Ie("span"),m=$e("No parents for "),S=$e(v),this.h()},l(E){p=ke(E,"SPAN",{class:!0});var s=we(p);m=et(s,"No parents for "),S=et(s,v),s.forEach(ae),this.h()},h(){X(p,"class","muted")},m(E,s){dt(E,p,s),ie(p,m),ie(p,S)},p(E,s){s[0]&2&&v!==(v=E[1].name+"")&&Ar(S,v)},d(E){E&&ae(p)}}}function R0(c){let p,m=[...c[1].parents].reverse(),v=[];for(let S=0;S<m.length;S+=1)v[S]=Tm(mm(c,m,S));return{c(){for(let S=0;S<v.length;S+=1)v[S].c();p=dn()},l(S){for(let E=0;E<v.length;E+=1)v[E].l(S);p=dn()},m(S,E){for(let s=0;s<v.length;s+=1)v[s].m(S,E);dt(S,p,E)},p(S,E){if(E[0]&2){m=[...S[1].parents].reverse();let s;for(s=0;s<m.length;s+=1){const C=mm(S,m,s);v[s]?v[s].p(C,E):(v[s]=Tm(C),v[s].c(),v[s].m(p.parentNode,p))}for(;s<v.length;s+=1)v[s].d(1);v.length=m.length}},d(S){Ms(v,S),S&&ae(p)}}}function Tm(c){let p,m,v=c[33]>0?"\u21B3 ":"",S,E=c[34].name+"",s,C;return{c(){p=Ie("span"),m=new Op(!1),S=Ie("a"),s=$e(E),this.h()},l(A){p=ke(A,"SPAN",{style:!0});var V=we(p);m=Fp(V,!1),S=ke(V,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var N=we(S);s=et(N,E),N.forEach(ae),V.forEach(ae),this.h()},h(){m.a=S,X(S,"href",C=$s+"/"+c[34].code),X(S,"sveltekit:noscroll",""),X(S,"class","svelte-1dy7mjs"),Me(p,"display","block"),Me(p,"margin-left",(c[33]>0?(c[33]-1)*15:0)+"px")},m(A,V){dt(A,p,V),m.m(v,p),ie(p,S),ie(S,s)},p(A,V){V[0]&2&&E!==(E=A[34].name+"")&&Ar(s,E),V[0]&2&&C!==(C=$s+"/"+A[34].code)&&X(S,"href",C)},d(A){A&&ae(p)}}}function B0(c){let p,m,v=c[1].name+"",S;return{c(){p=Ie("span"),m=$e("No areas below "),S=$e(v),this.h()},l(E){p=ke(E,"SPAN",{class:!0});var s=we(p);m=et(s,"No areas below "),S=et(s,v),s.forEach(ae),this.h()},h(){X(p,"class","muted")},m(E,s){dt(E,p,s),ie(p,m),ie(p,S)},p(E,s){s[0]&2&&v!==(v=E[1].name+"")&&Ar(S,v)},d(E){E&&ae(p)}}}function O0(c){let p,m=c[1].children,v=[];for(let S=0;S<m.length;S+=1)v[S]=Im(dm(c,m,S));return{c(){for(let S=0;S<v.length;S+=1)v[S].c();p=dn()},l(S){for(let E=0;E<v.length;E+=1)v[E].l(S);p=dn()},m(S,E){for(let s=0;s<v.length;s+=1)v[s].m(S,E);dt(S,p,E)},p(S,E){if(E[0]&2){m=S[1].children;let s;for(s=0;s<m.length;s+=1){const C=dm(S,m,s);v[s]?v[s].p(C,E):(v[s]=Im(C),v[s].c(),v[s].m(p.parentNode,p))}for(;s<v.length;s+=1)v[s].d(1);v.length=m.length}},d(S){Ms(v,S),S&&ae(p)}}}function Im(c){let p,m=c[31].name+"",v,S,E=c[33]<c[1].children.length-1?", ":"",s;return{c(){p=Ie("a"),v=$e(m),s=$e(E),this.h()},l(C){p=ke(C,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var A=we(p);v=et(A,m),A.forEach(ae),s=et(C,E),this.h()},h(){X(p,"href",S=$s+"/"+c[31].code),X(p,"sveltekit:noscroll",""),X(p,"class","svelte-1dy7mjs")},m(C,A){dt(C,p,A),ie(p,v),dt(C,s,A)},p(C,A){A[0]&2&&m!==(m=C[31].name+"")&&Ar(v,m),A[0]&2&&S!==(S=$s+"/"+C[31].code)&&X(p,"href",S),A[0]&2&&E!==(E=C[33]<C[1].children.length-1?", ":"")&&Ar(s,E)},d(C){C&&ae(p),C&&ae(s)}}}function F0(c){let p,m,v=c[1]&&c[2]&&vm(c);return{c(){v&&v.c(),p=dn()},l(S){v&&v.l(S),p=dn()},m(S,E){v&&v.m(S,E),dt(S,p,E),m=!0},p(S,E){S[1]&&S[2]?v?(v.p(S,E),E[0]&6&&Zt(v,1)):(v=vm(S),v.c(),Zt(v,1),v.m(p.parentNode,p)):v&&(mu(),ir(v,1,1,()=>{v=null}),yu())},i(S){m||(Zt(v),m=!0)},o(S){ir(v),m=!1},d(S){v&&v.d(S),S&&ae(p)}}}function V0(c){let p,m,v,S,E,s,C,A,V,N,W,K,H,pe;return document.title=p=c[1].name+" Census Data",H=new Lg({props:{column:"wide",$$slots:{default:[F0]},$$scope:{ctx:c}}}),{c(){m=Ie("meta"),v=Ie("meta"),E=Ie("meta"),s=Ie("meta"),A=Ie("meta"),N=Ie("meta"),K=pt(),gi(H.$$.fragment),this.h()},l(Re){const ze=Cg('[data-svelte="svelte-hyixok"]',document.head);m=ke(ze,"META",{name:!0,content:!0}),v=ke(ze,"META",{property:!0,content:!0}),E=ke(ze,"META",{property:!0,content:!0}),s=ke(ze,"META",{property:!0,content:!0}),A=ke(ze,"META",{property:!0,content:!0}),N=ke(ze,"META",{name:!0,content:!0}),ze.forEach(ae),K=ft(Re),_i(H.$$.fragment,Re),this.h()},h(){X(m,"name","description"),X(m,"content",""),X(v,"property","og:title"),X(v,"content",S=c[1].name+" Census Data"),X(E,"property","og:type"),X(E,"content","website"),X(s,"property","og:url"),X(s,"content",C=Lh.base+"/"+c[1].code+"/"),X(A,"property","og:description"),X(A,"content",V="Explore census data for "+c[1].name+"."),X(N,"name","description"),X(N,"content",W="Explore census data for "+c[1].name+".")},m(Re,ze){ie(document.head,m),ie(document.head,v),ie(document.head,E),ie(document.head,s),ie(document.head,A),ie(document.head,N),dt(Re,K,ze),vi(H,Re,ze),pe=!0},p(Re,ze){(!pe||ze[0]&2)&&p!==(p=Re[1].name+" Census Data")&&(document.title=p),(!pe||ze[0]&2&&S!==(S=Re[1].name+" Census Data"))&&X(v,"content",S),(!pe||ze[0]&2&&C!==(C=Lh.base+"/"+Re[1].code+"/"))&&X(s,"content",C),(!pe||ze[0]&2&&V!==(V="Explore census data for "+Re[1].name+"."))&&X(A,"content",V),(!pe||ze[0]&2&&W!==(W="Explore census data for "+Re[1].name+"."))&&X(N,"content",W);const Ge={};ze[0]&4095|ze[1]&2048&&(Ge.$$scope={dirty:ze,ctx:Re}),H.$set(Ge)},i(Re){pe||(Zt(H.$$.fragment,Re),pe=!0)},o(Re){ir(H.$$.fragment,Re),pe=!1},d(Re){ae(m),ae(v),ae(E),ae(s),ae(A),ae(N),Re&&ae(K),xi(H,Re)}}}const K0=!0;async function km(c,p){return await(await p(Lh.places+c+".json")).json()}async function X0({params:c,fetch:p}){let m=c.code,v=await Zg(Lh.options,p),S={};v.forEach(A=>S[A.code]=A.name),v.forEach(A=>{A.typepl=fu[A.type].pl,A.typenm=fu[A.type].name,A.typestr=S[A.parent]?`${fu[A.type].name} within ${S[A.parent]}`:""});let E=v.sort((A,V)=>A.name.localeCompare(V.name)),s=await km("N92000002",p),C=await km(m,p);return{props:{options:E,place:C,ew:s}}}function N0(c,p,m){let v,S,E,{options:s,place:C,ew:A}=p,V,N,W=null,K=!1,H={selected:null,type:null,childType:null,highlighted:[],hovered:null},pe={};Object.keys(za).forEach(Pt=>m(8,pe[Pt]=!1,pe));function Re(Pt){const tr=(wr,Bt)=>wr+Bt;let rt=Pt[0],Ze=Pt[1],lr=C.data[rt][Ze][2020],Tr=C.data[rt][Ze][2010],on=A.data[rt][Ze][2020],an=yd[rt].map(wr=>wr.code),Ni=yd[rt].map(wr=>wr.label?wr.label:wr.code);return an.map((wr,Bt)=>Array.isArray(wr)?{x:Ni[Bt],y:wr.map(Lr=>lr[Lr]).reduce(tr,0),ew:wr.map(Lr=>on[Lr]).reduce(tr,0),prev:wr.map(Lr=>Tr[Lr]).reduce(tr,0)}:{x:Ni[Bt],y:lr[wr],ew:on[wr],prev:Tr[wr]})}function ze(Pt){W&&W.fitBounds(Pt,{padding:20})}function Ge(Pt){let tr=JSON.parse(JSON.stringify(H)),rt=Pt.code,Ze=Pt.type,lr=Pt.children[0]?Pt.children.map(Xt=>Xt.code):[],Tr=Pt.type=="rgn"?"cty":lr[0]?Pt.children[0].type:null;m(7,H.selected=rt,H),m(7,H.type=Ze,H),m(7,H.childType=Tr,H),m(7,H.highlighted=lr,H);let on=Object.keys(za),an=["fill-color","fill-opacity"],Ni=["line-color","line-width","line-opacity"];W&&(H.type!=tr.type||H.childType!=tr.childType)&&(on.forEach(Xt=>{let wr=Xt==Ze||Tr&&Xt==Tr?"visible":"none";W.setLayoutProperty(Xt+"-fill","visibility",wr),W.setLayoutProperty(Xt+"-bounds","visibility",wr),Pt.parents[0]&&W.setLayoutProperty(Xt+"-self","visibility",wr),m(8,pe[Xt]=Xt==Tr,pe)}),Pt.parents[0]&&(an.forEach(Xt=>W.setPaintProperty(Ze+"-fill",Xt,zr[lr[0]?"fill-active":"fill-self"][Xt])),Ni.forEach(Xt=>{W.setPaintProperty(Ze+"-bounds",Xt,zr["line-active"][Xt]),W.setPaintProperty(Ze+"-self",Xt,zr["line-self"][Xt])})),Tr&&(an.forEach(Xt=>W.setPaintProperty(Tr+"-fill",Xt,zr["fill-child"][Xt])),Ni.forEach(Xt=>W.setPaintProperty(Tr+"-bounds",Xt,zr["line-child"][Xt]))))}function Ke(Pt){Ge(Pt),ze(Pt.bounds)}function Nt(Pt){vd(`${$s}/${Pt.detail.code}/`,{noscroll:!0})}function Dt(Pt){vd(`${$s}/${Pt.detail.value}/`,{noscroll:!0})}function mt(){m(5,N=V<575?1:window.getComputedStyle(grid).getPropertyValue("grid-template-columns").split(" ").length)}const He=()=>m(9,E=!0),Er=()=>m(4,K=!1),hr=()=>m(10,S=!1),Ht=()=>m(10,S=!0),Jt=()=>m(9,E=!1),qe=()=>m(4,K=!1),_r=()=>m(4,K=!0),At=()=>m(9,E=!1),nr=()=>m(10,S=!1);function tt(Pt){W=Pt,m(6,W)}function pr(){V=this.clientWidth,m(3,V)}function Vr(){V=this.clientWidth,m(3,V)}return c.$$set=Pt=>{"options"in Pt&&m(0,s=Pt.options),"place"in Pt&&m(1,C=Pt.place),"ew"in Pt&&m(2,A=Pt.ew)},c.$$.update=()=>{c.$$.dirty[0]&8&&V&&mt(),c.$$.dirty[0]&18&&m(11,v=K?"Same area 2010":C&&C.parents[0]?"NI 2020":null),c.$$.dirty[0]&2&&C&&Ke(C)},m(10,S=!1),m(9,E=!0),[s,C,A,V,K,N,W,H,pe,E,S,v,Re,Nt,Dt,He,Er,hr,Ht,Jt,qe,_r,At,nr,tt,pr,Vr]}class W0 extends Ka{constructor(p){super(),Xa(this,p,N0,V0,Wa,{options:0,place:1,ew:2},null,[-1,-1])}}export{W0 as default,X0 as load,K0 as prerender};
